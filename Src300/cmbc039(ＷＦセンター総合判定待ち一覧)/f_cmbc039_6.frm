VERSION 5.00
Object = "{B02F3647-766B-11CE-AF28-C3A2FBE76A13}#3.0#0"; "SPR32X30.ocx"
Begin VB.Form f_cmbc039_6 
   BorderStyle     =   1  'å≈íË(é¿ê¸)
   Caption         =   " f_cmbc039_6"
   ClientHeight    =   10875
   ClientLeft      =   1575
   ClientTop       =   1680
   ClientWidth     =   15270
   ControlBox      =   0   'False
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   725
   ScaleMode       =   3  'Àﬂ∏æŸ
   ScaleWidth      =   1018
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.TextBox txtDateT 
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   330
      IMEMode         =   3  'µÃå≈íË
      Left            =   4200
      MaxLength       =   8
      TabIndex        =   1
      Text            =   "20120808"
      Top             =   960
      Width           =   1140
   End
   Begin VB.TextBox txtDateF 
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   330
      IMEMode         =   3  'µÃå≈íË
      Left            =   2400
      MaxLength       =   8
      TabIndex        =   0
      Text            =   "20120808"
      Top             =   960
      Width           =   1140
   End
   Begin VB.Frame fraHead 
      Height          =   735
      Left            =   0
      TabIndex        =   2
      Top             =   0
      Width           =   15225
      Begin VB.Label lblvers 
         Height          =   195
         Left            =   13680
         TabIndex        =   24
         Top             =   480
         Width           =   1440
      End
      Begin VB.Label lblTime 
         Height          =   150
         Left            =   13680
         TabIndex        =   5
         Top             =   240
         Width           =   1455
      End
      Begin VB.Label lblMsg 
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   375
         Left            =   3810
         TabIndex        =   4
         Top             =   240
         Width           =   7050
      End
      Begin VB.Label lblTitle 
         Caption         =   "ÇOñáÉçÉbÉgàÍóóï\é¶"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   210
         TabIndex        =   3
         Top             =   270
         Width           =   3495
      End
   End
   Begin VB.Frame fraF 
      Height          =   1095
      Left            =   30
      TabIndex        =   7
      Top             =   9540
      Width           =   15195
      Begin VB.CommandButton cmdF 
         Caption         =   "[F12]Å@Å@Å@ ï¬Ç∂ÇÈ"
         Height          =   735
         Index           =   12
         Left            =   13920
         TabIndex        =   19
         TabStop         =   0   'False
         Top             =   240
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇR]Å@Å@Å@ÅñÅñÅñ"
         Height          =   735
         Index           =   3
         Left            =   2824
         TabIndex        =   18
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇQ]Å@Å@Å@ÅñÅñÅñ"
         Height          =   735
         Index           =   2
         Left            =   1592
         TabIndex        =   17
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇP]Å@Å@Å@ÅñÅñÅñ"
         Height          =   735
         Index           =   0
         Left            =   360
         TabIndex        =   16
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇX]Å@Å@Å@íäèo"
         Height          =   735
         Index           =   9
         Left            =   10216
         TabIndex        =   15
         TabStop         =   0   'False
         Top             =   240
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇS]Å@Å@Å@ÅñÅñÅñ"
         Height          =   735
         Index           =   4
         Left            =   4056
         TabIndex        =   14
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇT]Å@Å@Å@ÅñÅñÅñ"
         Height          =   735
         Index           =   5
         Left            =   5288
         TabIndex        =   13
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇU]Å@Å@Å@ÅñÅñÅñ"
         Height          =   735
         Index           =   6
         Left            =   6520
         TabIndex        =   12
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇV]Å@Å@Å@ÅñÅñÅñ"
         Height          =   735
         Index           =   7
         Left            =   7752
         TabIndex        =   11
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇW]Å@Å@Å@ÅñÅñÅñ"
         Height          =   735
         Index           =   8
         Left            =   8984
         TabIndex        =   10
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[F10]Å@Å@Å@ÅñÅñÅñ"
         Height          =   735
         Index           =   10
         Left            =   11448
         TabIndex        =   9
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[F11]Å@Å@Å@ÅñÅñÅñ"
         Height          =   735
         Index           =   11
         Left            =   12680
         TabIndex        =   8
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   960
      End
   End
   Begin FPSpread.vaSpread spdZeroView 
      Height          =   7725
      Left            =   240
      TabIndex        =   20
      Top             =   1680
      Width           =   14655
      _Version        =   196608
      _ExtentX        =   25850
      _ExtentY        =   13626
      _StockProps     =   64
      BackColorStyle  =   1
      ColHeaderDisplay=   0
      ColsFrozen      =   4
      MaxCols         =   15
      MaxRows         =   1
      RetainSelBlock  =   0   'False
      SpreadDesigner  =   "f_cmbc039_6.frx":0000
      UserResize      =   0
      VisibleCols     =   15
      VisibleRows     =   1
   End
   Begin VB.Label Label3 
      Caption         =   "(YYYYMMDD)"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   4140
      TabIndex        =   23
      Top             =   1320
      Width           =   1305
   End
   Begin VB.Label Label2 
      Caption         =   "(YYYYMMDD)"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   2340
      TabIndex        =   22
      Top             =   1320
      Width           =   1305
   End
   Begin VB.Label Label1 
      Caption         =   "WFï•èoì˙ÅF"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   1080
      TabIndex        =   21
      Top             =   990
      Width           =   1305
   End
   Begin VB.Label Label5 
      Caption         =   "Å`"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   3720
      TabIndex        =   6
      Top             =   960
      Width           =   375
   End
End
Attribute VB_Name = "f_cmbc039_6"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
'===============================================================================
' ÇOñáÉçÉbÉgàÍóóï\é¶âÊñ 
' 2012/09/07 SETsw Marushita
' äTóv    :Å@ÉTÉìÉvÉãè¡îÔÇ≈0ñáÉçÉbÉgÇ∆Ç»Ç¡ÇΩÉfÅ[É^ÇàÍóóï\é¶Ç∑ÇÈ(10ñáà»â∫ÉçÉbÉgó¨ìÆëŒâû)
'===============================================================================

'*******************************************************************************
'*    ä÷êîñº        : DispSpdZeroView
'*
'*    èàóùäTóv      : 1.íäèoèåèÇ…ÇÊÇËÅA0åèÉçÉbÉgàÍóóÇéÊìæÇµï\é¶Ç∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*                    Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub DispSpdZeroView()
    Dim intLoopCnt  As Integer
    Dim sSprSta     As String
    Dim intRowNo    As Integer
    Dim sDateF      As String
    Dim sDateT      As String
    Dim sMukesaki   As String
    Dim smpId(2)    As String
    Dim sErrMsg     As String
    
    intRowNo = 0
    
    'ÉXÉvÉåÉbÉhÉRÉìÉgÉçÅ[ÉãÇÃèâä˙âªèàóù
    SpCtrlInit f_cmbc039_6.spdZeroView, 0

    'âÊñ Ç©ÇÁíäèoèåèÇéÊìæÇ∑ÇÈ
    If Trim(txtDateF.text) = "" Then
    Else
        'ì¸óÕì˙ïtÉ`ÉFÉbÉN
        If DateCheck(Trim(txtDateF.text), 0) = False Then
            lblMsg.Caption = "ê≥ÇµÇ¢ì˙ïtÇì¸óÕÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB"
            txtDateF.SetFocus
            Exit Sub
        End If
    End If
    If Trim(txtDateT.text) = "" Then
    Else
        'ì¸óÕì˙ïtÉ`ÉFÉbÉN
        If DateCheck(Trim(txtDateT.text), 0) = False Then
            lblMsg.Caption = "ê≥ÇµÇ¢ì˙ïtÇì¸óÕÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB"
            txtDateT.SetFocus
            Exit Sub
        End If
        'ì¸óÕì˙ïtëÂè¨É`ÉFÉbÉN
        If Trim(txtDateF.text) > Trim(txtDateT.text) Then
            lblMsg.Caption = "ê≥ÇµÇ¢ì˙ïtîÕàÕÇì¸óÕÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB"
            txtDateF.SetFocus
            Exit Sub
        End If
    End If
    
    sDateF = txtDateF.text
    'TOì˙ïtéwíËéûÇÕéûä‘Çïtâ¡
    If Trim(txtDateT.text) = "" Then
        sDateT = txtDateT.text
    Else
        sDateT = txtDateT.text & " 23:59:59"
    End If
    
    '0ñáÉçÉbÉgàÍóóèÓïÒéÊìæ
    lblMsg.Caption = GetMsgStr(PWAIT)
    DoEvents
    
    'íäèoèåèÇéwíËÇµÇƒëŒè€ÉfÅ[É^ÇéÊìæÇ∑ÇÈÅB
    If DBDRV_fcmbc039_6_Disp(gsMukeCd, sDateF, sDateT, typ_zero(), sErrMsg) = FUNCTION_RETURN_FAILURE Then
        lblMsg.Caption = "ëŒè€ÉfÅ[É^éÊìæÉGÉâÅ[Ç≈Ç∑ÅB"
        Exit Sub
    End If
        
    If UBound(typ_zero) = 0 Then
        lblMsg.Caption = "ëŒè€ÉfÅ[É^Ç™Ç†ÇËÇ‹ÇπÇÒÅB"
        Exit Sub
    Else
        lblMsg.Caption = ""
    End If
    
    'ëŒè€ÉfÅ[É^ÇàÍóóï\é¶Ç∑ÇÈ
    With spdZeroView
        .ReDraw = False
        For intLoopCnt = 1 To UBound(typ_zero)
            intRowNo = intRowNo + 1
    
            sSprSta = ""

            If UBound(typ_zero(intLoopCnt).WFSMP) >= 1 Then
                smpId(1) = Trim(typ_zero(intLoopCnt).WFSMP(1).REPSMPLIDCW)
            Else
                smpId(1) = vbNullString
            End If
            If UBound(typ_zero(intLoopCnt).WFSMP) >= 2 Then
                smpId(2) = Trim(typ_zero(intLoopCnt).WFSMP(UBound(typ_zero(intLoopCnt).WFSMP)).REPSMPLIDCW)
            Else
                smpId(2) = vbNullString
            End If
                    
            .MaxRows = intRowNo
            .row = intRowNo
    
            'å¸êÊ
            .col = 1
            .SetText 1, intRowNo, typ_zero(intLoopCnt).PLANTCAT
    
            'âºSXL-ID
            .col = 2
            .SetText 2, intRowNo, typ_zero(intLoopCnt).SXLIDCA
    
            'ïiî‘
            .col = 3
            .SetText 3, intRowNo, typ_zero(intLoopCnt).HINBCA
            
            'í∑Ç≥
            .col = 4
            .SetText 4, intRowNo, typ_zero(intLoopCnt).GNLCA

            'ñáêî
            .col = 5
            .SetText 5, intRowNo, typ_zero(intLoopCnt).MAICB
    
            'WFï•èoì˙
            .col = 6
            .SetText 6, intRowNo, Format(typ_zero(intLoopCnt).TDAYCB, "yyyy/mm/dd")
    
            'ÉTÉìÉvÉãID(è„ë§)
            .col = 7
            .SetText 7, intRowNo, smpId(1)
    
            'ÉTÉìÉvÉãID(â∫ë§)
            .col = 8
            .SetText 8, intRowNo, smpId(2)
    
            'ç≈èIéÛêMì˙(è„ë§)
            If Not (smpId(1) = "" Or _
                left(smpId(1), 1) = vbNullChar) Then
                If UBound(typ_zero(intLoopCnt).WFSMP) >= 1 Then
                    .col = 9
                    .SetText 9, intRowNo, Format(typ_zero(intLoopCnt).WFSMP(1).KDAYCW, "yyyy/mm/dd")
                End If
            End If
    
            'ç≈èIéÛêMì˙(â∫ë§)
            If Not (smpId(2) = "" Or _
                left(smpId(2), 1) = vbNullChar) Then
                If UBound(typ_zero(intLoopCnt).WFSMP) >= 2 Then
                    .col = 10
                    .SetText 10, intRowNo, Format(typ_zero(intLoopCnt).WFSMP(UBound(typ_zero(intLoopCnt).WFSMP)).KDAYCW, "yyyy/mm/dd")
                End If
            End If

            'åªç›çHíˆ(TEST)
            .col = 11
            .SetText 11, intRowNo, typ_zero(intLoopCnt).NOWPROC

'            'åá(è„ë§)
'            If typ_zero(intLoopCnt).KETURAKU = True Then
'                sSprSta = sSprSta & "óL" & Chr$(13) & Chr$(10)
'            Else
'                sSprSta = sSprSta & "ñ≥" & Chr$(13) & Chr$(10)
'            End If
                    
            'ÉfÅ[É^ï\é¶
            '1çsÉfÅ[É^ÉZÉbÉg
            '.Clip = sSprSta
            
'            bRc = gFnc_SS_RecordSet(.spdWait, intRow, strRecord, udt_ww, i)
'            '¥◊∞Ç™î≠ê∂ÇµÇΩèÍçá
'            If bRc = False Then
'                '¥◊∞èàóù
'                .lblMsg.Caption = "ï\é¶ÉGÉâÅ["
'                Exit Sub
'            End If
            
        Next
        .MaxRows = intRowNo
        .ReDraw = True
        
        If .MaxRows > 0 Then
            .col = 1
            .row = 1
            .Action = ActionActiveCell
        End If
        
    End With
End Sub

'*******************************************************************************
'*    ä÷êîñº        : cmdF_Click
'*
'*    èàóùäTóv      : 1.ÉtÉ@ÉìÉNÉVÉáÉìÉ{É^ÉìÇ™ÉNÉäÉbÉNÇ≥ÇÍÇΩÇÁÅAäeèàóùÇ…ï™äÚÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    Index       ,I  ,IntegerÅ@,ÉRÉìÉgÉçÅ[ÉãîzóÒÇÃìYéö
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub cmdF_Click(Index As Integer)
    '' èàóùï™äÚ
    Select Case Index
    Case 9        '' Çe9ÉLÅ[ÅiíäèoÅj
        Call DispSpdZeroView
    Case 12       '' Çe12ÉLÅ[Åié¿çsÅj
        Me.Visible = False
        Unload Me
    End Select
End Sub

'*******************************************************************************
'*    ä÷êîñº        : Form_Activate
'*
'*    èàóùäTóv      : 1.Form_Activateèàóù
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub Form_Activate()
End Sub

'*******************************************************************************
'*    ä÷êîñº        : Form_KeyDown
'*
'*    èàóùäTóv      : 1.ÉLÅ[É{Å[Éhâüâ∫èàóù
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    KeyCode     ,I  ,IntegerÅ@,ÉLÅ[ÉRÅ[Éh
'*                    Shift       ,I  ,IntegerÅ@,ShiftÉLÅ[ÇÃèÛë‘
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
    Dim intIndex As Integer

    '' ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[Ç™óLå¯Ç»ÇÁ
    If KeyCode >= vbKeyF1 And KeyCode <= vbKeyF12 Then
        '' âÊñ ï\é¶ÉÅÉbÉZÅ[ÉWÉNÉäÉA
        lblMsg.Caption = ""
        
        intIndex = KeyCode - (vbKeyF1 - 1)
        If cmdF(intIndex).Visible = True And cmdF(intIndex).Enabled = True Then
            '' ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[âüâ∫èàóùÇé¿çsÇ∑ÇÈ
            If KeyCode <> vbKeyF7 And KeyCode <> vbKeyF8 Then
                Call cmdF_Click(intIndex)
            End If
        End If
    End If
End Sub

'*******************************************************************************
'*    ä÷êîñº        : Form_Load
'*
'*    èàóùäTóv      : 1.Form_Loadèàóù
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub Form_Load()
    ' åªç›ì˙éûÇÃï\é¶
    SetPresentTime lblTime
    
    ' ÉoÅ[ÉWÉáÉìèÓïÒÇÃï\é¶
    lblvers.Caption = "Version " & App.Major & "." & App.Minor & "." & App.Revision
    
    ' íäèoì˙ïtÇÃèâä˙ílÉZÉbÉg
    txtDateF.text = Format(DateAdd("m", -1, Date), "yyyymmdd")
    txtDateT.text = Format(Date, "yyyymmdd")

    ' ÇOñáÉçÉbÉgàÍóóâÊñ ÇÃï\é¶
    Call DispSpdZeroView

End Sub

