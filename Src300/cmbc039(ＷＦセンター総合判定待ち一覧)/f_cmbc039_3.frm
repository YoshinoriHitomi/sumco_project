VERSION 5.00
Object = "{B02F3647-766B-11CE-AF28-C3A2FBE76A13}#3.0#0"; "SPR32X30.ocx"
Begin VB.Form f_cmbc039_3 
   AutoRedraw      =   -1  'True
   BorderStyle     =   1  'å≈íË(é¿ê¸)
   Caption         =   "f_cmbc039_3(CW750) - 300mmåãèªëÄã∆ÉVÉXÉeÉÄ"
   ClientHeight    =   10875
   ClientLeft      =   0
   ClientTop       =   750
   ClientWidth     =   15270
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   9
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   725
   ScaleMode       =   3  'Àﬂ∏æŸ
   ScaleWidth      =   1018
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.CommandButton cmdDisp 
      Caption         =   "WFCëççáîªíËéQè∆ï\é¶"
      Height          =   375
      Left            =   600
      TabIndex        =   63
      Top             =   9000
      Width           =   2175
   End
   Begin VB.PictureBox pic_Png 
      Height          =   135
      Left            =   2250
      ScaleHeight     =   75
      ScaleWidth      =   315
      TabIndex        =   59
      Top             =   8535
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.CheckBox chk_Png 
      Caption         =   "PNGï€ë∂"
      Height          =   375
      Left            =   690
      TabIndex        =   58
      Top             =   8535
      Width           =   1335
   End
   Begin VB.CommandButton CmdChangeWF_EP 
      Caption         =   "WF  >>"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   14280
      TabIndex        =   49
      Tag             =   "WF"
      Top             =   2160
      Width           =   855
   End
   Begin FPSpread.vaSpread sprWarp 
      Height          =   1140
      Left            =   3120
      TabIndex        =   47
      TabStop         =   0   'False
      Top             =   7935
      Width           =   4095
      _Version        =   196608
      _ExtentX        =   7218
      _ExtentY        =   2011
      _StockProps     =   64
      BackColorStyle  =   1
      DisplayRowHeaders=   0   'False
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MaxCols         =   6
      MaxRows         =   4
      RetainSelBlock  =   0   'False
      ScrollBars      =   2
      SpreadDesigner  =   "f_cmbc039_3.frx":0000
      UserResize      =   0
      VisibleCols     =   5
      VisibleRows     =   1
   End
   Begin FPSpread.vaSpread vaSpread5 
      Height          =   240
      Left            =   360
      TabIndex        =   45
      Top             =   2520
      Width           =   1560
      _Version        =   196608
      _ExtentX        =   2752
      _ExtentY        =   423
      _StockProps     =   64
      AllowDragDrop   =   -1  'True
      ColsFrozen      =   1
      DisplayRowHeaders=   0   'False
      MaxCols         =   1
      MaxRows         =   0
      OperationMode   =   1
      ScrollBars      =   0
      SpreadDesigner  =   "f_cmbc039_3.frx":0739
      UserResize      =   0
      VisibleCols     =   1
      ClipboardOptions=   0
   End
   Begin VB.PictureBox pic_check 
      BorderStyle     =   0  'Ç»Çµ
      Height          =   210
      Index           =   0
      Left            =   10380
      Picture         =   "f_cmbc039_3.frx":09A9
      ScaleHeight     =   210
      ScaleWidth      =   195
      TabIndex        =   37
      Top             =   8610
      Width           =   195
   End
   Begin VB.PictureBox pic_check 
      AutoSize        =   -1  'True
      BorderStyle     =   0  'Ç»Çµ
      FillColor       =   &H00C0C0C0&
      Height          =   285
      Index           =   1
      Left            =   10335
      Picture         =   "f_cmbc039_3.frx":0D1B
      ScaleHeight     =   285
      ScaleWidth      =   315
      TabIndex        =   36
      Top             =   8775
      Width           =   315
   End
   Begin VB.TextBox txtBotRsltR 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H0080FF80&
      Height          =   270
      Left            =   1650
      Locked          =   -1  'True
      TabIndex        =   15
      Top             =   8175
      Width           =   1095
   End
   Begin VB.TextBox txtTopRsltR 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H0080FF80&
      Height          =   270
      Left            =   1650
      Locked          =   -1  'True
      TabIndex        =   13
      Top             =   7935
      Width           =   1095
   End
   Begin VB.TextBox txtCryP 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H0080FF80&
      Height          =   270
      Left            =   8310
      Locked          =   -1  'True
      TabIndex        =   23
      Top             =   8745
      Width           =   855
   End
   Begin VB.TextBox txtBlkP 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H0080FF80&
      Height          =   270
      Left            =   8310
      Locked          =   -1  'True
      TabIndex        =   21
      Top             =   8475
      Width           =   855
   End
   Begin VB.TextBox txtBlkID 
      Alignment       =   2  'íÜâõëµÇ¶
      BackColor       =   &H0080FF80&
      Height          =   270
      Left            =   8310
      Locked          =   -1  'True
      TabIndex        =   19
      Top             =   8205
      Width           =   855
   End
   Begin VB.TextBox txtTarget 
      Alignment       =   1  'âEëµÇ¶
      Height          =   270
      IMEMode         =   3  'µÃå≈íË
      Left            =   8310
      TabIndex        =   17
      Top             =   7935
      Width           =   855
   End
   Begin VB.TextBox txtKSXLID 
      BackColor       =   &H0080FF80&
      Height          =   264
      Left            =   6600
      Locked          =   -1  'True
      TabIndex        =   9
      Top             =   1170
      Width           =   1260
   End
   Begin VB.TextBox txtCryNum 
      BackColor       =   &H0080FF80&
      Height          =   264
      Left            =   1770
      Locked          =   -1  'True
      TabIndex        =   11
      Top             =   1500
      Width           =   1200
   End
   Begin VB.TextBox txtJfName 
      BackColor       =   &H0080FF80&
      Height          =   264
      Left            =   2670
      Locked          =   -1  'True
      TabIndex        =   7
      Top             =   1170
      Width           =   1500
   End
   Begin VB.TextBox txtStaffID 
      BackColor       =   &H0080FF80&
      Height          =   264
      Left            =   1770
      Locked          =   -1  'True
      TabIndex        =   6
      TabStop         =   0   'False
      Top             =   1170
      Width           =   825
   End
   Begin VB.Frame fraF 
      Height          =   1095
      Left            =   30
      TabIndex        =   1
      Top             =   9540
      Width           =   15195
      Begin VB.CommandButton cmdF 
         Caption         =   "[F11]Å@Å@ëOâÊñ "
         Height          =   735
         Index           =   11
         Left            =   12680
         TabIndex        =   34
         TabStop         =   0   'False
         Top             =   240
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[F10]Å@Å@ª›ÃﬂŸ"
         Height          =   735
         Index           =   10
         Left            =   11448
         TabIndex        =   33
         TabStop         =   0   'False
         Top             =   240
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇW]Å@Å@çÌèú"
         Height          =   735
         Index           =   8
         Left            =   8984
         TabIndex        =   31
         TabStop         =   0   'False
         Top             =   240
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇV]Å@Å@ë}ì¸"
         Height          =   735
         Index           =   7
         Left            =   7752
         TabIndex        =   30
         TabStop         =   0   'False
         Top             =   240
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇU]Å@Å@WFœØÃﬂ"
         Height          =   735
         Index           =   6
         Left            =   6520
         TabIndex        =   29
         TabStop         =   0   'False
         Top             =   240
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇT]Å@Å@êUë÷"
         Enabled         =   0   'False
         Height          =   735
         Index           =   5
         Left            =   5288
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   28
         TabStop         =   0   'False
         Top             =   240
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇS]Å@Å@åÛï‚"
         Height          =   735
         Index           =   4
         Left            =   4056
         TabIndex        =   27
         TabStop         =   0   'False
         Top             =   240
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇX]Å@Å@åãèª≤“∞ºﬁï\é¶"
         Height          =   735
         Index           =   9
         Left            =   10216
         TabIndex        =   32
         TabStop         =   0   'False
         Top             =   240
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇP]Å@Å@ÅñÅñÅñ"
         Height          =   735
         Index           =   1
         Left            =   360
         TabIndex        =   24
         TabStop         =   0   'False
         Top             =   240
         Visible         =   0   'False
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇQ]Å@Å@ªÃﬁ“∆≠∞"
         Height          =   735
         Index           =   2
         Left            =   1592
         TabIndex        =   25
         TabStop         =   0   'False
         Top             =   240
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[FÇR]Å@Å@∑¨›æŸ"
         Height          =   735
         Index           =   3
         Left            =   2824
         TabIndex        =   26
         TabStop         =   0   'False
         Top             =   240
         Width           =   960
      End
      Begin VB.CommandButton cmdF 
         Caption         =   "[F12]Å@Å@é¿çs"
         Height          =   735
         Index           =   12
         Left            =   13905
         TabIndex        =   35
         TabStop         =   0   'False
         Top             =   240
         Width           =   960
      End
   End
   Begin VB.Frame FraTitle 
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Left            =   0
      TabIndex        =   0
      Top             =   0
      Width           =   15225
      Begin VB.Label lblvers 
         Height          =   195
         Left            =   13740
         TabIndex        =   44
         Top             =   480
         Width           =   1440
      End
      Begin VB.Label lblTime 
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   165
         Left            =   13740
         TabIndex        =   4
         Top             =   240
         Width           =   1365
      End
      Begin VB.Label lblMsg 
         Alignment       =   2  'íÜâõëµÇ¶
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   375
         Left            =   1800
         TabIndex        =   3
         Top             =   210
         Width           =   8535
      End
      Begin VB.Label lblTitle 
         Caption         =   "çƒî≤éééwé¶"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   120
         TabIndex        =   2
         Top             =   240
         Width           =   4575
      End
   End
   Begin FPSpread.vaSpread sprSpec 
      Height          =   885
      Left            =   75
      TabIndex        =   50
      TabStop         =   0   'False
      Top             =   2520
      Width           =   15150
      _Version        =   196608
      _ExtentX        =   26723
      _ExtentY        =   1561
      _StockProps     =   64
      BackColorStyle  =   1
      ColsFrozen      =   30
      MaxCols         =   33
      MaxRows         =   5
      RetainSelBlock  =   0   'False
      ScrollBars      =   2
      SpreadDesigner  =   "f_cmbc039_3.frx":121D
      UserResize      =   0
      VisibleCols     =   32
      VisibleRows     =   5
   End
   Begin FPSpread.vaSpread vaSpread8 
      Height          =   240
      Left            =   75
      TabIndex        =   51
      TabStop         =   0   'False
      Top             =   3990
      Width           =   3870
      _Version        =   196608
      _ExtentX        =   6826
      _ExtentY        =   423
      _StockProps     =   64
      ColsFrozen      =   1
      DisplayRowHeaders=   0   'False
      MaxCols         =   1
      MaxRows         =   0
      RetainSelBlock  =   0   'False
      ScrollBars      =   0
      ShadowColor     =   12632256
      ShadowDark      =   10070188
      ShadowText      =   0
      SpreadDesigner  =   "f_cmbc039_3.frx":3267
      UserResize      =   0
      VisibleCols     =   1
   End
   Begin FPSpread.vaSpread vaSpread7 
      Height          =   480
      Left            =   75
      TabIndex        =   52
      TabStop         =   0   'False
      Top             =   4215
      Width           =   3870
      _Version        =   196608
      _ExtentX        =   6826
      _ExtentY        =   847
      _StockProps     =   64
      AllowCellOverflow=   -1  'True
      ColsFrozen      =   3
      DisplayRowHeaders=   0   'False
      MaxCols         =   7
      MaxRows         =   1
      ScrollBars      =   0
      ShadowColor     =   12632256
      ShadowDark      =   10070188
      ShadowText      =   0
      SpreadDesigner  =   "f_cmbc039_3.frx":34AB
      UserResize      =   0
      VisibleCols     =   3
   End
   Begin FPSpread.vaSpread vaSpread6 
      Height          =   480
      Left            =   5730
      TabIndex        =   53
      TabStop         =   0   'False
      Top             =   4215
      Width           =   8640
      _Version        =   196608
      _ExtentX        =   15240
      _ExtentY        =   847
      _StockProps     =   64
      ColsFrozen      =   15
      DisplayRowHeaders=   0   'False
      MaxCols         =   25
      MaxRows         =   1
      ScrollBars      =   0
      ShadowColor     =   12632256
      ShadowDark      =   10070188
      ShadowText      =   0
      SpreadDesigner  =   "f_cmbc039_3.frx":382F
      UserResize      =   0
      VisibleCols     =   15
   End
   Begin FPSpread.vaSpread vaSpread9 
      Height          =   255
      Left            =   5730
      TabIndex        =   54
      Top             =   3990
      Width           =   8640
      _Version        =   196608
      _ExtentX        =   15240
      _ExtentY        =   450
      _StockProps     =   64
      ColsFrozen      =   1
      DisplayRowHeaders=   0   'False
      MaxCols         =   2
      ScrollBars      =   0
      SpreadDesigner  =   "f_cmbc039_3.frx":433D
      UserResize      =   0
      VisibleCols     =   1
      VisibleRows     =   500
   End
   Begin FPSpread.vaSpread sprExamine 
      Height          =   3510
      Left            =   75
      TabIndex        =   55
      Top             =   3990
      Width           =   15090
      _Version        =   196608
      _ExtentX        =   26617
      _ExtentY        =   6191
      _StockProps     =   64
      BackColorStyle  =   1
      ColsFrozen      =   12
      DisplayRowHeaders=   0   'False
      MaxCols         =   47
      MaxRows         =   4
      ScrollBars      =   2
      ShadowColor     =   12632256
      ShadowDark      =   8421504
      ShadowText      =   0
      SpreadDesigner  =   "f_cmbc039_3.frx":5B4B
      UserResize      =   0
      VisibleCols     =   12
      VisibleRows     =   4
   End
   Begin VB.Label lblMSMP_SUU 
      Caption         =   "é¿ê—Å^ïKóvêîÅF"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   10755
      TabIndex        =   62
      Top             =   1650
      Visible         =   0   'False
      Width           =   2655
   End
   Begin VB.Label lblNukishi 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   21.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000FF&
      Height          =   495
      Left            =   8235
      TabIndex        =   61
      Top             =   1335
      Width           =   2295
   End
   Begin VB.Label lblKanren 
      Caption         =   "ä÷òAÉuÉçÉbÉN"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000FF&
      Height          =   255
      Left            =   120
      TabIndex        =   60
      Top             =   2160
      Width           =   1455
   End
   Begin VB.Label Label22 
      Caption         =   "å¸êÊ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   225
      Left            =   5130
      TabIndex        =   57
      Top             =   1530
      Width           =   1455
   End
   Begin VB.Label lblMukesaki 
      Alignment       =   2  'íÜâõëµÇ¶
      BackColor       =   &H0080FF80&
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "4ìè"
      Height          =   255
      Left            =   6600
      TabIndex        =   56
      Top             =   1515
      Width           =   390
   End
   Begin VB.Label Label12 
      BackColor       =   &H00FFFF00&
      Caption         =   "ï]âøåãâ éÛêMçœ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   10170
      TabIndex        =   48
      Top             =   7890
      Width           =   1500
   End
   Begin VB.Label Label11 
      BackColor       =   &H00C0C0C0&
      Caption         =   "ª›ÃﬂŸñ≥(åãèªé¿ê—)"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   12705
      TabIndex        =   46
      Top             =   8745
      Width           =   1575
   End
   Begin VB.Label Label10 
      BackColor       =   &H0000FFFF&
      Caption         =   "ª›ÃﬂŸñ≥(îΩâf)"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   12705
      TabIndex        =   43
      Top             =   8445
      Width           =   1575
   End
   Begin VB.Label Label9 
      BackColor       =   &H00000000&
      Caption         =   "ª›ÃﬂŸóL"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   255
      Left            =   12705
      TabIndex        =   42
      Top             =   8145
      Width           =   1575
   End
   Begin VB.Label Label8 
      BackColor       =   &H00FFFFFF&
      Caption         =   "ª›ÃﬂŸñ≥"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   12705
      TabIndex        =   41
      Top             =   7845
      Width           =   1575
   End
   Begin VB.Label lbl_check 
      AutoSize        =   -1  'True
      Caption         =   "ÅF1SXL"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   165
      Index           =   1
      Left            =   10560
      TabIndex        =   38
      Top             =   8655
      Visible         =   0   'False
      Width           =   600
   End
   Begin VB.Label lbl_check 
      AutoSize        =   -1  'True
      Caption         =   "ÅFSXLï™äÑ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   165
      Index           =   2
      Left            =   10560
      TabIndex        =   40
      Top             =   8835
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.Label lbl_check 
      AutoSize        =   -1  'True
      Caption         =   "¡™Ø∏ŒﬁØ∏Ω"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   180
      Index           =   0
      Left            =   10380
      TabIndex        =   39
      Top             =   8340
      Visible         =   0   'False
      Width           =   945
   End
   Begin VB.Label Label14 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      BackStyle       =   0  'ìßñæ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "åãèªP"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   270
      Left            =   7500
      TabIndex        =   22
      Top             =   8745
      Width           =   810
   End
   Begin VB.Label Label13 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      BackStyle       =   0  'ìßñæ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "Ãﬁ€Ø∏P"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   270
      Left            =   7500
      TabIndex        =   20
      Top             =   8475
      Width           =   810
   End
   Begin VB.Label Label7 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      BackStyle       =   0  'ìßñæ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "Ãﬁ€Ø∏ID"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   270
      Left            =   7500
      TabIndex        =   18
      Top             =   8205
      Width           =   810
   End
   Begin VB.Label Label6 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      BackStyle       =   0  'ìßñæ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ÇÀÇÁÇ¢Éœ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   270
      Left            =   7500
      TabIndex        =   16
      Top             =   7935
      Width           =   810
   End
   Begin VB.Label Label5 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      BackStyle       =   0  'ìßñæ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "Bë§é¿ê—Éœ"
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   690
      TabIndex        =   14
      Top             =   8175
      Width           =   975
   End
   Begin VB.Label Label4 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H80000005&
      BackStyle       =   0  'ìßñæ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "Të§é¿ê—Éœ"
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   690
      TabIndex        =   12
      Top             =   7935
      Width           =   975
   End
   Begin VB.Label Label3 
      Caption         =   "âºÇrÇwÇkÅ|ÇhÇc"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   270
      Left            =   5130
      TabIndex        =   8
      Top             =   1200
      Width           =   1455
   End
   Begin VB.Label Label2 
      Caption         =   "åãèªî‘çÜ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   225
      Left            =   435
      TabIndex        =   10
      Top             =   1530
      Width           =   1170
   End
   Begin VB.Label Label1 
      Caption         =   "íSìñé“ÉRÅ[Éh"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   435
      TabIndex        =   5
      Top             =   1200
      Width           =   1215
   End
End
Attribute VB_Name = "f_cmbc039_3"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
'                                       2001/06/14
'===============================================================================
' çƒî≤éééwé¶âÊñ 
' äTóv    :
'===============================================================================

Private orgXl As c_cmzcXl                         ' ì«Ç›çûÇ›éûì_ÇÃåãèªèÓïÒ
Private tblHinNum() As tFullHinban                ' ïiî‘ÉeÅ[ÉuÉã
Private InMaxRow As Integer                       ' ç≈ëÂçsï€éù
Private bSampFlag As Boolean                      ' ÉTÉìÉvÉãéÊìæÉtÉâÉO
Private CutCntFlg As Integer                      ' ÉTÉìÉvÉãÇÃÇ»Ç¢SXL
Private orgSXL As c_cmzcSxls                      ' èâä˙èÛë‘ÇÃSXLç\ê¨
Private giFKeyFlg As Integer                      'ÉTÉìÉvÉãÅEé¿çsÉ{É^ÉìÉtÉâÉO
Private bJituChkFlg As Boolean                    ' é¿ë™√ﬁ∞¿¡™Ø∏Ã◊∏ﬁ
Private iBetuRow()  As Integer                    ' ã§óL(ï )ª›ÃﬂŸçs
Private CpyCrySmpl  As typ_CpyJisseki             ' åãèªé¿ê—à¯åpÇ¨√ﬁ∞¿

' êUë÷É`ÉFÉbÉNí«â¡Ç…ÇÊÇÈèCê≥
Private Type tbl_MotoHin
    MOTOICHIS As Integer                          ' êUë÷å≥äJénà íu
    MOTOICHIE As Integer                          ' êUë÷å≥èIóπà íu
    MOTOHIN As tFullHinban                        ' êUë÷å≥ïiî‘
End Type
Private MotoHinban() As tbl_MotoHin               ' êUë÷å≥ïiî‘ÉfÅ[É^

Private Type tbl_FuriNaiyou
    FURIUMU As Integer                            ' êUë÷óLñ≥(0:ñ≥ÇµÅA1:óLÇË)
    ICHI    As Integer                            ' à íu
    MOTOHIN As tFullHinban                        ' êUë÷å≥ïiî‘
    SAKIHIN As tFullHinban                        ' êUë÷êÊïiî‘
    TREPID As String                              ' ë„ï\ÉTÉìÉvÉãID(TOP)
    BREPID As String                              ' ë„ï\ÉTÉìÉvÉãID(BOT)
End Type
Private FurikaeNaiyou() As tbl_FuriNaiyou         ' êUë÷ì‡óeê›íËÉfÅ[É^
Private FurikaeNaiyouWK() As tbl_FuriNaiyou       ' êUë÷ì‡óeê›íËÉfÅ[É^(Workóp)

Private Type tbl_TokusaiBan
    ICHI     As Integer                           ' à íu
    MOTOHIN  As tFullHinban                       ' êUë÷å≥ïiî‘
    SAKIHIN  As tFullHinban                       ' êUë÷êÊïiî‘
    BANGOU   As String                            ' ì¡çÃî‘çÜ
    RIYUU    As String                            ' ì¡çÃóùóR
    ERRRIYUU As String                            ' ÉGÉâÅ[óùóR
    TREPID As String                              'ë„ï\ÉTÉìÉvÉãID(TOP)
    BREPID As String                              'ë„ï\ÉTÉìÉvÉãID(BOT)
End Type

Private TokusaiBangou() As tbl_TokusaiBan         ' ì¡çÃî‘çÜÉfÅ[É^
Private TokuCnt As Integer                        ' ì¡çÃî‘çÜÉfÅ[É^ÉJÉEÉìÉ^
Private TokuCntWK As Integer                      ' ì¡çÃî‘çÜÉfÅ[É^ÉJÉEÉìÉ^(Workóp)

Private FurikaeRireki() As typ_XSDCE_Update       ' êUë÷óöóÉfÅ[É^

Private bTokuKengenFlag As Boolean                ' ì¡çÃå†å¿ÉtÉâÉO
Private tblKns() As typ_XSDCW                     ' åüç∏çÄñ⁄ÇÇ∆Ç¡ÇƒÇ®Ç≠ÇΩÇﬂÇÃç\ë¢ëÃ
Private tKensa() As typ_XSDCW                     ' åüç∏çÄñ⁄éÊìæóp
Private tWafk() As typeSprWFmap                   ' ÉEÉGÉnÅ[ÉZÉìÉ^Å[ì¸å…èÓïÒÇÃÉfÅ[É^ÇÇ∆Ç¡ÇƒÇ®Ç≠

Private sComment As String                        ' ÉRÉÅÉìÉg   07/10/05 miyatake è≥îFã@î\í«â¡
Private bSampleBtn        As Boolean              ' ÉTÉìÉvÉãÉ{É^ÉìèÛë‘ 2010/12/08 Marushita

'*******************************************************************************
'*    ä÷êîñº        : CmdChangeWF_EP_Click
'*
'*    èàóùäTóv      : 1.ÇvÇeÅÃÉGÉsêÿä∑Ç¶É{É^ÉìÉNÉäÉbÉNèàóù
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*                    Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub CmdChangeWF_EP_Click()
    CmdChangeWF_EP.Enabled = False

    If CmdChangeWF_EP.Tag = "WF" Then
        Call sub_cmbc039_3_ChangeHinSpec(1)
        CmdChangeWF_EP.Tag = "EP"
        CmdChangeWF_EP.Caption = "ÉGÉs >>"

    Else
        Call sub_cmbc039_3_ChangeHinSpec(0)
        CmdChangeWF_EP.Tag = "WF"
        CmdChangeWF_EP.Caption = "ÇvÇe >>"
    End If

    CmdChangeWF_EP.Enabled = True
End Sub

'>>>>> 2011/07/14 Marushita
'WFCëççáîªíËâÊñ ï\é¶É{É^Éìâüâ∫éûÇ…ÉLÉÉÉvÉ`ÉÉâÊñ Çï\é¶Ç∑ÇÈ
Private Sub cmdDisp_Click()
    'âÊñ ï\é¶
    f_hanteiS.picDisp.Picture = LoadPicture(App.Path & CAP_FNAME)
    Call f_hanteiS.Show
End Sub
'<<<<< 2011/07/14 Marushita

'*******************************************************************************
'*    ä÷êîñº        : cmdF_Click
'*
'*    èàóùäTóv      : 1.ÉtÉ@ÉìÉNÉVÉáÉìÉ{É^ÉìÇ™ÉNÉäÉbÉNÇ≥ÇÍÇΩÇÁÅAäeèàóùÇ…ï™äÚÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    intIndex    ,I  ,IntegerÅ@,ÉRÉìÉgÉçÅ[ÉãîzóÒÇÃìYéö
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub cmdF_Click(intIndex As Integer)
    Dim sErrMsg     As String
    Dim sBlkId      As String
    Dim sSXLID      As String
    Dim blnsflg     As Boolean

    lblMsg.Caption = ""
    Tokusai = ""

    '' èàóùï™äÚ
    Select Case intIndex
        Case 2          '' ÇeÇQÉLÅ[ÅiÉTÉuÉÅÉjÉÖÅ[Åj
            '>>>>> 2011/07/14 Marushita
            'ëççáîªíËîªíËï\é¶íÜÇÕï¬Ç∂ÇÈ
            If f_hanteiS.Visible = True Then
                Unload f_hanteiS
            End If
            '<<<<< 2011/07/14 Marushita
            GotoSubMenu
        Case 3          '' ÇeÇRÉLÅ[ÅiÉLÉÉÉìÉZÉãÅj
            ' É{É^ÉìòAë≈ÇñhÇÆà◊
            cmdF(3).Enabled = False

            Call sub_DispClear
            lblMsg.Caption = GetMsgStr("PWAIT")
            Call sub_LoadAndDisp

            '2003/04/21 FÉLÅ[ÉtÉâÉOí«â¡Å@0:èâä˙èÛë‘ 1:ÉTÉìÉvÉãÉ{É^Éì 2:é¿çsÉ{É^Éì
            giFKeyFlg = 0 'èâä˙èÛë‘
            ReDim FurikaeNaiyouWK(0)
            TokuCntWK = TokuCnt
            ReDim Preserve TokusaiBangou(TokuCntWK)

            ' É{É^ÉìòAë≈ÇñhÇÆà◊
            cmdF(3).Enabled = True
        Case 4
            'åÛï‚É{É^Éì
            Call sub_FurikaeKouho
        Case 5
            'ì¡çÃÉ{É^Éì
            Call sub_TokusaiInput
            Tokusai = "1"
            lblMsg.Caption = TBN_Msg
        Case 6
'Add Start 2011/03/11 SMPK Miyata
            'WFœØÃﬂä«óù√∞ÃﬁŸÇ©ÇÁ√ﬁ∞¿ÇéÊìæ
            If SelWFmap(vbNullString, SelectSxlID039, sErrMsg) = FUNCTION_RETURN_FAILURE Then
                f_cmbc039_2.lblMsg.Caption = sErrMsg
                Exit Sub
            End If
            
            'ΩÃﬂ⁄ØƒﬁÇ…√ﬁ∞¿Çï\é¶
            If SetWFmapData = FUNCTION_RETURN_FAILURE Then
                f_cmbc039_4.lblMsg.Caption = sErrMsg
                f_cmbc039_4.sprWfmapView.MaxRows = 0
                Exit Sub
            End If

            'ÉTÉìÉvÉãÉ{É^Éìâüâ∫éûÇÕâÊñ ÇÃèÛë‘ÇèÛë‘Ç∆êFÇ≈îΩâfÇ∑ÇÈ
            If giFKeyFlg = 1 Then
                fnc_DispChangeDataWfmap 'èÛë‘ÇMapÇ…ï\é¶
            End If

            f_cmbc039_4.txtSxlId.text = SelectSxlID039
            f_cmbc039_4.Show
'Add End   2011/03/11 SMPK Miyata

'Del Start 2011/03/11 SMPK Miyata
'            cmbSprChg.ListIndex = 0
'            With sprWfmapView
'                .col = 30
'                .ColHidden = True
'            End With
'
'            If bWfmapView = False Then
'                'èåèÇéÊìæ
'                sSXLID = Trim(txtKSXLID.text)
'                lblSxlId.Caption = sSXLID
'                sBlkId = vbNullString
'
'                'WFœØÃﬂä«óù√∞ÃﬁŸÇ©ÇÁ√ﬁ∞¿ÇéÊìæ
'                If sub_SelWFmap(sBlkId, sSXLID, sErrMsg) = FUNCTION_RETURN_FAILURE Then
'                    lblMsg.Caption = sErrMsg
'                    sprExamine.MaxRows = 0
'                    Exit Sub
'                End If
'                sprWfmapView.ReDraw = False
'                If fnc_SetWFmapData = FUNCTION_RETURN_FAILURE Then
'                    lblMsg.Caption = sErrMsg
'                    sprExamine.MaxRows = 0
'                    Exit Sub
'                End If
'
'                sprWfmapView.ReDraw = True
'                Me.top = 0
'                bWfmapView = True
'                Me.Height = 11280
'            ElseIf bWfmapView = True Then
'                Me.top = 1500
'                bWfmapView = False
'                Me.Height = 8580
'                Exit Sub
'            End If
'
'            'ÉTÉìÉvÉãÉ{É^Éìâüâ∫éûÇÕâÊñ ÇÃèÛë‘ÇèÛë‘Ç∆êFÇ≈îΩâfÇ∑ÇÈ
'            If giFKeyFlg = 1 Then
'                fnc_DispChangeDataWfmap 'èÛë‘ÇMapÇ…ï\é¶
'            End If
'
'            'ΩÃﬂ⁄Øƒﬁ√ﬁ∞¿É\Å[Ég
'            With sprWfmapView
'                .BlockMode = True
'                .col = 1
'                .col2 = .MaxCols
'                .row = 1
'                .row2 = .MaxRows
'                .SortBy = SortByRow
'                .SortKey(1) = 8
'                .SortKeyOrder(1) = SortKeyOrderAscending
'                .Action = ActionSort
'                .BlockMode = False
'            End With
'Del End   2011/03/11 SMPK Miyata

        Case 7          '' ÇeÇVÉLÅ[Åiçsë}ì¸Åj
            sprExamine.SetFocus
            Call sprExamine_KeyDown(vbKeyF7, 0)
        Case 8          '' ÇeÇWÉLÅ[ÅiçsçÌèúÅj
            sprExamine.SetFocus
            Call sprExamine_KeyDown(vbKeyF8, 0)
        Case 9          '' ÇeÇXÉLÅ[ÅiåãèªÉCÉÅÅ[ÉWï\é¶Åj
            If sub_DispSample(blnsflg) = True Then
                If blnsflg = True Then 'ÉfÅ[É^É`ÉFÉbÉNÇ≈ÉGÉâÅ[Ç…Ç»Ç¡ÇΩèÛë‘Ç≈ÇÕÉtÉâÉOÇóßÇƒÇ»Ç¢ÇÊÇ§Ç…èCê≥
                    giFKeyFlg = 1
                End If
                Call sub_DrawImage
            End If

            ' êUë÷É`ÉFÉbÉNí«â¡Ç…ÇÊÇÈèCê≥
            ReDim FurikaeNaiyou(UBound(FurikaeNaiyouWK))
            FurikaeNaiyou = FurikaeNaiyouWK
'----- ÉTÉìÉvÉãÉ{É^ÉìÇQâÒâüâ∫ïsâ¬ëŒâûÅ@2010/12/08 Marushita
            If bSampleBtn = True And giFKeyFlg = 1 Then
                bSampleBtn = False
                cmdF(7).Enabled = False
                cmdF(8).Enabled = False
                cmdF(10).Enabled = False
            End If
        Case 10         '' Çe10ÉLÅ[ÅiÉTÉìÉvÉãÅj
            If sub_DispSample(blnsflg) = False Then
                Exit Sub
            End If

            If blnsflg = True Then 'ÉfÅ[É^É`ÉFÉbÉNÇ≈ÉGÉâÅ[Ç…Ç»Ç¡ÇΩèÛë‘Ç≈ÇÕÉtÉâÉOÇóßÇƒÇ»Ç¢ÇÊÇ§Ç…èCê≥
                giFKeyFlg = 1
            End If

            '2003/04/21 FÉLÅ[ÉtÉâÉOí«â¡Å@0:èâä˙èÛë‘ 1:ÉTÉìÉvÉãÉ{É^Éì 2:é¿çsÉ{É^Éì
            If fnc_DispHinSpec(1) = False Then
                Exit Sub
            End If

            ' êUë÷É`ÉFÉbÉNí«â¡Ç…ÇÊÇÈèCê≥
            ReDim FurikaeNaiyou(UBound(FurikaeNaiyouWK))
            FurikaeNaiyou = FurikaeNaiyouWK
'----- ÉTÉìÉvÉãÉ{É^ÉìÇQâÒâüâ∫ïsâ¬ëŒâûÅ@2010/12/08 Marushita
            If bSampleBtn = True And giFKeyFlg = 1 Then
                bSampleBtn = False
                cmdF(7).Enabled = False
                cmdF(8).Enabled = False
                cmdF(10).Enabled = False
            End If
        Case 11         '' Çe11ÉLÅ[ÅiëOâÊñ Åj
            '>>>>> 2011/07/14 Marushita
            'ëççáîªíËéQè∆ï\é¶íÜÇÕï¬Ç∂ÇÈ
            If f_hanteiS.Visible = True Then
                Unload f_hanteiS
            End If
            '<<<<< 2011/07/14 Marushita
            CloseFormProc f_cmbc039_2, f_cmbc039_3
        Case 12         '' Çe12ÉLÅ[Åié¿çsÅj
            '' íSìñé“IDÇÃÉ`ÉFÉbÉN
            If f_cmzcChkUser.CanExec(Me.Name, txtStaffID.text) = False Then
                lblMsg.Caption = GetMsgStr("EUSR0")
                Exit Sub
            End If

            'Å·SaveDataÅ‚ÇÃëOÇ…à⁄ìÆ
            giFKeyFlg = 2 'é¿çsÉ{É^Éì

            Call sub_SaveData

            ' êUë÷É`ÉFÉbÉNí«â¡Ç…ÇÊÇÈèCê≥
            ReDim FurikaeNaiyou(UBound(FurikaeNaiyouWK))
            FurikaeNaiyou = FurikaeNaiyouWK
    End Select
End Sub

'*******************************************************************************
'*    ä÷êîñº        : cmdF_GotFocus
'*
'*    èàóùäTóv      : 1.ÉRÉìÉgÉçÅ[ÉãÇ™ÉtÉHÅ[ÉJÉXÇéÊìæÇµÇΩéûÇ…é¿çsÇ∑ÇÈèàóù
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    Index       ,I  ,IntegerÅ@,ÉRÉìÉgÉçÅ[ÉãîzóÒÇÃìYéö
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub cmdF_GotFocus(Index As Integer)
    '' çsçÌèúÅ^çsë}ì¸ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[Ç≈Ç»ÇØÇÍÇŒ
    If Index <> 7 And Index <> 8 Then
        '' çsçÌèúÅ^çsë}ì¸ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[Çñ≥å¯Ç…Ç∑ÇÈ
        cmdF(7).Enabled = False
        cmdF(8).Enabled = False
    End If

End Sub

'*******************************************************************************
'*    ä÷êîñº        : Form_KeyDown
'*
'*    èàóùäTóv      : 1.ÉLÅ[É{Å[Éhâüâ∫èàóù
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    KeyCode     ,I  ,IntegerÅ@,ÉLÅ[ÉRÅ[Éh
'*                    Shift       ,I  ,IntegerÅ@,ShiftÉLÅ[ÇÃèÛë‘
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
    Dim intIndex As Integer

    '' ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[Ç™óLå¯Ç»ÇÁ
    If KeyCode >= vbKeyF1 And KeyCode <= vbKeyF12 Then
        '' âÊñ ï\é¶ÉÅÉbÉZÅ[ÉWÉNÉäÉA
        lblMsg.Caption = ""

        intIndex = KeyCode - (vbKeyF1 - 1)
        If KeyCode = vbKeyF5 Then
            Call cmdF_Click(intIndex)
        End If
        If cmdF(intIndex).Visible = True And cmdF(intIndex).Enabled = True Then
            '' ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[âüâ∫èàóùÇé¿çsÇ∑ÇÈ
            If KeyCode <> vbKeyF7 And KeyCode <> vbKeyF8 Then
                Call cmdF_Click(intIndex)
            End If
        End If
    End If
End Sub

'*******************************************************************************
'*    ä÷êîñº        : Form_Load
'*
'*    èàóùäTóv      : 1.SXLç\ê¨ÇÃèâä˙èÛë‘Çï€ë∂Ç∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub Form_Load()
    Dim sxl As c_cmzcSxl

    Call Pic_Disp(0)

    '' âÊñ ÉNÉäÉA
    Call sub_DispClear

'Del Start 2011/03/11 SMPK Miyata
'    '' ÉtÉHÅ[ÉÄà íuÉZÉbÉg
'    CenterForm Me
'    Me.Height = 8580
'Del End   2011/03/11 SMPK Miyata
    Me.Show

    ' ÉoÅ[ÉWÉáÉìèÓïÒÇÃï\é¶
    lblvers.Caption = "Version " & App.Major & "." & App.Minor & "." & App.Revision


    'ïiî‘Ç1óÒí«â¡ÇµÇΩÇ±Ç∆Ç…ÇÊÇÈóÒÇÃïœçX
    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
    sprExamine.ColsFrozen = 35

    CutCntFlg = 0
    sprExamine.col = 5
    sprExamine.TypeComboBoxWidth = 1

    '' ÉfÅ[É^èâä˙èàóù
    lblMsg.Caption = GetMsgStr("PWAIT")
    DoEvents
    Call sub_InitData

    '' ÉfÅ[É^ÇÃÉçÅ[ÉhÇ∆ï\é¶
    lblMsg.Caption = GetMsgStr("PWAIT")
    DoEvents
    Call sub_LoadAndDisp

    '' SXLç\ê¨ÇÃèâä˙èÛë‘Çï€ë∂Ç∑ÇÈ
    Set orgSXL = New c_cmzcSxls
    Set sxl = New c_cmzcSxl

    With tblSXL
        sxl.CRYNUM = .CRYNUM
        sxl.INGOTPOS = .INGOTPOS
        sxl.LENGTH = .COUNT
        sxl.hinban = .hinban
        sxl.REVNUM = .REVNUM
        sxl.factory = .factory
        sxl.opecond = .opecond
    End With
    orgSXL.Add sxl
    Set sxl = Nothing

'2003/04/21 FÉLÅ[ÉtÉâÉOí«â¡Å@0:èâä˙èÛë‘ 1:ÉTÉìÉvÉãÉ{É^Éì 2:é¿çsÉ{É^Éì
    giFKeyFlg = 0 'èâä˙èÛë‘

    ReDim tblWafInd(0)
    ReDim tblNukishi(0) 'î≤ééïœçXópç\ë¢ëÃ
    ' ì¡çÃå†å¿í«â¡Ç…ÇÊÇÈèCê≥
            '' íSìñé“IDÇÃÉ`ÉFÉbÉN
            If f_cmzcChkUser.CanExec("TOKUSAI", txtStaffID.text) Then
                bTokuKengenFlag = True
            Else
                bTokuKengenFlag = False
            End If

    ' è≥îFã@î\í«â¡Ç…ÇÊÇÈèCê≥  07/10/05 miyatake ===================> START
    ''PNGï€ë∂É`ÉFÉbÉNÉ{ÉbÉNÉXON/OFF
    If Trim(GetCodeFieldA9(SWS_CHK_KEY1, SWS_CHK_KEY2, SWS_CHK_KEY3, SWS_CHK_COLUMN)) = SWS_CHK_VALUE_ON Then
        Me.chk_Png = 1
    ElseIf Trim(GetCodeFieldA9(SWS_CHK_KEY1, SWS_CHK_KEY2, SWS_CHK_KEY3, SWS_CHK_COLUMN)) = SWS_CHK_VALUE_OFF Then
        Me.chk_Png = 0
    Else
        Me.chk_Png = 0
    End If
    ' è≥îFã@î\í«â¡Ç…ÇÊÇÈèCê≥  07/10/05 miyatake ===================> END
End Sub

'*******************************************************************************
'*    ä÷êîñº        : Form_Unload
'*
'*    èàóùäTóv      : 1.ÉtÉHÅ[ÉÄÇ™ÉAÉìÉçÅ[ÉhÇ≥ÇÍÇÈéûÇ…é¿çsÇ∑ÇÈèàóù
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    Cancel      ,I  ,Integer
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub Form_Unload(Cancel As Integer)
    Set orgSXL = Nothing

    '' åãèªê}ÉEÉBÉìÉhÉEÇÃÉAÉìÉçÅ[Éh
    Unload f_cmzc003a
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sprExamine_Change
'*
'*    èàóùäTóv      : 1.ïiî‘ïœçXéûÇ…å¸ÇØêÊÇçƒéÊìæ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    col         ,I  ,Long     ,ëIëóÒ
'*                    Row         ,I  ,Long     ,ëIëçs
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sprExamine_Change(ByVal col As Long, ByVal row As Long)
    Dim blAns           As Boolean
    Dim vTemp           As Variant
    Dim vTemp1          As Variant
    Dim vTemp2          As String
    Dim udtFullHinban   As tFullHinban

    '' à íuÇ∆ïiî‘Ç™ïœçXÇÃèÍçá
    If (col = 2) Or (col = 4) Then
        '' ì¡çÃèÓïÒÉNÉäÉA
        Call sub_ClearTokusai
    End If

    If col = 2 Then
        lblMsg.Caption = vbNullString
        blAns = sprExamine.GetText(col, row, vTemp)
        vTemp = Trim(vTemp)
        Select Case ChkString(vTemp, 8, 8)
        Case CHK_NG, CHK_NULL
            If Trim$(vTemp) <> "Z" Then
                lblMsg.Caption = GetMsgStr(EHIN1)
            End If
            Exit Sub
        End Select
        vTemp2 = vTemp
        If GetLastHinban(vTemp2, udtFullHinban) = FUNCTION_RETURN_FAILURE Then
            lblMsg.Caption = GetMsgStr(EHIN0)
            Exit Sub
        End If
    End If

    Dim sHinban   As String
    Dim sMuke     As String
    Dim sNewMuke  As String
    '' ïiî‘Ç™ïœçXÇÃèÍçá
    If (col = 2) Then
        sprExamine.col = 2
        sprExamine.row = row
        sHinban = sprExamine.text

        sprExamine.col = 2
        sprExamine.row = row + 1

        sprExamine.text = sCmbMukeName

        '' å¸êÊèÓïÒéÊìæ
        sNewMuke = GetMukesaki(sHinban)
        sprExamine.text = sNewMuke

        If InStr(1, sNewMuke, left(sBaseMukesaki, 1), vbTextCompare) = 0 Then
            lblMsg.Caption = "å¸êÊÇ™ïœçXÇ≥ÇÍÇƒÇ¢Ç‹Ç∑ÅB"
            sprExamine.backColor = vbRed
        Else
            lblMsg.Caption = ""
            sprExamine.backColor = vbWhite
        End If
    End If
    'ÉTÉìÉvÉãÉ{É^Éìâüâ∫å„ÉfÅ[É^Ç™èëÇ´ä∑Ç¶ÇÁÇÍÇΩèÍçáÅAé¿çsÇ≈Ç´Ç»Ç≠Ç∑ÇÈÇΩÇﬂ2003/04/25 okazaki
    bSampFlag = False
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sprExamine_ComboSelChange
'*
'*    èàóùäTóv      : 1.ÉRÉìÉ{É{ÉbÉNÉXÇÃëIëçÄñ⁄Ç™ïœçXÇ≥ÇÍÇΩéûÇ…é¿çsÇ∑ÇÈèàóù
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    col         ,I  ,Long     ,ÉRÉìÉ{É{ÉbÉNÉXÇÃóÒî‘çÜ
'*                    Row         ,I  ,Long     ,ÉRÉìÉ{É{ÉbÉNÉXÇÃçsî‘çÜ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sprExamine_ComboSelChange(ByVal col As Long, ByVal row As Long)
    With sprExamine
        If col = 2 And row = 1 Then
            .row = 1
            .col = 2
            If Trim$(.text) = "Z" Then
                .col = 9
                .Lock = False
                .backColor = COLOR_OK
            Else
                .col = 9
                .Lock = True
                .TypeComboBoxCurSel = 0
                .backColor = COLOR_DISABLE
            End If
        End If
    End With
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sprExamine_GotFocus
'*
'*    èàóùäTóv      : 1.ÉRÉìÉgÉçÅ[ÉãÇ™ÉtÉHÅ[ÉJÉXÇéÊìæÇµÇΩéûÇ…é¿çsÇ∑ÇÈèàóù
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sprExamine_GotFocus()
    '' çsçÌèúÅ^çsë}ì¸ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ÇóLå¯Ç…Ç∑ÇÈ
'----- ÉTÉìÉvÉãÉ{É^Éìâüâ∫ïsâ¬ëŒâûÅ@2010/12/08 Marushita
    If bSampleBtn = False Then
    Else
        If CutCntFlg = 0 Then
            cmdF(7).Enabled = True
            cmdF(8).Enabled = True
        End If
    End If
    'If CutCntFlg = 0 Then
    '    cmdF(7).Enabled = True
    '    cmdF(8).Enabled = True
    'End If
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sprExamine_KeyDown
'*
'*    èàóùäTóv      : 1.î≤éééwé¶àÍóóÇï“èWÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    KeyCode     ,I  ,IntegerÅ@,ÉLÅ[ÉRÅ[Éh
'*                    Shift       ,I  ,IntegerÅ@,ShiftÉLÅ[ÇÃèÛë‘
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sprExamine_KeyDown(KeyCode As Integer, Shift As Integer)
    Dim vDeleteFlag     As Variant
    Dim intResult       As Integer
    Dim lngNewRow       As Long
    Dim lngNewRow2      As Long
    Dim blRtn           As Boolean
    Dim vGetHinban      As Variant
    Dim intRowCnt       As Integer
    Dim intColCnt       As Integer
    Dim sDataNum        As String
    Dim vBColor         As Variant
    Dim sColor          As String
    Dim blZhinFlg(2)    As Boolean      'Zïiî‘çsÇÃóLñ≥
    Dim lngsRow         As Long         'èàóùäJénçs
    Dim lngeRow         As Long         'èàóùèIóπçs

    '' ÉLÅ[ÉRÅ[Éhï™äÚ
    Select Case KeyCode
    Case vbKeyF7        '' F7ÉLÅ[Åiçsë}ì¸Åj
        'F7ÉLÅ[Ç™égópïsâ¬ÇÃÇ∆Ç´èàóùÇî≤ÇØÇÈÅ@2010/12/14Å@Marushita
        If cmdF(7).Enabled = False Then
            Exit Sub
        End If
        Call sub_F_InsertRow

        '' ÉTÉìÉvÉãÉtÉâÉOÉIÉt
        bSampFlag = False
        cmdF(12).Enabled = False

        '' ì¡çÃèÓïÒÉNÉäÉA
        Call sub_ClearTokusai
    Case vbKeyF8        '' F8ÉLÅ[ÅiçsçÌèúÅj
        'F8ÉLÅ[Ç™égópïsâ¬ÇÃÇ∆Ç´èàóùÇî≤ÇØÇÈÅ@2010/12/14Å@Marushita
        If cmdF(8).Enabled = False Then
            Exit Sub
        End If
        vDeleteFlag = ""
        'ÉAÉNÉeÉBÉuÉZÉãÇÃà íuÇ…ÇÊÇËÇQçsçÌèú(ÉtÉâÉOÇÃóßÇ¡ÇƒÇ¢ÇÈÇ‡ÇÃÇÕïsâ¬)
        'ïiî‘Ç1óÒí«â¡ÇµÇΩÇ±Ç∆Ç…ÇÊÇÈóÒÇÃïœçX-------start iida 2003/09/06
'        If (sprExamine.GetText(29, sprExamine.ActiveRow, vDeleteFlag) = True) Then
        ''écë∂é_ëfåüç∏çÄñ⁄í«â¡Ç…ÇÊÇÈïœçXÅ@03/12/15 ooba
'        If (sprExamine.GetText(30, sprExamine.ActiveRow, vDeleteFlag) = True) Then
        'GDí«â¡Ç…ÇÊÇÈïœçXÅ@05/02/17 ooba
        'If (sprExamine.GetText(31, sprExamine.ActiveRow, vDeleteFlag) = True) Then
        '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
        If (sprExamine.GetText(37, sprExamine.ActiveRow, vDeleteFlag) = True) Then
            If (vDeleteFlag = "1") Or (vDeleteFlag = "3") Then
                Exit Sub
            End If
        End If
        With sprExamine
            intResult = .ActiveRow Mod 2
            If intResult = 0 Then     'ãÙêîçs
                lngNewRow = .ActiveRow
                lngNewRow2 = .ActiveRow + 1
            Else                      'äÔêî
                lngNewRow = .ActiveRow - 1
                lngNewRow2 = .ActiveRow
            End If

            .GetText 2, lngNewRow2, vGetHinban
            If intResult = 0 Then 'ÉJÅ[É\ÉãçsÇ™ãÙêîÇÃéûÇÕÇPçsè„ÇÃïiî‘Çè¡ãéÇµÇΩÇ¢èÍçáÇ»ÇÃÇ≈ïiî‘ÇèëÇ´ä∑Ç¶ÇÈ
                .SetText 2, lngNewRow - 1, vGetHinban
            End If
            .row = lngNewRow
            .row2 = lngNewRow2
            .col = (-1)
            .BlockMode = True
            .FormulaSync = True
            .Action = ActionDeleteRow

            'ç≈ëÂçsêîçÌèú
            .MaxRows = sprExamine.MaxRows - 2

            'ïiî‘ÇÃêFÇìKópÇ∑ÇÈ
            .GetText 2, lngNewRow - 1, vGetHinban

            .row = lngNewRow - 1
            .col = 4
           vBColor = .backColor

            If (vGetHinban = "Z" Or vGetHinban = "Çy") And vBColor = &H8080FF Then
                .row = lngNewRow - 1
                .row2 = lngNewRow - 1
                .col = 4
                .col2 = .MaxCols
                .backColor = &H8080FF
                .row = lngNewRow
                .row2 = lngNewRow
                .col = 5
                .col2 = .MaxCols
                .backColor = &H8080FF
                .BlockMode = True
                .row = lngNewRow - 1
                .row2 = lngNewRow
                .col = 11
                .col2 = .MaxCols
                .ForeColor = &H8080FF
                .BlockMode = False
            Else
                .row = lngNewRow - 1
                .row2 = lngNewRow - 1
                .col = 4
                .col2 = 10
                .backColor = &H80FF80
                .ForeColor = vbBlack
                .row = lngNewRow
                .row2 = lngNewRow
                .col = 5
                .col2 = 10
                .backColor = &H80FF80
                .ForeColor = vbBlack

                '' ZçsÇÃÇ›ÇÃèàóùÇ∆Ç∑ÇÈ=================================>
                'çÌèúçsÇÃè„Ç™Zïiî‘Ç©Ç«Ç§Ç©
                .col = 11: .row = lngNewRow - 1
                If .backColor = &H8080FF Then blZhinFlg(1) = True Else blZhinFlg(1) = False
                'çÌèúçsÇÃâ∫Ç™Zïiî‘Ç©Ç«Ç§Ç©
                .col = 11: .row = lngNewRow
                If .backColor = &H8080FF Then blZhinFlg(2) = True Else blZhinFlg(2) = False
                'Zïiî‘çsÇÃèÍçá
                If blZhinFlg(1) Or blZhinFlg(2) Then
                    'èàóùäJénçsê›íË
                    If blZhinFlg(1) Then lngsRow = lngNewRow - 1 Else lngsRow = lngNewRow
                    'èàóùèIóπçsê›íË
                    If blZhinFlg(2) Then lngeRow = lngNewRow Else lngeRow = lngNewRow - 1
                    .row = lngsRow
                    .row2 = lngeRow
                    .col = 10
                    .col2 = .MaxCols
                    .ForeColor = vbBlack
                    .row = lngsRow
                    .row2 = lngeRow
                    .col = 11
                    .col2 = .MaxCols
                    .BlockMode = True
                    .backColor = vbWhite
                    .BlockMode = False

                    ''åüç∏çÄñ⁄óìÇÃîwåiçƒï\é¶
                    For intRowCnt = lngsRow To lngeRow
                        '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                        For intColCnt = 11 To 35
                            .row = intRowCnt
                            .col = intColCnt
                            sDataNum = .text
                            If (sDataNum <> "") Then
                                .row = intRowCnt
                                .col = intColCnt
                                .ForeColor = vbBlack
                                .backColor = vbBlack
                            Else

                            End If
                        Next intColCnt
                    Next intRowCnt
                End If
            End If

            .row = .MaxRows - 1
            .col = 2
            sColor = .text
            If sColor <> "Z" Then
                .row = .MaxRows
                .col = 4
                .backColor = &H80FF80

            End If
            .BlockMode = False
        End With

        '' ÉTÉìÉvÉãÉtÉâÉOÉIÉt
        bSampFlag = False
        cmdF(12).Enabled = False

        '' ì¡çÃèÓïÒÉNÉäÉA
        Call sub_ClearTokusai
    End Select
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sprExamine_KeyPress
'*
'*    èàóùäTóv      : 1.åüç∏éwé¶ÉTÉìÉvÉãÇì¸óÕÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    KeyAscii    ,I  ,IntegerÅ@,ï∂éöÉRÅ[Éh
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sprExamine_KeyPress(KeyAscii As Integer)

    Dim sSampID1 As String
    Dim sSampID2 As String
    Dim i As Integer
    Dim j As Integer
    Dim k As Integer

    With sprExamine
        i = .ActiveRow
        j = .ActiveCol

        '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
        If j < 11 Or j > 35 Then
            If j = 4 Or j = 3 Then
                bSampFlag = False
            End If
            Exit Sub
        Else
            KeyAscii = 0    'add  2003/05/07 hitec)matsumoto
        End If
        If KeyAscii <> vbKeyBack And (KeyAscii < vbKey3 Or KeyAscii > vbKey4) Then
            KeyAscii = 0
            Exit Sub
        End If
    End With
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sprSpec_GotFocus
'*
'*    èàóùäTóv      : 1.ÉRÉìÉgÉçÅ[ÉãÇ™ÉtÉHÅ[ÉJÉXÇéÊìæÇµÇΩéû
'*                      çsçÌèúÅ^çsë}ì¸ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[Çñ≥å¯Ç…Ç∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sprSpec_GotFocus()
    '' çsçÌèúÅ^çsë}ì¸ÉtÉ@ÉìÉNÉVÉáÉìÉLÅ[ÇóLå¯Ç…Ç∑ÇÈ
    cmdF(7).Enabled = False
    cmdF(8).Enabled = False
End Sub

'*******************************************************************************
'*    ä÷êîñº        : txtStaffID_KeyDown
'*
'*    èàóùäTóv      : 1.íSìñé“ÉRÅ[ÉhKeyDownèàóù
'*                      Åiì¡çÃã@î\í«â¡Ç…ÇÊÇÈèCê≥Åj
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    KeyCode     ,I  ,IntegerÅ@,ÉLÅ[ÉRÅ[Éh
'*                    Shift       ,I  ,Integer  ,ShiftÉLÅ[ÇÃèÛë‘
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub txtStaffID_KeyDown(KeyCode As Integer, Shift As Integer)
    'ì¡çÃã@î\í«â¡Ç…ÇÊÇÈèCê≥
    If f_cmzcChkUser.CanExec("TOKUSAI", txtStaffID.text) Then
        bTokuKengenFlag = True
    Else
        bTokuKengenFlag = False
    End If
End Sub

'*******************************************************************************
'*    ä÷êîñº        : txtTarget_KeyDown
'*
'*    èàóùäTóv      : 1.ÇÀÇÁÇ¢ÉœÇ≈ÉäÉ^Å[ÉìÉLÅ[âüâ∫
'*                      ÅiÇÀÇÁÇ¢ÉœÇ©ÇÁÇÃÃﬁ€Ø∏IDÅAÃﬁ€Ø∏PÅAåãèªPÇÃéÊìæÅj
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    KeyCode     ,I  ,IntegerÅ@,ÉLÅ[ÉRÅ[Éh
'*                    Shift       ,I  ,Integer  ,ShiftÉLÅ[ÇÃèÛë‘
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub txtTarget_KeyDown(KeyCode As Integer, Shift As Integer)
    Dim udtTmpResPosCal As type_ResPosCal
    Dim udtCof          As type_Coefficient
    Dim dblMenseki      As Double
    Dim dblTopWght      As Double
    Dim intPos          As Integer
    Dim lngWgtCharge    As Long     'ïŒêÕåvéZópÉpÉâÉÅÅ[É^
    Dim dblWgtTop       As Double   'ïŒêÕåvéZópÉpÉâÉÅÅ[É^
    Dim dblWgtTopCut    As Double   'ïŒêÕåvéZópÉpÉâÉÅÅ[É^
    Dim dblDM           As Double   'ïŒêÕåvéZópÉpÉâÉÅÅ[É^
    Dim sBlkId          As String
    Dim intBlkPos       As Integer
    Dim dblCalcPos      As Double

    lblMsg.Caption = ""
    txtBlkID = ""
    txtBlkP = ""
    txtCryP.text = ""

    '' ÉäÉ^Å[ÉìÉLÅ[âüâ∫éûÇÃÇ›èàóùë±çs
    If KeyCode = vbKeyReturn Then
        If ChkTextBox(txtTarget, CHK_NUMBER, 5, 5) = FUNCTION_RETURN_FAILURE Then
            '' ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇï\é¶Ç∑ÇÈ
            lblMsg.Caption = GetMsgStr("EINPM")
            Exit Sub
        End If
        txtTarget.text = toRsStr(val(txtTarget.text))
        udtCof.TOPSMPLPOS = tblSXL.INGOTPOS
        udtCof.BOTSMPLPOS = tblSXL.INGOTPOS + tblSXL.COUNT
        udtCof.TOPRES = tblTotal.typ_y013(1, WFRES).MESDATA5
        udtCof.BOTRES = tblTotal.typ_y013(2, WFRES).MESDATA5
        
        ''ïŒêÕåvéZópÉpÉâÉÅÅ[É^éÊìæ É}ÉãÉ`à¯è„ëŒâû éQè∆ä÷êîïœçX 2008/05/22 SETsw Nakada
        If GetCoeffParams_new(txtCryNum.text, lngWgtCharge, dblWgtTop, dblWgtTopCut, dblDM) = FUNCTION_RETURN_FAILURE Then
'        If GetCoeffParams(txtCryNum.text, lngWgtCharge, dblWgtTop, dblWgtTopCut, dblDM) = FUNCTION_RETURN_FAILURE Then
            Debug.Print "ïŒêÕåvéZópÉpÉâÉÅÅ[É^ÇÃéÊìæÇ…é∏îsÇµÇΩ"
        End If
        dblMenseki = AreaOfCircle(dblDM)
        dblTopWght = dblWgtTop + dblWgtTopCut
        udtCof.DUNMENSEKI = dblMenseki                      ' ífñ êœ
        udtCof.CHARGEWEIGHT = lngWgtCharge                  ' É`ÉÉÅ[ÉWó 
        udtCof.TOPWEIGHT = dblTopWght                       ' ÉgÉbÉvèdó 
        udtCof.TOPSMPLPOS = tblSXL.INGOTPOS                 ' ÉgÉbÉvà íu
        udtCof.BOTSMPLPOS = tblSXL.INGOTPOS + tblSXL.COUNT  ' É{ÉgÉÄà íu

        udtTmpResPosCal.COEFFICIENT = CoefficientCalculation(udtCof)
        udtTmpResPosCal.DUNMENSEKI = udtCof.DUNMENSEKI
        udtTmpResPosCal.CHARGEWEIGHT = udtCof.CHARGEWEIGHT
        udtTmpResPosCal.TOPWEIGHT = udtCof.TOPWEIGHT
        udtTmpResPosCal.TOPSMPLPOS = udtCof.TOPSMPLPOS
        udtTmpResPosCal.TOPRES = udtCof.TOPRES
        udtTmpResPosCal.target = val(txtTarget.text)

        '' ïŒêÕåvéZä÷êîÇÃåƒÇ—èoÇµ
        dblCalcPos = PosCalculation(udtTmpResPosCal)
        If dblCalcPos <= -9999 Or dblCalcPos > 9999 Then
            lblMsg.Caption = GetMsgStr("ECLC2")
            Exit Sub
        End If
        intPos = dblCalcPos

        '' åvéZà íuÇ™SXLÇÃíÜÇ…ä‹Ç‹ÇÍÇƒÇ¢ÇÈèÍçá
        txtCryP.text = intPos
        If (tblSXL.INGOTPOS <= intPos) And (intPos < tblSXL.INGOTPOS + tblSXL.COUNT) Then
            Call orgXl.GetBlkPos(intPos, sBlkId, intBlkPos)
            txtBlkID = Right(Trim$(sBlkId), 3)
            txtBlkP = ""
            If intBlkPos <> -9999 Then txtBlkP = intBlkPos
        End If
    End If
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_Top_Btm_TEIKOU
'*
'*    èàóùäTóv      : 1.âÊñ îÕàÕÇÃÇÀÇÁÇ¢ÉœÇéZèo
'*                      ÅiåãèªPÇÃÇ©ÇÁÉœÇéÊìæÅj
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    ingot     Å@,I  ,IntegerÅ@,åãèªP
'*                    dblTeikou   ,O  ,Double   ,ÇÀÇÁÇ¢Éœ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_Top_Btm_TEIKOU(ingot As Integer, dblTeikou As Double)
    Dim udtTmpResPosCal As type_ResPosCal
    Dim udtCof          As type_Coefficient
    Dim dblMenseki      As Double
    Dim dblTopWght      As Double
    Dim intPos          As Integer
    Dim lngWgtCharge    As Long     'ïŒêÕåvéZópÉpÉâÉÅÅ[É^
    Dim dblWgtTop       As Double   'ïŒêÕåvéZópÉpÉâÉÅÅ[É^
    Dim dblWgtTopCut    As Double   'ïŒêÕåvéZópÉpÉâÉÅÅ[É^
    Dim dblDM           As Double   'ïŒêÕåvéZópÉpÉâÉÅÅ[É^
    Dim sBlkId          As String
    Dim intBlkPos       As Integer
    Dim dblCalcPos      As Double

    lblMsg.Caption = ""
    txtBlkID = ""
    txtBlkP = ""
    txtCryP.text = ""

    udtCof.TOPSMPLPOS = tblSXL.INGOTPOS
    udtCof.BOTSMPLPOS = tblSXL.INGOTPOS + tblSXL.COUNT
    udtCof.TOPRES = tblTotal.typ_y013(1, WFRES).MESDATA5
    udtCof.BOTRES = tblTotal.typ_y013(2, WFRES).MESDATA5
    
    ''ïŒêÕåvéZópÉpÉâÉÅÅ[É^éÊìæ É}ÉãÉ`à¯è„ëŒâû éQè∆ä÷êîïœçX 2008/05/22 SETsw Nakada
    If GetCoeffParams_new(txtCryNum.text, lngWgtCharge, dblWgtTop, dblWgtTopCut, dblDM) = FUNCTION_RETURN_FAILURE Then
'    If GetCoeffParams(txtCryNum.text, lngWgtCharge, dblWgtTop, dblWgtTopCut, dblDM) = FUNCTION_RETURN_FAILURE Then
        Debug.Print "ïŒêÕåvéZópÉpÉâÉÅÅ[É^ÇÃéÊìæÇ…é∏îsÇµÇΩ"
    End If

    dblMenseki = AreaOfCircle(dblDM)
    dblTopWght = dblWgtTop + dblWgtTopCut
    udtCof.DUNMENSEKI = dblMenseki                      ' ífñ êœ
    udtCof.CHARGEWEIGHT = lngWgtCharge                  ' É`ÉÉÅ[ÉWó 
    udtCof.TOPWEIGHT = dblTopWght                       ' ÉgÉbÉvèdó 
    udtCof.TOPSMPLPOS = tblSXL.INGOTPOS                 ' ÉgÉbÉvà íu
    udtCof.BOTSMPLPOS = tblSXL.INGOTPOS + tblSXL.COUNT  ' É{ÉgÉÄà íu

    udtTmpResPosCal.COEFFICIENT = CoefficientCalculation(udtCof)
    udtTmpResPosCal.DUNMENSEKI = udtCof.DUNMENSEKI
    udtTmpResPosCal.CHARGEWEIGHT = udtCof.CHARGEWEIGHT
    udtTmpResPosCal.TOPWEIGHT = udtCof.TOPWEIGHT
    udtTmpResPosCal.TOPSMPLPOS = udtCof.TOPSMPLPOS
    udtTmpResPosCal.TOPRES = udtCof.TOPRES
    udtTmpResPosCal.target = val(ingot)

    '' ïŒêÕåvéZä÷êîÇÃåƒÇ—èoÇµ
    dblCalcPos = ResCalculation(udtTmpResPosCal)
    If dblCalcPos <= -9999 Or dblCalcPos > 9999 Then
        lblMsg.Caption = GetMsgStr("ECLC2")
        Exit Sub
    End If

    dblTeikou = dblCalcPos
    Debug.Print "åvéZíÔçRíl = " & dblTeikou
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_DispClear
'*
'*    èàóùäTóv      : 1.âÊñ ÇÃëSÉfÅ[É^ÇÉNÉäÉAÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_DispClear()
    lblMsg.Caption = ""
    lblKanren.Visible = False   '08/01/31 ooba
    txtStaffID.text = ""
    txtJfName.text = ""
    txtCryNum.text = ""
    txtKSXLID.text = ""
    txtTopRsltR.text = ""
    txtBotRsltR.text = ""
    txtTarget.text = ""
    txtBlkID.text = ""
    txtBlkP.text = ""
    txtCryP.text = ""
    sprSpec.MaxRows = 0
    sprExamine.MaxRows = 0
    sprWarp.MaxRows = 0
    bSampFlag = False
    cmdF(2).Enabled = False
    cmdF(5).Enabled = False 'ì¡çÃÉ{É^Éì
    cmdF(5).backColor = &H8000000F
    cmdF(12).Enabled = False

    Call Pic_Disp(0)
'----- ÉTÉìÉvÉãÉ{É^ÉìèÛë‘èâä˙âªÅ@2010/12/08 Marushita
    bSampleBtn = True
    cmdF(10).Enabled = True
End Sub

'*******************************************************************************
'*    ä÷êîñº        : fnc_DispHinSpec
'*
'*    èàóùäTóv      : 1.êªïiédólÉfÅ[É^Çï\é¶Ç∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    intsyoki    ,I  ,Integer  ,0:èâä˙ï\é¶ÅA1:ÉTÉìÉvÉãÉ{É^Éì
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Function fnc_DispHinSpec(intsyoki As Integer) As Boolean
    Dim udtTmpHin       As tFullHinban
    Dim sHin            As String
    Dim sErrMsg         As String
    Dim vTemp           As Variant
    Dim intNLen         As Integer
    Dim m               As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim vNukisiFlg      As Variant
    Dim vOldNukisiFlg   As Variant
    Dim intHinLoop      As Integer
    Dim intCnt          As Integer
    Dim sRev            As String
    Dim blSameHin       As Boolean
    Dim s               As Integer

    fnc_DispHinSpec = False
    With sprExamine
        '' ïiî‘É`ÉFÉbÉN
        For i = 1 To sprExamine.MaxRows - 1
            'ïiî‘Ç1óÒí«â¡ÇµÇΩÇ±Ç∆Ç…ÇÊÇÈóÒÇÃïœçX-------start iida 2003/09/06
'            sprExamine.GetText 29, i, vNukisiFlg
            ''écë∂é_ëfåüç∏çÄñ⁄í«â¡Ç…ÇÊÇÈïœçXÅ@03/12/15 ooba
'            sprExamine.GetText 30, i, vNukisiFlg
            'GDí«â¡Ç…ÇÊÇÈïœçXÅ@05/02/17 ooba
            'sprExamine.GetText 31, i, vNukisiFlg
            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
            sprExamine.GetText 37, i, vNukisiFlg
            If (vNukisiFlg = 1) Or (vNukisiFlg = 2) Then    'î≤ééçsÇæÇ¡ÇΩÇÁ
                '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                sprExamine.GetText 37, i + 1, vOldNukisiFlg
                If (vNukisiFlg = 1) And (vOldNukisiFlg = 1) Then  'ÇQçsë±ÇØÇƒèâä˙ï\é¶î≤ééçsÇæÇ¡ÇΩéû
                    'âΩÇ‡ÇµÇ»Ç¢
                Else
                    If (vNukisiFlg = 1) Then
                        Call sprExamine.GetText(2, i, vTemp)
                    Else
                        Call sprExamine.GetText(2, i + 1, vTemp)
                    End If
                    vTemp = Trim(vTemp)
                    If Trim$(vTemp) <> "Z" Then
                        Select Case ChkString(vTemp, 8, 8)
                        Case CHK_NG, CHK_NULL
                            lblMsg.Caption = GetMsgStr(EHIN1)
                            Exit Function
                        End Select
                        sHin = vTemp
                        If GetLastHinban(sHin, udtTmpHin) = FUNCTION_RETURN_FAILURE Then
                            lblMsg.Caption = GetMsgStr(EHIN0)
                            Exit Function
                        End If
                    End If
                End If
            End If
        Next i

        '' ïiî‘ÇÃê›íË
        m = .MaxRows
        ReDim tblHinbanRs(m)
        If m = 0 Then
            Exit Function
        End If
        j = 0
        For i = 1 To m - 1
            .row = i

            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû
            sprExamine.GetText 37, i, vNukisiFlg

            If intsyoki = 0 Then  'èâä˙ï\é¶ÇÃÇ∆Ç´ÇÃèàóù
                'î≤ééçsÇæÇ¡ÇΩÇÁ
                If (vNukisiFlg = 1) Or (vNukisiFlg = 2) Then
                    '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                    sprExamine.GetText 37, i + 1, vOldNukisiFlg

                    If (vNukisiFlg = 1) Then
                        .col = 2
                        sHin = Trim$(.text)
                        .col = 3
                        sRev = Trim$(.text)
                    Else
                        .row = i + 1
                        .col = 2
                        sHin = Trim$(.text)
                        .col = 3
                        sRev = Trim$(.text)
                    End If
                    If sHin <> "Z" Then
                        .col = 4
                        intNLen = val(.text)
                        If vNukisiFlg = 1 Then      '2003/11/14 SystemBrain ó«Ç≠âÇÁÇ»Ç¢ÇØÇ«ÅAñ≥óùÇ‚ÇËÇ…ÅEÅEÅE Å§
                            .row = i + 1                    'Ç≈Ç‡ÅAï°êîÃﬁ€Ø∏1SXLÇÃéûÅAÇæÇﬂÇ≈ÇµÇΩ
                        Else
                            .row = i + 2
                        End If                      '2003/11/14 SystemBrain ó«Ç≠âÇÁÇ»Ç¢ÇØÇ«ÅAñ≥óùÇ‚ÇËÇ…ÅEÅEÅE Å¢
                        If i = 1 Or i <> m Then
                            .col = 4
                            intNLen = val(.text) - intNLen

                            'ìØàÍÇÃ12åÖïiî‘Ç™ä˘Ç…ë∂ç›Ç∑ÇÈÇ©¡™Ø∏ÇµÅAä˘Ç…Ç†ÇÍÇŒçÏê¨ÇµÇ»Ç¢ 2003/11/14 SystemBrain Å§
                            blSameHin = False
                            For s = 1 To j
                                If tblHinbanRs(s).HIN.hinban = sHin And tblHinbanRs(s).HIN.mnorevno = val(Mid(sRev, 1, 2)) And _
                                   tblHinbanRs(s).HIN.factory = Mid(sRev, 3, 1) And tblHinbanRs(s).HIN.opecond = Mid(sRev, 4, 1) Then
                                    tblHinbanRs(s).LENGHT = tblHinbanRs(s).LENGHT + intNLen    'ÇΩÇ‘ÇÒâ¡éZ ÅÀ vNukisiFlg=0ÇÃ√ﬁ∞¿ÇÕÇ±Ç±Çí ÇÁÇ»Ç¢ÇÃÇ≈í∑Ç≥Ç™ë´ÇËÇ»Ç¢
                                    blSameHin = True
                                    Exit For
                                End If
                            Next s

                            'ìØàÍÇÃ12åÖïiî‘Ç™ä˘Ç…ë∂ç›Ç∑ÇÈÇ©¡™Ø∏ÇµÅAä˘Ç…Ç†ÇÍÇŒçÏê¨ÇµÇ»Ç¢ 2003/11/14 SystemBrain Å¢
                            If Not blSameHin Then
                                j = j + 1

                                With tblHinbanRs(j)                                                 'ï\é¶ÇµÇƒÇÈïiî‘ÇÃédólÇ»ÇÒÇæÇ¡Çƒ 2003/11/14 Å§
                                    .CRYNUM = tblSXL.CRYNUM
                                    .HIN.hinban = sHin                        ' ïiî‘
                                    .HIN.mnorevno = val(Mid(sRev, 1, 2))      ' êªïiî‘çÜâ¸í˘î‘çÜ
                                    .HIN.factory = Mid(sRev, 3, 1)            ' çHèÍ
                                    .HIN.opecond = Mid(sRev, 4, 1)            ' ëÄã∆èåè
                                    .LENGHT = intNLen                            ' í∑Ç≥
                                End With                                                            'ï\é¶ÇµÇƒÇÈïiî‘ÇÃédólÇ»ÇÒÇæÇ¡Çƒ 2003/11/14 Å¢
                            End If
                        End If
                    End If
                End If
            Else
'                'èåèÇí«â¡(2ÉuÉçÉbÉN1SXLédólÇÃÇ»Ç¢ïiî‘Ç…êUë÷ëŒâû) èâä˙ï\é¶à»äO
                If (vNukisiFlg = 1) Or (vNukisiFlg = 2) Or (i Mod 2 = 0 And vNukisiFlg = 3 And UBound(tblWafInd()) > 2) Then
                    '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                    sprExamine.GetText 37, i + 1, vOldNukisiFlg

                    If (vNukisiFlg = 1) Then
                        .col = 2
                        sHin = Trim$(.text)
                        .col = 3
                        sRev = Trim$(.text)
                    Else
                        .row = i + 1
                        .col = 2
                        sHin = Trim$(.text)
                        .col = 3
                        sRev = Trim$(.text)
                    End If
                    If sHin <> "Z" Then
                        .col = 4
                        intNLen = val(.text)
                        If vNukisiFlg = 1 Then      '2003/11/14 SystemBrain ó«Ç≠âÇÁÇ»Ç¢ÇØÇ«ÅAñ≥óùÇ‚ÇËÇ…ÅEÅEÅE Å§
                            .row = i + 1                    'Ç≈Ç‡ÅAï°êîÃﬁ€Ø∏1SXLÇÃéûÅAÇæÇﬂÇ≈ÇµÇΩ
                        Else
                            .row = i + 2
                        End If                      '2003/11/14 SystemBrain ó«Ç≠âÇÁÇ»Ç¢ÇØÇ«ÅAñ≥óùÇ‚ÇËÇ…ÅEÅEÅE Å¢
                        If i = 1 Or i <> m Then
                            .col = 4
                            intNLen = val(.text) - intNLen

                            'ìØàÍÇÃ12åÖïiî‘Ç™ä˘Ç…ë∂ç›Ç∑ÇÈÇ©¡™Ø∏ÇµÅAä˘Ç…Ç†ÇÍÇŒçÏê¨ÇµÇ»Ç¢ 2003/11/14 SystemBrain Å§
                            blSameHin = False
                            For s = 1 To j
                                If tblHinbanRs(s).HIN.hinban = sHin And tblHinbanRs(s).HIN.mnorevno = val(Mid(sRev, 1, 2)) And _
                                   tblHinbanRs(s).HIN.factory = Mid(sRev, 3, 1) And tblHinbanRs(s).HIN.opecond = Mid(sRev, 4, 1) Then
                                    tblHinbanRs(s).LENGHT = tblHinbanRs(s).LENGHT + intNLen    'ÇΩÇ‘ÇÒâ¡éZ ÅÀ vNukisiFlg=0,3ÇÃ√ﬁ∞¿ÇÕÇ±Ç±Çí ÇÁÇ»Ç¢ÇÃÇ≈í∑Ç≥Ç™ë´ÇËÇ»Ç¢
                                    blSameHin = True
                                    Exit For
                                End If
                            Next s

                            'ìØàÍÇÃ12åÖïiî‘Ç™ä˘Ç…ë∂ç›Ç∑ÇÈÇ©¡™Ø∏ÇµÅAä˘Ç…Ç†ÇÍÇŒçÏê¨ÇµÇ»Ç¢ 2003/11/14 SystemBrain Å¢
                            If Not blSameHin Then
                                j = j + 1
                                With tblHinbanRs(j)                                                 'ï\é¶ÇµÇƒÇÈïiî‘ÇÃédólÇ»ÇÒÇæÇ¡Çƒ 2003/11/14 Å§
                                    .CRYNUM = tblSXL.CRYNUM
                                    .HIN.hinban = sHin                        ' ïiî‘
                                    .HIN.mnorevno = val(Mid(sRev, 1, 2))      ' êªïiî‘çÜâ¸í˘î‘çÜ
                                    .HIN.factory = Mid(sRev, 3, 1)            ' çHèÍ
                                    .HIN.opecond = Mid(sRev, 4, 1)            ' ëÄã∆èåè
                                    .LENGHT = intNLen                            ' í∑Ç≥
                                End With                                                            'ï\é¶ÇµÇƒÇÈïiî‘ÇÃédólÇ»ÇÒÇæÇ¡Çƒ 2003/11/14 Å¢
                            End If
                        End If
                    End If
                End If
            End If
        Next i
        ReDim Preserve tblHinbanRs(j)
    End With

    '' DBÇ©ÇÁÉfÅ[É^Çì«Ç›çûÇﬁ
    '' édólïîï™ÇÃÉ`ÉFÉbÉN
    If DBDRV_scmzc_fcmlc001d_DispSiyou(tblHinbanRs, tblsiyou, sErrMsg) = FUNCTION_RETURN_FAILURE Then
        lblMsg.Caption = sErrMsg
        Exit Function
    End If

    '' êªïiédólÉfÅ[É^ÇÃï\é¶
    m = UBound(tblHinbanRs())
    With sprSpec
        j = 0
        .MaxRows = m
        For i = 1 To m
            If Trim$(tblHinbanRs(i).HIN.hinban) <> "" Then
                j = j + 1
                .row = j
                .col = 1
                .text = tblHinbanRs(i).HIN.hinban   ' ïiî‘
                .col = 2
                .text = Format(tblHinbanRs(j).HIN.mnorevno, "00") & tblHinbanRs(j).HIN.factory & tblHinbanRs(j).HIN.opecond
                .col = 3                            ' î‰íÔçR
                .text = toRsStr_nl(tblsiyou(i).HWFRMIN, tblsiyou(i).HWFRMAX) '2001/12/26 S.Sano
                .col = 4
                .text = tblsiyou(i).KEIKAKUL        ' åvâÊí∑
                .col = 5
                .text = tblHinbanRs(i).LENGHT       ' êÑíËí∑
                .col = 6
                .text = tblsiyou(i).HWFRHWYS        ' Rs
                .col = 7
                .text = tblsiyou(i).HWFONHWS        ' Oi
                .col = 8
                .text = tblsiyou(i).HWFBM1HS        ' B1
                .col = 9
                .text = tblsiyou(i).HWFBM2HS        ' B2
                .col = 10
                .text = tblsiyou(i).HWFBM3HS        ' B3
                .col = 11
                .text = tblsiyou(i).HWFOF1HS        ' L1
                .col = 12
                .text = tblsiyou(i).HWFOF2HS        ' L2
                .col = 13
                .text = tblsiyou(i).HWFOF3HS        ' L3
                .col = 14
                '.text = tblsiyou(i).HWFOF4HS        ' L4
                'Change 2010/01/06 Y.Hitomi
                .text = tblsiyou(i).HWFSIRDHS       ' SD(SIRD)
                .col = 15
                .text = tblsiyou(i).HWFDSOHS        ' DS
                .col = 16
                .text = tblsiyou(i).HWFMKHWS        ' DZ
                .col = 17

                'ägéUí∑,NrîZìxí«â¡Å@06/06/08 ooba START ===================>
                If tblsiyou(i).HWFSPVHS = "H" Or _
                   tblsiyou(i).HWFDLHWS = "H" Or _
                   tblsiyou(i).HWFNRHS = "H" Then
                    .text = "H"
                ElseIf tblsiyou(i).HWFSPVHS = "S" Or _
                       tblsiyou(i).HWFDLHWS = "S" Or _
                       tblsiyou(i).HWFNRHS = "S" Then
                    .text = "S"
                Else
                    .text = tblsiyou(i).HWFSPVHS
                End If

                .col = 18
                .text = tblsiyou(i).HWFOS1HS        ' D1
                .col = 19
                .text = tblsiyou(i).HWFOS2HS        ' D2
                .col = 20
                .text = tblsiyou(i).HWFOS3HS        ' D3
                .col = 21
                .text = tblsiyou(i).HWFZOHWS        ' AO        ''écë∂é_ëfí«â¡
                ''écë∂é_ëfåüç∏çÄñ⁄í«â¡Ç…ÇÊÇÈïœçXÅ@03/12/15 ooba

                'édól≥®›ƒﬁ©OT1§OT2Ç…éwé¶ÇÃóLñ≥Çï\é¶Ç∑ÇÈ
                If tblsiyou(i).HWFOT1 = "1" Then
                    .col = 22
                    .text = "óL"
                ElseIf tblsiyou(i).HWFOT1 = "0" Then
                    .col = 22
                    .text = "ñ≥"
                End If
                If tblsiyou(i).HWFOT2 = "1" Then
'--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh -s-
                    .col = 30
'--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh -e-
                    .text = "óL"
                ElseIf tblsiyou(i).HWFOT2 = "0" Then
'--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh -s-
                    .col = 30
'--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh -e-
                    .text = "ñ≥"
                End If

'--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh -s-
                .col = 23
'--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh -e-
                If tblsiyou(i).HWFDENHS = "H" Or tblsiyou(i).HWFLDLHS = "H" Or _
                        tblsiyou(i).HWFDVDHS = "H" Then
                    .text = "H"
                ElseIf tblsiyou(i).HWFDENHS = "S" Or tblsiyou(i).HWFLDLHS = "S" Or _
                        tblsiyou(i).HWFDVDHS = "S" Then
                    .text = "S"
                Else
                    .text = " "
                End If
'--- 2006/08/15 Add ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh -s-
                .col = 24:  .text = tblsiyou(i).HEPBM1HS
                .col = 25:  .text = tblsiyou(i).HEPBM2HS
                .col = 26:  .text = tblsiyou(i).HEPBM3HS
                .col = 27:  .text = tblsiyou(i).HEPOF1HS
                .col = 28:  .text = tblsiyou(i).HEPOF2HS
                .col = 29:  .text = tblsiyou(i).HEPOF3HS
'--- 2006/08/15 Add ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh -e-
                '>>>>> íÜä‘î≤ééãKäiÉZÉbÉgí«â¡ 2011/07/15 Marushita
                .col = 31:  .text = tblsiyou(i).CHUTAN
                .col = 32:  .text = tblsiyou(i).CHUKYO
                .col = 33:  .text = tblsiyou(i).CHUFLG
                '<<<<< íÜä‘î≤ééãKäiÉZÉbÉgí«â¡ 2011/07/15 Marushita
            End If
        Next i
        .MaxRows = j

'--- 2006/08/15 Add ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh -s-
        '' WFédólÇèâä˙ï\é¶Ç∑ÇÈ
        Call sub_cmbc039_3_ChangeHinSpec(0)
        CmdChangeWF_EP.Tag = "WF"
        CmdChangeWF_EP.Caption = "ÇvÇe >>"
'--- 2006/08/15 Add ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh -e-
    End With

    'édólÇ™Ç»Ç¢ÉfÅ[É^Ç÷ÇÃêUë÷ÇçsÇ¡ÇΩÇ∆Ç´ÇÕÉGÉâÅ[Ç…ÇµÇ»Ç¢
    'èâä˙ï\é¶çsÇÃïiî‘ÇæÇØÇïœçXÇµÇΩÇ∆Ç´
    'èâä˙ï\é¶èàóùÇÃÇ∆Ç´ÇÕÉ`ÉFÉbÉNÇÇµÇ»Ç¢
    If intsyoki <> 0 Then
    For i = 1 To UBound(tblsiyou())
        intCnt = 0
        If tblsiyou(i).HWFRHWYS <> "H" And tblsiyou(i).HWFRHWYS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFONHWS <> "H" And tblsiyou(i).HWFONHWS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFBM1HS <> "H" And tblsiyou(i).HWFBM1HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFBM2HS <> "H" And tblsiyou(i).HWFBM2HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFBM3HS <> "H" And tblsiyou(i).HWFBM3HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFOF1HS <> "H" And tblsiyou(i).HWFOF1HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFOF2HS <> "H" And tblsiyou(i).HWFOF2HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFOF3HS <> "H" And tblsiyou(i).HWFOF3HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFOF4HS <> "H" And tblsiyou(i).HWFOF4HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFDSOHS <> "H" And tblsiyou(i).HWFDSOHS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFMKHWS <> "H" And tblsiyou(i).HWFMKHWS <> "S" Then
            intCnt = intCnt + 1
        End If
        'ägéUí∑,NrîZìxí«â¡
        If tblsiyou(i).HWFSPVHS <> "H" And tblsiyou(i).HWFSPVHS <> "S" And _
           tblsiyou(i).HWFDLHWS <> "H" And tblsiyou(i).HWFDLHWS <> "S" And _
           tblsiyou(i).HWFNRHS <> "H" And tblsiyou(i).HWFNRHS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFOS1HS <> "H" And tblsiyou(i).HWFOS1HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFOS2HS <> "H" And tblsiyou(i).HWFOS2HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFOS3HS <> "H" And tblsiyou(i).HWFOS3HS <> "S" Then
            intCnt = intCnt + 1
        End If
        ''écë∂é_ëfí«â¡
        If tblsiyou(i).HWFZOHWS <> "H" And tblsiyou(i).HWFZOHWS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFOT1 = "0" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HWFOT2 = "0" Then
            intCnt = intCnt + 1
        End If
        'GDí«â¡
        If tblsiyou(i).HWFDENHS <> "H" And tblsiyou(i).HWFDENHS <> "S" And _
                tblsiyou(i).HWFLDLHS <> "H" And tblsiyou(i).HWFLDLHS <> "S" And _
                tblsiyou(i).HWFDVDHS <> "H" And tblsiyou(i).HWFDVDHS <> "S" Then
            intCnt = intCnt + 1
        End If
'--- 2006/08/15 Add ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh -s-
        If tblsiyou(i).HEPOF1HS <> "H" And tblsiyou(i).HEPOF1HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HEPOF2HS <> "H" And tblsiyou(i).HEPOF2HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HEPOF3HS <> "H" And tblsiyou(i).HEPOF3HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HEPBM1HS <> "H" And tblsiyou(i).HEPBM1HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HEPBM2HS <> "H" And tblsiyou(i).HEPBM2HS <> "S" Then
            intCnt = intCnt + 1
        End If
        If tblsiyou(i).HEPBM3HS <> "H" And tblsiyou(i).HEPBM3HS <> "S" Then
            intCnt = intCnt + 1
        End If
'--- 2006/08/15 Add ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh -e-

'--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh
        If intCnt = 25 Then
            If UBound(tblWafInd()) > 2 Then
                lblMsg.Caption = "édólÇ™Ç†ÇËÇ‹ÇπÇÒ"
                cmdF(12).Enabled = False
                Exit Function
            End If
        End If
    Next
    End If
    fnc_DispHinSpec = True
End Function

'*******************************************************************************
'*    ä÷êîñº        : sub_DispExamineData
'*
'*    èàóùäTóv      : 1.î≤éééwé¶ÉfÅ[É^Çï\é¶Ç∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_DispExamineData()
    Dim Blk             As c_cmzcBlk
    Dim sList           As String
    Dim intREBlockPos   As Integer
    Dim intBlockStPos   As Integer
    Dim m               As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim c0              As Integer
    Dim lngSelectpoint  As Long

    If Trim$(tblsmp(1).SMPLID) = "" Then
        ReDim tblsmp(2)
        tblsmp(1).INGOTPOS = tblSXL.INGOTPOS
        tblsmp(1).hinban = tblSXL.hinban
        tblsmp(2).INGOTPOS = tblSXL.INGOTPOS + tblSXL.COUNT
        tblsmp(2).hinban = tblSXL.hinban
    End If

    '' î≤éééwé¶ÉfÅ[É^ÇÃï\é¶
    With sprExamine
        .MaxRows = 2
        For i = 1 To 2
            '' ÉuÉçÉbÉNID
            .row = i
            .col = 1
            If tblsmp(i).INGOTPOS <> 0 Then
                If i = 1 Then
                    intBlockStPos = orgXl.Blks.LowerArea(CStr(tblsmp(i).INGOTPOS))
                Else
                    intBlockStPos = orgXl.Blks.UpperArea(CStr(tblsmp(i).INGOTPOS))
                End If
            Else
                intBlockStPos = 0
            End If
            Set Blk = orgXl.Blks(CStr(intBlockStPos))
            .text = Right(Blk.BLOCKID, 3)
            .backColor = COLOR_OK

            '' ÉuÉçÉbÉNP
            .col = 2
            intREBlockPos = DBData2DispData(tblsmp(i).INGOTPOS - intBlockStPos, "0")
            .text = intREBlockPos

            '' åãèªP
            .col = 3
            .text = tblsmp(i).INGOTPOS

            '' ãÊï™ÉRÉìÉ{ÇÃê›íË
            If i = 1 Then
                m = UBound(tblPrcList)
                sList = GetGPCodeDspStr(tblPrcList(1).CODE, tblPrcList(1).INFO1)
                For j = 2 To m
                    sList = sList & vbTab & GetGPCodeDspStr(tblPrcList(j).CODE, tblPrcList(j).INFO1)
                Next j
                .col = 4
                .TypeComboBoxList = sList
                .TypeComboBoxCurSel = 0
            End If

            '' ïiî‘
            .col = 5
            If i = 1 Then
                .text = Trim(tblTotal.typ_Param.hinban)
            Else
                '' SXLÇÃâ∫í[ÇÕì‡ë§ÇÃïiî‘Çï\é¶Ç≥ÇπÇÈ
                .text = tblsmp(1).hinban
            End If
        Next i

        '' WFëççáîªíËÇ…Çƒçƒî≤ééÇÃéwé¶Ç™Ç≈ÇΩèÍçáÅAçsí«â¡
        For i = 1 To 2
            If tblTotal.bOKNG(i) = False And _
               tblTotal.dblScut(i) > tblSXL.INGOTPOS And _
               tblTotal.dblScut(i) < tblSXL.INGOTPOS + tblSXL.COUNT Then
                .MaxRows = .MaxRows + 1
                .row = .ActiveRow
                .Action = ActionInsertRow

                '' ÉuÉçÉbÉNID
                intBlockStPos = orgXl.Blks.UpperPos(tblTotal.dblScut(i))
                Set Blk = orgXl.Blks(CStr(intBlockStPos))

                '' ÉuÉçÉbÉNIDÉRÉìÉ{ÇÃê›íË
                .col = 1
                m = UBound(SxlIntoBlock)
                If m = 1 Then
                    .Lock = True
                    .CellType = CellTypeStaticText
                    .text = SxlIntoBlock(1).SORTID
                Else
                    .Lock = False
                    .CellType = CellTypeComboBox
                    sList = SxlIntoBlock(1).SORTID
                    For j = 2 To m
                        sList = sList & vbTab & SxlIntoBlock(j).SORTID
                    Next j
                    .TypeComboBoxList = sList
                    m = .TypeComboBoxCount
                    For j = 0 To m
                        .TypeComboBoxCurSel = 0
                        If .text = Right(Blk.BLOCKID, 3) Then
                            .TypeComboBoxCurSel = j
                            Exit For
                        End If
                    Next j
                End If
                .TypeHAlign = TypeHAlignCenter

                '' ÉuÉçÉbÉNP
                .col = 2
                intREBlockPos = DBData2DispData(tblTotal.dblScut(i) - orgXl.Blks.UpperPos(tblTotal.dblScut(i)), "0")
                .text = intREBlockPos
                .col = 3
                .text = DBData2DispData(tblTotal.dblScut(i), "0")

                '' ãÊï™ÉRÉìÉ{ÇÃê›íË
                m = UBound(tblPrcList)
                sList = GetGPCodeDspStr(tblPrcList(1).CODE, tblPrcList(1).INFO1)
                For j = 2 To m
                    sList = sList & vbTab & GetGPCodeDspStr(tblPrcList(j).CODE, tblPrcList(j).INFO1)
                Next j
                .col = 4
                .TypeComboBoxList = sList
                .TypeComboBoxCurSel = 0

                '' ÉTÉìÉvÉãIDÇÃê›íË
                '' í«â¡çsÇÃïiî‘ê›íË(â∫ë§ÇÃZïiî‘ÇÕí«â¡çsÇ…ëŒÇµÇƒZÇÇΩÇƒÇÈÇΩÇﬂÅAÇ±ÇÃÉãÅ[Évì‡Ç≈ê›íËÇ∑ÇÈ)
                .col = 5
                If i = 1 Then
                    .text = tblSXL.hinban
                ElseIf i = 2 Then
                    .text = "Z"
                End If
                InMaxRow = InMaxRow + 1
            End If
        Next i

        '' åãèªà íuÇ…ÇƒÉ\Å[ÉgÇÇ©ÇØÇÈ
        .col = 1
        .col2 = .MaxCols
        .row = 1
        .row2 = .MaxRows
        .SortBy = SortByRow
        .SortKey(1) = 3
        .SortKeyOrder(1) = SortKeyOrderAscending
        .Action = ActionSort

        '' ïiî‘Ç…îpä¸èÓïÒê›íË(è„ë§NGÇÃèÍçáÇÕÅA1çsñ⁄ÇZÇ…Ç∑ÇÈ)
        If tblTotal.bOKNG(1) = False And _
           tblTotal.dblScut(1) > tblSXL.INGOTPOS And _
           tblTotal.dblScut(1) < tblSXL.INGOTPOS + tblSXL.COUNT Then
            .row = 1
            .col = 5
            .TypeComboBoxCurSel = 1
        End If
    End With
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_DispSample
'*
'*    èàóùäTóv      : 1.ãKíËílÇÃåüç∏éwé¶ÉTÉìÉvÉãÉfÅ[É^Çï\é¶Ç∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    blnsflgÅ@Å@ ,I  ,Boolean  ,ÉfÅ[É^É`ÉFÉbÉNäÆóπÉtÉâÉO
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Function sub_DispSample(Optional blnsflg As Boolean) As Boolean
    Dim sSampID1        As String
    Dim sSampID2        As String
    Dim m               As Integer
    Dim n               As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim blAns           As Boolean
    Dim vTemp           As Variant
    Dim vTemp1          As Variant
    Dim vTemp2          As String
    Dim c0              As Long
    Dim udtFullHinban   As tFullHinban
    Dim udtTmpWafSmp()  As typ_XSDCW
    Dim blNukisiOk      As Boolean
    Dim intLoopCnt      As Integer
    Dim vNukisiFlg      As Variant
    Dim intNukisiRow      As Integer
    Dim vgetlotid       As Variant
    Dim vGetLotId2      As Variant
    Dim vGetBlkP        As Variant
    Dim vGetIngotP      As Variant
    Dim vGetBlkSeq      As Variant
    Dim vGetBlkSeq2     As Variant
    Dim vGetHinban      As Variant
    Dim vSample1        As Variant
    Dim vSample2        As Variant
    Dim intNextBlkP     As Integer
    Dim vNextBlkP       As Variant
    Dim vGetWfNum       As Variant
    Dim vViewSmpId      As Variant
    Dim vViewSmpId2     As Variant
    Dim vAllNum         As Variant
    Dim vBlockId        As Variant
    Dim intCngBlpnt     As Integer
    Dim vWFNumber       As Variant
    Dim vKeturaku       As Variant
    Dim vNull           As Variant
    Dim vZERO           As Variant
    Dim sNextIngotP     As String
    Dim sHinban         As String
    Dim intRowNum       As Integer
    Dim intCol          As Integer
    Dim sNum            As String
    Dim sColor          As String
    Dim sNukishi        As String
    Dim intWfChkLoop    As Integer
    Dim vGetUpWf        As Variant
    Dim vGetDnWf        As Variant
    Dim vGetUpBlk       As Variant
    Dim vGetDnBlk       As Variant
    Dim blKensaLock     As Boolean
    Dim blKirikaeflg    As Boolean
    Dim vGetToHin       As Variant
    Dim vGetToSamp      As Variant
    Dim sMsg            As String
    Dim intModori       As Integer  'ñﬂÇËíl
    Dim sGHin           As String   'ïiî‘
    Dim blnhflg         As Boolean  'îΩâfîªíËÉtÉâÉO
    Dim intZkbn         As Integer  'ZãÊï™
    Dim udtFHin         As tFullHinban
    Dim intSmpkbn       As Integer 'ÉTÉìÉvÉããÊï™Ç™ë„ï\ÉTÉìÉvÉãÇ©îªífÇ∑ÇÈ
    Dim sHinRev         As String
    Dim intBcnt         As Integer  'ã§óL(ï )ÉTÉìÉvÉãêî
    
    Dim flg          As Integer
    Dim now_bid      As String
    Dim old_bid      As String
    Dim iJCnt1      As Integer
    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD START
    Dim sird1stBlockSet As Boolean          'åãèªì‡SIRDª›ÃﬂŸéwé¶ê›íËóLñ≥[True:ê›íËçœÇ›ÅAFalse:ñ¢ê›íË]
    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD END
     

    sub_DispSample = False
    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD START
    sird1stBlockSet = False             'åãèªì‡SIRDª›ÃﬂŸéwé¶ê›íËóLñ≥[True:ê›íËçœÇ›ÅAFalse:ñ¢ê›íË]
    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD END
    
    intBcnt = 1
    ReDim iBetuRow(sprExamine.MaxRows)

    blNukisiOk = False
    '' çƒî≤ééÇÃêVãKçsÇ™ë∂ç›ÇµÇ»ÇØÇÍÇŒèàóùÇî≤ÇØÇÈ&ëSêîîpä¸ÇÃZïiî‘ÇÃÇ›óLå¯Ç∆Ç∑ÇÈ

    With sprExamine
        For intLoopCnt = 1 To .MaxRows
            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
            .GetText 37, intLoopCnt, vNukisiFlg
            If (vNukisiFlg <> "1") And (vNukisiFlg <> "3") Then
                blNukisiOk = True
                Exit For
            End If
        Next
        If blNukisiOk = False Then
            For intLoopCnt = 1 To .MaxRows Step 2
                .row = intLoopCnt
                .col = 2
                sHinRev = Trim$(.text)
                .col = 3
                sHinRev = sHinRev & Trim$(.text)
                If sHinRev <> Trim(tblTotal.typ_Param.hinban) + _
                              Trim(Format(tblTotal.typ_Param.REVNUM, "00")) + _
                              Trim(tblTotal.typ_Param.factory) + _
                              Trim(tblTotal.typ_Param.opecond) Then
                    blNukisiOk = True
                    Exit For
                End If
            Next intLoopCnt

            For intLoopCnt = 1 To .MaxRows
                .row = intLoopCnt
                .col = 1
                If .CellType = CellTypeCheckBox Then
                    If .text = "1" Then
                        blNukisiOk = True
                    End If
                End If
            Next intLoopCnt
            If blNukisiOk = False Then
                lblMsg.Caption = GetMsgStr("SET48")
                Exit Function
            End If

        End If
    End With

    '' î≤éééwé¶àÍóóÇÃì¸óÕÉ`ÉFÉbÉNÅiWFœØÃﬂÅj
    If fnc_CheckDataWfmap() = FUNCTION_RETURN_FAILURE Then
        Exit Function
    End If

'ïiî‘ÇÃÇmÇtÇkÇkÉ`ÉFÉbÉNÇÕÇ∑Ç≈Ç…ÇÕÇ∂Ç¢ÇƒÇ†ÇÈÅB
'Ç±Ç±Ç≈ÇmÇtÇkÇkÇÇÕÇ∂Ç¢ÇƒÇ¢ÇÈÇÃÇÕÅAâÊñ ÉåÉCÉAÉEÉgïœçXÇ…ÇÊÇËÅAÇmÇtÇkÇkçs(ïiî‘ì¸óÕïsâ¬)Ç™ë∂ç›Ç∑ÇÈÇΩÇﬂÅB
    '' ïiî‘É`ÉFÉbÉN
    For c0 = 1 To sprExamine.MaxRows - 1
        '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
        sprExamine.GetText 37, c0, vNukisiFlg

        If (vNukisiFlg = "1") Or (vNukisiFlg = "2") Then    'î≤ééçsÇæÇ¡ÇΩÇÁ
            If (vNukisiFlg = "1") Then
                '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                sprExamine.GetText 37, c0 + 1, vNukisiFlg

                If vNukisiFlg = "1" Then
                    'í«â¡î≤ééÇÃñ≥Ç¢çsÇÕâΩÇ‡ÇµÇ»Ç¢
                ElseIf vNukisiFlg = "2" Then
                    sprExamine.GetText 2, c0, vTemp             'äeçsÇ…ïiî‘Ç™èëÇ¢ÇƒÇ†ÇÈÇÌÇØÇ≈ÇÕÇ»Ç¢ÅAÉ_É~Å[Ç≈ÇÕëSçsÇ…ïiî‘ÇéùÇ¡ÇƒÇ¢ÇÈÇÃÇ≈ÇªÇÍÇå©ÇÈ
                    vTemp = Trim(vTemp)
                    If Trim$(vTemp) <> "Z" Then
                        Select Case ChkString(vTemp, 8, 8)
                        Case CHK_NG, CHK_NULL
                            lblMsg.Caption = GetMsgStr(EHIN1)
                            Exit Function
                        End Select
                        vTemp2 = vTemp
                        If GetLastHinban(vTemp2, udtFullHinban) = FUNCTION_RETURN_FAILURE Then
                            lblMsg.Caption = GetMsgStr(EHIN0)
                            Exit Function
                        ''écë∂é_ëfédólÉ`ÉFÉbÉN
                        Else
                            iChkAoi = ChkAoiSiyou(udtFullHinban)
                            If iChkAoi < 0 Then
                                lblMsg.Caption = "écë∂é_ëf(AOi)édólÉGÉâÅ["
                                Exit Function
                            End If
                        End If
                    End If
                End If
            Else
                sprExamine.GetText 2, c0 + 1, vTemp
                vTemp = Trim(vTemp)
                If Trim$(vTemp) <> "Z" Then
                    Select Case ChkString(vTemp, 8, 8)
                    Case CHK_NG, CHK_NULL
                        lblMsg.Caption = GetMsgStr(EHIN1)
                        Exit Function
                    End Select
                    vTemp2 = vTemp
                    If GetLastHinban(vTemp2, udtFullHinban) = FUNCTION_RETURN_FAILURE Then
                        lblMsg.Caption = GetMsgStr(EHIN0)
                        Exit Function
                    ''écë∂é_ëfédólÉ`ÉFÉbÉN
                    Else
                        iChkAoi = ChkAoiSiyou(udtFullHinban)
                        If iChkAoi < 0 Then
                            lblMsg.Caption = "écë∂é_ëf(AOi)édólÉGÉâÅ["
                            Exit Function
                        End If
                    End If
                End If
            End If
        End If
    Next c0

   'î≤éééwé¶ópç\ë¢ëÃ
    ReDim Preserve tblNukishi(m)

    '' ãÊï™ÉGÉâÅ[É`ÉFÉbÉN
    If fnc_CheckHinbanZ() = FUNCTION_RETURN_FAILURE Then
        lblMsg.Caption = GetMsgStr("EHIN6")
        Exit Function
    End If

    '' ÉGÉâÅ[É`ÉFÉbÉN
    If fnc_CheckBlockP() = FUNCTION_RETURN_FAILURE Then
        Exit Function
    End If

    'î≤éé√ﬁ∞¿ïsê≥ï\é¶É`ÉFÉbÉN
    If fnc_ErrDispCheck(sMsg) = FUNCTION_RETURN_FAILURE Then
        lblMsg.Caption = GetMsgStr(sMsg)
        Exit Function
    End If

    'ÉfÅ[É^É`ÉFÉbÉNÇ™äÆóπÇµÇΩÇÁÉtÉâÉOÇóßÇƒÇÈ
    blnsflg = True

    '' åüç∏éwé¶ämîFÉÅÉbÉZÅ[ÉW
    If MsgBox(GetMsgStr("PSMP1"), vbOKCancel, "åüç∏éwé¶ÉTÉìÉvÉãèàóù") = vbCancel Then
        sub_DispSample = False
        Exit Function
    End If

    lblMsg.Caption = GetMsgStr("PWAIT")

     'ç\ë¢ëÃÉNÉäÉA
    ReDim tblKns(0) 'åüç∏çÄñ⁄êÿë÷ópÇÃç\ë¢ëÃÇÉNÉäÉAÇ∑ÇÈ

    DoEvents

    bSampFlag = False
    bMotoGDcpyFlg(1) = False
    bMotoGDcpyFlg(2) = False

    '' çƒî≤éééwé¶ÉeÅ[ÉuÉãÇÃçXêV
    If fnc_UpdateData() = FUNCTION_RETURN_FAILURE Then
        cmdF(12).Enabled = False
        bSampFlag = False
    Else
        cmdF(12).Enabled = True
        bSampFlag = True
    End If

    '' î≤éééwé¶ÉfÅ[É^ÇÃï\é¶
    With sprExamine
        .ReDraw = False
        If .MaxRows = 0 Then
            Exit Function
        End If

       '' åüç∏çÄñ⁄ÇÃì‡óeÇê›íË
        m = .MaxRows
        n = UBound(tblWafInd)
        intNukisiRow = 0
        intCngBlpnt = 1
        For i = 1 To m
            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
            .GetText 37, i, vNukisiFlg

    ''''''' 'èâä˙ï\é¶ÇÃÉuÉçÉbÉNÇÃã´
            If i Mod 2 = 0 And vNukisiFlg = "3" Then
                'ÉTÉìÉvÉãÉNÉäÉA
                .SetText 10, i, vbNullString
                .SetText 10, i + 1, vbNullString
                .SetText 8, i, gsWF_STA_NORMAL
                .SetText 8, i + 1, gsWF_STA_NORMAL
                'åüç∏çÄñ⁄ÉNÉäÉA
            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                For j = 11 To 35
                    .SetText j, i, vbNullString
                    .row = i
                    .row2 = i
                    .col = j
                    .col2 = j
                    .Lock = True
                    .BlockMode = True
                    .backColor = vbWhite
                    .Lock = False
                    .SetText j, i + 1, vbNullString
                    .row = i + 1
                    .col = j
                    .Lock = True
                    .BlockMode = True
                    .backColor = vbWhite
                    .BlockMode = False
                Next j
            End If

            If (vNukisiFlg <> "1") Then
                .row = i
                If bSampFlag = False Then
                    Exit Function
                End If

                '' åüç∏éwé¶ÇÃê›íË
                For j = 1 To n
                    With tblWafInd(j)
                        .SMP.CRYINDRS = GetWFSamp(.HINUP, .HINDN, 1)
                        .SMP.CRYINDOI = GetWFSamp(.HINUP, .HINDN, 2)
                        .SMP.CRYINDB1 = GetWFSamp(.HINUP, .HINDN, 3)
                        .SMP.CRYINDB2 = GetWFSamp(.HINUP, .HINDN, 4)
                        .SMP.CRYINDB3 = GetWFSamp(.HINUP, .HINDN, 5)
                        .SMP.CRYINDL1 = GetWFSamp(.HINUP, .HINDN, 6)
                        .SMP.CRYINDL2 = GetWFSamp(.HINUP, .HINDN, 7)
                        .SMP.CRYINDL3 = GetWFSamp(.HINUP, .HINDN, 8)
                        .SMP.CRYINDL4 = GetWFSamp(.HINUP, .HINDN, 9)
                        .SMP.CRYINDDS = GetWFSamp(.HINUP, .HINDN, 10)
                        .SMP.CRYINDDZ = GetWFSamp(.HINUP, .HINDN, 11)
                        .SMP.CRYINDSP = GetWFSamp(.HINUP, .HINDN, 12)
                        .SMP.CRYINDD1 = GetWFSamp(.HINUP, .HINDN, 13)
                        .SMP.CRYINDD2 = GetWFSamp(.HINUP, .HINDN, 14)
                        .SMP.CRYINDD3 = GetWFSamp(.HINUP, .HINDN, 15)
                        .SMP.CRYOTHER1 = GetWFSamp(.HINUP, .HINDN, 16)
                        .SMP.CRYOTHER2 = GetWFSamp(.HINUP, .HINDN, 17)
                        .SMP.CRYINDAO = GetWFSamp(.HINUP, .HINDN, 18)    'écë∂é_ëfí«â¡
                        .SMP.CRYINDGD = GetWFSamp(.HINUP, .HINDN, 19)    'GDí«â¡

                        'GD◊≤›¡™Ø∏ã@î\í«â¡
                        If Trim(.SMP.CRYINDGD) = "3" Then
                            .SMP.CRYINDGD2 = GetWFSamp(.HINUP, .HINDN, 26)
                        Else
                            .SMP.CRYINDGD2 = ""
                        End If

                        '--- 2006/08/15 Add ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .SMP.EPIINDB1 = GetWFSamp(.HINUP, .HINDN, 20)
                        .SMP.EPIINDB2 = GetWFSamp(.HINUP, .HINDN, 21)
                        .SMP.EPIINDB3 = GetWFSamp(.HINUP, .HINDN, 22)
                        .SMP.EPIINDL1 = GetWFSamp(.HINUP, .HINDN, 23)
                        .SMP.EPIINDL2 = GetWFSamp(.HINUP, .HINDN, 24)
                        .SMP.EPIINDL3 = GetWFSamp(.HINUP, .HINDN, 25)
                    End With
                Next j

                'åüç∏çÄñ⁄ÇÃï™óﬁï\é¶
                '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                .GetText 37, i, vNukisiFlg

                If CheckGetSampleID(i) = True Then
                    intNukisiRow = intNukisiRow + 1
                    'ï\é¶êFàÍìxîíÇ…
                    '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                    For j = 11 To 35
                        .col = j
                        .row = i
                        .Lock = False
                        .backColor = vbWhite
                        .ForeColor = vbWhite
                        .Lock = True
                        .row = i + 1
                        .Lock = False
                        .backColor = vbWhite
                        .ForeColor = vbWhite
                        .Lock = True
                    Next j

                    'îΩâfêÑíËèàóùí«â¡ÇÃÇΩÇﬂèCê≥
                    If GetSampleID(intNukisiRow, sSampID1, sSampID2, CInt(vNukisiFlg)) = True Then
                    'ã§óLÉTÉìÉvÉãÇ™ë∂ç›ÇµÅAêÿÇËë÷Ç¶Ç™Ç≈Ç´ÇÈèÍçá
                        blKirikaeflg = True  '2003/05/26 okazaki

                        If Right(sSampID1, 1) = "U" Then
                            vViewSmpId = sSampID1
                            vViewSmpId2 = vbNullString
                        Else
                            vViewSmpId = sSampID2
                            vViewSmpId2 = vbNullString
                        End If

                        intZkbn = 0 'ZãÊï™Çèâä˙âª

                        'îΩâfêÑíËÉ`ÉFÉbÉNä÷êîåƒÇ—èoÇµ
                        'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP START
'''                        Call sub_Hanei(i, intNukisiRow, intZkbn)
                        Call sub_Hanei(i, intNukisiRow, intZkbn, sird1stBlockSet)           ' ﬂ◊“∞¿í«â¡ÅFåãèªì‡SIRDª›ÃﬂŸéwé¶ê›íËóLñ≥
                        'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP END

                         intSmpkbn = 0 'èâä˙âª
                        .row = i
                        .col = 11 'Rs
                        .backColor = vbWhite
                        .text = IIf(tblWafInd(intNukisiRow).SMP.CRYINDRS = "0" Or tblWafInd(intNukisiRow).SMP.CRYINDRS = "1", "", "1")
                            If .text = "1" Then
                                tblNukishi(i).WFSMPLIDRSCW = tblNukishi(i).REPSMPLIDCW
                            ElseIf .text = "" Then
                                tblNukishi(i).WFSMPLIDRSCW = ""
                            End If
                        .row = i + 1
                        .col = 11
                        .backColor = vbWhite

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If tblNukishi(i).WFSMPLIDRSCW = tblNukishi(i).REPSMPLIDCW Then
                            .text = IIf(tblWafInd(intNukisiRow).SMP.CRYINDRS = "0" Or tblWafInd(intNukisiRow).SMP.CRYINDRS = "2", "", "2")
                        Else
                            .text = IIf(tblWafInd(intNukisiRow).SMP.CRYINDRS = "0" Or tblWafInd(intNukisiRow).SMP.CRYINDRS = "2", "", "1")
                        End If

                        If .text = "2" Then
                            tblNukishi(i + 1).WFSMPLIDRSCW = tblNukishi(i).REPSMPLIDCW
                        ElseIf .text = "1" Then
                            tblNukishi(i + 1).WFSMPLIDRSCW = tblNukishi(i + 1).REPSMPLIDCW
                        ElseIf .text = "" Then
                            tblNukishi(i + 1).WFSMPLIDRSCW = ""
                        End If

                        .col = 12
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then                                                                'ã§í ä÷êîÇ≈îΩâfÇ™Ç≈Ç´Ç»Ç¢Ç∆Ç´
                            If tblWafInd(intNukisiRow).SMP.CRYINDOI = "3" Then                                'édólÇ™Ç†ÇÈÇ∆Ç´
                                If tblNukishi(i).WFINDOICW = "1" And tblNukishi(i + 1).WFINDOICW = "1" Then 'óºï˚Ç∆Ç‡é¿ë™
                                    tblNukishi(i + 1).WFINDOICW = "2"                                       'â∫ÇÃÉfÅ[É^ÇîΩâfÇ…Ç∑ÇÈ
                                    tblNukishi(i + 1).WFSMPLIDOICW = tblNukishi(i).WFSMPLIDOICW
                                    tblNukishi(i + 1).WFRESOICW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                             End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDOICW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDOICW = "1") Then
                            intSmpkbn = 1
                        End If
                        .col = 13
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDB1 = "3" Then
                                If tblNukishi(i).WFINDB1CW = "1" And tblNukishi(i + 1).WFINDB1CW = "1" Then
                                    tblNukishi(i + 1).WFINDB1CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDB1CW = tblNukishi(i).WFSMPLIDB1CW
                                    tblNukishi(i + 1).WFRESB1CW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDB1CW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDB1CW = "1") Then
                            intSmpkbn = 1
                        End If

                        .col = 14
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDB2 = "3" Then
                                If tblNukishi(i).WFINDB2CW = "1" And tblNukishi(i + 1).WFINDB2CW = "1" Then
                                    tblNukishi(i + 1).WFINDB2CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDB2CW = tblNukishi(i).WFSMPLIDB2CW
                                    tblNukishi(i + 1).WFRESB2CW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDB2CW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDB2CW = "1") Then
                            intSmpkbn = 1
                        End If

                        .col = 15
                        .row = i
                        .backColor = vbWhite

                         If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDB3 = "3" Then
                                If tblNukishi(i).WFINDB3CW = "1" And tblNukishi(i + 1).WFINDB3CW = "1" Then
                                    tblNukishi(i + 1).WFINDB3CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDB3CW = tblNukishi(i).WFSMPLIDB3CW
                                    tblNukishi(i + 1).WFRESB3CW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                         ElseIf (.text = "2" And tblNukishi(i + 1).WFINDB3CW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDB3CW = "1") Then
                            intSmpkbn = 1
                         End If

                        .col = 16
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDL1 = "3" Then
                                If tblNukishi(i).WFINDL1CW = "1" And tblNukishi(i + 1).WFINDL1CW = "1" Then
                                    tblNukishi(i + 1).WFINDL1CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDL1CW = tblNukishi(i).WFSMPLIDL1CW
                                    tblNukishi(i + 1).WFRESL1CW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDL1CW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDL1CW = "1") Then
                            intSmpkbn = 1
                        End If

                        .col = 17
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDL2 = "3" Then
                                If tblNukishi(i).WFINDL2CW = "1" And tblNukishi(i + 1).WFINDL2CW = "1" Then
                                    tblNukishi(i + 1).WFINDL2CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDL2CW = tblNukishi(i).WFSMPLIDL2CW
                                    tblNukishi(i + 1).WFRESL2CW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDL2CW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDL2CW = "1") Then
                            intSmpkbn = 1
                        End If

                        .col = 18
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDL3 = "3" Then
                                If tblNukishi(i).WFINDL3CW = "1" And tblNukishi(i + 1).WFINDL3CW = "1" Then
                                    tblNukishi(i + 1).WFINDL3CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDL3CW = tblNukishi(i).WFSMPLIDL3CW
                                    tblNukishi(i + 1).WFRESL3CW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDL3CW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDL3CW = "1") Then
                            intSmpkbn = 1
                        End If

                        .col = 19
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDL4 = "3" Then
                                If tblNukishi(i).WFINDL4CW = "1" And tblNukishi(i + 1).WFINDL4CW = "1" Then
                                    tblNukishi(i + 1).WFINDL4CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDL4CW = tblNukishi(i).WFSMPLIDL4CW
                                    tblNukishi(i + 1).WFRESL4CW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDL4CW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDL4CW = "1") Then
                            intSmpkbn = 1
                        End If

                        .col = 20
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDDS = "3" Then
                                If tblNukishi(i).WFINDDSCW = "1" And tblNukishi(i + 1).WFINDDSCW = "1" Then
                                    tblNukishi(i + 1).WFINDDSCW = "2"
                                    tblNukishi(i + 1).WFSMPLIDDSCW = tblNukishi(i).WFSMPLIDDSCW
                                    tblNukishi(i + 1).WFRESDSCW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDDSCW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDDSCW = "1") Then
                            intSmpkbn = 1
                        End If

                        .col = 21
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDDZ = "3" Then
                               If tblNukishi(i).WFINDDZCW = "1" And tblNukishi(i + 1).WFINDDZCW = "1" Then
                                    tblNukishi(i + 1).WFINDDZCW = "2"
                                    tblNukishi(i + 1).WFSMPLIDDZCW = tblNukishi(i).WFSMPLIDDZCW
                                    tblNukishi(i + 1).WFRESDZCW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                               End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDDZCW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDDZCW = "1") Then
                            intSmpkbn = 1
                        End If

                        .col = 22
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDSP = "3" Then
                                If tblNukishi(i).WFINDSPCW = "1" And tblNukishi(i + 1).WFINDSPCW = "1" Then
                                    tblNukishi(i + 1).WFINDSPCW = "2"
                                    tblNukishi(i + 1).WFSMPLIDSPCW = tblNukishi(i).WFSMPLIDSPCW
                                    tblNukishi(i + 1).WFRESSPCW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDSPCW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDSPCW = "1") Then
                            intSmpkbn = 1
                        End If

                        .col = 23
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDD1 = "3" Then
                                If tblNukishi(i).WFINDDO1CW = "1" And tblNukishi(i + 1).WFINDDO1CW = "1" Then
                                    tblNukishi(i + 1).WFINDDO1CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDDO1CW = tblNukishi(i).WFSMPLIDDO1CW
                                    tblNukishi(i + 1).WFRESDO1CW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDDO1CW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDDO1CW = "1") Then
                            intSmpkbn = 1
                        End If

                        .col = 24
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDD2 = "3" Then
                                If tblNukishi(i + 1).WFINDDO2CW = "1" And tblNukishi(i).WFINDDO2CW = "1" Then
                                    tblNukishi(i + 1).WFINDDO2CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDDO2CW = tblNukishi(i).WFSMPLIDDO2CW
                                    tblNukishi(i + 1).WFRESDO2CW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDDO2CW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDDO2CW = "1") Then
                            intSmpkbn = 1
                        End If

                        .col = 25
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDD3 = "3" Then
                                If tblNukishi(i).WFINDDO3CW = "1" And tblNukishi(i + 1).WFINDDO3CW = "1" Then
                                    tblNukishi(i + 1).WFINDDO3CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDDO3CW = tblNukishi(i).WFSMPLIDDO3CW
                                    tblNukishi(i + 1).WFRESDO3CW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDDO3CW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDDO3CW = "1") Then
                            intSmpkbn = 1
                        End If

                        ''écë∂é_ëfí«â¡
                        .col = 26
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDAO = "3" Then
                                If tblNukishi(i).WFINDAOICW = "1" And tblNukishi(i + 1).WFINDAOICW = "1" Then
                                    tblNukishi(i + 1).WFINDAOICW = "2"
                                    tblNukishi(i + 1).WFSMPLIDAOICW = tblNukishi(i).WFSMPLIDAOICW
                                    tblNukishi(i + 1).WFRESAOICW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDAOICW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDAOICW = "1") Then
                            intSmpkbn = 1
                        End If

                        .col = 27
                        .row = i
                        .backColor = vbWhite
                        .text = IIf(tblWafInd(intNukisiRow).SMP.CRYOTHER1 = "0", "", "1")

                        If .text = "1" Then
                            tblNukishi(i).WFSMPLIDOT1CW = tblNukishi(i).REPSMPLIDCW
                        ElseIf .text = "" Then
                            tblNukishi(i).WFSMPLIDOT1CW = ""
                        End If

                        .col = 27
                        .row = i + 1
                        .backColor = vbWhite
                        .text = IIf(tblWafInd(intNukisiRow).SMP.CRYOTHER1 = "0", "", "1")

                        If .text = "1" Then
                            tblNukishi(i + 1).WFSMPLIDOT1CW = tblNukishi(i + 1).REPSMPLIDCW
                        ElseIf .text = "" Then
                            tblNukishi(i).WFSMPLIDOT1CW = ""
                        End If

                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .col = 35
                        .row = i
                        .backColor = vbWhite
                        .text = IIf(tblWafInd(intNukisiRow).SMP.CRYOTHER2 = "0", "", "1")

                        If .text = "1" Then
                            tblNukishi(i).WFSMPLIDOT2CW = tblNukishi(i).REPSMPLIDCW
                        ElseIf .text = "" Then
                            tblNukishi(i).WFSMPLIDOT2CW = ""
                        End If

                        .col = 35
                        .row = i + 1
                        .backColor = vbWhite
                        .text = IIf(tblWafInd(intNukisiRow).SMP.CRYOTHER2 = "0", "", "1")

                        If .text = "1" Then
                            tblNukishi(i + 1).WFSMPLIDOT2CW = tblNukishi(i + 1).REPSMPLIDCW
                        ElseIf .text = "" Then
                            tblNukishi(i).WFSMPLIDOT2CW = ""
                        End If

                        ''GDí«â¡
                        .col = 28
                        .row = i
                        .backColor = vbWhite

                        If .text <> "2" Then
                            If tblWafInd(intNukisiRow).SMP.CRYINDGD = "3" Then
                                If tblNukishi(i).WFINDGDCW = "1" And tblNukishi(i + 1).WFINDGDCW = "1" Then
                                    tblNukishi(i + 1).WFINDGDCW = "2"
                                    tblNukishi(i + 1).WFSMPLIDGDCW = tblNukishi(i).WFSMPLIDGDCW
                                    tblNukishi(i + 1).WFRESGDCW = "0"
                                    tblNukishi(i + 1).WFHSGDCW = "0"
                                    .row = i + 1
                                    .text = "2"
                                Else
                                    intSmpkbn = 1
                                End If
                            End If
                        ElseIf (.text = "2" And tblNukishi(i + 1).WFINDGDCW = "2") Or (.text = "2" And tblNukishi(i + 1).WFINDGDCW = "1") Then
                            intSmpkbn = 1
                        End If

                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        ' VBè„ÇÃêßñÒ(ÉvÉçÉVÅ[ÉWÉÉóeó 64kêßå¿)ÇÃÇΩÇﬂ§ÉGÉsï™ÇÕï ä÷êîÇ≈èàóùÇ∑ÇÈ
                        Call sub_DispSumple_Hanei_Ep_1(i, intNukisiRow, intSmpkbn)

                        ''î‰íÔçRÇ≈ïKÇ∏é¿ê—ÇóßÇƒÇÈèàóùÇí«â¡
                        .col = 11
                        .row = i
                        Dim intCntrs As Integer
                        If .text = "2" Then
                            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                            For intCntrs = 12 To 35
                                If intCntrs <> 27 And intCntrs <> 35 Then
                                    .col = intCntrs
                                    If .text = "1" Then
                                        .col = 11
                                        .text = "1"
                                        tblNukishi(i).WFSMPLIDRSCW = tblNukishi(i).REPSMPLIDCW
                                    End If
                                End If
                            Next intCntrs
                        End If
                        .col = 11
                        .row = i + 1
                        If .text = "2" Then
                            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                            For intCntrs = 12 To 35
                                If intCntrs <> 27 And intCntrs <> 35 Then
                                    .col = intCntrs
                                    If .text = "1" Then
                                        .col = 11
                                        .text = "1"
                                        tblNukishi(i + 1).WFSMPLIDRSCW = tblNukishi(i + 1).REPSMPLIDCW
                                    End If
                                End If
                            Next intCntrs
                        End If
                        .row = i

                        'é¿ÉfÅ[É^É`ÉFÉbÉNèàóù é¿ÉfÅ[É^èàóùÇ∆êFÇìhÇÈèàóùÇÕ2çsÇ‹Ç∆ÇﬂÇƒçsÇ§
                          Call sub_Jitu(i + 1, blKirikaeflg, blnhflg, intZkbn)

                        'é¿ÉfÅ[É^É`ÉFÉbÉNèàóù
                        'êFÇìhÇÈ
                        Call sub_Paint(i + 1)
                   Else
                        'êÿÇËë÷Ç¶Ç»ÇµÇÃèÍçá
                        If Right(sSampID1, 1) = "U" Then
                            vViewSmpId = sSampID1
                            vViewSmpId2 = sSampID2
                        Else
                            vViewSmpId = sSampID2
                            vViewSmpId2 = sSampID1
                        End If

                        intZkbn = 0
                        'è„ïiî‘Ç‹ÇΩÇÕâ∫ïiî‘Ç™ZÇæÇ¡ÇΩèÍçáÇÃèàóùÇÇ∑ÇÈ
                        'è„ïiî‘Ç™Z
                          If Trim(tblWafInd(intNukisiRow).HINUP.hinban) = "Z" Then
                            intZkbn = 1
                                If tblWafInd(intNukisiRow).HINDN.hinban = tblSXL.hinban Then  'êUë÷Ç¶ÇÁÇÍÇƒÇ¢Ç»Ç¢Ç∆Ç´Ç∆êUë÷Ç¶ÇΩïiî‘Çå≥Ç…ñﬂÇ∑Ç∆Ç´
                                    intZkbn = 3
                                End If

                                udtFHin.factory = tblSXL.factory
                                udtFHin.hinban = tblSXL.hinban
                                udtFHin.mnorevno = tblSXL.REVNUM
                                udtFHin.opecond = tblSXL.opecond
                            With tblWafInd(intNukisiRow)
                            ''''''''''''''''''''''''''êUë÷ëOÇÃïiî‘-------------------,êUë÷å„ÇÃïiî‘
                            .SMP.CRYINDRS = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 1)
                            .SMP.CRYINDOI = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 2)
                            .SMP.CRYINDB1 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 3)
                            .SMP.CRYINDB2 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 4)
                            .SMP.CRYINDB3 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 5)
                            .SMP.CRYINDL1 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 6)
                            .SMP.CRYINDL2 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 7)
                            .SMP.CRYINDL3 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 8)
                            .SMP.CRYINDL4 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 9)
                            .SMP.CRYINDDS = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 10)
                            .SMP.CRYINDDZ = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 11)
                            .SMP.CRYINDSP = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 12)
                            .SMP.CRYINDD1 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 13)
                            .SMP.CRYINDD2 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 14)
                            .SMP.CRYINDD3 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 15)
                            .SMP.CRYOTHER1 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 16)  '03/05/26 å„ì°
                            .SMP.CRYOTHER2 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 17)   '03/05/28 å„ì°
                            .SMP.CRYINDAO = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 18)    'écë∂é_ëfí«â¡Å@03/12/15 ooba
                            .SMP.CRYINDGD = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 19)    'GDí«â¡Å@05/02/18 ooba

                            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                            .SMP.EPIINDB1 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 20)
                            .SMP.EPIINDB2 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 21)
                            .SMP.EPIINDB3 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 22)
                            .SMP.EPIINDL1 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 23)
                            .SMP.EPIINDL2 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 24)
                            .SMP.EPIINDL3 = GetWFSamp(udtFHin, tblWafInd(intNukisiRow).HINDN, 25)
                            End With
                        'â∫ïiî‘Ç™Z
                        ElseIf Trim(tblWafInd(intNukisiRow).HINDN.hinban) = "Z" Then
                            intZkbn = 2
                                If tblWafInd(intNukisiRow).HINUP.hinban = tblSXL.hinban Then 'êUë÷Ç¶ÇÁÇÍÇƒÇ¢Ç»Ç¢Ç∆Ç´Ç∆êUë÷Ç¶ÇΩïiî‘Çå≥Ç…ñﬂÇ∑Ç∆Ç´
                                    intZkbn = 4
                                End If
                                udtFHin.factory = tblSXL.factory
                                udtFHin.hinban = tblSXL.hinban
                                udtFHin.mnorevno = tblSXL.REVNUM
                                udtFHin.opecond = tblSXL.opecond
                            With tblWafInd(intNukisiRow)

                            ''''''''''''''''''''''''''êUë÷å„ÇÃïiî‘---------------,êUë÷ëOÇÃïiî‘
                            .SMP.CRYINDRS = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 1)
                            .SMP.CRYINDOI = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 2)
                            .SMP.CRYINDB1 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 3)
                            .SMP.CRYINDB2 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 4)
                            .SMP.CRYINDB3 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 5)
                            .SMP.CRYINDL1 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 6)
                            .SMP.CRYINDL2 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 7)
                            .SMP.CRYINDL3 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 8)
                            .SMP.CRYINDL4 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 9)
                            .SMP.CRYINDDS = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 10)
                            .SMP.CRYINDDZ = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 11)
                            .SMP.CRYINDSP = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 12)
                            .SMP.CRYINDD1 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 13)
                            .SMP.CRYINDD2 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 14)
                            .SMP.CRYINDD3 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 15)
                            .SMP.CRYOTHER1 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 16)  '03/05/26 å„ì°
                            .SMP.CRYOTHER2 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 17)   '03/05/28 å„ì°
                            .SMP.CRYINDAO = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 18)    'écë∂é_ëfí«â¡Å@03/12/15 ooba
                            .SMP.CRYINDGD = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 19)    'GDí«â¡Å@05/02/18 ooba

                            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                            .SMP.EPIINDB1 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 20)
                            .SMP.EPIINDB2 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 21)
                            .SMP.EPIINDB3 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 22)
                            .SMP.EPIINDL1 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 23)
                            .SMP.EPIINDL2 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 24)
                            .SMP.EPIINDL3 = GetWFSamp(tblWafInd(intNukisiRow).HINUP, udtFHin, 25)
                            End With
                        End If

                        'é¿ë™¡™Ø∏ÇÃÇΩÇﬂÇ…ã§óL(ï )ÇÃî≤ééçsÇæØƒÇ∑ÇÈ
                        If intZkbn = 0 Then
                            iBetuRow(intBcnt) = i + 1
                            intBcnt = intBcnt + 1
                        End If

                        'îΩâfêÑíËÉ`ÉFÉbÉNä÷êîåƒÇ—èoÇµ
                        'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP START
'''                        Call sub_Hanei(i, intNukisiRow, intZkbn)
                        Call sub_Hanei(i, intNukisiRow, intZkbn, sird1stBlockSet)           ' ﬂ◊“∞¿í«â¡ÅFåãèªì‡SIRDª›ÃﬂŸéwé¶ê›íËóLñ≥
                        'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP END

                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        Dim skensa1(24) As String
                        Dim skensa2(24) As String
                         Call sub_Betu(i, intNukisiRow, skensa1(), skensa2(), intZkbn, blnhflg)

                        'ZÇÃÇ∆Ç´
                          '2
                          '1
                          '1
                          '2
                        'ã§óLÇÃîªíË
                        .row = i
                        .col = 11
                        .backColor = vbWhite

                        'ïœçX---
                        'RsÇÕó◊ÇÃÉfÅ[É^ÇÃîΩâf
                        .text = skensa1(0)
                        If intZkbn = 4 Or intZkbn = 2 Then
                            If skensa2(0) = "2" Or skensa2(0) = "1" Then  'ã§óLâ¬
                                .text = "1" 'é¿ë™ÇéÊÇÈ
                                tblNukishi(i).WFINDRSCW = "1"
                                tblNukishi(i).WFSMPLIDRSCW = tblNukishi(i).REPSMPLIDCW
                                tblNukishi(i).WFRESRS1CW = "0" 'é¿ê—ñ≥
                                'ÉRÉsÅ[
                                tblNukishi(i + 1).WFINDRSCW = "2"  'é¿ë™ÇóßÇƒÇ»Ç¢
                                tblNukishi(i + 1).WFSMPLIDRSCW = tblNukishi(i).WFSMPLIDRSCW
                                tblNukishi(i + 1).WFRESRS1CW = tblNukishi(i).WFRESRS1CW  'é¿ê—ÉtÉâÉOÇ™óßÇ¡ÇƒÇ»Ç¢ÇΩÇﬂ0
                                .row = i + 1
                                .text = "2"
                                .row = i
                            ElseIf skensa2(0) = "0" Then
                                If skensa1(0) = "0" Then
                                    .text = ""
                                    tblNukishi(i).WFINDRSCW = "0"
                                    tblNukishi(i).WFSMPLIDRSCW = ""
                                    tblNukishi(i).WFRESRS1CW = "0"
                                Else
                                    .text = "1"
                                    tblNukishi(i).WFINDRSCW = "1"
                                    tblNukishi(i).WFSMPLIDRSCW = tblNukishi(i).REPSMPLIDCW
                                    tblNukishi(i).WFRESRS1CW = "0"
                                End If
                                tblNukishi(i + 1).WFINDRSCW = "0"
                                tblNukishi(i + 1).WFSMPLIDRSCW = ""
                                tblNukishi(i + 1).WFRESRS1CW = "0"
                                .row = i + 1
                                .text = ""
                                .row = i
                            End If
                        ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                            .text = skensa1(0)
                            If .text = "1" Then
                                tblNukishi(i).WFINDRSCW = "1"
                                tblNukishi(i).WFSMPLIDRSCW = tblNukishi(i).REPSMPLIDCW
                            ElseIf .text = "2" Then
                                tblNukishi(i).WFINDRSCW = "2"
                                tblNukishi(i).WFSMPLIDRSCW = tblNukishi(i + 1).REPSMPLIDCW
                                tblNukishi(i).WFRESRS1CW = "0" 'é¿ê—ñ≥
                            End If
                        End If

                        .col = 12
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then 'ã§í ä÷êîÇ≈îΩâfïsâ¬
                            If intZkbn = 4 Or intZkbn = 2 Then '
                                If tblNukishi(i + 1).WFINDOICW = "1" Then '2Ç™ì¸Ç¡ÇƒÇ¢ÇÈ
                                    tblNukishi(i).WFINDOICW = "2"
                                    tblNukishi(i).WFSMPLIDOICW = ""
                                    tblNukishi(i).WFRESOICW = "1" 'é¿ê—óßÇƒÇÈ
                                Else
                                    'ã§í ä÷êîÇ≈îªíËÇµÇƒÇ¢ÇÈåãâ Ç
                                    'ÉRÉsÅ[
                                    tblNukishi(i + 1).WFSMPLIDOICW = tblNukishi(i).WFSMPLIDOICW
                                    tblNukishi(i + 1).WFRESOICW = tblNukishi(i).WFRESOICW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                                If tblWafInd(intNukisiRow).SMP.CRYINDOI = "3" Then                                 'édólÇ™Ç†Ç¡Çƒ
                                    If tblNukishi(i).WFINDOICW = "1" And tblNukishi(i + 1).WFINDOICW = "1" Then  'óºï˚é¿ë™ÇÃèÍçá
                                          If skensa1(1) = "2" Then                                             'édólÇÃåµÇµÇ≠Ç»Ç¢ÇŸÇ§Ç™îΩâf
                                            tblNukishi(i).WFINDOICW = "2"
                                            tblNukishi(i).WFSMPLIDOICW = tblNukishi(i + 1).WFSMPLIDOICW
                                            tblNukishi(i).WFRESOICW = "0"
                                            .text = skensa1(1)
                                          End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then  'ã§í ä÷êîÇ≈îΩâfâ¬ÇÃÇ∆Ç´ÇÃÉTÉìÉvÉãIDÇÉRÉsÅ[
                            tblNukishi(i + 1).WFSMPLIDOICW = tblNukishi(i).WFSMPLIDOICW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(1) = "0" Then
                            tblNukishi(i + 1).WFINDOICW = "0"
                            tblNukishi(i + 1).WFSMPLIDOICW = ""
                            tblNukishi(i + 1).WFRESOICW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        .col = 13
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDB1CW = "1" Then
                                    tblNukishi(i).WFINDB1CW = "2"
                                    tblNukishi(i).WFSMPLIDB1CW = ""
                                    tblNukishi(i).WFRESB1CW = "1"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDB1CW = tblNukishi(i).WFSMPLIDB1CW
                                    tblNukishi(i + 1).WFRESB1CW = tblNukishi(i).WFRESB1CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                                If tblWafInd(intNukisiRow).SMP.CRYINDB1 = "3" Then
                                    If tblNukishi(i).WFINDB1CW = "1" And tblNukishi(i + 1).WFINDB1CW = "1" Then
                                        If skensa1(2) = "2" Then
                                            tblNukishi(i).WFINDB1CW = "2"
                                            tblNukishi(i).WFSMPLIDB1CW = tblNukishi(i + 1).WFSMPLIDB1CW
                                            tblNukishi(i).WFRESB1CW = "0"
                                            .text = skensa1(2)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDB1CW = tblNukishi(i).WFSMPLIDB1CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(2) = "0" Then
                            tblNukishi(i + 1).WFINDB1CW = "0"
                            tblNukishi(i + 1).WFSMPLIDB1CW = ""
                            tblNukishi(i + 1).WFRESB1CW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                         .col = 14
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDB2CW = "1" Then
                                    tblNukishi(i).WFINDB2CW = "2"
                                    tblNukishi(i).WFSMPLIDB2CW = ""
                                    tblNukishi(i).WFRESB2CW = "1"
                                Else
                                    'ÉRÉsÅ[
                                    tblNukishi(i + 1).WFSMPLIDB2CW = tblNukishi(i).WFSMPLIDB2CW
                                    tblNukishi(i + 1).WFRESB2CW = tblNukishi(i).WFRESB2CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                                If tblWafInd(intNukisiRow).SMP.CRYINDB2 = "3" Then
                                    If tblNukishi(i).WFINDB2CW = "1" And tblNukishi(i + 1).WFINDB2CW = "1" Then
                                        If skensa1(3) = "2" Then
                                            tblNukishi(i).WFINDB2CW = "2"
                                            tblNukishi(i).WFSMPLIDB2CW = tblNukishi(i + 1).WFSMPLIDB2CW
                                            tblNukishi(i).WFRESB2CW = "0"
                                            .text = skensa1(3)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDB2CW = tblNukishi(i).WFSMPLIDB2CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(3) = "0" Then
                            tblNukishi(i + 1).WFINDB2CW = "0"
                            tblNukishi(i + 1).WFSMPLIDB2CW = ""
                            tblNukishi(i + 1).WFRESB2CW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        .col = 15
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDB3CW = "1" Then
                                    tblNukishi(i).WFINDB3CW = "2"
                                    tblNukishi(i).WFSMPLIDB3CW = ""
                                    tblNukishi(i).WFRESB3CW = "1"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDB3CW = tblNukishi(i).WFSMPLIDB3CW
                                    tblNukishi(i + 1).WFRESB3CW = tblNukishi(i).WFRESB3CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                                If tblWafInd(intNukisiRow).SMP.CRYINDB3 = "3" Then
                                    If tblNukishi(i).WFINDB3CW = "1" And tblNukishi(i + 1).WFINDB3CW = "1" Then
                                        If skensa1(4) = "2" Then
                                            tblNukishi(i).WFINDB3CW = "2"
                                            tblNukishi(i).WFSMPLIDB3CW = tblNukishi(i + 1).WFSMPLIDB3CW
                                            tblNukishi(i).WFRESB3CW = "0"
                                            .text = skensa1(4)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDB3CW = tblNukishi(i).WFSMPLIDB3CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(4) = "0" Then
                            tblNukishi(i + 1).WFINDB3CW = "0"
                            tblNukishi(i + 1).WFSMPLIDB3CW = ""
                            tblNukishi(i + 1).WFRESB3CW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        .col = 16
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDL1CW = "1" Then
                                    tblNukishi(i).WFINDL1CW = "2"
                                    tblNukishi(i).WFSMPLIDL1CW = ""
                                    tblNukishi(i).WFRESL1CW = "1"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDL1CW = tblNukishi(i).WFSMPLIDL1CW
                                    tblNukishi(i + 1).WFRESL1CW = tblNukishi(i).WFRESL1CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                                If tblWafInd(intNukisiRow).SMP.CRYINDL1 = "3" Then
                                    If tblNukishi(i).WFINDL1CW = "1" And tblNukishi(i + 1).WFINDL1CW = "1" Then
                                        If skensa1(5) = "2" Then
                                            tblNukishi(i).WFINDL1CW = "2"
                                            tblNukishi(i).WFSMPLIDL1CW = tblNukishi(i + 1).WFSMPLIDL1CW
                                            tblNukishi(i).WFRESL1CW = "0"
                                            .text = skensa1(5)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDL1CW = tblNukishi(i).WFSMPLIDL1CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(5) = "0" Then
                            tblNukishi(i + 1).WFINDL1CW = "0"
                            tblNukishi(i + 1).WFSMPLIDL1CW = ""
                            tblNukishi(i + 1).WFRESL1CW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        .col = 17
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDL2CW = "1" Then
                                    tblNukishi(i).WFINDL2CW = "2"
                                    tblNukishi(i).WFSMPLIDL2CW = ""
                                    tblNukishi(i).WFRESL2CW = "1"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDL2CW = tblNukishi(i).WFSMPLIDL2CW
                                    tblNukishi(i + 1).WFRESL2CW = tblNukishi(i).WFRESL2CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                                If tblWafInd(intNukisiRow).SMP.CRYINDL2 = "3" Then
                                    If tblNukishi(i).WFINDL2CW = "1" And tblNukishi(i + 1).WFINDL2CW = "1" Then
                                        If skensa1(6) = "2" Then
                                            tblNukishi(i).WFINDL2CW = "2"
                                            tblNukishi(i).WFSMPLIDL2CW = tblNukishi(i + 1).WFSMPLIDL2CW
                                            tblNukishi(i).WFRESL2CW = "0"
                                            .text = skensa1(6)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDL2CW = tblNukishi(i).WFSMPLIDL2CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(6) = "0" Then
                            tblNukishi(i + 1).WFINDL2CW = "0"
                            tblNukishi(i + 1).WFSMPLIDL2CW = ""
                            tblNukishi(i + 1).WFRESL2CW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        .col = 18
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDL3CW = "1" Then
                                    tblNukishi(i).WFINDL3CW = "2"
                                    tblNukishi(i).WFSMPLIDL3CW = ""
                                    tblNukishi(i).WFRESL3CW = "1"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDL3CW = tblNukishi(i).WFSMPLIDL3CW
                                    tblNukishi(i + 1).WFRESL3CW = tblNukishi(i).WFRESL3CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                                If tblWafInd(intNukisiRow).SMP.CRYINDL3 = "3" Then
                                    If tblNukishi(i).WFINDL3CW = "1" And tblNukishi(i + 1).WFINDL3CW = "1" Then
                                        If skensa1(7) = "2" Then
                                            tblNukishi(i).WFINDL3CW = "2"
                                            tblNukishi(i).WFSMPLIDL3CW = tblNukishi(i + 1).WFSMPLIDL3CW
                                            tblNukishi(i).WFRESL3CW = "0"
                                            .text = skensa1(7)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDL3CW = tblNukishi(i).WFSMPLIDL3CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(7) = "0" Then
                            tblNukishi(i + 1).WFINDL3CW = "0"
                            tblNukishi(i + 1).WFSMPLIDL3CW = ""
                            tblNukishi(i + 1).WFRESL3CW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        .col = 19
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDL4CW = "1" Then
                                    tblNukishi(i).WFINDL4CW = "2"
                                    tblNukishi(i).WFSMPLIDL4CW = ""
                                    tblNukishi(i).WFRESL4CW = "1"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDL4CW = tblNukishi(i).WFSMPLIDL4CW
                                    tblNukishi(i + 1).WFRESL4CW = tblNukishi(i).WFRESL4CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                                If tblWafInd(intNukisiRow).SMP.CRYINDL4 = "3" Then
                                    If tblNukishi(i).WFINDL4CW = "1" And tblNukishi(i + 1).WFINDL4CW = "1" Then
                                        If skensa1(8) = "2" Then
                                            tblNukishi(i).WFINDL4CW = "2"
                                            tblNukishi(i).WFSMPLIDL4CW = tblNukishi(i + 1).WFSMPLIDL4CW
                                            tblNukishi(i).WFRESL4CW = "0"
                                            .text = skensa1(8)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDL4CW = tblNukishi(i).WFSMPLIDL4CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(8) = "0" Then
                            tblNukishi(i + 1).WFINDL4CW = "0"
                            tblNukishi(i + 1).WFSMPLIDL4CW = ""
                            tblNukishi(i + 1).WFRESL4CW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        .col = 20
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDDSCW = "1" Then
                                    tblNukishi(i).WFINDDSCW = "2"
                                    tblNukishi(i).WFSMPLIDDSCW = ""
                                    tblNukishi(i).WFRESDSCW = "1"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDDSCW = tblNukishi(i).WFSMPLIDDSCW
                                    tblNukishi(i + 1).WFRESDSCW = tblNukishi(i).WFRESDSCW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                                If tblWafInd(intNukisiRow).SMP.CRYINDDS = "3" Then
                                    If tblNukishi(i).WFINDDSCW = "1" And tblNukishi(i + 1).WFINDDSCW = "1" Then
                                        If skensa1(9) = "2" Then
                                            tblNukishi(i).WFINDDSCW = "2"
                                            tblNukishi(i).WFSMPLIDDSCW = tblNukishi(i + 1).WFSMPLIDDSCW
                                            tblNukishi(i).WFRESDSCW = "0"
                                            .text = skensa1(9)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDDSCW = tblNukishi(i).WFSMPLIDDSCW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(9) = "0" Then
                            tblNukishi(i + 1).WFINDDSCW = "0"
                            tblNukishi(i + 1).WFSMPLIDDSCW = ""
                            tblNukishi(i + 1).WFRESDSCW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        .col = 21
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDDZCW = "1" Then
                                    tblNukishi(i).WFINDDZCW = "2"
                                    tblNukishi(i).WFSMPLIDDZCW = tblNukishi(i + 1).WFSMPLIDDZCW
                                    tblNukishi(i).WFRESDZCW = "1"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDDZCW = tblNukishi(i).WFSMPLIDDZCW
                                    tblNukishi(i + 1).WFRESDZCW = tblNukishi(i).WFRESDZCW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                                If tblWafInd(intNukisiRow).SMP.CRYINDDZ = "3" Then
                                    If tblNukishi(i).WFINDDZCW = "1" And tblNukishi(i + 1).WFINDDZCW = "1" Then
                                        If skensa1(10) = "2" Then
                                            tblNukishi(i).WFINDDZCW = "2"
                                            tblNukishi(i).WFSMPLIDDZCW = tblNukishi(i + 1).WFSMPLIDDZCW
                                            tblNukishi(i).WFRESDZCW = "0"
                                            .text = skensa1(10)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDDZCW = tblNukishi(i).WFSMPLIDDZCW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(10) = "0" Then
                            tblNukishi(i + 1).WFINDDZCW = "0"
                            tblNukishi(i + 1).WFSMPLIDDZCW = ""
                            tblNukishi(i + 1).WFRESDZCW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        .col = 22
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDSPCW = "1" Then
                                    tblNukishi(i).WFINDSPCW = "2"
                                    tblNukishi(i).WFSMPLIDSPCW = ""
                                    tblNukishi(i).WFRESSPCW = "1"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDSPCW = tblNukishi(i).WFSMPLIDSPCW
                                    tblNukishi(i + 1).WFRESSPCW = tblNukishi(i).WFRESSPCW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                                If tblWafInd(intNukisiRow).SMP.CRYINDSP = "3" Then
                                    If tblNukishi(i).WFINDSPCW = "1" And tblNukishi(i + 1).WFINDSPCW = "1" Then
                                        If skensa1(11) = "2" Then
                                            tblNukishi(i).WFINDSPCW = "2"
                                            tblNukishi(i).WFSMPLIDSPCW = tblNukishi(i + 1).WFSMPLIDSPCW
                                            tblNukishi(i).WFRESSPCW = "0"
                                            .text = skensa1(11)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDSPCW = tblNukishi(i).WFSMPLIDSPCW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(11) = "0" Then
                            tblNukishi(i + 1).WFINDSPCW = "0"
                            tblNukishi(i + 1).WFSMPLIDSPCW = ""
                            tblNukishi(i + 1).WFRESSPCW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        .col = 23
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDDO1CW = "1" Then
                                    tblNukishi(i).WFINDDO1CW = "2"
                                    tblNukishi(i).WFSMPLIDDO1CW = ""
                                    tblNukishi(i).WFRESDO1CW = "1"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDDO1CW = tblNukishi(i).WFSMPLIDDO1CW
                                    tblNukishi(i + 1).WFRESDO1CW = tblNukishi(i).WFRESDO1CW
                                End If
                            ElseIf intZkbn = 0 Then
                                If tblWafInd(intNukisiRow).SMP.CRYINDD1 = "3" Then
                                    If tblNukishi(i).WFINDOT1CW = "1" And tblNukishi(i + 1).WFINDOT1CW = "1" Then
                                        If skensa1(12) = "2" Then
                                            tblNukishi(i).WFINDDO1CW = "2"
                                            tblNukishi(i).WFSMPLIDDO1CW = tblNukishi(i + 1).WFSMPLIDDO1CW
                                            tblNukishi(i).WFRESDO1CW = "0"
                                            .text = skensa1(12)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDDO1CW = tblNukishi(i).WFSMPLIDDO1CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(12) = "0" Then
                            tblNukishi(i + 1).WFINDDO1CW = "0"
                            tblNukishi(i + 1).WFSMPLIDDO1CW = ""
                            tblNukishi(i + 1).WFRESDO1CW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        .col = 24
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDDO2CW = "1" Then
                                    tblNukishi(i).WFINDDO2CW = "2"
                                    tblNukishi(i).WFSMPLIDDO2CW = ""
                                    tblNukishi(i).WFRESDO2CW = "1"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDDO2CW = tblNukishi(i).WFSMPLIDDO2CW
                                    tblNukishi(i + 1).WFRESDO2CW = tblNukishi(i).WFRESDO2CW
                                End If
                            ElseIf intZkbn = 0 Then
                                If tblWafInd(intNukisiRow).SMP.CRYINDD2 = "3" Then
                                    If tblNukishi(i).WFINDDO2CW = "1" And tblNukishi(i + 1).WFINDDO2CW = "1" Then
                                        If skensa1(13) = "2" Then
                                            tblNukishi(i).WFINDDO2CW = "2"
                                            tblNukishi(i).WFSMPLIDDO2CW = tblNukishi(i + 1).WFSMPLIDDO2CW
                                            tblNukishi(i).WFRESDO2CW = "0"
                                            .text = skensa1(13)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDDO2CW = tblNukishi(i).WFSMPLIDDO2CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(13) = "0" Then
                            tblNukishi(i + 1).WFINDDO2CW = "0"
                            tblNukishi(i + 1).WFSMPLIDDO2CW = ""
                            tblNukishi(i + 1).WFRESDO2CW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        .col = 25
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDDO3CW = "1" Then
                                    tblNukishi(i).WFINDDO3CW = "2"
                                    tblNukishi(i).WFSMPLIDDO3CW = ""
                                    tblNukishi(i).WFRESDO3CW = "1"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDDO3CW = tblNukishi(i).WFSMPLIDDO3CW
                                    tblNukishi(i + 1).WFRESDO3CW = tblNukishi(i).WFRESDO3CW
                                End If
                            ElseIf intZkbn = 0 Then
                                If tblWafInd(intNukisiRow).SMP.CRYINDD3 = "3" Then
                                    If tblNukishi(i).WFINDDO3CW = "1" And tblNukishi(i + 1).WFINDDO3CW = "1" Then
                                        If skensa1(14) = "2" Then
                                            tblNukishi(i).WFINDDO3CW = "2"
                                            tblNukishi(i).WFSMPLIDDO3CW = tblNukishi(i + 1).WFSMPLIDDO3CW
                                            tblNukishi(i).WFRESDO3CW = "0"
                                            .text = skensa1(14)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDDO3CW = tblNukishi(i).WFSMPLIDDO3CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(14) = "0" Then
                            tblNukishi(i + 1).WFINDDO3CW = "0"
                            tblNukishi(i + 1).WFSMPLIDDO3CW = ""
                            tblNukishi(i + 1).WFRESDO3CW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        ''écë∂é_ëfí«â¡
                        .col = 26
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDAOICW = "1" Then
                                    tblNukishi(i).WFINDAOICW = "2"
                                    tblNukishi(i).WFSMPLIDAOICW = ""
                                    tblNukishi(i).WFRESAOICW = "1"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDAOICW = tblNukishi(i).WFSMPLIDAOICW
                                    tblNukishi(i + 1).WFRESAOICW = tblNukishi(i).WFRESAOICW
                                End If
                            ElseIf intZkbn = 0 Then
                                If tblWafInd(intNukisiRow).SMP.CRYINDAO = "3" Then
                                    If tblNukishi(i).WFINDAOICW = "1" And tblNukishi(i + 1).WFINDAOICW = "1" Then
                                        If skensa1(15) = "2" Then
                                            tblNukishi(i).WFINDAOICW = "2"
                                            tblNukishi(i).WFSMPLIDAOICW = tblNukishi(i + 1).WFSMPLIDAOICW
                                            tblNukishi(i).WFRESAOICW = "0"
                                            .text = skensa1(15)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDAOICW = tblNukishi(i).WFSMPLIDAOICW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(15) = "0" Then
                            tblNukishi(i + 1).WFINDAOICW = "0"
                            tblNukishi(i + 1).WFSMPLIDAOICW = ""
                            tblNukishi(i + 1).WFRESAOICW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        .col = 27 'OT1(çïÇ©îí)
                        .backColor = vbWhite

                        'ïœçXå„
                        If intZkbn = 4 Or intZkbn = 2 Then
                            .text = skensa1(16)
                            If skensa1(16) = "1" Then 'édólóLÇË
                                tblNukishi(i).WFINDOT1CW = "1"
                                tblNukishi(i).WFSMPLIDOT1CW = tblNukishi(i).REPSMPLIDCW
                                'ÉRÉsÅ[
                                tblNukishi(i + 1).WFINDOT1CW = "0"  'OTÇÕîΩâfÇÕÇ»Ç¢
                                tblNukishi(i + 1).WFSMPLIDOT1CW = ""
                                tblNukishi(i + 1).WFRESOT1CW = ""
                            ElseIf .text = "" Or .text = "0" Then
                                tblNukishi(i).WFINDOT1CW = ""
                                tblNukishi(i).WFSMPLIDOT1CW = ""
                                tblNukishi(i + 1).WFINDOT1CW = ""
                                tblNukishi(i + 1).WFSMPLIDOT1CW = ""
                                .text = ""
                            End If
                        ElseIf intZkbn = 0 Then
                            .text = skensa1(16)
                                If .text = "1" Then
                                    tblNukishi(i).WFINDOT1CW = "1"
                                    tblNukishi(i).WFSMPLIDOT1CW = tblNukishi(i).REPSMPLIDCW
                                ElseIf .text = "" Then
                                    tblNukishi(i).WFINDOT1CW = ""
                                    tblNukishi(i).WFSMPLIDOT1CW = ""
                                End If
                        End If

                        'ïœçXå„
                        .col = 35
                        .backColor = vbWhite
                        If intZkbn = 4 Or intZkbn = 2 Then
                            .text = skensa1(17)
                            If skensa1(17) = "1" Then 'édólóLÇË
                                tblNukishi(i).WFINDOT2CW = "1"
                                tblNukishi(i).WFSMPLIDOT2CW = tblNukishi(i).REPSMPLIDCW

                                'ÉRÉsÅ[
                                tblNukishi(i + 1).WFINDOT2CW = "0"
                                tblNukishi(i + 1).WFSMPLIDOT2CW = ""
                                tblNukishi(i + 1).WFRESOT2CW = ""
                            ElseIf .text = "" Or .text = "0" Then
                                tblNukishi(i).WFINDOT2CW = ""
                                tblNukishi(i).WFSMPLIDOT2CW = ""
                                tblNukishi(i + 1).WFINDOT2CW = ""
                                tblNukishi(i + 1).WFSMPLIDOT2CW = ""
                                .text = ""
                            End If
                        ElseIf intZkbn = 0 Then
                            .text = skensa1(17)
                            If .text = "1" Then
                                tblNukishi(i).WFINDOT2CW = "1"
                                tblNukishi(i).WFSMPLIDOT2CW = tblNukishi(i).REPSMPLIDCW
                            ElseIf .text = "" Then
                                tblNukishi(i).WFINDOT2CW = ""
                                tblNukishi(i).WFSMPLIDOT2CW = ""
                            End If
                        End If

                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .col = 28
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 4 Or intZkbn = 2 Then
                                If tblNukishi(i + 1).WFINDGDCW = "1" Then
                                    tblNukishi(i).WFINDGDCW = "2"
                                    tblNukishi(i).WFSMPLIDGDCW = ""
                                    tblNukishi(i).WFRESGDCW = "1"
                                    tblNukishi(i).WFHSGDCW = "0"
                                Else
                                    tblNukishi(i + 1).WFSMPLIDGDCW = tblNukishi(i).WFSMPLIDGDCW
                                    tblNukishi(i + 1).WFRESGDCW = tblNukishi(i).WFRESGDCW
                                    tblNukishi(i + 1).WFHSGDCW = "0"
                                End If
                            ElseIf intZkbn = 0 Then
                                If tblWafInd(intNukisiRow).SMP.CRYINDGD = "3" Then
                                    If tblNukishi(i).WFINDGDCW = "1" And tblNukishi(i + 1).WFINDGDCW = "1" Then
                                        If skensa1(18) = "2" Then
                                            tblNukishi(i).WFINDGDCW = "2"
                                            tblNukishi(i).WFSMPLIDGDCW = tblNukishi(i + 1).WFSMPLIDGDCW
                                            tblNukishi(i).WFRESGDCW = "0"
                                            tblNukishi(i).WFHSGDCW = "0"
                                            .text = skensa1(18)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
                            tblNukishi(i + 1).WFSMPLIDGDCW = tblNukishi(i).WFSMPLIDGDCW
                            tblNukishi(i + 1).WFRESGDCW = tblNukishi(i).WFRESGDCW
                            tblNukishi(i + 1).WFHSGDCW = tblNukishi(i).WFHSGDCW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 4 Or intZkbn = 2) And skensa2(18) = "0" Then
                            tblNukishi(i + 1).WFINDGDCW = "0"
                            tblNukishi(i + 1).WFSMPLIDGDCW = ""
                            tblNukishi(i + 1).WFRESGDCW = "0"
                            tblNukishi(i + 1).WFHSGDCW = "0"
                            .row = i + 1
                            .text = ""
                            .row = i
                        End If

                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        ' VBè„ÇÃêßñÒ(ÉvÉçÉVÅ[ÉWÉÉóeó 64kêßå¿)ÇÃÇΩÇﬂ§ÉGÉsï™ÇÕï ä÷êîÇ≈èàóùÇ∑ÇÈ
                        Call sub_DispSumple_Hanei_Ep_2(i, intNukisiRow, skensa1(), skensa2(), intZkbn)
                        .row = i + 1
                        .col = 11 'Rs
                        .backColor = vbWhite

                        'ïœçX-------
                        .text = skensa2(0)
                        If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                            If skensa1(0) = "2" Or skensa1(0) = "1" Then  'ã§óLÇ≈Ç´ÇÈ
                                .text = "1"
                                tblNukishi(i + 1).WFINDRSCW = "1" 'é¿ë™ÇéÊÇÈ
                                tblNukishi(i + 1).WFSMPLIDRSCW = tblNukishi(i + 1).REPSMPLIDCW 'èCê≥
                                tblNukishi(i + 1).WFRESRS1CW = "0"
                                'ÉRÉsÅ[
                                tblNukishi(i).WFINDRSCW = "2"
                                tblNukishi(i).WFSMPLIDRSCW = tblNukishi(i + 1).WFSMPLIDRSCW
                                tblNukishi(i).WFRESRS1CW = tblNukishi(i + 1).WFRESRS1CW
                                .row = i
                                .text = "2"
                                .row = i + 1
                            ElseIf skensa1(0) = "0" Then
                                If skensa2(0) = "0" Then
                                    .text = ""
                                    tblNukishi(i + 1).WFINDRSCW = "0"
                                    tblNukishi(i + 1).WFSMPLIDRSCW = ""
                                    tblNukishi(i + 1).WFRESRS1CW = "0"
                                Else
                                    .text = "1"
                                    tblNukishi(i + 1).WFINDRSCW = "1"
                                    tblNukishi(i + 1).WFSMPLIDRSCW = tblNukishi(i + 1).REPSMPLIDCW
                                    tblNukishi(i + 1).WFRESRS1CW = "0"
                                End If
                                tblNukishi(i).WFINDRSCW = "0"
                                tblNukishi(i).WFSMPLIDRSCW = ""
                                tblNukishi(i).WFRESRS1CW = "0"
                                .row = i
                                .text = ""
                                .row = i + 1
                            End If
                        ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                            If .text = "2" Then
                                tblNukishi(i + 1).WFINDRSCW = "2"
                                tblNukishi(i + 1).WFSMPLIDRSCW = tblNukishi(i).REPSMPLIDCW
                               'é¿ê—ÉtÉâÉOÇÕóßÇƒÇ»Ç¢
                            ElseIf .text = "1" Then
                                tblNukishi(i + 1).WFINDRSCW = "1"
                                tblNukishi(i + 1).WFSMPLIDRSCW = tblNukishi(i + 1).REPSMPLIDCW
                            End If
                        End If

                        '-----ïœçX
                        .col = 12
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then 'îΩâfêÑíËä÷êîÇ≈îΩâfOKà»äO
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDOICW = "1" Then  '1Ç™ì¸Ç¡ÇƒÇÕÇ¢ÇØÇ»Ç¢(îΩâfÇÃÇÕÇ∏)
                                    tblNukishi(i + 1).WFINDOICW = "2"
                                    tblNukishi(i + 1).WFSMPLIDOICW = tblNukishi(i).WFSMPLIDOICW
                                    tblNukishi(i + 1).WFRESOICW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDOICW = tblNukishi(i + 1).WFSMPLIDOICW
                                    tblNukishi(i).WFRESOICW = tblNukishi(i + 1).WFRESOICW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDOI = "3" Then                                 'édólÇ™Ç†Ç¡Çƒ
                                    If tblNukishi(i).WFINDOICW = "1" And tblNukishi(i + 1).WFINDOICW = "1" Then 'óºï˚é¿ë™ÇÃèÍçá
                                        If skensa2(1) = "2" Then                                           'édólÇÃåµÇµÇ≠Ç»Ç¢ÇŸÇ§Ç™îΩâf
                                            tblNukishi(i + 1).WFINDOICW = "2"
                                            tblNukishi(i + 1).WFSMPLIDOICW = tblNukishi(i).WFSMPLIDOICW
                                            tblNukishi(i + 1).WFRESOICW = "0"
                                            .text = skensa2(1)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDOICW = tblNukishi(i + 1).WFSMPLIDOICW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(1) = "0" Then
                            tblNukishi(i).WFINDOICW = "0"
                            tblNukishi(i).WFSMPLIDOICW = ""
                            tblNukishi(i).WFRESOICW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 13
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDB1CW = "1" Then
                                    tblNukishi(i + 1).WFINDB1CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDB1CW = tblNukishi(i).WFSMPLIDB1CW
                                    tblNukishi(i + 1).WFRESB1CW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDB1CW = tblNukishi(i + 1).WFSMPLIDB1CW
                                    tblNukishi(i).WFRESB1CW = tblNukishi(i + 1).WFRESB1CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDB1 = "3" Then
                                    If tblNukishi(i).WFINDB1CW = "1" And tblNukishi(i + 1).WFINDB1CW = "1" Then
                                        If skensa2(2) = "2" Then
                                            tblNukishi(i + 1).WFINDB1CW = "2"
                                            tblNukishi(i + 1).WFSMPLIDB1CW = tblNukishi(i).WFSMPLIDB1CW
                                            tblNukishi(i + 1).WFRESB1CW = "0"
                                            .text = skensa2(2)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDB1CW = tblNukishi(i + 1).WFSMPLIDB1CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(2) = "0" Then
                            tblNukishi(i).WFINDB1CW = "0"
                            tblNukishi(i).WFSMPLIDB1CW = ""
                            tblNukishi(i).WFRESB1CW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 14
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDB2CW = "1" Then
                                    tblNukishi(i + 1).WFINDB2CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDB2CW = tblNukishi(i).WFSMPLIDB2CW
                                    tblNukishi(i + 1).WFRESB2CW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDB2CW = tblNukishi(i + 1).WFSMPLIDB2CW
                                    tblNukishi(i).WFRESB2CW = tblNukishi(i + 1).WFRESB2CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDB2 = "3" Then
                                    If tblNukishi(i).WFINDB2CW = "1" And tblNukishi(i + 1).WFINDB2CW = "1" Then
                                        If skensa2(3) = "2" Then
                                            tblNukishi(i + 1).WFINDB2CW = "2"
                                            tblNukishi(i + 1).WFSMPLIDB2CW = tblNukishi(i).WFSMPLIDB2CW
                                            tblNukishi(i + 1).WFRESB2CW = "0"
                                            .text = skensa2(3)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDB2CW = tblNukishi(i + 1).WFSMPLIDB2CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(3) = "0" Then
                            tblNukishi(i).WFINDB2CW = "0"
                            tblNukishi(i).WFSMPLIDB2CW = ""
                            tblNukishi(i).WFRESB2CW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 15
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDB3CW = "1" Then
                                    tblNukishi(i + 1).WFINDB3CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDB3CW = tblNukishi(i).WFSMPLIDB2CW
                                    tblNukishi(i + 1).WFRESB3CW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDB3CW = tblNukishi(i + 1).WFSMPLIDB3CW
                                    tblNukishi(i).WFRESB3CW = tblNukishi(i + 1).WFRESB3CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDB3 = "3" Then
                                    If tblNukishi(i).WFINDB3CW = "1" And tblNukishi(i + 1).WFINDB3CW = "1" Then
                                        If skensa2(4) = "2" Then
                                            tblNukishi(i + 1).WFINDB3CW = "2"
                                            tblNukishi(i + 1).WFSMPLIDB3CW = tblNukishi(i).WFSMPLIDB3CW
                                            tblNukishi(i + 1).WFRESB3CW = "0"
                                            .text = skensa2(4)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDB3CW = tblNukishi(i + 1).WFSMPLIDB3CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(4) = "0" Then
                            tblNukishi(i).WFINDB3CW = "0"
                            tblNukishi(i).WFSMPLIDB3CW = ""
                            tblNukishi(i).WFRESB3CW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 16
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDL1CW = "1" Then
                                    tblNukishi(i + 1).WFINDL1CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDL1CW = tblNukishi(i).WFSMPLIDL1CW
                                    tblNukishi(i + 1).WFRESL1CW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDL1CW = tblNukishi(i + 1).WFSMPLIDL1CW
                                    tblNukishi(i).WFRESL1CW = tblNukishi(i + 1).WFRESL1CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDL1 = "3" Then
                                    If tblNukishi(i).WFINDL1CW = "1" And tblNukishi(i + 1).WFINDL1CW = "1" Then
                                        If skensa2(5) = "2" Then
                                            tblNukishi(i + 1).WFINDL1CW = "2"
                                            tblNukishi(i + 1).WFSMPLIDL1CW = tblNukishi(i).WFSMPLIDL1CW
                                            tblNukishi(i + 1).WFRESL1CW = "0"
                                            .text = skensa2(5)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                                tblNukishi(i).WFSMPLIDL1CW = tblNukishi(i + 1).WFSMPLIDL1CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(5) = "0" Then
                            tblNukishi(i).WFINDL1CW = "0"
                            tblNukishi(i).WFSMPLIDL1CW = ""
                            tblNukishi(i).WFRESL1CW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 17
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDL2CW = "1" Then
                                    tblNukishi(i + 1).WFINDL2CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDL2CW = tblNukishi(i).WFSMPLIDL2CW
                                    tblNukishi(i + 1).WFRESL2CW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDL2CW = tblNukishi(i + 1).WFSMPLIDL2CW
                                    tblNukishi(i).WFRESL2CW = tblNukishi(i + 1).WFRESL2CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDL2 = "3" Then
                                    If tblNukishi(i).WFINDL2CW = "1" And tblNukishi(i + 1).WFINDL2CW = "1" Then
                                        If skensa2(6) = "2" Then
                                            tblNukishi(i + 1).WFINDL2CW = "2"
                                            tblNukishi(i + 1).WFSMPLIDL2CW = tblNukishi(i).WFSMPLIDL2CW
                                            tblNukishi(i + 1).WFRESL2CW = "0"
                                            .text = skensa2(6)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDL2CW = tblNukishi(i + 1).WFSMPLIDL2CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(6) = "0" Then
                            tblNukishi(i).WFINDL2CW = "0"
                            tblNukishi(i).WFSMPLIDL2CW = ""
                            tblNukishi(i).WFRESL2CW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 18
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDL3CW = "1" Then
                                    tblNukishi(i + 1).WFINDL3CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDL3CW = tblNukishi(i).WFSMPLIDL3CW
                                    tblNukishi(i + 1).WFRESL3CW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDL3CW = tblNukishi(i + 1).WFSMPLIDL3CW
                                    tblNukishi(i).WFRESL3CW = tblNukishi(i + 1).WFRESL3CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDL3 = "3" Then
                                    If tblNukishi(i).WFINDL3CW = "1" And tblNukishi(i + 1).WFINDL3CW = "1" Then
                                        If skensa2(7) = "2" Then
                                            tblNukishi(i + 1).WFINDL3CW = "2"
                                            tblNukishi(i + 1).WFSMPLIDL3CW = tblNukishi(i).WFSMPLIDL3CW
                                            tblNukishi(i + 1).WFRESL3CW = "0"
                                            .text = skensa2(7)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDL3CW = tblNukishi(i + 1).WFSMPLIDL3CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(7) = "0" Then
                            tblNukishi(i).WFINDL3CW = "0"
                            tblNukishi(i).WFSMPLIDL3CW = ""
                            tblNukishi(i).WFRESL3CW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 19
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDL4CW = "1" Then
                                    tblNukishi(i + 1).WFINDL4CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDL4CW = tblNukishi(i).WFSMPLIDL4CW
                                    tblNukishi(i + 1).WFRESL4CW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDL4CW = tblNukishi(i + 1).WFSMPLIDL4CW
                                    tblNukishi(i).WFRESL4CW = tblNukishi(i + 1).WFRESL4CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDL4 = "3" Then
                                    If tblNukishi(i).WFINDL4CW = "1" And tblNukishi(i + 1).WFINDL4CW = "1" Then
                                        If skensa2(8) = "2" Then
                                            tblNukishi(i + 1).WFINDL4CW = "2"
                                            tblNukishi(i + 1).WFSMPLIDL4CW = tblNukishi(i).WFSMPLIDL4CW
                                            tblNukishi(i + 1).WFRESL4CW = "0"
                                            .text = skensa2(8)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDL4CW = tblNukishi(i + 1).WFSMPLIDL4CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(8) = "0" Then
                            tblNukishi(i).WFINDL4CW = "0"
                            tblNukishi(i).WFSMPLIDL4CW = ""
                            tblNukishi(i).WFRESL4CW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 20
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDDSCW = "1" Then
                                    tblNukishi(i + 1).WFINDDSCW = "2"
                                    tblNukishi(i + 1).WFSMPLIDDSCW = tblNukishi(i).WFSMPLIDDSCW
                                    tblNukishi(i + 1).WFRESDSCW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDDSCW = tblNukishi(i + 1).WFSMPLIDDSCW
                                    tblNukishi(i).WFRESDSCW = tblNukishi(i + 1).WFRESDSCW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDDS = "3" Then
                                    If tblNukishi(i).WFINDDSCW = "1" And tblNukishi(i + 1).WFINDDSCW = "1" Then
                                        If skensa2(9) = "2" Then
                                            tblNukishi(i + 1).WFINDDSCW = "2"
                                            tblNukishi(i + 1).WFSMPLIDDSCW = tblNukishi(i).WFSMPLIDDSCW
                                            tblNukishi(i + 1).WFRESDSCW = "0"
                                            .text = skensa2(9)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDDSCW = tblNukishi(i + 1).WFSMPLIDDSCW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(9) = "0" Then
                            tblNukishi(i).WFINDDSCW = "0"
                            tblNukishi(i).WFSMPLIDDSCW = ""
                            tblNukishi(i).WFRESDSCW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 21
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDDZCW = "1" Then
                                    tblNukishi(i + 1).WFINDDZCW = "2"
                                    tblNukishi(i + 1).WFSMPLIDDZCW = tblNukishi(i).WFSMPLIDDZCW
                                    tblNukishi(i + 1).WFRESDZCW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDDZCW = tblNukishi(i + 1).WFSMPLIDDZCW
                                    tblNukishi(i).WFRESDZCW = tblNukishi(i + 1).WFRESDZCW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDDZ = "3" Then
                                    If tblNukishi(i).WFINDDZCW = "1" And tblNukishi(i + 1).WFINDDZCW = "1" Then
                                        If skensa2(10) = "2" Then
                                            tblNukishi(i + 1).WFINDDZCW = "2"
                                            tblNukishi(i + 1).WFSMPLIDDZCW = tblNukishi(i).WFSMPLIDDZCW
                                            tblNukishi(i + 1).WFRESDZCW = "0"
                                            .text = skensa2(10)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDDZCW = tblNukishi(i + 1).WFSMPLIDDZCW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(10) = "0" Then
                            tblNukishi(i).WFINDDZCW = "0"
                            tblNukishi(i).WFSMPLIDDZCW = ""
                            tblNukishi(i).WFRESDZCW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 22
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDSPCW = "1" Then
                                    tblNukishi(i + 1).WFINDSPCW = "2"
                                    tblNukishi(i + 1).WFSMPLIDSPCW = tblNukishi(i).WFSMPLIDSPCW
                                    tblNukishi(i + 1).WFRESSPCW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDSPCW = tblNukishi(i + 1).WFSMPLIDSPCW
                                    tblNukishi(i).WFRESSPCW = tblNukishi(i + 1).WFRESSPCW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDSP = "3" Then
                                    If tblNukishi(i).WFINDSPCW = "1" And tblNukishi(i + 1).WFINDSPCW = "1" Then
                                        If skensa2(11) = "2" Then
                                            tblNukishi(i + 1).WFINDSPCW = "2"
                                            tblNukishi(i + 1).WFSMPLIDSPCW = tblNukishi(i).WFSMPLIDSPCW
                                            tblNukishi(i + 1).WFRESSPCW = "0"
                                            .text = skensa2(11)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDSPCW = tblNukishi(i + 1).WFSMPLIDSPCW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(11) = "0" Then
                            tblNukishi(i).WFINDSPCW = "0"
                            tblNukishi(i).WFSMPLIDSPCW = ""
                            tblNukishi(i).WFRESSPCW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 23
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDDO1CW = "1" Then
                                    tblNukishi(i + 1).WFINDDO1CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDDO1CW = tblNukishi(i).WFSMPLIDDO1CW
                                    tblNukishi(i + 1).WFRESDO1CW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDDO1CW = tblNukishi(i + 1).WFSMPLIDDO1CW
                                    tblNukishi(i).WFRESDO1CW = tblNukishi(i + 1).WFRESDO1CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDD1 = "3" Then
                                    If tblNukishi(i).WFINDOT1CW = "1" And tblNukishi(i + 1).WFINDOT1CW = "1" Then
                                        If skensa2(12) = "2" Then
                                            tblNukishi(i + 1).WFINDDO1CW = "2"
                                            tblNukishi(i + 1).WFSMPLIDDO1CW = tblNukishi(i).WFSMPLIDDO1CW
                                            tblNukishi(i + 1).WFRESDO1CW = "0"
                                            .text = skensa2(12)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDDO1CW = tblNukishi(i + 1).WFSMPLIDDO1CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(12) = "0" Then
                            tblNukishi(i).WFINDDO1CW = "0"
                            tblNukishi(i).WFSMPLIDDO1CW = ""
                            tblNukishi(i).WFRESDO1CW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 24
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDDO2CW = "1" Then
                                    tblNukishi(i + 1).WFINDDO2CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDOICW = tblNukishi(i).WFSMPLIDDO2CW
                                    tblNukishi(i + 1).WFRESDO2CW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDDO2CW = tblNukishi(i + 1).WFSMPLIDDO2CW
                                    tblNukishi(i).WFRESDO2CW = tblNukishi(i + 1).WFRESDO2CW
                                End If
                            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDD2 = "3" Then
                                    If tblNukishi(i).WFINDDO2CW = "1" And tblNukishi(i + 1).WFINDDO2CW = "1" Then
                                        If skensa2(13) = "2" Then
                                            tblNukishi(i + 1).WFINDDO2CW = "2"
                                            tblNukishi(i + 1).WFSMPLIDDO2CW = tblNukishi(i).WFSMPLIDDO2CW
                                            tblNukishi(i + 1).WFRESDO2CW = "0"
                                            .text = skensa2(13)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDDO2CW = tblNukishi(i + 1).WFSMPLIDDO2CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(13) = "0" Then
                            tblNukishi(i).WFINDDO2CW = "0"
                            tblNukishi(i).WFSMPLIDDO2CW = ""
                            tblNukishi(i).WFRESDO2CW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 25
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDDO3CW = "1" Then
                                    tblNukishi(i + 1).WFINDDO3CW = "2"
                                    tblNukishi(i + 1).WFSMPLIDDO3CW = tblNukishi(i).WFSMPLIDDO3CW
                                    tblNukishi(i + 1).WFRESDO3CW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDDO3CW = tblNukishi(i + 1).WFSMPLIDDO3CW
                                    tblNukishi(i).WFRESDO3CW = tblNukishi(i + 1).WFRESDO3CW
                                End If
                            ElseIf intZkbn = 0 Then  'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDD3 = "3" Then
                                    If tblNukishi(i).WFINDDO3CW = "1" And tblNukishi(i + 1).WFINDDO3CW = "1" Then
                                        If skensa2(14) = "2" Then
                                            tblNukishi(i + 1).WFINDDO3CW = "2"
                                            tblNukishi(i + 1).WFSMPLIDDO3CW = tblNukishi(i).WFSMPLIDDO3CW
                                            tblNukishi(i + 1).WFRESDO3CW = "0"
                                            .text = skensa2(14)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDDO3CW = tblNukishi(i + 1).WFSMPLIDDO3CW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(14) = "0" Then
                            tblNukishi(i).WFINDDO3CW = "0"
                            tblNukishi(i).WFSMPLIDDO3CW = ""
                            tblNukishi(i).WFRESDO3CW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        ''écë∂é_ëfí«â¡
                        .col = 26
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDAOICW = "1" Then
                                    tblNukishi(i + 1).WFINDAOICW = "2"
                                    tblNukishi(i + 1).WFSMPLIDAOICW = tblNukishi(i).WFSMPLIDAOICW
                                    tblNukishi(i + 1).WFRESAOICW = "1"
                                Else
                                    tblNukishi(i).WFSMPLIDAOICW = tblNukishi(i + 1).WFSMPLIDAOICW
                                    tblNukishi(i).WFRESAOICW = tblNukishi(i + 1).WFRESAOICW
                                End If
                            ElseIf intZkbn = 0 Then  'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDAO = "3" Then
                                    If tblNukishi(i).WFINDAOICW = "1" And tblNukishi(i + 1).WFINDAOICW = "1" Then
                                        If skensa2(15) = "2" Then
                                            tblNukishi(i + 1).WFINDAOICW = "2"
                                            tblNukishi(i + 1).WFSMPLIDAOICW = tblNukishi(i).WFSMPLIDAOICW
                                            tblNukishi(i + 1).WFRESAOICW = "0"
                                            .text = skensa2(15)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDAOICW = tblNukishi(i + 1).WFSMPLIDAOICW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(15) = "0" Then
                            tblNukishi(i).WFINDAOICW = "0"
                            tblNukishi(i).WFSMPLIDAOICW = ""
                            tblNukishi(i).WFRESAOICW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        .col = 27 'OT1
                        .backColor = vbWhite
                        If .text <> "2" Then
                            If intZkbn = 3 Or intZkbn = 1 Then
                                .text = skensa2(16)
                                If .text = "1" Then
                                    tblNukishi(i + 1).WFINDOT1CW = "1"
                                    tblNukishi(i + 1).WFSMPLIDOT1CW = tblNukishi(i + 1).REPSMPLIDCW
                                    'ÉRÉsÅ[
                                    tblNukishi(i).WFINDOT1CW = "0"
                                    tblNukishi(i).WFSMPLIDOT1CW = ""
                                    tblNukishi(i).WFRESOT1CW = ""
                                ElseIf .text = "0" Then
                                    tblNukishi(i + 1).WFINDOT1CW = ""
                                    tblNukishi(i + 1).WFSMPLIDOT1CW = ""
                                End If
                            ElseIf intZkbn = 0 Then
                                .text = skensa2(16)
                                If .text = "2" Then
                                    tblNukishi(i + 1).WFINDOT1CW = "0"
                                    tblNukishi(i + 1).WFSMPLIDOT1CW = ""
                                ElseIf .text = "1" Then
                                    tblNukishi(i + 1).WFINDOT1CW = "1"
                                    tblNukishi(i + 1).WFSMPLIDOT1CW = tblNukishi(i + 1).REPSMPLIDCW
                                End If
                            End If
                        ElseIf skensa1(16) = "" Then
                            .text = ""
                            tblNukishi(i).WFINDOT1CW = "0"
                            tblNukishi(i).WFSMPLIDOT1CW = ""
                        End If

                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .col = 35
                        .backColor = vbWhite
                        If .text <> "2" Then
                            If intZkbn = 3 Or intZkbn = 1 Then
                                .text = skensa2(17)
                                If .text = "1" Then
                                    tblNukishi(i + 1).WFINDOT2CW = "1"
                                    tblNukishi(i + 1).WFSMPLIDOT2CW = tblNukishi(i + 1).REPSMPLIDCW
                                    'ÉRÉsÅ[
                                    tblNukishi(i).WFINDOT2CW = "0"
                                    tblNukishi(i).WFSMPLIDOT2CW = ""
                                    tblNukishi(i).WFRESOT2CW = ""
                                ElseIf .text = "0" Then
                                    tblNukishi(i + 1).WFINDOT2CW = ""
                                    tblNukishi(i + 1).WFSMPLIDOT2CW = ""
                                End If
                        ElseIf intZkbn = 0 Then
                            .text = skensa2(17)
                                If .text = "2" Then
                                    tblNukishi(i + 1).WFINDOT2CW = "0"
                                    tblNukishi(i + 1).WFSMPLIDOT2CW = ""
                                ElseIf .text = "1" Then
                                    tblNukishi(i + 1).WFINDOT2CW = "1"
                                    tblNukishi(i + 1).WFSMPLIDOT2CW = tblNukishi(i + 1).REPSMPLIDCW
                                End If
                            End If
                        ElseIf skensa2(17) = "" Then
                            .text = ""
                            tblNukishi(i).WFINDOT1CW = "0"
                            tblNukishi(i).WFSMPLIDOT1CW = ""
                        End If

                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .col = 28
                        .backColor = vbWhite
                        If .text <> "2" And .text <> "" Then
                            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                                If tblNukishi(i).WFINDGDCW = "1" Then
                                    tblNukishi(i + 1).WFINDGDCW = "2"
                                    tblNukishi(i + 1).WFSMPLIDGDCW = tblNukishi(i).WFSMPLIDGDCW
                                    tblNukishi(i + 1).WFRESGDCW = "1"
                                    tblNukishi(i + 1).WFHSGDCW = "0"
                                Else
                                    tblNukishi(i).WFSMPLIDGDCW = tblNukishi(i + 1).WFSMPLIDGDCW
                                    tblNukishi(i).WFRESGDCW = tblNukishi(i + 1).WFRESGDCW
                                    tblNukishi(i).WFHSGDCW = "0"
                                End If
                            ElseIf intZkbn = 0 Then  'ZÇ≈ÇÕÇ»Ç¢
                                If tblWafInd(intNukisiRow).SMP.CRYINDGD = "3" Then
                                    If tblNukishi(i).WFINDGDCW = "1" And tblNukishi(i + 1).WFINDGDCW = "1" Then
                                        If skensa2(18) = "2" Then
                                            tblNukishi(i + 1).WFINDGDCW = "2"
                                            tblNukishi(i + 1).WFSMPLIDGDCW = tblNukishi(i).WFSMPLIDGDCW
                                            tblNukishi(i + 1).WFRESGDCW = "0"
                                            tblNukishi(i + 1).WFHSGDCW = "0"
                                            .text = skensa2(18)
                                        End If
                                    End If
                                End If
                            End If
                        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                            tblNukishi(i).WFSMPLIDGDCW = tblNukishi(i + 1).WFSMPLIDGDCW
                            tblNukishi(i).WFRESGDCW = tblNukishi(i + 1).WFRESGDCW
                            tblNukishi(i).WFHSGDCW = tblNukishi(i + 1).WFHSGDCW
                        End If

                        'ï€èÿï˚ñ@ïœçXëŒâû
                        If (intZkbn = 3 Or intZkbn = 1) And skensa1(18) = "0" Then
                            tblNukishi(i).WFINDGDCW = "0"
                            tblNukishi(i).WFSMPLIDGDCW = ""
                            tblNukishi(i).WFRESGDCW = "0"
                            tblNukishi(i).WFHSGDCW = "0"
                            .row = i
                            .text = ""
                            .row = i + 1
                        End If

                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        ' VBè„ÇÃêßñÒ(ÉvÉçÉVÅ[ÉWÉÉóeó 64kêßå¿)ÇÃÇΩÇﬂ§ÉGÉsï™ÇÕï ä÷êîÇ≈èàóùÇ∑ÇÈ
                        Call sub_DispSumple_Hanei_Ep_3(i, intNukisiRow, skensa1(), skensa2(), intZkbn)

                        ''î‰íÔçRÇ≈ïKÇ∏é¿ê—ÇóßÇƒÇÈèàóùÇí«â¡
                        With tblNukishi(i)
                            If .WFINDRSCW = "2" Then
                                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                                If .WFINDOICW = "1" Or .WFINDB1CW = "1" Or .WFINDB2CW = "1" Or _
                                   .WFINDB3CW = "1" Or .WFINDL1CW = "1" Or .WFINDL2CW = "1" Or _
                                   .WFINDL3CW = "1" Or .WFINDL4CW = "1" Or .WFINDDSCW = "1" Or _
                                   .WFINDDZCW = "1" Or .WFINDSPCW = "1" Or .WFINDDO1CW = "1" Or _
                                   .WFINDDO2CW = "1" Or .WFINDDO3CW = "1" Or .WFINDAOICW = "1" Or _
                                   .WFINDGDCW = "1" Or _
                                   .EPINDB1CW = "1" Or .EPINDB2CW = "1" Or .EPINDB3CW = "1" Or _
                                   .EPINDL1CW = "1" Or .EPINDL2CW = "1" Or .EPINDL3CW = "1" Then
                                    .WFINDRSCW = "1"
                                    .WFSMPLIDRSCW = .REPSMPLIDCW
                                    .WFRESRS1CW = "0"
                                    sprExamine.col = 11
                                    sprExamine.row = i
                                    sprExamine.text = "1"
                                End If
                            End If
                        End With
                        With tblNukishi(i + 1)
                            If .WFINDRSCW = "2" Then
                                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                                If .WFINDOICW = "1" Or .WFINDB1CW = "1" Or .WFINDB2CW = "1" Or _
                                   .WFINDB3CW = "1" Or .WFINDL1CW = "1" Or .WFINDL2CW = "1" Or _
                                   .WFINDL3CW = "1" Or .WFINDL4CW = "1" Or .WFINDDSCW = "1" Or _
                                   .WFINDDZCW = "1" Or .WFINDSPCW = "1" Or .WFINDDO1CW = "1" Or _
                                   .WFINDDO2CW = "1" Or .WFINDDO3CW = "1" Or .WFINDAOICW = "1" Or _
                                   .WFINDGDCW = "1" Or _
                                   .EPINDB1CW = "1" Or .EPINDB2CW = "1" Or .EPINDB3CW = "1" Or _
                                   .EPINDL1CW = "1" Or .EPINDL2CW = "1" Or .EPINDL3CW = "1" Then
                                    .WFINDRSCW = "1"
                                    .WFSMPLIDRSCW = .REPSMPLIDCW
                                    .WFRESRS1CW = "0"
                                    sprExamine.col = 11
                                    sprExamine.row = i + 1
                                    sprExamine.text = "1"
                                    sprExamine.row = i
                                End If
                            End If
                        End With

                        'é¿ÉfÅ[É^ÇÃÉ`ÉFÉbÉN
                         Call sub_Jitu(i + 1, blKirikaeflg, blnhflg, intZkbn)

                        'êFÇìhÇÈ
                        Call sub_Paint(i + 1)
                        'êFÇìhÇÈ
                End If
                    If i Mod 2 = 0 Then
                        ReDim Preserve gtSprWfMap(i + 1)
                        gtSprWfMap(i).ADD_FLG = 2
                        gtSprWfMap(i + 1).ADD_FLG = 0
                        '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                        .GetText 39, i, vgetlotid
                        gtSprWfMap(i).LOTID = Mid(tblSXL.SXLID, 1, 9) & Trim(vgetlotid)
                        .GetText 39, i + 1, vGetLotId2
                        gtSprWfMap(i + 1).LOTID = Mid(tblSXL.SXLID, 1, 9) & Trim(vGetLotId2)

                        .GetText 4, i, vGetBlkP
                        gtSprWfMap(i).blockp = Trim(vGetBlkP)
                        gtSprWfMap(i + 1).blockp = Trim(vGetBlkP)
                        .GetText 4, i + 1, vGetBlkP
                        If vGetBlkP <> "" And vNukisiFlg <> 2 Then    'í«â¡çsÇÕèàóùÇµÇ»Ç¢Å@04/06/07 ooba
                            If vgetlotid <> vGetLotId2 Then
                                gtSprWfMap(i + 1).blockp = Trim(vGetBlkP)
                            End If
                        End If
                        .GetText 4, i, vGetBlkP
                        .GetText 2, i - 1, vGetHinban
                        gtSprWfMap(i).hinban = Trim(vGetHinban)
                        .GetText 2, i + 1, vGetHinban
                        gtSprWfMap(i + 1).hinban = Trim(vGetHinban)
                        gtSprWfMap(i - 1).opecond = tblWafInd(intNukisiRow).HINUP.opecond
                        gtSprWfMap(i - 1).REVNUM = tblWafInd(intNukisiRow).HINUP.mnorevno
                        gtSprWfMap(i - 1).factory = tblWafInd(intNukisiRow).HINUP.factory
                        gtSprWfMap(i).opecond = tblWafInd(intNukisiRow).HINUP.opecond
                        gtSprWfMap(i).REVNUM = tblWafInd(intNukisiRow).HINUP.mnorevno
                        gtSprWfMap(i).factory = tblWafInd(intNukisiRow).HINUP.factory
                        gtSprWfMap(i + 1).opecond = tblWafInd(intNukisiRow).HINDN.opecond
                        gtSprWfMap(i + 1).REVNUM = tblWafInd(intNukisiRow).HINDN.mnorevno
                        gtSprWfMap(i + 1).factory = tblWafInd(intNukisiRow).HINDN.factory
                        'TBCMY011Ç©ÇÁäYìñÉfÅ[É^éÊìæ
                        vSample1 = Trim(Right(sSampID1, 1))
                        vSample2 = Trim(Right(sSampID2, 1))
                        If i <= m - 2 Then
                            .GetText 4, i + 2, vNextBlkP
                            intNextBlkP = CInt(Trim(vNextBlkP))
                        End If

                        'WFñáêîÅAÉTÉìÉvÉãIDéÊìæ
                        If DBDRV_GET_WFMAP(gtSprWfMap(i).LOTID, tblSXL.SXLID, gtSprWfMap(i).blockp, _
                                            vGetBlkP, vGetIngotP, sNextIngotP, vGetBlkSeq, vGetBlkSeq2, _
                                            vSample1, vSample2, intNextBlkP, vGetWfNum) = FUNCTION_RETURN_FAILURE Then
                            lblMsg.Caption = GetMsgStr("EWFM1") '03/06/06 å„ì°
                            Exit Function
                        End If

                        gtSprWfMap(i).KESSYOUP = Trim(vGetIngotP)
                        gtSprWfMap(i + 1).KESSYOUP = Trim(vGetIngotP)
                        gtSprWfMap(i).BLOCKSEQ = Trim(vGetBlkSeq)
                        If IsNull(vGetBlkSeq2) = False And vGetBlkSeq2 <> "" Then
                            gtSprWfMap(i + 1).BLOCKSEQ = Trim(vGetBlkSeq2)
                        Else
                            gtSprWfMap(i + 1).BLOCKSEQ = Trim(vGetBlkSeq)
                        End If
                        If vSample1 <> vbNullString Then
                            gtSprWfMap(i).SAMPLEID = vSample1
                        Else
                            gtSprWfMap(i).SAMPLEID = tblNukishi(i).REPSMPLIDCW
                        End If
                        If vSample2 <> vbNullString Then
                            gtSprWfMap(i + 1).SAMPLEID = vSample2
                        Else
                            gtSprWfMap(i + 1).SAMPLEID = tblNukishi(i + 1).REPSMPLIDCW
                        End If
                        gtSprWfMap(i).wfnum = vGetWfNum
                        'ã§óLÅAÉTÉìÉvÉãÇÃëIëâ¬î\ÇÃèÍçáÅASampleIDÇï âBÇµÉJÉâÉÄÇ…ï€ë∂
                        'ã§óLÇÃèÍçáÇ≈Ç‡ÉTÉìÉvÉãIDÇ™ë„ï\ÉTÉìÉvÉãIDÇÃÇ∆Ç´Ç…èàóùÇÇ∑ÇÈÇÊÇ§Ç…ïœçXÅ@2003/11/11
                        If blKirikaeflg = True And intSmpkbn <> 1 Then
                            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                            .SetText 44, i, vSample1
                            gtSprWfMap(i).SAMPLEID = vSample1
                            .SetText 44, i, vSample1
                            gtSprWfMap(i + 1).SAMPLEID = vSample1
                        End If
                    End If
                Else
                    'ãÊï™ÇRÇ≈î≤ééÇî∫ÇÌÇ»Ç©Ç¡ÇΩÇ‡ÇÃ
                    If i Mod 2 = 0 Then
                        ReDim Preserve gtSprWfMap(i + 1)
                        gtSprWfMap(i).ADD_FLG = 3
                        gtSprWfMap(i + 1).ADD_FLG = 3
                        '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                        .GetText 39, i, vgetlotid
                        gtSprWfMap(i).LOTID = Mid(tblSXL.SXLID, 1, 9) & Trim(vgetlotid)
                         .GetText 39, i + 1, vgetlotid
                        gtSprWfMap(i + 1).LOTID = Mid(tblSXL.SXLID, 1, 9) & Trim(vgetlotid)
                        .GetText 4, i, vGetBlkP
                        gtSprWfMap(i).blockp = Trim(vGetBlkP)

                        .GetText 4, i + 1, vGetBlkP
                        gtSprWfMap(i + 1).blockp = Trim(vGetBlkP)
                        'èâä˙ï\é¶ÇÃåãèªà íu,òAî‘ÇÕâÊñ Ç©ÇÁÅ@2003/04/23
                        .GetText 5, i, vGetIngotP
                        gtSprWfMap(i).KESSYOUP = Trim(vGetIngotP)

                        .GetText 5, i + 1, vGetIngotP
                        gtSprWfMap(i + 1).KESSYOUP = Trim(vGetIngotP)
                        .GetText 6, i, vGetBlkSeq
                        If vGetBlkSeq <> "" Then
                            gtSprWfMap(i).BLOCKSEQ = Trim(vGetBlkSeq)
                        End If
                        .GetText 6, i + 1, vGetBlkSeq
                        If vGetBlkSeq <> "" Then
                            gtSprWfMap(i + 1).BLOCKSEQ = Trim(vGetBlkSeq)
                        End If

                        .GetText 2, i - 1, vGetHinban
                        gtSprWfMap(i).hinban = Trim(vGetHinban)
                        .GetText 2, i + 1, vGetHinban
                        gtSprWfMap(i + 1).hinban = Trim(vGetHinban)
                        gtSprWfMap(i - 1).opecond = tblWafInd(intNukisiRow + 1).HINUP.opecond
                        gtSprWfMap(i - 1).REVNUM = tblWafInd(intNukisiRow + 1).HINUP.mnorevno
                        gtSprWfMap(i - 1).factory = tblWafInd(intNukisiRow + 1).HINUP.factory
                        gtSprWfMap(i).opecond = tblWafInd(intNukisiRow + 1).HINUP.opecond
                        gtSprWfMap(i).REVNUM = tblWafInd(intNukisiRow + 1).HINUP.mnorevno
                        gtSprWfMap(i).factory = tblWafInd(intNukisiRow + 1).HINUP.factory
                        gtSprWfMap(i + 1).opecond = tblWafInd(intNukisiRow + 1).HINUP.opecond
                        gtSprWfMap(i + 1).REVNUM = tblWafInd(intNukisiRow + 1).HINUP.mnorevno
                        gtSprWfMap(i + 1).factory = tblWafInd(intNukisiRow + 1).HINUP.factory
                        If i <= m - 2 Then
                            .GetText 4, i + 2, vNextBlkP
                            intNextBlkP = CInt(Trim(vNextBlkP))
                        End If
                    End If
                End If
            Else
                intNukisiRow = intNukisiRow + 1 '1çsñ⁄Åïç≈èIçsÇ≈ÅAINDEX+1ÇµÇƒÇ®Ç≠
                ReDim Preserve gtSprWfMap(i)
                If vNukisiFlg = 1 Then
                    gtSprWfMap(i).ADD_FLG = 1
                Else
                    gtSprWfMap(i).ADD_FLG = 3
                End If
                '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                .GetText 39, i, vgetlotid
                gtSprWfMap(i).LOTID = Mid(tblSXL.SXLID, 1, 9) & Trim(vgetlotid)
                .GetText 4, i, vGetBlkP
                gtSprWfMap(i).blockp = Trim(vGetBlkP)
                .GetText 5, i, vGetIngotP
                gtSprWfMap(i).KESSYOUP = Trim(vGetIngotP)
                .GetText 6, i, vGetBlkSeq
                gtSprWfMap(i).BLOCKSEQ = Trim(vGetBlkSeq)
                If i = 1 Then
                    .GetText 2, 1, vGetHinban
                    gtSprWfMap(i).hinban = Trim(vGetHinban)
                Else
                    .GetText 2, m - 1, vGetHinban
                    gtSprWfMap(i).hinban = Trim(vGetHinban)
                End If
                gtSprWfMap(i).opecond = tblWafInd(intNukisiRow).HINDN.opecond
                gtSprWfMap(i).REVNUM = tblWafInd(intNukisiRow).HINDN.mnorevno
                gtSprWfMap(i).factory = tblWafInd(intNukisiRow).HINDN.factory

                ''ëSêUë÷éûÇÃåãèªGDà¯åpÇ¨ëŒâû
                .row = i
                .col = 28
                'GDÇÃéwé¶Ç™Ç»Ç¢èÍçá
                If .text <> "1" And .text <> "2" Then
                    With tblWafInd(intNukisiRow)
                        'èâä˙çsÇÃTOPë§Ç≈ïiî‘ÇêUë÷Ç¶ÇΩèÍçá
                        If i = 1 And Trim(.HINDN.hinban) <> "Z" And _
                                    (.HINDN.hinban <> tblSXL.hinban Or _
                                    .HINDN.mnorevno <> tblSXL.REVNUM Or _
                                    .HINDN.factory <> tblSXL.factory Or _
                                    .HINDN.opecond <> tblSXL.opecond) Then

                            .SMP.CRYINDGD = GetWFSamp(.HINUP, .HINDN, 19)       'GD
                            'GDÇÃéwé¶Ç™Ç†ÇÈèÍçá
                            If .SMP.CRYINDGD <> "0" And .SMP.CRYINDGD <> "2" And _
                                        IsNumeric(CpyCrySmpl.TsmplidGD) Then

                                .SMP.WFHSGD = "1"
                                sprExamine.text = CpyCrySmpl.TindGD
                                sprExamine.backColor = COLOR_CryJitsu
                                sprExamine.ForeColor = COLOR_CryJitsu
                                bMotoGDcpyFlg(1) = True
                            End If

                        'èâä˙çsÇÃBOTë§Ç≈ïiî‘ÇêUë÷Ç¶ÇΩèÍçá
                        ElseIf i = m And Trim(.HINUP.hinban) <> "Z" And _
                                    (.HINUP.hinban <> tblSXL.hinban Or _
                                    .HINUP.mnorevno <> tblSXL.REVNUM Or _
                                    .HINUP.factory <> tblSXL.factory Or _
                                    .HINUP.opecond <> tblSXL.opecond) Then

                            .SMP.CRYINDGD = GetWFSamp(.HINUP, .HINDN, 19)       'GD
                            'GDÇÃéwé¶Ç™Ç†ÇÈèÍçá
                            If .SMP.CRYINDGD <> "0" And .SMP.CRYINDGD <> "1" And _
                                        IsNumeric(CpyCrySmpl.BsmplidGD) Then

                                .SMP.WFHSGD = "1"
                                sprExamine.text = CpyCrySmpl.BindGD
                                sprExamine.backColor = COLOR_CryJitsu
                                sprExamine.ForeColor = COLOR_CryJitsu
                                bMotoGDcpyFlg(2) = True
                            End If

                        End If
                    End With
                End If
            End If
        Next i

        'âÊñ ï\é¶
        m = .MaxRows
        intNukisiRow = 0
        For i = 1 To m
            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
            .GetText 37, i, vNukisiFlg
            If CheckGetSampleID(i) = True Then  '3ÇÃè„Ç∆ãÙêîçs
                .SetText 4, i, gtSprWfMap(i).blockp
                .SetText 5, i, gtSprWfMap(i).KESSYOUP
                .SetText 6, i, gtSprWfMap(i).BLOCKSEQ
                If vNukisiFlg = 2 Then
                    .SetText 5, i + 1, gtSprWfMap(i + 1).KESSYOUP
                    .SetText 4, i + 1, gtSprWfMap(i + 1).blockp
                    .SetText 6, i + 1, gtSprWfMap(i + 1).BLOCKSEQ
                    .SetText 7, i + 1, gtSprWfMap(i).wfnum
                End If
                If gtSprWfMap(i).SAMPLEID = vbNullString Then
                    .SetText 10, i, gsWF_SMPL_JOINT
                    .SetText 8, i, gsWF_STA_NORMAL
                    '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                    .SetText 44, i, gtSprWfMap(i).SAMPLEID
                    If blKirikaeflg = True And intSmpkbn <> 1 Then  'ã§í ÇÃÇ∆Ç´ÇæÇØ
                        If i Mod 2 = 1 Then
                            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                            .SetText 38, i, gtSprWfMap(i - 1).SAMPLEID
                        Else
                            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                            .SetText 38, i, gtSprWfMap(i + 1).SAMPLEID
                        End If
                    End If
                Else
                    .SetText 10, i, Right(gtSprWfMap(i).LOTID, 3) & "-" & Right(gtSprWfMap(i).SAMPLEID, 4)
                    '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                    .SetText 38, i, gtSprWfMap(i).SAMPLEID
                    .SetText 8, i, gsWF_STA_SIJI
                    .SetText 44, i, gtSprWfMap(i).SAMPLEID
                End If

                blKensaLock = False 'é¿ë™ÇÉ`ÉFÉbÉN
                '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                For intLoopCnt = 11 To 35
                '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                    If intLoopCnt <> 27 And intLoopCnt <> 35 Then
                        .col = intLoopCnt
                        .row = i + 1
                        If .text = "1" Then 'é¿ë™Ç™Ç†ÇÈ
                            blKensaLock = True
                        End If
                    End If
                Next
                If blKirikaeflg = True And intSmpkbn <> 1 Then       'ã§í 
                    .SetText 10, i + 1, gsWF_SMPL_JOINT
                    '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                    .SetText 38, i + 1, gtSprWfMap(i + 1).SAMPLEID
                    .SetText 8, i + 1, gsWF_STA_NORMAL
                Else
                    If blKensaLock = False Then  'é¿ë™ñ≥Çµ
                        .SetText 10, i + 1, Right(gtSprWfMap(i + 1).LOTID, 3) & "-" & Right(gtSprWfMap(i + 1).SAMPLEID, 4)
                        '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                        .SetText 38, i + 1, gtSprWfMap(i + 1).SAMPLEID
                        .SetText 44, i + 1, gtSprWfMap(i + 1).SAMPLEID
                        .SetText 8, i + 1, gsWF_STA_SIJI
                    Else                            'é¿ë™óLÇË
                        .SetText 10, i + 1, Right(gtSprWfMap(i + 1).LOTID, 3) & "-" & Right(gtSprWfMap(i + 1).SAMPLEID, 4)
                        '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                        .SetText 38, i + 1, gtSprWfMap(i + 1).SAMPLEID
                        .SetText 44, i + 1, gtSprWfMap(i + 1).SAMPLEID
                        .SetText 8, i + 1, gsWF_STA_SIJI
                    End If
                End If
            End If
        Next

        'WFñáêîåvéZ
        For i = 1 To .MaxRows - 2
            If i Mod 2 = 0 Then

                'ñáêî0ñáÇÕÉuÉçÉbÉNã´äE Ç‹ÇΩÇÕZïiî‘
                If CInt(Trim$(gtSprWfMap(i).wfnum)) = 0 Then
                    '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                    .GetText 43, i - 1, vAllNum
                    .GetText 7, intCngBlpnt, vWFNumber
                    If vWFNumber <> "" Then
                        If Not (CInt(vWFNumber) = 0) Then
                            .SetText 7, intCngBlpnt, CInt(vAllNum) - CInt(Trim$(gtSprWfMap(i).wfnum))
                        End If
                    End If
                    intCngBlpnt = i + 1
                ElseIf Trim$(gtSprWfMap(i).hinban) = "Z" Then
                    .SetText 7, i - 1, "0"
                    '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                    .GetText 43, i - 1, vAllNum
                    If i < .MaxRows Then
                        .GetText 1, i + 1, vBlockId
                        If vBlockId = "" And vAllNum <> "" Then
                            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                            .SetText 43, i + 1, CInt(vAllNum) - CInt(Trim$(gtSprWfMap(i).wfnum))
                            If (i = .MaxRows - 2) Then
                                .SetText 7, intCngBlpnt, CInt(vAllNum) - CInt(Trim$(gtSprWfMap(i).wfnum))
                                intCngBlpnt = i + 1
                            End If

                        Else
                            .GetText 7, intCngBlpnt, vWFNumber
                            If Not (CInt(vWFNumber) = 0) Then
                                .SetText 7, intCngBlpnt, CInt(vAllNum) - CInt(Trim$(gtSprWfMap(i).wfnum))
                                intCngBlpnt = i + 1
                            End If
                        End If
                    Else
                        If Not (CInt(vWFNumber) = 0) Then
                            .SetText 7, intCngBlpnt, CInt(vAllNum) - CInt(Trim$(gtSprWfMap(i).wfnum))
                            intCngBlpnt = i + 1
                        End If
                   End If
                Else
                    If CInt(gtSprWfMap(i).wfnum) <> 0 Then  'ÉuÉçÉbÉNã´äEÇ÷ÇÃëŒèà
                        .SetText 7, i + 1, Trim$(gtSprWfMap(i).wfnum)
                    End If
                    '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                    .GetText 43, i - 1, vAllNum
                    .GetText 1, intCngBlpnt, vBlockId
                    If vBlockId = Mid(gtSprWfMap(i).LOTID, 10, 3) Then
                        If (gtSprWfMap(i).LOTID) = (gtSprWfMap(i + 1).LOTID) Then 'ÉuÉçÉbÉNã´äEÇ÷ÇÃëŒèà    'upd 2003/04/28 hitec)matsumoto WFèÛë‘0ÇÃéûÇÕÅAÉuÉçÉbÉNã´ÇæÇØÇ≈Ç»Ç¢
                            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                            .SetText 43, i + 1, CInt(vAllNum) - CInt(Trim$(gtSprWfMap(i).wfnum))
                        End If

                        If (i = .MaxRows - 2) Then
                            .SetText 7, intCngBlpnt, CInt(vAllNum) - CInt(Trim$(gtSprWfMap(i).wfnum))
                        End If

                    Else
                        .GetText 6, intCngBlpnt, vWFNumber
                        If Not (CInt(vWFNumber) = 0) Then
                            .SetText 7, intCngBlpnt, CInt(vAllNum) - CInt(Trim$(gtSprWfMap(i).wfnum))
                            intCngBlpnt = i + 1
                        End If
                    End If
                End If
            Else
                If 0 = i Mod 2 Then
                    If i < .MaxRows Then
                        .GetText 1, i + 1, vBlockId
                        If vBlockId <> "" Then
                            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                            .GetText 43, i - 1, vAllNum
                            .SetText 7, intCngBlpnt, vAllNum
                            intCngBlpnt = i + 1
                        End If

                        'éüÇÃÉuÉçÉbÉNÇÃåãèªà íuÇÕå„ÇÃÉfÅ[É^ìWäJÇÃÇΩÇﬂìØÇ∂à íuÇ…ÇµÇƒÇ®Ç≠Åi4/23åªç›Åj
                        .GetText 5, i, vGetIngotP
                        .SetText 5, i + 1, vGetIngotP
                    End If
                End If
            End If
        Next i

        m = .MaxRows
        For i = 1 To m
                If i = 1 Then
                .GetText 2, i, vGetHinban
                If vGetHinban = "Z" Then
                    .col = 8
                    .row = i + 1
                    .text = "åáóé"
                End If
            ElseIf i = .MaxRows Then
                .GetText 2, i - 1, vGetHinban
                If vGetHinban = "Z" Then
                    .col = 8
                    .row = i - 1
                    .text = "åáóé"
                End If
            Else
                If i Mod 2 = 1 And i <> .MaxRows - 1 And i <> .MaxRows Then
                    .GetText 2, i, vGetHinban
                    If vGetHinban = "Z" Then
                        .col = 8
                        .row = i
                        .text = "åáóé"
                        .row = i + 1
                        .text = "åáóé"
                    End If
                End If
            End If
        Next i

        vKeturaku = "åáóé"
        vNull = ""
        vZERO = "0"
        For i = 1 To .MaxRows Step 2
            .GetText 2, i, vGetHinban
            If vGetHinban = "Z" Then
                .SetText 7, i, vZERO
                '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                .GetText 37, i, vNukisiFlg
                If vNukisiFlg <> "1" Then
                    .SetText 10, i, vNull
                    For intLoopCnt = i To 1 Step -1  'add 2003/06/11 hitec)matsumoto zïiî‘éûÇÃÉTÉìÉvÉãIDÉoÉbÉNÉAÉbÉv
                        If intLoopCnt = 1 Then
                            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                            .GetText 38, intLoopCnt, vGetToSamp
                            .SetText 38, i, vGetToSamp

                            Exit For
                        End If
                        If intLoopCnt Mod 2 = 0 Then
                            .GetText 2, intLoopCnt - 1, vGetToHin
                        Else
                            .GetText 2, intLoopCnt, vGetToHin
                        End If
                        If vGetToHin <> "Z" Then
                            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                            .GetText 38, intLoopCnt, vGetToSamp
                            .SetText 38, i, vGetToSamp
                            Exit For
                        End If
                    Next
                End If

                ' 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)kondoh
                .GetText 37, i + 1, vNukisiFlg

                If vNukisiFlg <> "1" Then
                    .SetText 10, i + 1, vNull
                    For intLoopCnt = i + 1 To .MaxRows Step 1  'add 2003/06/11 hitec)matsumoto zïiî‘éûÇÃÉTÉìÉvÉãIDÉoÉbÉNÉAÉbÉv
                        If intLoopCnt = .MaxRows Then
                            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                            .GetText 38, intLoopCnt, vGetToSamp
'                            .SetText 38, i, vGetToSamp
                            .SetText 38, i + 1, vGetToSamp      '08/08/25 ooba
                            Exit For
                        End If
                        If intLoopCnt Mod 2 = 0 Then
                            .GetText 2, intLoopCnt - 1, vGetToHin
                        Else
                            .GetText 2, intLoopCnt, vGetToHin
                        End If
                        If vGetToHin <> "Z" Then
                            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                            .GetText 38, intLoopCnt, vGetToSamp
                            .SetText 38, i + 1, vGetToSamp
                            Exit For
                        End If
                    Next
                End If

                'èâä˙ï\é¶çsÅi1,ç≈èIçsÅjÇÃÉTÉìÉvÉãIDÇÕè¡ãéÇµÇ»Ç¢
                .col = 10
                .row = i
                .ForeColor = &H8080FF
                .col = 10
                .row = i + 1
                .ForeColor = &H8080FF
                ''Zïiî‘Çê‘ï\é¶Ç…Ç∑ÇÈ
                .row = i + 1

                '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                .col = 37
                sNukishi = .text

                If sNukishi <> "3" Then
                    .BlockMode = True
                    .row = i
                    .row2 = i + 1
                    .col = 4
                    .col2 = .MaxCols
                    .backColor = &H8080FF
                    .BlockMode = False
                    .col = 4
                    .row = i + 1
                    .backColor = vbWhite

                Else
                    .row = i
                    .row2 = i + 1
                    .col = 4
                    .col2 = .MaxCols
                    .BlockMode = True
                    .backColor = &H8080FF
                    .BlockMode = False

                End If
               ''åüç∏çÄñ⁄ÇÃï∂éöÇê‘Ç…Ç∑ÇÈ
                .row = i
                .row2 = i + 1
                .col = 11
                .col2 = .MaxCols
                .BlockMode = True
                .ForeColor = &H8080FF
                .backColor = &H8080FF
                .BlockMode = False
                If i = .MaxRows - 1 Then
                    .row = i
                    .row2 = i + 1
                    .col = 4
                    .col2 = 4
                    .BlockMode = True
                    .backColor = &H8080FF
                    .BlockMode = False
                End If
            Else
                .row = i
                .col = 3
                .backColor = &H80FF80

                'ÉuÉçÉbÉNÇoÇÃóÒ
                .row = i + 1
                '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                .col = 37
                sNukishi = .text

                If sNukishi <> "3" Then
                    .BlockMode = True
                    .row = i
                    .row2 = i + 1
                    .col = 4
                    .col2 = 4
                    .backColor = &H80FF80
                    .BlockMode = False
                    .col = 4
                    .row = i + 1
                    .backColor = vbWhite

                Else
                    .row = i
                    .row2 = i + 1
                    .col = 4
                    .col2 = 4
                    .BlockMode = True
                    .backColor = &H80FF80
                    .BlockMode = False
                End If

                .row = i
                .row2 = i + 1
                .col = 5
                .col2 = 10
                .BlockMode = True
                .backColor = &H80FF80
                .ForeColor = vbBlack
                .BlockMode = False
            End If
        Next i

        i = 1
        intRowNum = .MaxRows
        .row = intRowNum - 1  '' 04/24 å„ì°
        .col = 2
        sHinban = .text
        If (intRowNum = .MaxRows) And (sHinban = "Z") Then
            .row = intRowNum
            .col = 4
            .col2 = 10
            .BlockMode = True
            .backColor = &H8080FF
'            .ForeColor = vbBlack   '05/28
            .BlockMode = False
        ElseIf (intRowNum = .MaxRows) Then
            .row = intRowNum
            .col = 4
            .col2 = 10
            .BlockMode = True
            .backColor = &H80FF80
            .ForeColor = vbBlack
            .BlockMode = False
        End If

'Å´í«â¡ îMèàóùîªífèàóùí«â¡ 2006/02/15 SMPêŒêÏ ---------------
        'WFèÛë‘Ç™"åãâ "ÇÃèÍçáÅAÉTÉìÉvÉãIDÇÃîwåiêFÇêÖêFÇ…Ç∑ÇÈ
        For i = 1 To .MaxRows Step 2
            'ïiî‘éÊìæ
            .GetText 2, i, vGetHinban
            If vGetHinban <> vbNullString And vGetHinban <> "Z" And vGetHinban <> "G" Then
                .col = 10
                'WFèÛë‘éÊìæ(TOP)
                .GetText 8, i, vTemp
                'WFèÛë‘Ç™"åãâ "ÇÃèÍçáÅAÉTÉìÉvÉãIDÇÃîwåiêFÇêÖêFÇ…Ç∑ÇÈ
                If Trim(vTemp) = gsWF_STA_SIJI_KEKKA Then
                    .row = i
                    .backColor = f_cmbc039_3.Label12.backColor
                End If
                'WFèÛë‘éÊìæ(BOTTOM)
                .GetText 8, i + 1, vTemp
                'WFèÛë‘Ç™"åãâ "ÇÃèÍçáÅAÉTÉìÉvÉãIDÇÃîwåiêFÇêÖêFÇ…Ç∑ÇÈ
                If Trim(vTemp) = gsWF_STA_SIJI_KEKKA Then
                    .row = i + 1
                    .backColor = f_cmbc039_3.Label12.backColor
                End If

            End If
        Next i
'Å™í«â¡ îMèàóùîªífèàóùí«â¡ 2006/02/15 SMPêŒêÏ ---------------

        'add start 2003/04/28 hitec)matsumotoÅ@åüçıÇµÇƒÇ´ÇΩWFÇ™èdï°ÇµÇƒÇ¢Ç»Ç¢Ç©É`ÉFÉbÉNÇµÅAèdï°ÇµÇƒÇ¢ÇÈèÍçáÇÕÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇï\é¶Ç≥ÇπÇÈ----------------------
        For i = 2 To .MaxRows Step 2    'ãÙêîçsÇÃÇ›ÉãÅ[ÉvÇ∑ÇÈ
            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
            .GetText 37, i, vNukisiFlg
            If vNukisiFlg = "2" Then                'í«â¡î≤ééçsÇÃèÍçá
                .GetText 6, i, vGetUpWf    'É}ÉbÉvà íuéÊìæ
                '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                .GetText 39, i, vGetUpBlk  'ÉuÉçÉbÉNID
                .GetText 8, i - 1, vGetWfNum   'ñáêî
                If vGetWfNum = 0 Then
                    If vGetHinban <> "Z" Then
                        cmdF(12).Enabled = False
                        bSampFlag = False
                        lblMsg.Caption = GetMsgStr("EWFM2") '03/06/06 å„ì°
                        Exit Function
                    End If
                End If

                For intWfChkLoop = i + 2 To .MaxRows Step 2   'èdï°É`ÉFÉbÉNÇÃÇΩÇﬂÅAéüÇÃãÙêîçsÇåüçı
                    '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                    .GetText 37, intWfChkLoop, vNukisiFlg

                    If vNukisiFlg = "2" Then                'í«â¡î≤ééçsÇÃèÍçá
                        .GetText 6, intWfChkLoop, vGetDnWf    'É}ÉbÉvà íuéÊìæ
                        '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                        .GetText 39, intWfChkLoop, vGetDnBlk  'ÉuÉçÉbÉNID
                        If Trim(vGetUpWf) = Trim(vGetDnWf) Then     'É}ÉbÉvà íuÇ™ÅAç≈èâÇ…éÊìæÇµÇΩílÇ∆ìØÇ∂ÇæÇ¡ÇΩÇÁÅA
                            If vGetUpBlk = vGetDnBlk Then
                                cmdF(12).Enabled = False
                                bSampFlag = False
                                lblMsg.Caption = GetMsgStr("EWFM3") '03/06/06
                                Exit Function
                            End If
                        End If
                    End If
                Next
            End If
        Next

        .ReDraw = True

        ''WarpîªíËëŒâû
        'WFœØÃﬂè„ÇÃïiî‘èÓïÒéÊìæ
        ReDim tMapHin(0)
        m = 0
        For i = 1 To .MaxRows Step 2
            'ïiî‘éÊìæ
            .GetText 2, i, vGetHinban
            If vGetHinban <> vbNullString And vGetHinban <> "Z" And vGetHinban <> "G" Then
                If GetLastHinban(CStr(vGetHinban), udtFullHinban) = FUNCTION_RETURN_FAILURE Then
                    lblMsg.Caption = "ïiî‘ì¸óÕÉGÉâÅ["
                    Exit Function
                End If

                m = m + 1
                ReDim Preserve tMapHin(m)

                tMapHin(m).HIN = udtFullHinban

                'Ãﬁ€Ø∏IDéÊìæ
                '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                .GetText 39, i, vBlockId
                tMapHin(m).BLOCKID = left(txtCryNum.text, 9) & CStr(vBlockId)
                'Ãﬁ€Ø∏SEQéÊìæ
                .GetText 6, i, vTemp
                .GetText 6, i + 1, vTemp1
                tMapHin(m).BLKSEQ_S = CInt(vTemp)
                tMapHin(m).BLKSEQ_E = CInt(vTemp1)
                'êUë÷¡™Ø∏Ã◊∏ﬁ
                tMapHin(m).WARPFLG = False
                tMapHin(m).KAKUFLG = False

                'Add Start 2011/04/25 SMPK Miyata
                tMapHin(m).XTALCS = txtCryNum.text      'åãèªî‘çÜ
                .GetText 5, i, vTemp
                .GetText 5, i + 1, vTemp1
                tMapHin(m).INPOSCS_S = CInt(vTemp)      'åãèªì‡à íu(Start)
                tMapHin(m).INPOSCS_E = CInt(vTemp1)     'åãèªì‡à íu(End)
                'Add End   2011/04/25 SMPK Miyata

            End If
        Next i
    End With

    '' êªïiédólÇÃï\é¶
    cmdF(12).Enabled = False
    bSampFlag = False

    'ç\ë¢ëÃÇÇ∆Ç¡ÇƒÇ®Ç≠
    ReDim tblksn(UBound(tblNukishi))
    tblKns() = tblNukishi()

    ReDim tWafk(UBound(gtSprWfMap))
    tWafk() = gtSprWfMap()

    ReDim udtTmpWafSmp(UBound(tblWafInd))
    For i = 1 To UBound(tblWafInd)
        udtTmpWafSmp(i).INPOSCW = tblWafInd(i).INGOTPOS
        udtTmpWafSmp(i).HINBCW = tblWafInd(i).HINDN.hinban
        udtTmpWafSmp(i).REVNUMCW = tblWafInd(i).HINDN.mnorevno
        udtTmpWafSmp(i).FACTORYCW = tblWafInd(i).HINDN.factory
        udtTmpWafSmp(i).OPECW = tblWafInd(i).HINDN.opecond
    Next

    ReDim tWarpMeasG(0)
    ReDim tKakuMeasG(0)
    'Add Start 2011/07/21 SMPK Nakamura åãèªñ åXÇ´É`ÉFÉbÉNí«â¡ëŒâû
    ReDim tKakuXMeasG(0)
    ReDim tKakuYMeasG(0)
    'Add End 2011/07/21 SMPK Nakamura åãèªñ åXÇ´É`ÉFÉbÉNí«â¡ëŒâû

    'êUë÷É`ÉFÉbÉN-------start iida 2003/09/29 Å®à⁄ìÆ cmdF_Click
    If fnc_Furikae_Check = False Then
         bSampFlag = False

        'êUë÷¡™Ø∏ñ¢é¿é{ïiî‘ÇÃWarp/çáê¨äpìxîªíËÅ@06/01/12 ooba START ========================>
        For i = 1 To UBound(tMapHin)
            'êUë÷¡™Ø∏é¿é{ÇÃämîF
            tMapHinG = tMapHin(i)
            For j = 1 To 2
                If Not (tMapHinG.WARPFLG And tMapHinG.KAKUFLG) Then
                    m = funChkFurikaeShiyou("CW763", txtKSXLID.text, tMapHinG.HIN, _
                                            tMapHinG.HIN, intModori, sMsg, _
                                            typ_b, typ_CType, 0)

                    tMapHin(i).WARPFLG = tMapHinG.WARPFLG   'WarpêUë÷¡™Ø∏Ã◊∏ﬁæØƒ
                    tMapHin(i).KAKUFLG = tMapHinG.KAKUFLG   'çáê¨äpìxêUë÷¡™Ø∏Ã◊∏ﬁæØƒ
                End If
            Next j
        Next i

        'Warp/çáê¨äpìxèÓïÒï\é¶
        Call WarpKakuDisp(Me)
        Exit Function
    End If

    '>>>>> MOD 2012/09/07 SETsw Marushita 10ñáñ¢ñûó¨ìÆëŒâû
    ' ÉuÉçÉbÉNï€è·É`ÉFÉbÉNèàóù(ÉvÉçÉVÅ[ÉWÉÉÉTÉCÉYÉGÉâÅ[ÇÃÇΩÇﬂï™äÑ)
    If fnc_BlockHCheck() < 0 Then
        Exit Function
    End If

    'Warp/çáê¨äpìxèÓïÒï\é¶Å@06/01/12 ooba
    Call WarpKakuDisp(Me)
    
    'êUë÷É`ÉFÉbÉN-------end iida 2003/09/29
    cmdF(12).Enabled = True
    bSampFlag = True

    sub_DispSample = True
End Function

'*******************************************************************************
'*    ä÷êîñº        : sub_BlockHCheck
'*
'*    èàóùäTóv      : ÉuÉçÉbÉNï€è·É`ÉFÉbÉN
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*
'*    ñﬂÇËíl        : Integer
'*
'*******************************************************************************
Private Function fnc_BlockHCheck() As Integer
    Dim i            As Integer
    Dim m            As Integer
    Dim flg          As Integer
    Dim now_bid      As String
    Dim old_bid      As String
    Dim vGetHinban   As Variant
    Dim vGetWfNum    As Variant
    Dim iJCnt1       As Integer
    Dim sC_Flg       As String   'É`ÉFÉbÉNÉtÉâÉOéÊìæópÅ@Å@Å@2012/09/07 SETsw Marushita
    Dim sC_Mai       As String   'É`ÉFÉbÉNWaferñáêîéÊìæóp Å@2012/09/07 SETsw Marushita
    Dim iRtn         As Integer  'èàóùämîFópÅ@2012/09/07 SETsw Marushita

    fnc_BlockHCheck = -1

'** Ãﬁ€Ø∏ï€è·¡™Ø∏ *********************** 2008.03.20 aoyagi *************
    With sprExamine

    flg = 0
    old_bid = ""

    'ëSçsêîÉãÅ[Év-------
    For i = 1 To .MaxRows
        .row = i
        .col = 39
        now_bid = .text
        If now_bid <> old_bid Then  'ÉuÉçÉbÉNIDïœÇËñ⁄---
            old_bid = now_bid
            'óLå¯Ç»SXLêî--------
            iJCnt1 = sub_DispSample_SCnt02(i)
            If iJCnt1 <= 1 Then   '1Ãﬁ€Ø∏=1SXLÇ»ÇÃÇ≈Ãﬁ€Ø∏ï€è·¡™Ø∏ÇµÇ»Ç¢
                '1Ãﬁ€Ø∏ÇÃçsêî--------
                iJCnt1 = sub_DispSample_SCnt03(i)
                i = i + iJCnt1 - 1  'éüÇ…êiÇﬂÇÈ
            Else
                'Ãﬁ€Ø∏ï€è·¡™Ø∏-------
                iJCnt1 = sub_DispSample_SCnt01(i)
                If iJCnt1 <= 0 Then  'ª›ÃﬂŸÇ»Çµ
                    flg = 1          'NG
                    Exit For
                End If
            End If
        Else
            'Ãﬁ€Ø∏ï€è·¡™Ø∏-------
            iJCnt1 = sub_DispSample_SCnt01(i)
            If iJCnt1 <= 0 Then  'ª›ÃﬂŸÇ»Çµ
                flg = 1          'NG
                Exit For
            End If
        End If
    Next i
    
    If flg = 1 Then
        lblMsg.Caption = "WFÉTÉìÉvÉãñ≥ÇµÇÕï™äÑÇ≈Ç´Ç‹ÇπÇÒÅB"
        cmdF(12).Enabled = False
    
        Exit Function
    End If
    
    '>>>>> ADD 2012/09/07 SETsw Marushita 10ñáñ¢ñûó¨ìÆëŒâû
    'É`ÉFÉbÉNÉtÉâÉOÇÃéÊìæ(1:ÉGÉâÅ[É`ÉFÉbÉNÅA2:ÉAÉâÅ[ÉÄÉ`ÉFÉbÉN)
    sC_Flg = GetCodeA9Field("X", "19", "NUKIMAI", "KCODE01A9")
    'É`ÉFÉbÉNWaferñáêîÇÃéÊìæ
    sC_Mai = GetCodeA9Field("X", "19", "NUKIMAI", "CTR01A9")
    '<<<<< ADD 2012/09/07 SETsw Marushita 10ñáñ¢ñûó¨ìÆëŒâû

'Cng Start 2012/02/23 Y.Hitomi
    'édä|ïiWafer10ñáîªíË
    m = .MaxRows
    For i = 1 To m
        .row = i
        .col = 7

        If i Mod 2 <> 0 Then
            .GetText 2, i, vGetHinban
            .GetText 7, i, vGetWfNum
            If vGetHinban <> vbNullString And vGetHinban <> "Z" And vGetHinban <> "G" Then
                .backColor = &H80FF80
                '>>>>> Mod 2012/09/07 SETsw Marushita 10ñáà»â∫ÉçÉbÉgó¨ìÆëŒâû
                'WaferñáêîÇÃÉ`ÉFÉbÉN
                If CInt(vGetWfNum) < CInt(sC_Mai) Then
                    If Trim(sC_Flg) = "1" Then
                        .backColor = &H8080FF
                        lblMsg.Caption = "WaferñáêîÇ™" & sC_Mai & "ñáñ¢ñûÇÃà◊ÅAé¿çsÇ≈Ç´Ç‹ÇπÇÒÅB"
                        Exit Function
                    Else
                        If Trim(sC_Flg) = "2" Then
                            iRtn = MsgBox("WaferñáêîÇ™" & sC_Mai & "ñáñ¢ñûÇ≈Ç∑ÅBé¿çsÇµÇƒÇ‡ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", vbQuestion + vbOKCancel, "ämîF")
                            'ÉLÉÉÉìÉZÉãÇÃèÍçáÇÕèàóùÇî≤ÇØÇÈ
                            If iRtn = vbCancel Then
                                Exit Function
                            End If
                        End If
                    End If
                End If
                'If CInt(vGetWfNum) < 11 Then
                '    .backColor = &H8080FF
                '    lblMsg.Caption = "WaferñáêîÇ™10ñáà»â∫ÇÃà◊ÅAé¿çsÇ≈Ç´Ç‹ÇπÇÒÅB"
                '    Exit Function
                'End If
                '<<<<< Mod 2012/09/07 SETsw Marushita 10ñáà»â∫ÉçÉbÉgó¨ìÆëŒâû
            End If
        End If
    Next
'''Add Start SPK 2009/09/14
'    'édä|ïiWafer0ñáîªíË
'    m = .MaxRows
'    For i = 1 To m
'        .row = i
'        .col = 7
'
'        If i Mod 2 <> 0 Then
'            .GetText 2, i, vGetHinban
'            .GetText 7, i, vGetWfNum
'            If vGetHinban <> vbNullString And vGetHinban <> "Z" And vGetHinban <> "G" Then
'                .backColor = &H80FF80
'                If CInt(vGetWfNum) = 0 Then
'                    .backColor = &H8080FF
'
'                    lblMsg.Caption = "WaferñáêîÇ™0ñáÇ≈Ç∑ÅI"
'                    Exit Function
'                End If
'            End If
'        End If
'    Next
''Add End SPK 2009/09/14
'Cng End 2012/02/23 Y.Hitomi
    
    End With

    fnc_BlockHCheck = 0

End Function

'*******************************************************************************
'*    ä÷êîñº        : sub_Hanei
'*
'*    èàóùäTóv      : 1.îΩâfêÑíËÉ`ÉFÉbÉN
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    iÅ@Å@       ,I  ,Integer  ,Row
'*                    jÅ@Å@       ,I  ,Integer  ,tblWafind
'*                    iÅ@Å@       ,I  ,Integer  ,ZãÊï™
'*                    pSird1stBlockSetÅ@,IO  ,Boolean  ,åãèªì‡SIRDª›ÃﬂŸéwé¶ê›íËóLñ≥[True:ê›íËçœÇ›ÅAFalse:ñ¢ê›íË]
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP START  ( ﬂ◊“∞¿í«â¡ÅFåãèªì‡SIRDª›ÃﬂŸéwé¶ê›íËóLñ≥)
'''Private Sub sub_Hanei(i As Integer, j As Integer, intZkbn As Integer)
Private Sub sub_Hanei(i As Integer, j As Integer, intZkbn As Integer, ByRef pSird1stBlockSet As Boolean)
'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP END
    'iÅFRowÅAj:tblWafind
    Dim k               As Integer 'åüç∏
    Dim sKensa()        As String
    Dim sSampID()       As String
    Dim sJflg()         As String
    Dim s               As Integer
    Dim sTB             As String
    Dim udtFullHinban   As tFullHinban
    Dim sGetSmpllid1    As String
    Dim sGetSmpllid2    As String 'îΩâfÇ»ÇÃÇ≈égópÇµÇ»Ç¢
    Dim intHanSuiKBN    As Integer
    Dim intSmpPos       As Integer
    Dim intModori       As Integer
    Dim sKRs            As String
    Dim sKensac()       As String
    Dim sGetHS          As String        'ï€èÿÃ◊∏ﬁÅ@05/02/18 ooba
    Dim sGDChk          As String
    Dim sHanFlg         As String
    
    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD START
    Dim SirdYN          As Boolean          'SIRDª›ÃﬂŸéwé¶óLñ≥[True:èÓïÒÇ†ÇËÅAFalse:èÓïÒñ≥Çµ]
    Dim sirdSmpID       As String           'åüç∏çœÇ›ª›ÃﬂŸIDÅiSIRDópÅj<TBCMJ022>
    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD END


    sGetHS = "0"        '05/02/24 ooba

    'GD◊≤›¡™Ø∏ã@î\í«â¡
    sHanFlg = "0"

    CrySampleID = CpyCrySmpl        'åãèªé¿ê—à¯åpÇ¨√ﬁ∞¿ÇÃ∫Àﬂ∞Å@05/06/13 ooba

    For s = i To i + 1 'Row
'--- 2006/08/15 Add ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh
        ReDim sKensa(21)
        ReDim sKensac(21)
        ReDim sSampID(21)
        ReDim sJflg(21)

        With tblWafInd(j)
            sKensac(0) = .SMP.CRYINDOI
            sKensac(1) = .SMP.CRYINDB1
            sKensac(2) = .SMP.CRYINDB2
            sKensac(3) = .SMP.CRYINDB3
            sKensac(4) = .SMP.CRYINDL1
            sKensac(5) = .SMP.CRYINDL2
            sKensac(6) = .SMP.CRYINDL3
            sKensac(7) = .SMP.CRYINDL4
            sKensac(8) = .SMP.CRYINDDS
            sKensac(9) = .SMP.CRYINDDZ
            sKensac(10) = .SMP.CRYINDSP
            sKensac(11) = .SMP.CRYINDD1
            sKensac(12) = .SMP.CRYINDD2
            sKensac(13) = .SMP.CRYINDD3
            sKensac(14) = .SMP.CRYINDAO       'écë∂é_ëfí«â¡Å@03/12/15 ooba
            sKensac(15) = .SMP.CRYINDGD       'GDí«â¡Å@05/02/18 ooba

            '--- 2006/08/15 Add ÉGÉsêÊçsï]âøí«â¡ëŒâû
            sKensac(16) = .SMP.EPIINDB1
            sKensac(17) = .SMP.EPIINDB2
            sKensac(18) = .SMP.EPIINDB3
            sKensac(19) = .SMP.EPIINDL1
            sKensac(20) = .SMP.EPIINDL2
            sKensac(21) = .SMP.EPIINDL3

            'GD◊≤›¡™Ø∏ã@î\í«â¡ 2007/06/25 M.Kaga START   ---
            sGDChk = .SMP.CRYINDGD2
        End With

        If s = i Then
        'ïiî‘Ç™ZÇÃÇ∆Ç´
            If Trim(tblWafInd(j).HINUP.hinban) = "Z" Then
                sTB = "B"
                udtFullHinban.hinban = tblWafInd(j).HINDN.hinban
                udtFullHinban.factory = tblWafInd(j).HINDN.factory
                udtFullHinban.mnorevno = tblWafInd(j).HINDN.mnorevno
                udtFullHinban.opecond = tblWafInd(j).HINDN.opecond
                sprExamine.col = 5
                sprExamine.row = i - 1
                intSmpPos = val(sprExamine.text)
            Else
                sTB = "B"
                udtFullHinban.factory = tblWafInd(j).HINUP.factory 'ïiî‘
                udtFullHinban.hinban = tblWafInd(j).HINUP.hinban
                udtFullHinban.mnorevno = tblWafInd(j).HINUP.mnorevno
                udtFullHinban.opecond = tblWafInd(j).HINUP.opecond
'               sprExamine.GetText 5, i, intSmpPos
                sprExamine.col = 5
                sprExamine.row = i
                intSmpPos = val(sprExamine.text)
            End If
        Else
            If Trim(tblWafInd(j).HINDN.hinban) = "Z" Then
                sTB = "T"
                udtFullHinban.hinban = tblWafInd(j).HINUP.hinban
                udtFullHinban.factory = tblWafInd(j).HINUP.factory
                udtFullHinban.mnorevno = tblWafInd(j).HINUP.mnorevno
                udtFullHinban.opecond = tblWafInd(j).HINUP.opecond
                sprExamine.col = 5
                sprExamine.row = i
                intSmpPos = val(sprExamine.text)
            Else
                sTB = "T"  'TBãÊï™
                udtFullHinban.factory = tblWafInd(j).HINDN.factory
                udtFullHinban.hinban = tblWafInd(j).HINDN.hinban
                udtFullHinban.mnorevno = tblWafInd(j).HINDN.mnorevno
                udtFullHinban.opecond = tblWafInd(j).HINDN.opecond
'               sprExamine.GetText 5, i + 1, intSmpPos
                sprExamine.col = 5
                sprExamine.row = i
                intSmpPos = val(sprExamine.text)
            End If
        End If
        '1ÅFDÅA2ÅFUÅA3UD 2çsï™ÇÃîªíËÇÇ∑ÇÈ

        '--- 2006/08/15 Add ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh
        For k = 0 To 21
            Select Case sKensac(k)
                Case 1
                    If s = i Then
                        sKensa(k) = "0"
                    Else
                        sKensa(k) = "1"
                    End If
                Case 2
                    If s = i Then
                        sKensa(k) = "1"
                    Else
                        sKensa(k) = "0"
                    End If
                Case 3, 4
                    If s = i Then
                        sKensa(k) = "1"
                    Else
                        sKensa(k) = "1"
                    End If
                Case 0, ""
                    If s = i Then
                        sKensa(k) = ""
                    Else
                        sKensa(k) = ""
                    End If
            End Select

            If sKensac(k) <> "0" Then
                If (intZkbn = 3 And s = i) Or (intZkbn = 1 And s = i) Or (intZkbn = 4 And s = i + 1) Or (intZkbn = 2 And s = i + 1) Then   'ZÇ™è„ÇÃÇ∆Ç´Ç∆â∫ÇÃÇ∆Ç´ÇÕîΩâf:2Çì¸ÇÍÇÈã§í ä÷êîåƒÇŒÇ»Ç¢
                   sKensa(k) = "2"
                   sJflg(k) = "1"
                   sGetHS = "0"     '05/02/18 ooba
                ElseIf sKensa(k) <> "0" Then
                    'GDí«â¡Ç…ÇÊÇÈïœçXÅ@05/02/17 ooba
                    If k >= 14 Then k = k + 2
                    'îΩâfêÑíËã§í ä÷êîÇÃåƒÇ—èoÇµ
                    intModori = funChkWfHanSui(tblSXL.SXLID, sTB, tblSXL.CRYNUM, udtFullHinban, intSmpPos, k + 2, SIngotP, EIngotP, intHanSuiKBN, sGetSmpllid1, sGetSmpllid2, sGetHS)
                    'ñﬂÇËíl(0:ê≥èÌèIóπ(îΩâf/êÑíËOK)ÅA1ÅFê≥èÌèIóπ(îΩâf/êÑíËNG)ÅA-1ÅFì¸óÕà¯êîílÉGÉâÅ[ÅA-2ÅFÇªÇÍà»äOÇÃÉGÉâÅ[)
                    If k >= 16 Then k = k - 2

                    If intModori = 1 Then  'îΩâfNG
                        sKensa(k) = "1"
                        sSampID(k) = tblNukishi(s).REPSMPLIDCW 'åüç∏çÄñ⁄Ç…ë„ï\ÉTÉìÉvÉãIDÇì¸ÇÍÇÈ
                        sGetHS = "0"    '05/02/18 ooba
                    ElseIf intModori = 0 Then
                        If intHanSuiKBN = 0 Then 'îΩâfOK
                            sKensa(k) = "2"
                            sSampID(k) = sGetSmpllid1
                            sJflg(k) = "1"
                        End If
                    ElseIf intModori <= -1 Then
                        'err
    '                   Exit For
                    End If
                End If
            End If

            With sprExamine
                .row = s
'--- 2006/08/15 Add ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh
                If k < 15 Then .col = 12 + k Else .col = 13 + k
                'GD◊≤›¡™Ø∏ÇÃèÍçá
                If .col = 28 Then
                    If sHanFlg = "0" Then
                        'è„ïiî‘Ç…é¿ë™
                        If Trim(sGDChk) = "2" Then
                            sKensa(k) = "1"
                        ElseIf Trim(sGDChk) = "1" Then
                            sKensa(k) = "2"
                        End If
                        .text = sKensa(k) 'åãâ ÇÉXÉvÉåÉbÉhÇ…ÉZÉbÉg
                        sHanFlg = "1"
                    ElseIf sHanFlg = "1" Then
                        'â∫ïiî‘Ç…é¿ë™
                        If Trim(sGDChk) = "2" Then
                            sKensa(k) = "2"
                        ElseIf Trim(sGDChk) = "1" Then
                            sKensa(k) = "1"
                        End If
                        .text = sKensa(k) 'åãâ ÇÉXÉvÉåÉbÉhÇ…ÉZÉbÉg
                        sHanFlg = "0"
                    End If
                Else
                    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP START
'''                    .text = sKensa(k) 'åãâ ÇÉXÉvÉåÉbÉhÇ…ÉZÉbÉg
                    
                    If .col = 19 Then
                        '<< SIRD >>
                        If (sKensa(k) = "1") Or (sKensa(k) = "2") Or (sKensa(k) = "3") Or (sKensa(k) = "4") Then
                            '<TBCMJ022åüçı>
                            Call fncGetSirdSample(Trim(txtCryNum.text), SirdYN, sirdSmpID)
                            If SirdYN Then
                                '<åãèªì‡ 1st block à»ç~>
                                .text = "2"          'ã§óL
                                pSird1stBlockSet = True             'åãèªì‡SIRDª›ÃﬂŸéwé¶ê›íËóLñ≥[True:ê›íËçœÇ›ÅAFalse:ñ¢ê›íË]
                            Else
                                If Not pSird1stBlockSet Then
                                    '<åãèªì‡ 1st block>
                                    .text = "1"      'éÊìæ
                                    pSird1stBlockSet = True         'åãèªì‡SIRDª›ÃﬂŸéwé¶ê›íËóLñ≥[True:ê›íËçœÇ›ÅAFalse:ñ¢ê›íË]
                                Else
                                    '<åãèªì‡ 1st block à»ç~>
                                    .text = "2"      'ã§óL
                                    pSird1stBlockSet = True         'åãèªì‡SIRDª›ÃﬂŸéwé¶ê›íËóLñ≥[True:ê›íËçœÇ›ÅAFalse:ñ¢ê›íË]
                                End If
                            End If
                        Else
'''                            .text = sKensa(k) 'åãâ ÇÉXÉvÉåÉbÉhÇ…ÉZÉbÉg
                            .text = ""
                        End If
                    Else
                        .text = sKensa(k) 'åãâ ÇÉXÉvÉåÉbÉhÇ…ÉZÉbÉg
                    End If
                    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP END
                End If
            End With

            With tblNukishi(s) 'ç\ë¢ëÃÇ…ÉZÉbÉg
                Select Case k
                    Case 0                                      '--------Oi
                    .WFINDOICW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDOICW = sSampID(k)
                    .WFRESOICW = sJflg(k)
                    Case 1
                    .WFINDB1CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDB1CW = sSampID(k)
                    .WFRESB1CW = sJflg(k)
                    Case 2
                    .WFINDB2CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDB2CW = sSampID(k)
                    .WFRESB2CW = sJflg(k)
                    Case 3
                    .WFINDB3CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDB3CW = sSampID(k)
                    .WFRESB3CW = sJflg(k)
                    Case 4
                    .WFINDL1CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDL1CW = sSampID(k)
                    .WFRESL1CW = sJflg(k)
                    Case 5
                    .WFINDL2CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDL2CW = sSampID(k)
                    .WFRESL2CW = sJflg(k)
                    Case 6
                    .WFINDL3CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDL3CW = sSampID(k)
                    .WFRESL3CW = sJflg(k)
                    Case 7
                    .WFINDL4CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDL4CW = sSampID(k)
                    .WFRESL4CW = sJflg(k)
                    Case 8
                    .WFINDDSCW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDDSCW = sSampID(k)
                    .WFRESDSCW = sJflg(k)
                    Case 9
                    .WFINDDZCW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDDZCW = sSampID(k)
                    .WFRESDZCW = sJflg(k)
                    Case 10
                    .WFINDSPCW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDSPCW = sSampID(k)
                    .WFRESSPCW = sJflg(k)
                    Case 11
                    .WFINDDO1CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDDO1CW = sSampID(k)
                    .WFRESDO1CW = sJflg(k)
                    Case 12
                    .WFINDDO2CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDDO2CW = sSampID(k)
                    .WFRESDO2CW = sJflg(k)
                    Case 13                                         '-------DO3
                    .WFINDDO3CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDDO3CW = sSampID(k)
                    .WFRESDO3CW = sJflg(k)
                    Case 14     ''écë∂é_ëfí«â¡Å@03/12/15 ooba
                    .WFINDAOICW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .WFSMPLIDAOICW = sSampID(k)
                    .WFRESAOICW = sJflg(k)
                    Case 15     'GDí«â¡Å@05/02/18 ooba
                    .WFINDGDCW = IIf(sKensa(k) = "", "0", sKensa(k))    'èÛë‘FLG(GD)
'                    .WFSMPLIDGDCW = sSampID(k)                          'ª›ÃﬂŸID(GD)
                    '09/07/22 Y.Hitomi GDª›ÃﬂŸéwé¶ïsãÔçáëŒâûÅ®GDÇÃÇ›,WFª›ÃﬂŸéwé¶óLÇËéû,åãèªª›ÃﬂŸîΩâfNG
                        If .WFINDGDCW <> "1" Then
                            .WFSMPLIDGDCW = sSampID(k)                 'ª›ÃﬂŸID(GD)
                        ElseIf .WFINDGDCW = "1" Then
                            .WFSMPLIDGDCW = tblNukishi(s).REPSMPLIDCW 'åüç∏çÄñ⁄Ç…ë„ï\ÉTÉìÉvÉãIDÇì¸ÇÍÇÈ
                        End If
                    
                    .WFRESGDCW = sJflg(k)                               'é¿ê—FLG(GD)
                    .WFHSGDCW = sGetHS                                  'ï€èÿFLG(GD)

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    Case 16
                    .EPINDB1CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .EPSMPLIDB1CW = sSampID(k)
                    .EPRESB1CW = sJflg(k)
                    Case 17
                    .EPINDB2CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .EPSMPLIDB2CW = sSampID(k)
                    .EPRESB2CW = sJflg(k)
                    Case 18
                    .EPINDB3CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .EPSMPLIDB3CW = sSampID(k)
                    .EPRESB3CW = sJflg(k)
                    Case 19
                    .EPINDL1CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .EPSMPLIDL1CW = sSampID(k)
                    .EPRESL1CW = sJflg(k)
                    Case 20
                    .EPINDL2CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .EPSMPLIDL2CW = sSampID(k)
                    .EPRESL2CW = sJflg(k)
                    Case 21
                    .EPINDL3CW = IIf(sKensa(k) = "", "0", sKensa(k))
                    .EPSMPLIDL3CW = sSampID(k)
                    .EPRESL3CW = sJflg(k)
                End Select
            End With
        Next k
    Next s
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_Betu
'*
'*    èàóùäTóv      : 1.ã§óLï ÇÃèÍçáÇÃê›íËÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    iÅ@Å@       ,I  ,Integer  ,Row
'*                    jÅ@Å@       ,I  ,Integer  ,tblWafind
'*                    sKensa1Å@ ,I  ,String   ,åüç∏óp
'*                    sKensa2Å@ ,I  ,StringÅ@ ,åüç∏óp
'*                    intZkbnÅ@Å@ ,I  ,Integer  ,ZãÊï™
'*                    blnhflgÅ@Å@ ,I  ,Boolean  ,îΩâfîªíËÉtÉâÉO
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_Betu(i As Integer, j As Integer, skensa1() As String, skensa2() As String, intZkbn As Integer, blnhflg As Boolean)
    Dim k           As Integer 'åüç∏
'--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh
    Dim sKensa(24)  As String
    Dim k1          As Integer
    Dim k2          As Integer

    With tblWafInd(j)
        sKensa(0) = .SMP.CRYINDRS
        sKensa(1) = .SMP.CRYINDOI
        sKensa(2) = .SMP.CRYINDB1
        sKensa(3) = .SMP.CRYINDB2
        sKensa(4) = .SMP.CRYINDB3
        sKensa(5) = .SMP.CRYINDL1
        sKensa(6) = .SMP.CRYINDL2
        sKensa(7) = .SMP.CRYINDL3
        sKensa(8) = .SMP.CRYINDL4
        sKensa(9) = .SMP.CRYINDDS
        sKensa(10) = .SMP.CRYINDDZ
        sKensa(11) = .SMP.CRYINDSP
        sKensa(12) = .SMP.CRYINDD1
        sKensa(13) = .SMP.CRYINDD2
        sKensa(14) = .SMP.CRYINDD3
        sKensa(15) = .SMP.CRYINDAO        'écë∂é_ëfí«â¡Å@03/12/15 ooba
        sKensa(16) = .SMP.CRYOTHER1
        sKensa(17) = .SMP.CRYOTHER2
        sKensa(18) = .SMP.CRYINDGD        'GDí«â¡Å@05/02/18 ooba

        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
        sKensa(19) = .SMP.EPIINDB1        'BMD1E
        sKensa(20) = .SMP.EPIINDB2        'BMD2E
        sKensa(21) = .SMP.EPIINDB3        'BMD3E
        sKensa(22) = .SMP.EPIINDL1        'OSF1E
        sKensa(23) = .SMP.EPIINDL2        'OSF2E
        sKensa(24) = .SMP.EPIINDL3        'OSF3E
    End With

'--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh
    For k = 0 To 24
        Select Case sKensa(k)
            Case 1 'Top
               If intZkbn = 2 Or intZkbn = 4 Then
                   'â∫ïiî‘ZÇ»ÇÁåüç∏Ç»ÇµÅ@04/04/14 ooba
                   skensa1(k) = "0"
                   skensa2(k) = "0"
               Else
                   skensa1(k) = "0"
                   skensa2(k) = "1"
                   k2 = k2 + 1
               End If
            Case 2 'Tail
               If intZkbn = 1 Or intZkbn = 3 Then
                   'è„ïiî‘ZÇ»ÇÁåüç∏Ç»ÇµÅ@04/04/14 ooba
                   skensa1(k) = "0"
                   skensa2(k) = "0"
               Else
                   skensa1(k) = "1"
                   skensa2(k) = "0"
                   k1 = k1 + 1
               End If
            Case 3 'ã§í 
               If intZkbn = 1 Then
                   skensa1(k) = "2"
                   skensa2(k) = "1"
               ElseIf intZkbn = 2 Then
                   skensa1(k) = "1"
                   skensa2(k) = "2"
               ElseIf intZkbn = 3 Then
                   skensa1(k) = "2"
                   skensa2(k) = "1"
               ElseIf intZkbn = 4 Then
                   skensa1(k) = "1"
                   skensa2(k) = "2"
               Else
                   skensa1(k) = "1"
                   skensa2(k) = "1"
               End If

            'Å´í«â¡ îMèàóùîªífèàóùí«â¡ 2006/02/15 SMPêŒêÏ ---------------
            '2.1.2 ã§óLÉ`ÉFÉbÉNí«â¡
            'íÔçRÇÃcase 4 ÇÃéûÇÕñ≥èåèÇ≈é¿ê—ÇóßÇƒÇÈ
            Case 4 'óºï˚åüç∏(ï )
'Cng Start 2011/11/02 Y.Hitomi
                ''íÔçRÇÃéûÇæÇØèàóùÇçsÇ§
                If k = 0 Then
                    If intZkbn = 1 Then
                        skensa1(k) = "2"
                        skensa2(k) = "1"
                    ElseIf intZkbn = 2 Then
                        skensa1(k) = "1"
                        skensa2(k) = "2"
                    ElseIf intZkbn = 3 Then
                        skensa1(k) = "2"
                        skensa2(k) = "1"
                    ElseIf intZkbn = 4 Then
                        skensa1(k) = "1"
                        skensa2(k) = "2"
                    Else
                    skensa1(k) = "1"
                    skensa2(k) = "1"
                End If
                End If
'                If k = 0 Then
'                    skensa1(k) = "1"
'                    skensa2(k) = "1"
'                End If
'Cng End 2011/11/02 Y.Hitomi
            'Å™í«â¡ îMèàóùîªífèàóùí«â¡ 2006/02/15 SMPêŒêÏ ---------------
            Case 0  'ñ≥Çµ
               skensa1(k) = ""
               skensa2(k) = ""
        End Select
    Next k

    If intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢Ç∆Ç´
        blnhflg = False

        'ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh
        For k = 0 To 24
            If skensa1(k) = "1" And skensa2(k) = "1" Then 'ã§óLÇÃÇ∆Ç´ÇæÇØ2Ç…Ç∑ÇÈ
                If k1 < k2 Then 'åüç∏çÄñ⁄Ç™è≠Ç»Ç¢ÇŸÇ§Ç™îΩâfÇ∆Ç»ÇÈ
                    skensa1(k) = IIf(skensa1(k) = "1", "2", skensa1(k))
                    blnhflg = False 'è„ã§óL

                Else
                    skensa2(k) = IIf(skensa2(k) = "1", "2", skensa2(k))
                    blnhflg = True  'â∫ã§óL
                End If
            End If
        Next k
    End If
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_Paint
'*
'*    èàóùäTóv      : 1.åüç∏çÄñ⁄ÇÃÉXÉvÉåÉbÉhÇÃèÛë‘Ç…ÇÊÇËêFï™ÇØÇÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    intRow        ,I  ,Integer  ,Row
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_Paint(intRow As Integer)
    Dim sTval       As String
    Dim sKval       As String
    Dim intKensa    As Integer
    Dim i           As Integer 'óÒ
    Dim k           As Integer 'çs---2çsÇêFìhÇÈ

    'ÉXÉvÉåÉbÉhÇÃåüç∏çÄñ⁄(""ÅFîíÅA1ÅFçïÅA2ÅFâ©êF)
    intKensa = 0
        With sprExamine
        For k = intRow - 1 To intRow
            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
            For i = 11 To 35
                If i <> 28 Then
                    .col = i
                    .row = k
                    sKval = .text
                    If sKval = "" Then
                        .backColor = vbWhite
                        .ForeColor = vbWhite
                        .Lock = True
                    ElseIf sKval = "1" Then
                        .backColor = vbBlack
                        .ForeColor = vbBlack
                        .Lock = True
                    ElseIf sKval = "2" Then
                        'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP START
'''                        .backColor = vbYellow
'''                        .ForeColor = vbYellow
'''                        .Lock = False
                        
                        If i = 19 Then
                            '<SIRD>ÅEÅEÅE∏ﬁ⁄≤
                            .backColor = COLOR_CryJitsu
                            .ForeColor = COLOR_CryJitsu
                            .Lock = False
                        Else
                            '<SIRDà»äO>ÅEÅEÅEâ©êF
                            .backColor = vbYellow
                            .ForeColor = vbYellow
                            .Lock = False
                        End If
                        'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP START
                    End If
                End If
            Next i

            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
            .col = 28
            .row = k
            sKval = .text
            'éwé¶ñ≥ÇÃèÍçáÇÕîíï\é¶
            If sKval = "" Then
                .backColor = vbWhite
                .ForeColor = vbWhite
                .Lock = True
            'é¿ë™ÇÃèÍçáÇÕçïï\é¶
            ElseIf sKval = "1" Then
                .backColor = vbBlack
                .ForeColor = vbBlack
                .Lock = True
            'îΩâfÇÃèÍçáÇÕâ©êFï\é¶
            ElseIf sKval = "2" And tblNukishi(k).WFHSGDCW <> "1" Then
                .backColor = vbYellow
                .ForeColor = vbYellow
                .Lock = False
            'åãèªé¿ê—ÇÃèÍçáÇÕ∏ﬁ⁄∞ï\é¶
            ElseIf sKval = "2" And tblNukishi(k).WFHSGDCW = "1" Then
                .backColor = COLOR_CryJitsu
                .ForeColor = COLOR_CryJitsu
                .Lock = False
            End If
        Next k
    End With
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : sub_Jitu
'*
'*    èàóùäTóv      : 1.åüç∏ÇçsÇ¡ÇƒîΩâfÇ∆Ç»Ç¡ÇΩçsÇ≈é¿ÉfÅ[É^Ç™1Ç¬Ç‡Ç»Ç¢çsÇíTÇ∑(ã§óLÇÕèúÇ≠)
'*                      (é¿ÉfÅ[É^Ç™ë∂ç›Ç∑ÇÈÇ©ÇÃÉ`ÉFÉbÉNÇÇ∑ÇÈ)
'*                    2.é¿ÉfÅ[É^ñ≥ÇµÇÃèÍçáÇªÇÃçsÇÃíÔçR(Rs)Ç…é¿ÉfÅ[É^ÇóßÇƒÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^       ,ê‡ñæ
'*                    k           ,I  ,Integer  ,Row
'*                    blKirikaeflg ,I  ,Boolean  ,êÿë÷Ç¶ÉtÉâÉO
'*                    blnhflgÅ@Å@ ,I  ,Boolean  ,îΩâfîªíËÉtÉâÉO
'*                    intZkbnÅ@Å@ ,I  ,Integer  ,ZãÊï™
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sub_Jitu(k As Integer, blKirikaeflg As Boolean, blnhflg As Boolean, intZkbn As Integer)
    Dim sTval       As String
    Dim sKval       As String
    Dim intKensa    As Integer
    Dim j           As Integer
    Dim i           As Integer
    Dim blTwoFlg    As Boolean     '2004/01/29 ooba

    'á@åüç∏ÇçsÇ¡ÇƒîΩâfÇ∆Ç»Ç¡ÇΩçsÇ≈é¿ÉfÅ[É^Ç™1Ç¬Ç‡Ç»Ç¢çsÇíTÇ∑(ã§óLÇÕèúÇ≠)
    'áAé¿ÉfÅ[É^ñ≥ÇµÇÃèÍçáÇªÇÃçsÇÃíÔçR(Rs)Ç…é¿ÉfÅ[É^ÇóßÇƒÇÈ
    'é¿ÉfÅ[É^ÇÃÉ`ÉFÉbÉN-------start iida 2003/09/12

    For j = k - 1 To k
        blTwoFlg = False     '2004/01/29 ooba

        If blKirikaeflg = True Then
            If j = k Then
                Exit For
            End If
        'ZÇÃÇ∆Ç´
        ElseIf intZkbn = 3 Or intZkbn = 4 Or intZkbn = 1 Or intZkbn = 2 Then
            If (intZkbn = 3 And j = k - 1) Or (intZkbn = 1 And j = k - 1) Then
                j = j + 1  'è„Ç…é¿ë™óßÇƒÇ»Ç¢
            ElseIf (intZkbn = 4 And j = k) Or (intZkbn = 4 And j = k) Then
                Exit For   'â∫Ç…é¿ë™óßÇƒÇ»Ç¢
            End If
        'ã§óLï ÇÃÇ∆Ç´
        Else
            intKensa = 0    '2004/01/28 ooba
            blTwoFlg = True  '2004/01/29 ooba
        End If

        With sprExamine
            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                For i = 11 To 35
                    .col = i
                    .row = j
                    sKval = .text

                    If sKval = "1" Then   'åüç∏ñ≥Çµ(é¿ë™)
                        intKensa = intKensa + 1
                    End If
                    '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                    If i = 35 Then
                        If intKensa = 0 Then
                            .col = 11
                            sKval = .text             '2004/01/28 ooba
                            If sKval = "2" Then       '2004/01/28 ooba
                                .text = "1"
                                .Lock = True
                                'ÉTÉìÉvÉãIDÇë„ï\ÉTÉìÉvÉãIDÇ…Ç∑ÇÈ
'                                tblNukishi(k).WFSMPLIDRS1CW = tblNukishi(k).REPSMPLIDCW
                                If blTwoFlg = False Then
                                    If j = k Then
                                        tblNukishi(j).WFSMPLIDRSCW = tblNukishi(j).REPSMPLIDCW
                                        tblNukishi(k - 1).WFSMPLIDRSCW = tblNukishi(j).REPSMPLIDCW
                                    Else
                                        tblNukishi(j).WFSMPLIDRSCW = tblNukishi(j).REPSMPLIDCW
                                        tblNukishi(k).WFSMPLIDRSCW = tblNukishi(j).REPSMPLIDCW
                                    End If
                                Else
                                    '2çs¡™Ø∏Ç∑ÇÈèÍçáÇÕäYìñçsÇÃÇ›ïœçXÅ@2004/01/29 ooba
                                    tblNukishi(j).WFSMPLIDRSCW = tblNukishi(j).REPSMPLIDCW
                                End If
                            End If
                        End If
                    End If
                Next i
'            End If
        End With
    Next j
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_DrawImage
'*
'*    èàóùäTóv      : 1.åãèªÉCÉÅÅ[ÉWÉEÉBÉìÉhÉEÇï\é¶Ç∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*                    Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_DrawImage()
    Dim Xl              As c_cmzcXl
    Dim m               As Integer
    Dim i               As Integer
    Dim blAns           As Boolean
    Dim vTemp           As Variant
    Dim vTemp1          As Variant
    Dim vTemp2          As String
    Dim c0              As Long
    Dim udtFullHinban   As tFullHinban
    Dim vNukisiFlg      As Variant
    Dim intCnt          As Integer
    Dim intRow          As Integer
    Dim intRowNum       As Integer
    Dim sHinban         As String
    Dim sNukishi        As String
    Dim intCol          As Integer
    Dim sNum            As String
    Dim vGetHinban      As Variant

    lblMsg.Caption = ""

'>>>>> ì™8Ççwì¸íPåãèªàµÇ¢ÇµÇ»Ç¢ 2007/10/10 SETsw kubota ---------------------
'    If Mid(tblSXL.CRYNUM, 1, 1) = "8" Then
'        '' ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇï\é¶Ç∑ÇÈ
'        lblMsg.Caption = GetMsgStr("EKDE1")
''        Screen.MousePointer = 1
'        Exit Sub
'    End If
'<<<<< ì™8Ççwì¸íPåãèªàµÇ¢ÇµÇ»Ç¢ 2007/10/10 SETsw kubota ---------------------

'2001/08/30 S.Sano Start
    '' ïiî‘É`ÉFÉbÉN
    For c0 = 1 To sprExamine.MaxRows
        '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
        sprExamine.GetText 37, c0, vNukisiFlg

        '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
        sprExamine.GetText 40, c0, vTemp
        vTemp = Trim(vTemp)
        If Trim$(vTemp) <> "Z" Then
            Select Case ChkString(vTemp, 8, 8)
            Case CHK_NG, CHK_NULL
                lblMsg.Caption = GetMsgStr(EHIN1)
                Exit Sub
            End Select
            vTemp2 = vTemp
            If GetLastHinban(vTemp2, udtFullHinban) = FUNCTION_RETURN_FAILURE Then
                lblMsg.Caption = GetMsgStr(EHIN0)
                Exit Sub
            End If
        End If
    Next c0

    '' î≤éééwé¶àÍóóÇÃì¸óÕÉ`ÉFÉbÉNÅiWFœØÃﬂÅj
    If fnc_CheckDataWfmap() = FUNCTION_RETURN_FAILURE Then
        Exit Sub
    End If

'2003/03/18 hitec)matsumoto ïiî‘ÇÃÇmÇtÇkÇkÉ`ÉFÉbÉNÇÕÇ∑Ç≈Ç…ÇÕÇ∂Ç¢ÇƒÇ†ÇÈÅBÇ±Ç±Ç≈ÇmÇtÇkÇkÇÇÕÇ∂Ç¢ÇƒÇ¢ÇÈÇÃÇÕÅAâÊñ ÉåÉCÉAÉEÉgïœçXÇ…ÇÊÇËÅAÇmÇtÇkÇkçs(ïiî‘ì¸óÕïsâ¬)Ç™ë∂ç›Ç∑ÇÈÇΩÇﬂÅB
'2001/08/30 S.Sano Start
    '' ïiî‘É`ÉFÉbÉN
    For c0 = 1 To sprExamine.MaxRows - 1
        '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
        sprExamine.GetText 37, c0, vNukisiFlg
        If (vNukisiFlg = "1") Or (vNukisiFlg = "2") Then    'î≤ééçsÇæÇ¡ÇΩÇÁ
            If (vNukisiFlg = "1") Then
                '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
                sprExamine.GetText 37, c0 + 1, vNukisiFlg
                If vNukisiFlg = "1" Then
                    'í«â¡î≤ééÇÃñ≥Ç¢çsÇÕâΩÇ‡ÇµÇ»Ç¢
                ElseIf vNukisiFlg = "2" Then
                    sprExamine.GetText 2, c0, vTemp             'äeçsÇ…ïiî‘Ç™èëÇ¢ÇƒÇ†ÇÈÇÌÇØÇ≈ÇÕÇ»Ç¢ÅAÉ_É~Å[Ç≈ÇÕëSçsÇ…ïiî‘ÇéùÇ¡ÇƒÇ¢ÇÈÇÃÇ≈ÇªÇÍÇå©ÇÈ
                    vTemp = Trim(vTemp)
                    If Trim$(vTemp) <> "Z" Then
                        Select Case ChkString(vTemp, 8, 8)
                        Case CHK_NG, CHK_NULL
                            lblMsg.Caption = GetMsgStr(EHIN1)
                            Exit Sub
                        End Select
                        vTemp2 = vTemp
                        If GetLastHinban(vTemp2, udtFullHinban) = FUNCTION_RETURN_FAILURE Then
                            lblMsg.Caption = GetMsgStr(EHIN0)
                            Exit Sub
                        End If
                    End If
                End If
            Else
                sprExamine.GetText 2, c0 + 1, vTemp
                vTemp = Trim(vTemp)
                If Trim$(vTemp) <> "Z" Then
                    Select Case ChkString(vTemp, 8, 8)
                    Case CHK_NG, CHK_NULL
                        lblMsg.Caption = GetMsgStr(EHIN1)
                        Exit Sub
                    End Select
                    vTemp2 = vTemp
                    If GetLastHinban(vTemp2, udtFullHinban) = FUNCTION_RETURN_FAILURE Then
                        lblMsg.Caption = GetMsgStr(EHIN0)
                        Exit Sub
                    End If
                End If
            End If
        End If
    Next c0

    '' åãèªÉNÉâÉXÇ©ÇÁÉuÉçÉbÉNèÓïÒÇéÊìæÇ∑ÇÈÇΩÇﬂÇ…Getxlä÷êîåƒÇ—èoÇµ
    Set Xl = GetXl(tblSXL.CRYNUM, "f_cmbc039_3")

    With Xl
        Call sub_MakeTBCME042
        '' çƒî≤ééà íu
        m = UBound(tblWafInd) - 1
        For i = 1 To m
            '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SAMPO)sekine
            sprExamine.GetText 37, i, vNukisiFlg
            If i = 1 Then
                blAns = sprExamine.GetText(2, i, vTemp)
                Xl.WfSmps(CStr(tblSXL.WFSMP(1).INPOSCW) & tblSXL.WFSMP(1).SMPKBNCW).hinban = Trim(vTemp)
            Else
                .AddWfSample tblWafInd(i).INGOTPOS, tblWafInd(i).HINDN.hinban
            End If
        Next i
        .GenerateSxl SIngotP, EIngotP
    End With

    '' åãèªê}Çï`âÊÇ∑ÇÈ
    f_cmzc003a.Draw Xl  '' åãèªÇÃèÓïÒÇï`âÊÇ∑ÇÈ
    f_cmzc003a.Show     '' åãèªê}ÉEÉBÉìÉhÉEÇï\é¶Ç∑ÇÈ
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_InitData
'*
'*    èàóùäTóv      : 1.ÉfÅ[É^èâä˙ê›íË
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*                    Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_InitData()

    Dim Blk     As c_cmzcBlk
    Dim blFlag  As Boolean
    Dim intSP   As Integer
    Dim intEP   As Integer
    Dim intSBP  As Integer
    Dim intEBP  As Integer
    Dim m       As Integer
    Dim i       As Integer

    '' ëOâÊñ Ç©ÇÁÇÃÉfÅ[É^éÛÇØéÊÇË
    tblTotal = typ_CType
    tblSXL = typ_CType.typ_Param

    '' ëŒè€ÉuÉçÉbÉNIDï\é¶ópÇÃç\ë¢ëÃÇéÊìæÇ∑ÇÈ
    '' çsë}ì¸ÇµÇΩç€ÇÃÉuÉçÉbÉNIDÇÃëIëÉRÉìÉ{É{ÉbÉNÉXÇ…égópÇ∑ÇÈ
    Set orgXl = GetXl(tblSXL.CRYNUM, Me.Name)

    '' åãèªÉNÉâÉXÇ©ÇÁÉuÉçÉbÉNì‡óeÇéÊìæÇµÅASXLÇÃëŒè€ÉuÉçÉbÉNÇ©Çîªï 
    m = orgXl.Blks.COUNT
    ReDim SxlIntoBlock(m)
    i = 0
    For Each Blk In orgXl.Blks
        intSP = tblSXL.INGOTPOS
        intEP = intSP + tblSXL.COUNT
        intSBP = Blk.INGOTPOS
        intEBP = intSBP + Blk.LENGTH
        blFlag = False

        '' ÉuÉçÉbÉNÇ™SXLÇÃíÜÇ…äÆëSÇ…ä‹Ç‹ÇÍÇƒÇ¢ÇÈèÍçá
        If intSP <= intSBP And intEP >= intEBP Then
            blFlag = True
        '' ÉuÉçÉbÉNÇ™SXLÇÃäJénà íuÇÊÇËè„Ç…Ç†ÇËÅAÇ©Ç¬èIí[à íuÇÊÇËÇ‡í∑Ç¢èÍçá
        ElseIf intSP >= intSBP And intEP <= intEBP Then
            blFlag = True
        '' ÉuÉçÉbÉNÇ™àÍïîSXLÇ…Ç©Ç©Ç¡ÇƒÇ¢ÇÈèÍçá
        '' (ÉuÉçÉbÉNÇ™è„ë§ÅBÇΩÇæÇµÉuÉçÉbÉNÇÃèIí[Ç∆SXLÇÃäJénà íuÇ™àÍívÇµÇ»Ç¢Ç±Ç∆)
        ElseIf intSP > intSBP And intSP < intEBP And intSP <> intEBP Then
            blFlag = True
        '' ÉuÉçÉbÉNÇ™àÍïîSXLÇ…Ç©Ç©Ç¡ÇƒÇ¢ÇÈèÍçá
        '' (ÉuÉçÉbÉNÇ™â∫ë§ÅBÇΩÇæÇµSXLÇÃèIí[Ç∆ÉuÉçÉbÉNÇÃäJénà íuÇ™àÍívÇµÇ»Ç¢Ç±Ç∆)
        ElseIf intSP < intSBP And intEP > intSBP And intEP <> intSBP Then
            blFlag = True
        End If
        If blFlag = True Then
            i = i + 1
            SxlIntoBlock(i).SORTID = Right(Blk.BLOCKID, 3)
            SxlIntoBlock(i).FULLID = Blk.BLOCKID
        End If
    Next
    ReDim Preserve SxlIntoBlock(i)

    '' ÉuÉçÉbÉNä«óùÉeÅ[ÉuÉãÇç\ë¢ëÃÇ…ê›íË
    m = orgXl.Blks.COUNT
    ReDim tblBlkInf(m)
    i = 1
    For Each Blk In orgXl.Blks
        With tblBlkInf(i)
            .COF.TOPSMPLPOS = Blk.INGOTPOS
            .LENGTH = Blk.LENGTH
            .REALLEN = Blk.REALLEN
            .BLOCKID = Blk.BLOCKID
            .KRPROCCD = Blk.KRPROCCD
            .NOWPROC = Blk.NOWPROC
            .LPKRPROCCD = Blk.LPKRPROCCD
            .LASTPASS = Blk.LASTPASS
            .RSTATCLS = Blk.RSTATCLS
            .COF.BOTSMPLPOS = .COF.TOPSMPLPOS + .LENGTH
            .SAMPFLAG = False
        End With
        i = i + 1
    Next

    '' ãÊï™ÉRÅ[ÉhÇÃéÊìæ
    Call GetCodeListSC18("SC", "18", "WF", tblPrcList)
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_LoadAndDisp
'*
'*    èàóùäTóv      : 1.ÉfÅ[É^ÇÃÉçÅ[ÉhÇ∆ï\é¶
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_LoadAndDisp()

    Dim m       As Integer
    Dim n       As Integer
    Dim i       As Integer
    Dim sMsg    As String
    Dim vt      As Variant
'>>>>> add start 2011/06/30 Marushita
    Dim iMinMidCnt      As Integer       'íÜä‘î≤ééÇÃïKóvêî
    Dim iRstMidCnt      As Integer       'íÜä‘î≤ééÇÃåèêî
'<<<<< add start 2011/06/30 Marushita

    '' ëOâÊñ Ç©ÇÁà¯Ç´ìnÇ≥ÇÍÇΩílÇï\é¶Ç∑ÇÈ
    txtStaffID.text = tblTotal.StrStaffId                                   ' íSìñé“ÉRÅ[Éh
    txtJfName.text = tblTotal.strStaffName                                  ' íSìñé“ñº
    txtKSXLID.text = tblSXL.SXLID                                           ' âºSXLID
    txtCryNum.text = tblSXL.CRYNUM                                          ' ÉCÉìÉSÉbÉgID
    If sKanrenFlg = "1" Then lblKanren.Visible = True       'ä÷òAÃﬁ€Ø∏ï\é¶Å@08/01/31 ooba
    txtTopRsltR.text = toRsStr(CDbl(tblTotal.typ_y013(1, WFRES).MESDATA5))  ' Të§é¿ê—Éœ
    txtBotRsltR.text = toRsStr(CDbl(tblTotal.typ_y013(2, WFRES).MESDATA5))  ' Bë§é¿ê—Éœ

    If fnc_GetMukesaki_XSDCB(Trim(txtKSXLID.text)) = FUNCTION_RETURN_FAILURE Then
        Exit Sub
    End If

    '' èàóùéûä‘ÉZÉbÉg
    SetPresentTime lblTime

    InMaxRow = 2

    '' åãèªÇ…ä‹Ç‹ÇÍÇÈïiî‘Ç∑Ç◊ÇƒÇéÊìæ
    If GetXlHinban(tblSXL.CRYNUM, tblHinNum) = FUNCTION_RETURN_FAILURE Then
        Exit Sub
    End If

    '' ïiî‘ÇÃê›íË
    ReDim tblHinbanRs(1)
    With tblHinbanRs(1)
        .CRYNUM = tblSXL.CRYNUM
        .HIN.hinban = tblSXL.hinban
        .HIN.mnorevno = tblSXL.REVNUM
        .HIN.factory = tblSXL.factory
        .HIN.opecond = tblSXL.opecond
    End With

    '' DBÇ©ÇÁä÷òAÉfÅ[É^Çì«Ç›çûÇﬁ
    If fnc_LoadData = FUNCTION_RETURN_FAILURE Then
        Exit Sub
    End If

    '' ÉTÉìÉvÉãÇÃÇ»Ç¢SXLÇæÇ¡ÇΩèÍçáÅAâÊñ ÇÃèàóùÇÕÇ»Ç…Ç‡çsÇ¶Ç»Ç¢Ç‡ÇÃÇ∆Ç∑ÇÈ
    If Trim$(tblSXL.WFSMP(1).XTALCW) <> "" And _
       Trim$(tblSXL.WFSMP(2).XTALCW) <> "" Then
        '' î≤éééwé¶ÇÃï\é¶
        If fnc_Nukisi_LOAD_DISP = FUNCTION_RETURN_FAILURE Then
            Exit Sub
        End If

        '' êªïiédólÇÃï\é¶
        If fnc_DispHinSpec(0) = False Then
            Exit Sub
        End If

        'ïiî‘Ç1óÒí«â¡ÇµÇΩÇ±Ç∆Ç…ÇÊÇÈóÒÇÃïœçX
        With sprExamine
            m = .MaxRows
            n = .MaxCols

            '' ëŒè€SXLÇÃåãèªà íuÇï€éù
            .row = 1
            SIngotP = tblsmp(1).INGOTPOS    'ÉgÉbÉvà íu

            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
            .SetText 42, 1, tblsmp(1).INGOTPOS
'            '' ëŒè€SXLÇÃåãèªà íuÇï€éù
            .row = m
            EIngotP = tblsmp(2).INGOTPOS    'É{ÉgÉÄà íu

            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
            .SetText 42, m, tblsmp(2).INGOTPOS
        End With

        'î≤éé√ﬁ∞¿ïsê≥ï\é¶É`ÉFÉbÉN
        If fnc_ErrDispCheck(sMsg) = FUNCTION_RETURN_FAILURE Then
            lblMsg.Caption = GetMsgStr(sMsg)
            Exit Sub
        End If
'>>>>> add start 2011/06/30 Marushita
        ' íÜä‘î≤ééïiÇ©ÅH
        With sprSpec
            lblNukishi.Caption = ""
            For i = 1 To .MaxRows
                .GetText 33, i, vt
                If CStr(vt) = "1" Then
                    lblNukishi.Caption = "íÜä‘î≤éé"
                End If
            Next i
        End With
'        If typ_CType.typ_si.MSMPFLG = "1" Then
'            lblNukishi.Visible = True
'            lblNukishi.Caption = "íÜä‘î≤éé"
'            With sprSpec
'                .ColWidth(31) = 3.88      ' ï\é¶
'                .ColWidth(32) = 3.88      ' ï\é¶
'            End With
'            'íÜä‘î≤ééíPà (íÜä‘î≤ééãñóeíl(ñáêî)/(mm))
'            sprSpec.SetText 32, 1, CInt(typ_CType.typ_si.MSMPCONSTMAI)
'            'íÜä‘î≤ééïKóvêî
'            lblMSMP_SUU.Visible = True
'            'íÜä‘î≤ééÇÃïKóvêî = (SXLÇÃWFñáêî - íÜä‘î≤ééãñóeíl(ñáêî)) / íÜä‘î≤ééíPà (ñáêî)
'            iMinMidCnt = Fix((typ_CType.typ_Param.COUNT - typ_CType.typ_si.MSMPCONSTMAI) / typ_CType.typ_si.MSMPTANIMAI)
'            'É}ÉCÉiÉXÇÃèÍçáÅAÇOÇ∆Ç∑ÇÈ
'            If iMinMidCnt < 0 Then iMinMidCnt = 0
'            'íÜä‘î≤ééÇÃåèêî
'            iRstMidCnt = (UBound(typ_CType.typ_Param.WFSMP) - SxlMidl) + 1
'            lblMSMP_SUU.Caption = "î≤ééêî/ïKóvêîÅF " & _
'            CInt(iRstMidCnt) & "/" & CInt(iMinMidCnt) & " ñá"
'            'íÜä‘î≤ééíPà (ñáêî)
'            sprSpec.SetText 31, 1, CInt(typ_CType.typ_si.MSMPTANIMAI)
'        Else
'            lblNukishi.Visible = False
'            lblNukishi.Caption = ""
'            lblMSMP_SUU.Visible = False
'            With sprSpec
'                .ColWidth(31) = 0      ' îÒï\é¶
'                .ColWidth(32) = 0      ' îÒï\é¶
'            End With
'        End If
'<<<<< add end 2011/06/30 Marushita
    
    Else
        CutCntFlg = 1
        bSampFlag = True
        cmdF(12).Enabled = True
        lblMsg.Caption = GetMsgStr("SET47")
    End If
End Sub

'*******************************************************************************
'*    ä÷êîñº        : fnc_LoadData
'*
'*    èàóùäTóv      : 1.ÉeÅ[ÉuÉãÇ©ÇÁïKóvÉåÉRÅ[ÉhÇéÊìæ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Ç»Çµ
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*******************************************************************************
Private Function fnc_LoadData() As FUNCTION_RETURN

    Dim udtTmpLackWaf() As typ_LackWaf
    Dim udtTmpBlkInf()  As typ_BlkInf3
    Dim sErrMsg         As String
    Dim m               As Integer
    Dim i               As Integer

    '' DBÇ©ÇÁÉfÅ[É^Çì«Ç›çûÇﬁ
    If DBDRV_scmzc_fcmlc001d_DispSiyou(tblHinbanRs, tblsiyou, sErrMsg) = FUNCTION_RETURN_FAILURE Then
        '' ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
        lblMsg.Caption = sErrMsg
        fnc_LoadData = FUNCTION_RETURN_FAILURE
        Exit Function
    End If

    '' çƒî≤éééwé¶ÉfÅ[É^ÇÃéÊìæ
    If DBDRV_scmzc_fcmlc001d_DispSmp(tblSXL.SXLID, tblsmp, sErrMsg) = FUNCTION_RETURN_FAILURE Then
        '' ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
        lblMsg.Caption = sErrMsg
        fnc_LoadData = FUNCTION_RETURN_FAILURE
        Exit Function
    End If

    '' åáóéèÓïÒÇÃéÊìæ
    If DBDRV_scmzc_fcmlc001d_LostInfo(tblSXL.CRYNUM, udtTmpLackWaf) = FUNCTION_RETURN_FAILURE Then
        '' ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWï\é¶
        lblMsg.Caption = GetMsgStr("EAPLY") & "Y006"
        fnc_LoadData = FUNCTION_RETURN_FAILURE
        Exit Function
    End If

    m = UBound(tblBlkInf)
    ReDim udtTmpBlkInf(m)
    For i = 1 To m
        DoEvents
        udtTmpBlkInf(i).BLOCKID = tblBlkInf(i).BLOCKID
        udtTmpBlkInf(i).REALLEN = tblBlkInf(i).REALLEN
    Next i

    '' åáóéÉEÉFÉnÅ[ÉeÅ[ÉuÉãÇÃçÏê¨
    If LackMapMake(udtTmpBlkInf, udtTmpLackWaf, 1, m) = FUNCTION_RETURN_FAILURE Then
    End If

    fnc_LoadData = FUNCTION_RETURN_SUCCESS
End Function

'*******************************************************************************
'*    ä÷êîñº        : sub_SaveData
'*
'*    èàóùäTóv      : 1.ÉeÅ[ÉuÉãÇ÷ÇÃí«â¡ÅAçXêVÇçsÇ§
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_SaveData()

    Dim RET                     As FUNCTION_RETURN
    Dim sErrMsg                 As String
    Dim m                       As Integer
    Dim i                       As Integer
    Dim j                       As Integer
    Dim k                       As Integer
    Dim udtTmpWafSmp()          As typ_XSDCW
    Dim udtTmpEpMesInd()        As typ_TBCMY020
    Dim vNukisiFlg              As Variant
    Dim vGetHinban              As Variant
    Dim intLoopCnt              As Integer
    Dim intRowCnt               As Integer
    Dim sMsg                    As String
    Dim intCnt                  As Integer
    Dim udtNewData              As typImgData       '07/10/05 miyatake START ================>
    Dim udtNewData_Detail(0)    As typImgData_Detail

    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD START
    Dim SirdYN                  As Boolean      'SIRDª›ÃﬂŸéwé¶óLñ≥[True:èÓïÒÇ†ÇËÅAFalse:èÓïÒñ≥Çµ]
    Dim sirdSmpID               As String       'åüç∏çœÇ›ª›ÃﬂŸIDÅiSIRDópÅj<TBCMJ022>
    Dim sirdSmpID_Inp           As String       'î≤éééwé¶ª›ÃﬂŸIDÅiSIRDópÅj
    Dim ix                      As Integer      'SIRDª›ÃﬂŸåüçıópINDEX
    Dim iy                      As Integer      'SIRDª›ÃﬂŸåüçıópINDEX
    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD END

    udtNewData.detail = udtNewData_Detail     '07/10/05 miyatake END ==================>

    lblMsg.Caption = ""

    '' ÉTÉìÉvÉãÉ{É^ÉìÇ™âüÇ≥ÇÍÇƒÇ¢ÇÈÇ©
    If bSampFlag = False Then
        '' ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇï\é¶ÇµÇƒèàóùÇî≤ÇØÇÈ
        lblMsg.Caption = GetMsgStr("ESAMP")
        Exit Sub
    End If

    '' î≤éééwé¶àÍóóÇÃì¸óÕÉ`ÉFÉbÉNÅiWFœØÃﬂÅj
    If fnc_CheckDataWfmap() = FUNCTION_RETURN_FAILURE Then
        Exit Sub
    End If

    '' ãÊï™ÉGÉâÅ[É`ÉFÉbÉN
    If fnc_CheckHinbanZ() = FUNCTION_RETURN_FAILURE Then
        lblMsg.Caption = GetMsgStr("EHIN6")
        Exit Sub
    End If

    'å¸êÊì]ópÉ`ÉFÉbÉN
    If fnc_ChkMukesaki = FUNCTION_RETURN_FAILURE Then
        lblMsg.Caption = "å¸êÊÇ™ïœçXÇ≥ÇÍÇƒÇ¢Ç‹Ç∑ÅB"
        Exit Sub
    End If

    'î≤éé√ﬁ∞¿ïsê≥ï\é¶É`ÉFÉbÉN
    If fnc_ErrDispCheck(sMsg) = FUNCTION_RETURN_FAILURE Then
        lblMsg.Caption = GetMsgStr(sMsg)
        Exit Sub
    End If

    '' ó¨ìÆäƒéãÉ`ÉFÉbÉN add 09/03/17 SETkimizuka
    If CheckXODY4(WATCH_PROCCD_NUKISI, "", txtKSXLID.text) = False Then
        lblMsg.Caption = Y4_STOP_ERR
        Exit Sub
    End If
        
    'ï•èoãKêßÉ`ÉFÉbÉN    *2010/02/15 Kameda
    If F_HaraiKisei = False Then
        lblMsg.Caption = GetMsgStr("EREG1")
        Exit Sub
    End If
    
    If MsgBox(GetMsgStr("PIN01"), vbOKCancel, "çƒî≤éé") = vbCancel Then
        cmdF(12).Enabled = True
        Exit Sub
    End If

    ' è≥îFã@î\í«â¡Ç…ÇÊÇÈèCê≥  2007/10/05 miyatake ===================> START
    '' ÉRÉÅÉìÉgì¸óÕ
    If Me.chk_Png = 1 Then
        If f_comment.GetComment(sComment) <> vbOK Then
            Exit Sub
        End If
        Call SetForceForegroundWindow(Me.hwnd)
    End If
    DoEvents
    ' è≥îFã@î\í«â¡Ç…ÇÊÇÈèCê≥  2007/10/05 miyatake ===================> START

    '' çƒî≤ééÉeÅ[ÉuÉãÇÃçXêV
    If fnc_UpdateData() = FUNCTION_RETURN_FAILURE Then
        '' ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇï\é¶ÇµÇƒèàóùÇî≤ÇØÇÈ
        'é¿ë™¡™Ø∏¥◊∞ÇÃ“Øæ∞ºﬁï\é¶Å@2004/01/28 ooba
        If bJituChkFlg = True Then
            lblMsg.Caption = "ÉTÉìÉvÉãà íuÇ…é¿ë™Ç™Ç†ÇËÇ‹ÇπÇÒÅB"
        Else
            lblMsg.Caption = GetMsgStr("SET49")
        End If
        Exit Sub
    End If

    '' U/DÇè„â∫Ç…ï™äÑ
    Call SeparateUD

    'ÉTÉìÉvÉãä«óùÇ∆SXLä«óùÇÃèáèòÇïœÇ¶ÇΩ
    '' SXLä«óùÉeÅ[ÉuÉãç\ë¢ëÃÇÃê›íË
    Call sub_MakeTBCME042

    '' WFÉTÉìÉvÉãä«óùÉeÅ[ÉuÉãç\ë¢ëÃÇÃê›íË
    'êVÉTÉìÉvÉãä«óù(XSDCW)Ç…ïœçX
    Call sub_MakeTBCME044

    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD START
    'åüç∏çœÇ›ÇÃª›ÃﬂŸèÓïÒÇåüçı<TBCMJ022>
    If Not fncGetSirdSample(Trim(txtCryNum.text), SirdYN, sirdSmpID) Then
        MsgBox "åüç∏çœÇ›ÇÃÉTÉìÉvÉãèÓïÒÇÃåüçıÇ…é∏îsÇµÇ‹ÇµÇΩ" & vbCrLf & "( TBCMJ022 )", vbInformation + vbOKOnly
        Exit Sub
    End If

    '-------------------------------------------------------------------------
    'SIRDÇÃî≤éééwé¶Ç™óLÇÈèÍçáÅAÇªÇ±Ç©ÇÁâ∫ÇÃèÓïÒÇÕç°âÒéwé¶ÇµÇΩª›ÃﬂŸÇã§óLÇ∑ÇÈ
    'SIRDÇÃî≤éééwé¶Ç™ñ≥Ç¢èÍçáÅAä˘Ç…åüç∏çœÇ›ÇÃª›ÃﬂŸIDÇã§óLÇ∑ÇÈ
    '-------------------------------------------------------------------------
    For ix = 1 To UBound(tblWfSample)
        'SIRDÇÃÅuª›ÃﬂŸã§óLÅvÇ…Ç¬Ç¢ÇƒÅAã§óLÇ∑ÇÈª›ÃﬂŸIDÇåüçıÇµíuÇ´ä∑Ç¶ÇÈÅià íuÇ™éËëOÇ≈ç≈Ç‡ãﬂÇ¢ª›ÃﬂŸÅj
        If tblWfSample(ix).WFSMP.WFINDL4CW = "2" Then
            
            'ç°âÒìoò^èÓïÒì‡Ç…SIRDÇÃî≤éééwé¶Ç™Ç†ÇÈÇ©¡™Ø∏Ç∑ÇÈ
            sirdSmpID_Inp = ""
            For iy = 1 To ix - 1
            
                'ç°âÒìoò^èÓïÒì‡Ç…SIRDÇÃî≤éééwé¶Ç™Ç†ÇÈèÍçáÅAà íuèÓïÒÇämîF
                If tblWfSample(iy).WFSMP.WFINDL4CW = "1" Then
                
                    'î≤éééwé¶ª›ÃﬂŸÇÃà íuÇ™é©ï™ÇÊÇËéËëOÇ≈Ç†ÇÍÇŒª›ÃﬂŸIDÇKeep
                    If tblWfSample(iy).WFSMP.INPOSCW < tblWfSample(ix).WFSMP.INPOSCW Then
                        sirdSmpID_Inp = tblWfSample(iy).WFSMP.REPSMPLIDCW           'ë„ï\ÉTÉìÉvÉãID
                    End If
                End If
            Next iy
            
            If sirdSmpID_Inp = "" Then
                'ç°âÒìoò^èÓïÒì‡Ç…SIRDÇÃî≤éééwé¶Ç™ã§óLÇÊÇËéËëOÇ…ñ≥Ç¢èÍçáÅA<TBCMJ022>ÇÃåüç∏çœÇ›ª›ÃﬂŸIDÇæØƒ
                tblWfSample(ix).WFSMP.WFSMPLIDL4CW = sirdSmpID
            Else
                'ç°âÒìoò^èÓïÒì‡Ç…SIRDÇÃî≤éééwé¶Ç™ã§óLÇÊÇËéËëOÇ…óLÇÈèÍçáÅAåüçıÇµÇΩª›ÃﬂŸIDÇæØƒ
                tblWfSample(ix).WFSMP.WFSMPLIDL4CW = sirdSmpID_Inp
            End If
            
        End If
    Next ix
    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD END
    
    '' SXLämíËéwé¶ÉeÅ[ÉuÉãç\ë¢ëÃÇÃê›íË
    Call sub_MakeTBCMY007

    '' WFëççáîªíËé¿ê—ÉeÅ[ÉuÉãç\ë¢ëÃÇÃê›íË
    Call sub_MakeTBCMW005

    '' êUë÷îpä¸é¿ê—ÉeÅ[ÉuÉãç\ë¢ëÃÇÃê›íË
    Call sub_MakeTBCMW006

'' ë™íËï]âøï˚ñ@éwé¶ÉeÅ[ÉuÉãç\ë¢ëÃÇÃê›íË Start
    '' TBCME041ç\ë¢ëÃÇ…ïiî‘ê›íË(ë™íËï]âøï˚ñ@éwé¶ÉeÅ[ÉuÉãçÏê¨óp)
    m = UBound(tblHinbanRs)
    ReDim tblHinMng(m)
    For i = 1 To m
        tblHinMng(i).hinban = tblHinbanRs(i).HIN.hinban
        tblHinMng(i).REVNUM = tblHinbanRs(i).HIN.mnorevno
        tblHinMng(i).factory = tblHinbanRs(i).HIN.factory
        tblHinMng(i).opecond = tblHinbanRs(i).HIN.opecond
    Next i

    For intLoopCnt = 1 To UBound(tblWfSample())
        With f_cmbc039_3.sprExamine
            For intRowCnt = 1 To .MaxRows
                .row = intRowCnt
                .col = 10
                If left((.text), 3) = Mid(tblWfSample(intLoopCnt).WFSMP.REPSMPLIDCW, 10, 3) And _
                   Right((.text), 4) = Right(tblWfSample(intLoopCnt).WFSMP.REPSMPLIDCW, 4) Then
                    ''écë∂é_ëfåüç∏çÄñ⁄í«â¡Ç…ÇÊÇÈïœçXÅ@03/12/15 ooba
                    .col = 27
                    If .backColor = vbWhite Then
                        tblWfSample(intLoopCnt).WFSMP.WFINDOT1CW = "0"
                    Else
                        tblWfSample(intLoopCnt).WFSMP.WFINDOT1CW = IIf(.text = "", "0", .text)
                    End If

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 35
                    If .backColor = vbWhite Then
                        tblWfSample(intLoopCnt).WFSMP.WFINDOT2CW = "0"
                    Else
                        tblWfSample(intLoopCnt).WFSMP.WFINDOT2CW = IIf(.text = "", "0", .text)
                    End If
                    Exit For
                End If
            Next
        End With
    Next

    '' TBCME044ç\ë¢ëÃÇ…ê›íË(ë™íËï]âøï˚ñ@éwé¶ÉeÅ[ÉuÉãçÏê¨óp)
    m = UBound(tblWfSample)
    ReDim tblWafSmp(m)
    j = 0
    For i = 1 To m
        If Trim(tblWfSample(i).BLOCKID) <> "" Then
            j = j + 1
            tblWafSmp(j).XTALCW = tblWfSample(i).WFSMP.XTALCW
            tblWafSmp(j).INPOSCW = tblWfSample(i).WFSMP.INPOSCW
            tblWafSmp(j).SMPKBNCW = tblWfSample(i).WFSMP.SMPKBNCW
            tblWafSmp(j).REPSMPLIDCW = tblWfSample(i).WFSMP.REPSMPLIDCW
            tblWafSmp(j).HINBCW = tblWfSample(i).WFSMP.HINBCW
            tblWafSmp(j).REVNUMCW = tblWfSample(i).WFSMP.REVNUMCW
            tblWafSmp(j).FACTORYCW = tblWfSample(i).WFSMP.FACTORYCW
            tblWafSmp(j).OPECW = tblWfSample(i).WFSMP.OPECW
            tblWafSmp(j).WFINDRSCW = tblWfSample(i).WFSMP.WFINDRSCW
            tblWafSmp(j).WFINDOICW = tblWfSample(i).WFSMP.WFINDOICW
            tblWafSmp(j).WFINDB1CW = tblWfSample(i).WFSMP.WFINDB1CW
            tblWafSmp(j).WFINDB2CW = tblWfSample(i).WFSMP.WFINDB2CW
            tblWafSmp(j).WFINDB3CW = tblWfSample(i).WFSMP.WFINDB3CW
            tblWafSmp(j).WFINDL1CW = tblWfSample(i).WFSMP.WFINDL1CW
            tblWafSmp(j).WFINDL2CW = tblWfSample(i).WFSMP.WFINDL2CW
            tblWafSmp(j).WFINDL3CW = tblWfSample(i).WFSMP.WFINDL3CW
            tblWafSmp(j).WFINDL4CW = tblWfSample(i).WFSMP.WFINDL4CW
            tblWafSmp(j).WFINDDSCW = tblWfSample(i).WFSMP.WFINDDSCW
            tblWafSmp(j).WFINDDZCW = tblWfSample(i).WFSMP.WFINDDZCW
            tblWafSmp(j).WFINDSPCW = tblWfSample(i).WFSMP.WFINDSPCW
            tblWafSmp(j).WFINDDO1CW = tblWfSample(i).WFSMP.WFINDDO1CW
            tblWafSmp(j).WFINDDO2CW = tblWfSample(i).WFSMP.WFINDDO2CW
            tblWafSmp(j).WFINDDO3CW = tblWfSample(i).WFSMP.WFINDDO3CW
            tblWafSmp(j).WFINDOT1CW = tblWfSample(i).WFSMP.WFINDOT1CW       ' WFåüç∏éwé¶ÅiOT1)
            tblWafSmp(j).WFINDOT2CW = tblWfSample(i).WFSMP.WFINDOT2CW       ' WFåüç∏éwé¶ÅiOT2)
            tblWafSmp(j).WFINDAOICW = tblWfSample(i).WFSMP.WFINDAOICW       ' écë∂é_ëfí«â¡
            tblWafSmp(j).WFINDGDCW = tblWfSample(i).WFSMP.WFINDGDCW         ' GDí«â¡
            tblWafSmp(j).WFHSGDCW = tblWfSample(i).WFSMP.WFHSGDCW           ' ï€èÿFLG(GD)

            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
            tblWafSmp(j).EPINDB1CW = tblWfSample(i).WFSMP.EPINDB1CW
            tblWafSmp(j).EPINDB2CW = tblWfSample(i).WFSMP.EPINDB2CW
            tblWafSmp(j).EPINDB3CW = tblWfSample(i).WFSMP.EPINDB3CW
            tblWafSmp(j).EPINDL1CW = tblWfSample(i).WFSMP.EPINDL1CW
            tblWafSmp(j).EPINDL2CW = tblWfSample(i).WFSMP.EPINDL2CW
            tblWafSmp(j).EPINDL3CW = tblWfSample(i).WFSMP.EPINDL3CW
        End If
    Next i
    ReDim Preserve tblWafSmp(j)
    ReDim tblSokuSizi(0)

    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
    ReDim udtTmpEpMesInd(0)

    If UBound(tblWafSmp) > 0 Then
        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
        If MakeMesIndTbl(tblWfSxlMng, tblWafSmp, tblSokuSizi, udtTmpEpMesInd()) = FUNCTION_RETURN_FAILURE Then

            lblMsg.Caption = GetMsgStr("EGET2", "Y003")
            Exit Sub
        End If
    End If

    m = UBound(tblSokuSizi)
    For i = 1 To m
        tblSokuSizi(i).SENDFLAG = "0"
        tblSokuSizi(i).MUKESAKI = sCmbMukesaki
    Next i

    m = UBound(udtTmpEpMesInd)
    For i = 1 To m
        udtTmpEpMesInd(i).SENDFLAG = "0"
        udtTmpEpMesInd(i).MUKESAKI = sCmbMukesaki
    Next i


'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD START
For i = 1 To UBound(tblWafInd)
    Debug.Print "tblWafInd(" & i & ").BLOCKID=" & tblWafInd(i).BLOCKID & " : " & "tblWafInd(" & i & ").SAMPLEID=" & tblWafInd(i).SAMPLEID & " : " & "tblWafInd(" & i & ").SMP.CRYINDL4=" & tblWafInd(i).SMP.CRYINDL4
Next i
For i = 1 To UBound(tblSokuSizi)
    Debug.Print "tblSokuSizi(" & i & ").SAMPLEID=" & tblSokuSizi(i).SAMPLEID & " : " & "tblSokuSizi(" & i & ").OSITEM=" & tblSokuSizi(i).OSITEM
Next i
'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD  END

    '' DBÇ…ìoò^
    OraDB.BeginTrans

    If DBDRV_UPD_WFMap = FUNCTION_RETURN_FAILURE Then
        '' ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇï\é¶ÇµÇƒèàóùÇî≤ÇØÇÈ
        lblMsg.Caption = GetMsgStr("EWFM4") '03/06/06 å„ì°
        OraDB.Rollback
        Exit Sub
    End If

    '' WF_GDé¿ê—(TBCMJ015)çXêVèàóù
    If UBound(typ_J015_WFGDUpd) > 0 Then
        '√ﬁ∞¿êîï™UPDATE
        For intCnt = 1 To UBound(typ_J015_WFGDUpd)
            If DBDRV_scmzc_fcmlc001c_UpdGDdata(typ_J015_WFGDUpd(intCnt), txtStaffID.text) _
                                        <> FUNCTION_RETURN_SUCCESS Then
                lblMsg.Caption = GetMsgStr("EAPLY") & "J015"
                OraDB.Rollback
            Exit Sub
            End If
        Next
    End If

    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
    RET = DBDRV_scmzc_fcmlc001d_Exec(tblWfSample, tblWfSxlMng, tblWfHantei, tblHuriHai, tblSokuSizi, tblSxlKSiji, udtTmpEpMesInd(), sErrMsg)

    If RET = FUNCTION_RETURN_FAILURE Then
        '' ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇï\é¶Ç∑ÇÈ
        lblMsg.Caption = sErrMsg
        OraDB.Rollback
        Exit Sub
    End If

    '### äÓñ{èàóù ###
    Debug.Print "êVDBèëçûÇ›èàóùäJén"
    If MakeParameter(SAINUKISI_FORM) <> FUNCTION_RETURN_SUCCESS Then
        'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇÕÇ∑Ç≈Ç…èoÇµÇƒÇ†ÇÈ
        OraDB.Rollback
        Debug.Print "êVDBèëçûÇ›èàóùàŸèÌèIóπ"
        Call clearType  'ç\ë¢ëÃèâä˙âª
        EndProcess '' ÉvÉçÉZÉXèIóπ
        Exit Sub
    End If

    'óöóä«óùDBìoò^
    'ïiî‘ÇÃêUë÷ÇçsÇ¡ÇΩèÍçáóöóä«óùDBÇ…ÉfÅ[É^Çìoò^Ç∑ÇÈ
     If fnc_RirekiKanriDB_Touroku(sErrMsg) = False Then
     lblMsg.Caption = sErrMsg
        OraDB.Rollback
        Exit Sub
     End If

     Call clearType  'ç\ë¢ëÃèâä˙âª

    ' è≥îFã@î\í«â¡Ç…ÇÊÇÈèCê≥  07/10/05 miyatake ===================> START
    ''PNGÉtÉ@ÉCÉãçÏê¨
    If Me.chk_Png = 1 Then
        udtNewData.xtal = txtCryNum
        udtNewData.STAFFID = txtStaffID
        udtNewData.SXLID = txtKSXLID
        udtNewData.memo = sComment
        'çHíˆÇCC710Ç©ÇÁCW760Ç…ïœçX 2010/04/30 SETsw kubota
        'If FileCreate_PNG(PROCD_NUKISI_SIJI, udtNewData, Me, sErrMsg, Nothing, pic_Png) = False Then ' upd 09/02/04 SETmiyatake
        If FileCreate_PNG(PROCD_WFC_SAINUKISI, udtNewData, Me, sErrMsg, Nothing, pic_Png) = False Then
            OraDB.Rollback
            lblMsg.Caption = sErrMsg
            Exit Sub
        End If
    End If
    ' è≥îFã@î\í«â¡Ç…ÇÊÇÈèCê≥  07/10/05 miyatake ===================> END

    'OraDB.Rollback   'testópÉRÉÅÉìÉgÇñﬂÇ∑
    OraDB.CommitTrans
    Debug.Print "êVDBèëçûÇ›èàóùê≥èÌèIóπ"

    ' è≥îFã@î\í«â¡Ç…ÇÊÇÈèCê≥  07/10/05 miyatake ===================> START
    If Me.chk_Png = 1 Then
        ''PNGÉtÉ@ÉCÉãëóêM
        'çHíˆÇCC710Ç©ÇÁCW760Ç…ïœçX 2010/04/30 SETsw kubota
        'Call FileReSend_PNG(PROCD_NUKISI_SIJI)
        Call FileReSend_PNG(PROCD_WFC_SAINUKISI)
    End If
    ' è≥îFã@î\í«â¡Ç…ÇÊÇÈèCê≥  07/10/05 miyatake ===================> END

    '' èIóπÉÅÉbÉZÅ[ÉWÇï\é¶Ç∑ÇÈ
    lblMsg.Caption = GetMsgStr("PPROK")

    ' èIóπÉÅÉbÉZÅ[ÉWÇï\é¶Ç∑ÇÈ
    lblMsg.Caption = GetMsgStr("PPROK")

    sprExamine.Enabled = False
    cmdF(2).Enabled = True
    cmdF(3).Enabled = False
    cmdF(6).Enabled = False
    cmdF(7).Enabled = False
    cmdF(8).Enabled = False
    cmdF(9).Enabled = False
    cmdF(10).Enabled = False
    cmdF(11).Enabled = False
    cmdF(12).Enabled = False
End Sub

'*******************************************************************************
'*    ä÷êîñº        : fnc_CheckBlockP
'*
'*    èàóùäTóv      : 1.ì¸óÕÇ≥ÇÍÇΩÉuÉçÉbÉNà íuÇ™ê≥ÇµÇ¢Ç©îªï 
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Ç»Çµ
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*******************************************************************************
Private Function fnc_CheckBlockP() As FUNCTION_RETURN

    Dim sTmpBlockID     As String
    Dim sTmpHinban      As String
    Dim sNowHinban      As String
    Dim intTmpBlockP    As Integer
    Dim intRetIngotPos  As Integer
    Dim intCmdIndex     As Integer
    Dim intBlockPErrFlg As Integer
    Dim intRow          As Integer
    Dim intPos          As Integer
    Dim m               As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim vBlkNullChk     As Variant
    Dim vNukisiFlg      As Variant
    Dim vNextNukisiFlg  As Variant
    Dim sBlockId        As String
    Dim sNextIngotP     As String
    Dim vGetBlkSeq      As Variant
    Dim vGetBlkSeq2     As Variant
    Dim vSample1        As Variant
    Dim vSample2        As Variant
    Dim sSample1        As String
    Dim sSample2        As String
    Dim intNextBlkP     As Integer
    Dim vGetWfNum       As Variant
    Dim vGetBlkP        As Variant
    Dim vGetIngotP      As Variant
    Dim intBlockp       As Integer
    Dim iRtn            As FUNCTION_RETURN

    fnc_CheckBlockP = FUNCTION_RETURN_SUCCESS

    '' ÉuÉçÉbÉNà íuÅAåãèªà íuÇÃämíË
    'ïiî‘Ç1óÒí«â¡ÇµÇΩÇ±Ç∆Ç…ÇÊÇÈóÒÇÃïœçX
    With sprExamine
        m = .MaxRows
        If m = 0 Then
            Exit Function
        End If

        For i = 1 To m
            If i <> 1 And i <> m Then
                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                .GetText 37, i, vNukisiFlg
                If (vNukisiFlg = "2") Then
                    .row = i
                    .col = 1
                    intCmdIndex = .TypeComboBoxCurSel

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 39
                    sTmpBlockID = Mid(Trim(txtCryNum.text), 1, 9) & Trim(.text)
                    .col = 4
                    '' ÉGÉâÅ[É`ÉFÉbÉN(ì¸óÕÇ≥ÇÍÇΩÇ©)
                    If Trim$(.text) = "" Then
                        .backColor = COLOR_NG
                        Exit Function
                    End If
                    intTmpBlockP = .text
                    .col = 3
                    intRetIngotPos = orgXl.Blks.GetPosByID(sTmpBlockID)
                    '' ÉGÉâÅ[É`ÉFÉbÉN
                    If fnc_CheckBlockP2(intRetIngotPos, sTmpBlockID, intTmpBlockP, i, intBlockPErrFlg) = FUNCTION_RETURN_FAILURE Then
                        '' ÉGÉâÅ[Ç≈Ç»ÇØÇÍÇŒåãèªPÇê›íËÇ∑ÇÈ
                        .row = i
                        .col = 4
                        .backColor = COLOR_NG
                    Else
                        .row = i

                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .col = 39
                        sTmpBlockID = Mid(Trim(txtCryNum.text), 1, 9) & Trim(.text)
                        .col = 4
                        intBlockp = CInt(.text)
                        .row = i + 2
                        .col = 4
                        intNextBlkP = CInt(.text)

                        .row = i
                        vSample1 = "U"
                        vSample2 = " " 'DÇÃÉTÉìÉvÉãIDÇ‡çÏê¨Ç∑ÇÈ

                        If DBDRV_GET_WFMAP(sTmpBlockID, tblSXL.SXLID, intBlockp, vGetBlkP, vGetIngotP, sNextIngotP, vGetBlkSeq, vGetBlkSeq2, vSample1, vSample2, intNextBlkP, vGetWfNum) = FUNCTION_RETURN_FAILURE Then
                            .col = 4
                            .col2 = 4
                            .row = i
                            .row2 = i
                            .BlockMode = True
                            .backColor = &H8080FF
                            .BlockMode = False
                            lblMsg.Caption = GetMsgStr("EWFM1")
                            fnc_CheckBlockP = FUNCTION_RETURN_FAILURE
                            Exit Function
                        Else
                            .col = 4
                            .col2 = 4
                            .row = i
                            .row2 = i
                            .BlockMode = True
                            .backColor = &H80FF80
                            .BlockMode = False
                        End If
                        ReDim Preserve tblNukishi(i + 1)
                        tblNukishi(i).REPSMPLIDCW = vSample1 'ë„ï\ÉTÉìÉvÉãIDÇçÏê¨
                        tblNukishi(i + 1).REPSMPLIDCW = vSample2

                        'Ç±Ç±Ç≈çÏÇÁÇÍÇΩåãèªPÇÕï\é¶Ç≥ÇπÇ»Ç¢ -----------
                        .col = 5
                        .text = CStr(vGetIngotP)
                        .col = 4
                            .backColor = COLOR_OK
                    End If
                'vNukisiFlg = "3"ÇÃÇ∆Ç´ÇÃèàóùÇí«â¡(ÉTÉìÉvÉãIDêÿë÷ÇÃÇΩÇﬂ)
                ElseIf vNukisiFlg = "3" And i Mod 2 = 0 Then
                    .row = i

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 39
                    sTmpBlockID = Mid(Trim(txtCryNum.text), 1, 9) & Trim(.text)
                    .col = 4
                    intBlockp = CInt(.text)
                    .row = i + 2
                    .col = 4
                    intNextBlkP = CInt(.text)

                    .row = i
                    vSample1 = "U"
                    vSample2 = " " 'DÇÃÉTÉìÉvÉãIDÇ‡çÏê¨Ç∑ÇÈ

                    If DBDRV_GET_WFMAP(sTmpBlockID, tblSXL.SXLID, intBlockp, vGetBlkP, vGetIngotP, sNextIngotP, vGetBlkSeq, vGetBlkSeq2, vSample1, vSample2, intNextBlkP, vGetWfNum) = FUNCTION_RETURN_SUCCESS Then
                        ReDim Preserve tblNukishi(i + 1)
                        tblNukishi(i).REPSMPLIDCW = vSample1 'ë„ï\ÉTÉìÉvÉãIDÇçÏê¨
                        tblNukishi(i + 1).REPSMPLIDCW = vSample2
                    End If
                End If
            End If
        Next i

        '' ÉGÉâÅ[ÇæÇ¡ÇΩèÍçáÅAèàóùÇî≤ÇØÇÈ
        If intBlockPErrFlg <> 0 Then
            '' ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇï\é¶ÇµÇƒèàóùÇî≤ÇØÇÈ
            Select Case intBlockPErrFlg
                Case 1      ' SXLîÕàÕäO
                    lblMsg.Caption = GetMsgStr("EBLK2")
                Case 2      ' à íuèdï°
                    lblMsg.Caption = GetMsgStr("EBLK3")
                Case 3      ' ïiî‘ÉGÉâÅ[
                    lblMsg.Caption = GetMsgStr("EHIN3")
                Case 4      ' åáóé
                    lblMsg.Caption = GetMsgStr("EBLK4")
            End Select

            fnc_CheckBlockP = FUNCTION_RETURN_FAILURE
            Exit Function
        End If
    End With
End Function

'*******************************************************************************
'*    ä÷êîñº        : fnc_CheckBlockP2
'*
'*    èàóùäTóv      : 1.ÉuÉçÉbÉNPÉGÉâÅ[É`ÉFÉbÉNÅiÉTÉuÅj
'*Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@  (ÉuÉçÉbÉNPÇ™îÕàÕäOì¸óÕÇ≥ÇÍÇƒÇ¢Ç»Ç¢Ç©É`ÉFÉbÉN)
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*          Å@Å@      intIngotpos   ,I  ,IntegerÅ@,ÉuÉçÉbÉNäJénà íu
'*Å@Å@      Å@Å@      InBlockId     ,I  ,String Å@,ÉuÉçÉbÉNID
'*Å@Å@      Å@Å@      intBlockp     ,I  ,String Å@,ÉuÉçÉbÉNà íu
'*Å@Å@      Å@Å@      intRowCount   ,I  ,String Å@,SPREADÇÃà íu
'*Å@Å@      Å@Å@      intErrP       ,O  ,String Å@,ÉGÉâÅ[ì‡óeÉtÉâÉO
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*******************************************************************************
Private Function fnc_CheckBlockP2(intIngotpos As Integer, sBlockId As String, intBlockp As Integer, intRowCount As Integer, ByRef intErrP As Integer) As FUNCTION_RETURN

    Dim sBlk            As String
    Dim sTmpBlockID     As String
    Dim intTmpBlockPos  As Integer
    Dim intTmpBlockLen  As Integer
    Dim intTopIngotPos  As Integer
    Dim intTailIngotPos As Integer
    Dim blFlag          As Boolean
    Dim intPos          As Integer
    Dim m               As Integer
    Dim n               As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim vNukisiFlg      As Variant

    fnc_CheckBlockP2 = FUNCTION_RETURN_SUCCESS

    '' ÉGÉâÅ[É`ÉFÉbÉNÅiSXLîÕàÕì‡Ç©Ç«Ç§Ç©Åj
    If intIngotpos + intBlockp > EIngotP Or intIngotpos + intBlockp < SIngotP Then
        fnc_CheckBlockP2 = FUNCTION_RETURN_FAILURE
        intErrP = 1
        Exit Function
    End If

    '' ÉGÉâÅ[É`ÉFÉbÉNÅiÉuÉçÉbÉNÇÃîÕàÕì‡Ç©Åj
    If intIngotpos = 0 Then
        intTmpBlockLen = orgXl.Blks.LowerPos(1)
    Else
        intTopIngotPos = orgXl.Blks.LowerPos(intIngotpos + intBlockp)
        intTailIngotPos = orgXl.Blks.UpperArea(intIngotpos + intBlockp)
        intTmpBlockLen = intTopIngotPos - intTailIngotPos
    End If
    If intTmpBlockLen < intBlockp Then
        fnc_CheckBlockP2 = FUNCTION_RETURN_FAILURE
        intErrP = 1
        Exit Function
    End If

    'ïiî‘Ç1óÒí«â¡ÇµÇΩÇ±Ç∆Ç…ÇÊÇÈóÒÇÃïœçX
    With sprExamine
        m = .MaxRows

        '' ÉuÉçÉbÉNÇoÇÃåáóéÉ`ÉFÉbÉN
        n = UBound(tblLackMap)
        For i = 1 To m
            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
            .GetText 37, i, vNukisiFlg
            If (vNukisiFlg = "2") Then  'í«â¡î≤ééçsÇÃÇ›èàóùÇçsÇ§
                .row = i

                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                .col = 39
                sBlk = left(txtCryNum.text, 9) & .text
                .col = 4

                intPos = val(.text)
                For j = 1 To n
                    If tblLackMap(j).BLOCKID = sBlk And _
                       tblLackMap(j).LACKPOSS <= intPos And _
                       tblLackMap(j).LACKPOSE >= intPos Then
                        .backColor = COLOR_NG
                        blFlag = True
                        Exit For
                    End If
                Next j
            End If
        Next i

        If blFlag = True Then
            fnc_CheckBlockP2 = FUNCTION_RETURN_FAILURE
            intErrP = 4
            Exit Function
        End If
    End With
End Function

'*******************************************************************************
'*    ä÷êîñº        : fnc_CheckHinbanZ
'*
'*    èàóùäTóv      : 1.Zïiî‘Ç™ê›íËÇ≥ÇÍÇƒÇ¢ÇÈÇ∆Ç´Ç…ãÊï™0Ç»ÇÁÉGÉâÅ[Ç∆Ç∑ÇÈ
'*Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@  (ïiî‘ÉGÉâÅ[É`ÉFÉbÉN)
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*******************************************************************************
Private Function fnc_CheckHinbanZ() As FUNCTION_RETURN

    Dim sNowHinban      As String
    Dim sNowKubun       As String
    Dim m               As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim vHinChk         As Variant
    Dim vNukisiFlg      As Variant
    Dim vNextNukisiFlg  As Variant

    fnc_CheckHinbanZ = FUNCTION_RETURN_SUCCESS

    'ïiî‘Ç1óÒí«â¡ÇµÇΩÇ±Ç∆Ç…ÇÊÇÈóÒÇÃïœçX
    With sprExamine
        m = .MaxRows
        For i = 1 To m
            If i <> m Then
                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                .GetText 37, i, vNukisiFlg  'åªç›çs
                .GetText 37, i + 1, vNextNukisiFlg  'éüçs

                If i Mod 2 <> 0 Then    'äÔêîçsÇÃÇ›èàóùÇçsÇ§
                     .GetText 2, i, vHinChk
                    sNowHinban = vHinChk
                    .row = i
                    .col = 9
                    j = .TypeComboBoxCurSel + 1
                    sNowKubun = Trim$(tblPrcList(j).CODE)
                    If sNowHinban = "Z" And sNowKubun = "0" Then
                        .backColor = COLOR_NG  'êFïœÇ¶ÇµÇ»Ç¢
                        fnc_CheckHinbanZ = FUNCTION_RETURN_FAILURE
                    ElseIf (sNowHinban = "Z" And i = 1) Or i <> 1 Then
                         .backColor = &H80FF80     '2003/04/16
                    End If
                End If
            End If
        Next i
    End With
End Function

'*******************************************************************************
'*    ä÷êîñº        : fnc_UpdateData
'*
'*    èàóùäTóv      : 1.î≤éééwé¶àÍóóÇÃì¸óÕì‡óeÇ…ÇÊÇËëSÉfÅ[É^ÇçXêVÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*******************************************************************************
Private Function fnc_UpdateData() As FUNCTION_RETURN

    Dim udtTmpHin   As tFullHinban
    Dim udtTmpUPHin As tFullHinban
    Dim udtTmpDNHin As tFullHinban
    Dim sHin        As String
    Dim blFlag      As Boolean
    Dim m           As Integer
    Dim i           As Integer
    Dim j           As Integer
    Dim intSmpRow   As Integer
    Dim vNukisiFlg  As Variant
    Dim vGetSample1 As Variant
    Dim vGetSample2 As Variant
    Dim vSmpleID    As Variant
    Dim lngRow      As Long
    Dim intRow      As Integer

    lblMsg.Caption = ""

    '' çƒî≤éééwé¶ÉfÅ[É^ÇÃéÊìæ
    'ïiî‘Ç1óÒí«â¡ÇµÇΩÇ±Ç∆Ç…ÇÊÇÈóÒÇÃïœçX

    bJituChkFlg = False

    With sprExamine
        blFlag = False
        m = .MaxRows
        If m = 0 Then
            fnc_UpdateData = FUNCTION_RETURN_SUCCESS
            Exit Function
        End If
        intSmpRow = 0

        For i = 1 To m
            ReDim Preserve tblNukishi(m)
            tblNukishi(i).INPOSCW = -1

            '' WFÉTÉìÉvÉãéwé¶ÉfÅ[É^ÇçXêVÇ∑ÇÈ
            If i = 1 Or i = m Or CheckGetSampleID(i) = True Or CheckGetSampleID(i) = False Then
                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                .GetText 37, i, vNukisiFlg

                If (vNukisiFlg = 1) Then   'èâä˙ï\é¶î≤ééçsÇÃèàóùÇçsÇ§
                    intSmpRow = intSmpRow + 1
                    ReDim Preserve tblWafInd(intSmpRow)     'î≤ééçsÇÃÇ›ç\ë¢ëÃÇçÏê¨Ç∑ÇÈ
                    .row = i

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 39
                    'ÉTÉìÉvÉãIDÇ‡ì¸ÇÍÇÈ UPDATEÇÃèåèÇ…égóp
                    tblWafInd(intSmpRow).BLOCKID = left(tblSXL.SXLID, 9) & .text

                    'ÉTÉìÉvÉãIDÇ™ïœÇÌÇÁÇ»Ç¢Åièâä˙ï\é¶ÇÃÇPÅEç≈èIçsÅjÇ≈ÇÕäJénÅEèIóπà íuÇÕïœÇ¶Ç»Ç¢
                    .col = 4
                    tblWafInd(intSmpRow).BlockPos = val(.text)

                    .col = 5
                    If Not .text = "" Then
                        tblWafInd(intSmpRow).INGOTPOS = .text
                    End If

                    If i = 1 Then   'ÇPçsñ⁄ÇÃåãèªà íuÇÕä˘ë∂à íuÇ…Ç»ÇÈ
                        tblWafInd(intSmpRow).INGOTPOS = SIngotP
                        tblNukishi(i).INPOSCW = SIngotP
                    ElseIf i = m Then
                        tblWafInd(intSmpRow).INGOTPOS = EIngotP   'ç≈èIçsÇ‡ä˘ë∂à íu
                        tblNukishi(i).INPOSCW = EIngotP
                    End If

                    .col = 2

                    If i = 1 Then
                        lngRow = i
                    Else
                        lngRow = i - 1
                    End If
                    .row = lngRow
                    sHin = Trim$(.text)
                    .row = i

                    If sHin <> "Z" And intSmpRow <> m Then
                        '' ïiî‘ê›íËÇ≥ÇÍÇƒÇ¢ÇÈÇ»ÇÁÉtÉãåÖïiî‘ÇéÊìæ
                        If sHin <> "" Then
                            If GetLastHinban(sHin, udtTmpHin) = FUNCTION_RETURN_FAILURE Then
                                '' ÉGÉâÅ[èàóù
                                tblWafInd(intSmpRow).ERRDNFLG = True
                                blFlag = True
                            End If
                        End If
                    End If

                    'ç≈å„ÇÃçsÇÃâ∫ïiî‘Ç…ÇÕèâä˙ï\é¶ÇÃïiî‘Çê›íË
                    If i = m Then
                        sHin = ""
                    End If

                    With tblWafInd(intSmpRow)
                        If sHin = "Z" Then
                            .HINDN.hinban = sHin                    ' ïiî‘
                            .HINDN.mnorevno = 0                     ' êªïiî‘çÜâ¸í˘î‘çÜ
                            .HINDN.factory = ""                     ' çHèÍ
                            .HINDN.opecond = ""                     ' ëÄã∆èåè
                        ElseIf sHin = "" Then
                            .HINDN.hinban = tblSXL.hinban           ' ïiî‘
                            .HINDN.mnorevno = tblSXL.REVNUM         ' êªïiî‘çÜâ¸í˘î‘çÜ
                            .HINDN.factory = tblSXL.factory         ' çHèÍ
                            .HINDN.opecond = tblSXL.opecond         ' ëÄã∆èåè
                        Else
                            .HINDN.hinban = sHin                    ' ïiî‘
                            .HINDN.mnorevno = udtTmpHin.mnorevno    ' êªïiî‘çÜâ¸í˘î‘çÜ
                            .HINDN.factory = udtTmpHin.factory      ' çHèÍ
                            .HINDN.opecond = udtTmpHin.opecond      ' ëÄã∆èåè
                        End If
                    End With

                    Call sub_GetWafHinban01(intSmpRow)

                    If i = 1 Then
                        tblNukishi(i).HINBCW = tblWafInd(intSmpRow).HINDN.hinban
                        tblNukishi(i).FACTORYCW = tblWafInd(intSmpRow).HINDN.factory
                        tblNukishi(i).REVNUMCW = tblWafInd(intSmpRow).HINDN.mnorevno
                        tblNukishi(i).OPECW = tblWafInd(intSmpRow).HINDN.opecond
                    ElseIf i = m Then
                        tblNukishi(i).HINBCW = tblWafInd(intSmpRow).HINUP.hinban
                        tblNukishi(i).FACTORYCW = tblWafInd(intSmpRow).HINUP.factory
                        tblNukishi(i).REVNUMCW = tblWafInd(intSmpRow).HINUP.mnorevno
                        tblNukishi(i).OPECW = tblWafInd(intSmpRow).HINUP.opecond
                    End If

                    .col = 11
                    tblWafInd(intSmpRow).SMP.CRYINDRS = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDRSCW = IIf(.text = "", "0", .text)

                    .col = 12
                    tblWafInd(intSmpRow).SMP.CRYINDOI = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDOICW = IIf(.text = "", "0", .text)

                    .col = 13
                    tblWafInd(intSmpRow).SMP.CRYINDB1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDB1CW = IIf(.text = "", "0", .text)

                    .col = 14
                    tblWafInd(intSmpRow).SMP.CRYINDB2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDB2CW = IIf(.text = "", "0", .text)

                    .col = 15
                    tblWafInd(intSmpRow).SMP.CRYINDB3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDB3CW = IIf(.text = "", "0", .text)

                    .col = 16
                    tblWafInd(intSmpRow).SMP.CRYINDL1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDL1CW = IIf(.text = "", "0", .text)

                    .col = 17
                    tblWafInd(intSmpRow).SMP.CRYINDL2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDL2CW = IIf(.text = "", "0", .text)

                    .col = 18
                    tblWafInd(intSmpRow).SMP.CRYINDL3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDL3CW = IIf(.text = "", "0", .text)

                    .col = 19
                    tblWafInd(intSmpRow).SMP.CRYINDL4 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDL4CW = IIf(.text = "", "0", .text)

                    .col = 20
                    tblWafInd(intSmpRow).SMP.CRYINDDS = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDSCW = IIf(.text = "", "0", .text)

                    .col = 21
                    tblWafInd(intSmpRow).SMP.CRYINDDZ = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDZCW = IIf(.text = "", "0", .text)

                    .col = 22
                    tblWafInd(intSmpRow).SMP.CRYINDSP = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDSPCW = IIf(.text = "", "0", .text)

                    .col = 23
                    tblWafInd(intSmpRow).SMP.CRYINDD1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDO1CW = IIf(.text = "", "0", .text)

                    .col = 24
                    tblWafInd(intSmpRow).SMP.CRYINDD2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDO2CW = IIf(.text = "", "0", .text)

                    .col = 25
                    tblWafInd(intSmpRow).SMP.CRYINDD3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDO3CW = IIf(.text = "", "0", .text)

                    ''écë∂é_ëfí«â¡
                    .col = 26
                    tblWafInd(intSmpRow).SMP.CRYINDAO = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDAOICW = IIf(.text = "", "0", .text)

                    .col = 27
                    tblWafInd(intSmpRow).SMP.CRYOTHER1 = 0
                    If .text <> vbNullString Then   'åüç∏çÄñ⁄ONÇÃïîï™ÇÃÇ›åüç∏çÄñ⁄éÊìæ
                        If .backColor = vbBlack Then
                            tblWafInd(intSmpRow).SMP.CRYOTHER1 = IIf(.text = "", "0", .text)
                            tblNukishi(i).WFINDOT1CW = IIf(.text = "", "0", .text)
                        End If
                    End If

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 35
                    tblWafInd(intSmpRow).SMP.CRYOTHER2 = 0
                    If .text <> vbNullString Then   'åüç∏çÄñ⁄ONÇÃïîï™ÇÃÇ›åüç∏çÄñ⁄éÊìæ
                        If .backColor = vbBlack Then
                            tblWafInd(intSmpRow).SMP.CRYOTHER2 = IIf(.text = "", "0", .text)
                            tblNukishi(i).WFINDOT2CW = IIf(.text = "", "0", .text)
                        End If
                    End If

                    'GDí«â¡
                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 28
                    tblWafInd(intSmpRow).SMP.CRYINDGD = IIf(.text = "", "0", .text)     'èÛë‘Ã◊∏ﬁ(GD)
                    tblNukishi(i).WFINDGDCW = IIf(.text = "", "0", .text)               'èÛë‘Ã◊∏ﬁ(GD)

                    'ª›ÃﬂŸñ¢èàóùÇ‹ÇΩÇÕZïiî‘Ç≈Ç»Ç¢èÍçá
                    If bSampFlag = False Or Trim(tblNukishi(i).HINBCW) <> "Z" Then
                        tblWafInd(intSmpRow).SMP.WFHSGD = fnc_Get_CellHsFlg(vNukisiFlg) 'ï€èÿÃ◊∏ﬁ(GD)
                        tblNukishi(i).WFHSGDCW = tblWafInd(intSmpRow).SMP.WFHSGD        'ï€èÿÃ◊∏ﬁ(GD)
                    'ª›ÃﬂŸèàóùçœÇ©Ç¬Zïiî‘ÇÃèÍçá
                    Else
                        tblWafInd(intSmpRow).SMP.WFHSGD = tblNukishi(i).WFHSGDCW        'ï€èÿÃ◊∏ﬁ(GD)
                    End If

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 29
                    tblWafInd(intSmpRow).SMP.EPIINDB1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDB1CW = IIf(.text = "", "0", .text)

                    .col = 30
                    tblWafInd(intSmpRow).SMP.EPIINDB2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDB2CW = IIf(.text = "", "0", .text)

                    .col = 31
                    tblWafInd(intSmpRow).SMP.EPIINDB3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDB3CW = IIf(.text = "", "0", .text)

                    .col = 32
                    tblWafInd(intSmpRow).SMP.EPIINDL1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDL1CW = IIf(.text = "", "0", .text)

                    .col = 33
                    tblWafInd(intSmpRow).SMP.EPIINDL2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDL2CW = IIf(.text = "", "0", .text)

                    .col = 34
                    tblWafInd(intSmpRow).SMP.EPIINDL3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDL3CW = IIf(.text = "", "0", .text)

                    .col = 10

                    'èâä˙ï\é¶ÇÃêÊì™ÅAç≈å„ÇÕÉTSMPLKBN2ÉìÉvÉãUPDATEÇÃÇΩÇﬂãÊï™ÇÕì¸ÇÍÇ»Ç¢
                    tblWafInd(intSmpRow).SMPLKBN2 = ""
                    tblWafInd(intSmpRow).SMPLKBN1 = ""

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 38
                    tblWafInd(intSmpRow).SAMPLEID = .text

                    If i = 1 Then
                        tblNukishi(i).SMPKBNCW = tKensa(0).SMPKBNCW
                    Else
                        tblNukishi(i).SMPKBNCW = tKensa(1).SMPKBNCW
                    End If
                    tblNukishi(i).TBKBNCW = IIf(tblNukishi(i).SMPKBNCW = "B" Or tblNukishi(i).SMPKBNCW = "U", "B", "T") 'TBãÊï™
                ElseIf vNukisiFlg = 2 Or (vNukisiFlg = 3 And CheckGetSampleID(i) = True) Then  'í«â¡î≤ééçsÇÃèàóùÇçsÇ§
                    intSmpRow = intSmpRow + 1
                    ReDim Preserve tblWafInd(intSmpRow)   'add 2003/04/14 hitec)matsumoto î≤ééçsÇÃÇ›ç\ë¢ëÃÇçÏê¨Ç∑ÇÈ

                    If vNukisiFlg = 2 Then
                        .row = i
                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .col = 39
                        tblWafInd(intSmpRow).BLOCKID = left(tblSXL.SXLID, 9) & .text

                        .col = 4
                        tblWafInd(intSmpRow).BlockPos = val(.text)

                        .col = 5
                        tblWafInd(intSmpRow).INGOTPOS = .text
                        tblNukishi(i).INPOSCW = .text
                    ElseIf vNukisiFlg = 3 Then
                        .row = i + 1
                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .col = 39
                        tblWafInd(intSmpRow).BLOCKID = left(tblSXL.SXLID, 9) & .text

                        .col = 4
                        tblWafInd(intSmpRow).BlockPos = val(.text)

                        .col = 5
                        tblWafInd(intSmpRow).INGOTPOS = .text
                        tblNukishi(i).INPOSCW = .text
                    End If

                    .row = i + 1
                    .col = 2
                    sHin = Trim$(.text)

                    If sHin <> "Z" And intSmpRow <> m Then
                        '' ïiî‘ê›íËÇ≥ÇÍÇƒÇ¢ÇÈÇ»ÇÁÉtÉãåÖïiî‘ÇéÊìæ
                        If sHin <> "" Then
                            If GetLastHinban(.text, udtTmpHin) = FUNCTION_RETURN_FAILURE Then
                                '' ÉGÉâÅ[èàóù
                                tblWafInd(intSmpRow).ERRDNFLG = True
                                blFlag = True
                            End If
                        End If
                    End If

                    With tblWafInd(intSmpRow)
                        If sHin = "Z" Then
                            .HINDN.hinban = sHin                    ' ïiî‘
                            .HINDN.mnorevno = 0                     ' êªïiî‘çÜâ¸í˘î‘çÜ
                            .HINDN.factory = ""                     ' çHèÍ
                            .HINDN.opecond = ""                     ' ëÄã∆èåè
                        ElseIf sHin = "" Then
                            .HINDN.hinban = tblSXL.hinban           ' ïiî‘
                            .HINDN.mnorevno = tblSXL.REVNUM         ' êªïiî‘çÜâ¸í˘î‘çÜ
                            .HINDN.factory = tblSXL.factory         ' çHèÍ
                            .HINDN.opecond = tblSXL.opecond         ' ëÄã∆èåè
                        Else
                            .HINDN.hinban = sHin                    ' ïiî‘
                            .HINDN.mnorevno = udtTmpHin.mnorevno    ' êªïiî‘çÜâ¸í˘î‘çÜ
                            .HINDN.factory = udtTmpHin.factory      ' çHèÍ
                            .HINDN.opecond = udtTmpHin.opecond      ' ëÄã∆èåè
                        End If
                    End With

                    tblWafInd(intSmpRow).HINUP.hinban = tblWafInd(intSmpRow - 1).HINDN.hinban
                    tblWafInd(intSmpRow).HINUP.mnorevno = tblWafInd(intSmpRow - 1).HINDN.mnorevno
                    tblWafInd(intSmpRow).HINUP.factory = tblWafInd(intSmpRow - 1).HINDN.factory
                    tblWafInd(intSmpRow).HINUP.opecond = tblWafInd(intSmpRow - 1).HINDN.opecond

                    tblNukishi(i).HINBCW = tblWafInd(intSmpRow).HINUP.hinban
                    tblNukishi(i).FACTORYCW = tblWafInd(intSmpRow).HINUP.factory
                    tblNukishi(i).REVNUMCW = tblWafInd(intSmpRow).HINUP.mnorevno
                    tblNukishi(i).OPECW = tblWafInd(intSmpRow).HINUP.opecond

                    .GetText 10, i, vGetSample1
                    .GetText 10, i + 1, vGetSample2

                    If Trim(vGetSample1) = gsWF_SMPL_JOINT Then
                        tblWafInd(intSmpRow).SMPLKBN1 = Right(vGetSample2, 1)
                        tblWafInd(intSmpRow).SMPLKBN2 = ""

                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .GetText 38, i + 1, vGetSample2
                        .GetText 44, i, vGetSample1

                        tblWafInd(intSmpRow).SAMPLEID = CStr(vGetSample2)
                        tblWafInd(intSmpRow).SAMPLEID2 = ""
                    ElseIf Trim(vGetSample2) = gsWF_SMPL_JOINT Then
                        tblWafInd(intSmpRow).SMPLKBN1 = Right(vGetSample1, 1)
                        tblWafInd(intSmpRow).SMPLKBN2 = ""

                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .GetText 38, i, vGetSample1
                        .GetText 44, i + 1, vGetSample2

                        tblWafInd(intSmpRow).SAMPLEID = CStr(vGetSample1)
                        tblWafInd(intSmpRow).SAMPLEID2 = ""
                    Else
                        tblWafInd(intSmpRow).SMPLKBN1 = Right(vGetSample1, 1)
                        tblWafInd(intSmpRow).SMPLKBN2 = Right(vGetSample2, 1)

                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .GetText 38, i, vGetSample1
                        .GetText 44, i + 1, vGetSample2

                        tblWafInd(intSmpRow).SAMPLEID = CStr(vGetSample1)
                        tblWafInd(intSmpRow).SAMPLEID2 = CStr(vGetSample2)
                    End If

                    .row = i
                    .col = 11
                    tblWafInd(intSmpRow).SMP.CRYINDRS = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDRSCW = IIf(.text = "", "0", .text)

                    .col = 12
                    tblWafInd(intSmpRow).SMP.CRYINDOI = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDOICW = IIf(.text = "", "0", .text)

                    .col = 13
                    tblWafInd(intSmpRow).SMP.CRYINDB1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDB1CW = IIf(.text = "", "0", .text)

                    .col = 14
                    tblWafInd(intSmpRow).SMP.CRYINDB2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDB2CW = IIf(.text = "", "0", .text)

                    .col = 15
                    tblWafInd(intSmpRow).SMP.CRYINDB3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDB3CW = IIf(.text = "", "0", .text)

                    .col = 16
                    tblWafInd(intSmpRow).SMP.CRYINDL1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDL1CW = IIf(.text = "", "0", .text)

                    .col = 17
                    tblWafInd(intSmpRow).SMP.CRYINDL2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDL2CW = IIf(.text = "", "0", .text)

                    .col = 18
                    tblWafInd(intSmpRow).SMP.CRYINDL3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDL3CW = IIf(.text = "", "0", .text)

                    .col = 19
                    tblWafInd(intSmpRow).SMP.CRYINDL4 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDL4CW = IIf(.text = "", "0", .text)

                    .col = 20
                    tblWafInd(intSmpRow).SMP.CRYINDDS = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDSCW = IIf(.text = "", "0", .text)

                    .col = 21
                    tblWafInd(intSmpRow).SMP.CRYINDDZ = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDZCW = IIf(.text = "", "0", .text)

                    .col = 22
                    tblWafInd(intSmpRow).SMP.CRYINDSP = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDSPCW = IIf(.text = "", "0", .text)

                    .col = 23
                    tblWafInd(intSmpRow).SMP.CRYINDD1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDO1CW = IIf(.text = "", "0", .text)

                    .col = 24
                    tblWafInd(intSmpRow).SMP.CRYINDD2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDO2CW = IIf(.text = "", "0", .text)

                    .col = 25
                    tblWafInd(intSmpRow).SMP.CRYINDD3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDO3CW = IIf(.text = "", "0", .text)

                    ''écë∂é_ëfí«â¡
                    .col = 26
                    tblWafInd(intSmpRow).SMP.CRYINDAO = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDAOICW = IIf(.text = "", "0", .text)

                    .col = 27
                    tblWafInd(intSmpRow).SMP.CRYOTHER1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDOT1CW = IIf(.text = "", "0", .text)

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 35
                    tblWafInd(intSmpRow).SMP.CRYOTHER2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDOT2CW = IIf(.text = "", "0", .text)

                    'GDí«â¡Å@05/02/18 ooba
                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 28
                    tblWafInd(intSmpRow).SMP.CRYINDGD = IIf(.text = "", "0", .text)     'èÛë‘Ã◊∏ﬁ(GD)
                    tblNukishi(i).WFINDGDCW = IIf(.text = "", "0", .text)               'èÛë‘Ã◊∏ﬁ(GD)

                    'ª›ÃﬂŸñ¢èàóùÇ‹ÇΩÇÕZïiî‘Ç≈Ç»Ç¢èÍçá
                    If bSampFlag = False Or Trim(tblNukishi(i).HINBCW) <> "Z" Then
                        tblWafInd(intSmpRow).SMP.WFHSGD = fnc_Get_CellHsFlg(vNukisiFlg) 'ï€èÿÃ◊∏ﬁ(GD)
                        tblNukishi(i).WFHSGDCW = tblWafInd(intSmpRow).SMP.WFHSGD        'ï€èÿÃ◊∏ﬁ(GD)
                    'ª›ÃﬂŸèàóùçœÇ©Ç¬Zïiî‘ÇÃèÍçá
                    Else
                        tblWafInd(intSmpRow).SMP.WFHSGD = tblNukishi(i).WFHSGDCW        'ï€èÿÃ◊∏ﬁ(GD)
                    End If

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 29
                    tblWafInd(intSmpRow).SMP.EPIINDB1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDB1CW = IIf(.text = "", "0", .text)

                    .col = 30
                    tblWafInd(intSmpRow).SMP.EPIINDB2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDB2CW = IIf(.text = "", "0", .text)

                    .col = 31
                    tblWafInd(intSmpRow).SMP.EPIINDB3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDB3CW = IIf(.text = "", "0", .text)

                    .col = 32
                    tblWafInd(intSmpRow).SMP.EPIINDL1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDL1CW = IIf(.text = "", "0", .text)

                    .col = 33
                    tblWafInd(intSmpRow).SMP.EPIINDL2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDL2CW = IIf(.text = "", "0", .text)

                    .col = 34
                    tblWafInd(intSmpRow).SMP.EPIINDL3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDL3CW = IIf(.text = "", "0", .text)

                    i = i + 1
                     .row = i      'î≤ééçsâ∫èàóùí«â¡

                    tblNukishi(i).HINBCW = tblWafInd(intSmpRow).HINDN.hinban
                    tblNukishi(i).FACTORYCW = tblWafInd(intSmpRow).HINDN.factory
                    tblNukishi(i).REVNUMCW = tblWafInd(intSmpRow).HINDN.mnorevno
                    tblNukishi(i).OPECW = tblWafInd(intSmpRow).HINDN.opecond
                    tblNukishi(i).INPOSCW = tblNukishi(i - 1).INPOSCW
                    .col = 11
                    tblWafInd(intSmpRow).SMP.CRYINDRS = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDRSCW = IIf(.text = "", "0", .text)

                    .col = 12
                    tblWafInd(intSmpRow).SMP.CRYINDOI = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDOICW = IIf(.text = "", "0", .text)

                    .col = 13
                    tblWafInd(intSmpRow).SMP.CRYINDB1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDB1CW = IIf(.text = "", "0", .text)

                    .col = 14
                    tblWafInd(intSmpRow).SMP.CRYINDB2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDB2CW = IIf(.text = "", "0", .text)

                    .col = 15
                    tblWafInd(intSmpRow).SMP.CRYINDB3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDB3CW = IIf(.text = "", "0", .text)

                    .col = 16
                    tblWafInd(intSmpRow).SMP.CRYINDL1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDL1CW = IIf(.text = "", "0", .text)

                    .col = 17
                    tblWafInd(intSmpRow).SMP.CRYINDL2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDL2CW = IIf(.text = "", "0", .text)

                    .col = 18
                    tblWafInd(intSmpRow).SMP.CRYINDL3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDL3CW = IIf(.text = "", "0", .text)

                    .col = 19
                    tblWafInd(intSmpRow).SMP.CRYINDL4 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDL4CW = IIf(.text = "", "0", .text)

                    .col = 20
                    tblWafInd(intSmpRow).SMP.CRYINDDS = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDSCW = IIf(.text = "", "0", .text)

                    .col = 21
                    tblWafInd(intSmpRow).SMP.CRYINDDZ = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDZCW = IIf(.text = "", "0", .text)

                    .col = 22
                    tblWafInd(intSmpRow).SMP.CRYINDSP = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDSPCW = IIf(.text = "", "0", .text)

                    .col = 23
                    tblWafInd(intSmpRow).SMP.CRYINDD1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDO1CW = IIf(.text = "", "0", .text)

                    .col = 24
                    tblWafInd(intSmpRow).SMP.CRYINDD2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDO2CW = IIf(.text = "", "0", .text)

                    .col = 25
                    tblWafInd(intSmpRow).SMP.CRYINDD3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDDO3CW = IIf(.text = "", "0", .text)

                    ''écë∂é_ëfí«â¡
                    .col = 26
                    tblWafInd(intSmpRow).SMP.CRYINDAO = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDAOICW = IIf(.text = "", "0", .text)

                    .col = 27
                    tblWafInd(intSmpRow).SMP.CRYOTHER1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDOT1CW = IIf(.text = "", "0", .text)

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 35
                    tblWafInd(intSmpRow).SMP.CRYOTHER2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).WFINDOT2CW = IIf(.text = "", "0", .text)

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 28
                    tblWafInd(intSmpRow).SMP.CRYINDGD = IIf(.text = "", "0", .text)   'èÛë‘Ã◊∏ﬁ(GD)
                    tblNukishi(i).WFINDGDCW = IIf(.text = "", "0", .text)           'èÛë‘Ã◊∏ﬁ(GD)
                    'ª›ÃﬂŸñ¢èàóùÇ‹ÇΩÇÕZïiî‘Ç≈Ç»Ç¢èÍçá
                    If bSampFlag = False Or Trim(tblNukishi(i).HINBCW) <> "Z" Then
                        tblWafInd(intSmpRow).SMP.WFHSGD = fnc_Get_CellHsFlg(vNukisiFlg)   'ï€èÿÃ◊∏ﬁ(GD)
                        tblNukishi(i).WFHSGDCW = tblWafInd(intSmpRow).SMP.WFHSGD      'ï€èÿÃ◊∏ﬁ(GD)
                    'ª›ÃﬂŸèàóùçœÇ©Ç¬Zïiî‘ÇÃèÍçá
                    Else
                        tblWafInd(intSmpRow).SMP.WFHSGD = tblNukishi(i).WFHSGDCW      'ï€èÿÃ◊∏ﬁ(GD)
                    End If

                    .col = 29
                    tblWafInd(intSmpRow).SMP.EPIINDB1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDB1CW = IIf(.text = "", "0", .text)

                    .col = 30
                    tblWafInd(intSmpRow).SMP.EPIINDB2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDB2CW = IIf(.text = "", "0", .text)

                    .col = 31
                    tblWafInd(intSmpRow).SMP.EPIINDB3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDB3CW = IIf(.text = "", "0", .text)

                    .col = 32
                    tblWafInd(intSmpRow).SMP.EPIINDL1 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDL1CW = IIf(.text = "", "0", .text)

                    .col = 33
                    tblWafInd(intSmpRow).SMP.EPIINDL2 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDL2CW = IIf(.text = "", "0", .text)

                    .col = 34
                    tblWafInd(intSmpRow).SMP.EPIINDL3 = IIf(.text = "", "0", .text)
                    tblNukishi(i).EPINDL3CW = IIf(.text = "", "0", .text)

                    .GetText 10, i, vGetSample1
                    .GetText 10, i + 1, vGetSample2

                    'é¿ë™¡™Ø∏èàóùí«â¡
                    If giFKeyFlg = 2 Then
                        If fnc_CheckJituData(i) = FUNCTION_RETURN_FAILURE Then
                            fnc_UpdateData = FUNCTION_RETURN_FAILURE
                            bJituChkFlg = True
                            Exit Function
                        End If
                    End If
                End If
            End If
        Next i

        '' ïiî‘Ç…åÎÇËÇ™Ç†ÇÈÇ»ÇÁèàóùÇî≤ÇØÇÈ
        If blFlag = True Then
            fnc_UpdateData = FUNCTION_RETURN_FAILURE
            lblMsg.Caption = GetMsgStr("EHIN3")
            Exit Function
        End If
    End With

    '' WFëŒè€ïiî‘ç\ë¢ëÃÇÃê›íË
    sHin = ""
    j = 0
    m = UBound(tblWafInd) - 1
    ReDim tblHinbanRs(m)
    For i = 1 To m
        With tblWafInd(i)
            If Trim$(.HINDN.hinban) <> sHin And _
               Trim$(.HINDN.hinban) <> "Z" And _
               Trim$(.HINDN.hinban) <> "" Then
                j = j + 1
                tblHinbanRs(j).CRYNUM = tblSXL.CRYNUM
                tblHinbanRs(j).HIN.hinban = .HINDN.hinban
                tblHinbanRs(j).HIN.mnorevno = .HINDN.mnorevno
                tblHinbanRs(j).HIN.factory = .HINDN.factory
                tblHinbanRs(j).HIN.opecond = .HINDN.opecond
            End If
            sHin = Trim$(.HINDN.hinban)
        End With
    Next i
    ReDim Preserve tblHinbanRs(j)

    '' í∑Ç≥ÇÃçXêV
    m = UBound(tblWafInd)
    For i = 1 To m
        If i = m Then
            tblWafInd(i).LENGTH = 0
        Else

            tblWafInd(i).LENGTH = tblWafInd(i + 1).INGOTPOS - tblWafInd(i).INGOTPOS
        End If
    Next i

    fnc_UpdateData = FUNCTION_RETURN_SUCCESS
End Function

'*******************************************************************************
'*    ä÷êîñº        : fnc_Get_CellHsFlg
'*
'*    èàóùäTóv      : 1.æŸêFÇ©ÇÁï€èÿÃ◊∏ﬁÇéÊìæÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*Å@Å@      Å@Å@      vNukisiÅ@Å@Å@ ,I  ,Variant  ,î≤ééÉtÉâÉO
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*******************************************************************************
Private Function fnc_Get_CellHsFlg(vNukisi As Variant) As String

    Dim intRow      As Integer            'èàóùçs
    Dim intCol      As Integer            'èàóùóÒ
    Dim sHin        As String             '8åÖïiî‘
    Dim udtFullHin  As tFullHinban        '12åÖïiî‘
    Dim sBlkflg     As String             'Ãﬁ€Ø∏íPà ï€èÿÃ◊∏ﬁ

    'ï€èÿÃ◊∏ﬁ¢0£ÅFWFé¿ê—
    fnc_Get_CellHsFlg = "0"

    With sprExamine
        intRow = .row
        intCol = .col

        'î≤ééà íuÇÃïiî‘éÊìæ
        If intRow Mod 2 = 1 Then .row = intRow Else .row = intRow - 1
        .col = 2
        sHin = Trim$(.text)
        If GetLastHinban(sHin, udtFullHin) = FUNCTION_RETURN_FAILURE Then Exit Function

        'Ãﬁ€Ø∏íPà ï€èÿÃ◊∏ﬁéÊìæ
        If chkBlkTanFlg(udtFullHin, sBlkflg) = FUNCTION_RETURN_FAILURE Then Exit Function

        .row = intRow
        .col = intCol

        'Ãﬁ€Ø∏íPà ï€èÿÃ◊∏ﬁÇÃ¡™Ø∏èúäO
        If .backColor = COLOR_CryJitsu Then fnc_Get_CellHsFlg = "1"
    End With
End Function

'*******************************************************************************
'*    ä÷êîñº        : fnc_CheckJituData
'*
'*    èàóùäTóv      : 1.é¿çsèàóùéûÅAí«â¡î≤ééçsÇ…ëŒÇµé¿ë™√ﬁ∞¿¡™Ø∏ÇÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*Å@Å@      Å@Å@      intRowÅ@Å@   Å@ ,I  ,Integer  ,SpreadÇÃçs
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*******************************************************************************
Private Function fnc_CheckJituData(intRow As Integer) As FUNCTION_RETURN
    Dim intChkRow       As Integer      'é¿ê—¡™Ø∏î≤ééçs
    Dim intChkCol       As Integer      'é¿ê—¡™Ø∏åüç∏çÄñ⁄
    Dim intJituChkCnt   As Integer      'é¿ê—Ç†ÇËåüç∏çÄñ⁄êî
    Dim blBetuFlg       As Boolean      'ã§óL(ï )ª›ÃﬂŸÃ◊∏ﬁ
    Dim intCnt          As Integer

    fnc_CheckJituData = FUNCTION_RETURN_FAILURE
    intJituChkCnt = 0
    intCnt = 1
    blBetuFlg = False

    With sprExamine

        'é¿ê—¡™Ø∏çsÇ™ã§óL(ï )ª›ÃﬂŸÇ©¡™Ø∏
        Do While iBetuRow(intCnt) > 0
            If intRow = iBetuRow(intCnt) Then
                blBetuFlg = True
            End If
            intCnt = intCnt + 1
            If intCnt > .MaxRows Then Exit Do
        Loop

        'ã§óL(ï )ª›ÃﬂŸÇÃèÍçáÇÕ1çsÇ∏Ç¬é¿ê—¡™Ø∏Ç∑ÇÈ
        If blBetuFlg = True Then
            For intChkRow = intRow - 1 To intRow
                .row = intChkRow

                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                For intChkCol = 11 To 35
                    .col = intChkCol
                    If .text = "1" Then
                        intJituChkCnt = intJituChkCnt + 1
                    End If
                Next

                'é¿ë™√ﬁ∞¿Ç™1Ç¬Ç≈Ç‡Ç†ÇÈèÍçáÇÕ¡™Ø∏OKÅBÇ»Ç¢èÍçáÇÕ¡™Ø∏NGÇ≈é¿çsèàóùÇíÜé~Ç∑ÇÈÅB
                If intJituChkCnt > 0 Then
                    fnc_CheckJituData = FUNCTION_RETURN_SUCCESS
                    intJituChkCnt = 0
                Else
                    fnc_CheckJituData = FUNCTION_RETURN_FAILURE
                    Exit For
                End If
            Next
        Else
            For intChkRow = intRow - 1 To intRow
                .row = intChkRow

                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                For intChkCol = 11 To 35
                    .col = intChkCol
                    If .text = "1" Then
                        intJituChkCnt = intJituChkCnt + 1
                    End If
                Next
            Next

            'é¿ë™√ﬁ∞¿Ç™1Ç¬Ç≈Ç‡Ç†ÇÈèÍçáÇÕ¡™Ø∏OKÅBÇ»Ç¢èÍçáÇÕ¡™Ø∏NGÇ≈é¿çsèàóùÇíÜé~Ç∑ÇÈÅB
            If intJituChkCnt > 0 Then
                fnc_CheckJituData = FUNCTION_RETURN_SUCCESS
            End If
        End If
    End With
End Function

'*******************************************************************************
'*    ä÷êîñº        : sub_GetWafHinban
'*
'*    èàóùäTóv      : 1.ÉeÅ[ÉuÉãÇÃè„â∫ïiî‘ÇéÊìæÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_GetWafHinban()

    Dim sHin    As String
    Dim intPos  As Integer
    Dim m       As Integer
    Dim n       As Integer
    Dim i       As Integer
    Dim j       As Integer

    '' î≤éééwé¶ÉfÅ[É^ÇÃçXêV
    m = UBound(tblWafInd)
    n = UBound(tblHinNum)
    For i = 1 To m
        With tblWafInd(i)
            If i = 1 Then
                '' è„ïiî‘ÇÃéÊìæ
                intPos = orgXl.Hins.UpperArea(.INGOTPOS)
                If intPos < 0 Then
                    .HINUP.hinban = ""
                Else
                    .HINUP.hinban = orgXl.Hins(CStr(intPos)).hinban
                End If

                sHin = Trim$(.HINUP.hinban)

                If sHin = "" Or sHin = "G" Or sHin = "Z" Then
                    .HINUP.mnorevno = 0
                    .HINUP.factory = ""
                    .HINUP.opecond = ""
                Else
                    For j = 0 To n
                        If .HINUP.hinban = tblHinNum(j).hinban Then
                            .HINUP.mnorevno = tblHinNum(j).mnorevno
                            .HINUP.factory = tblHinNum(j).factory
                            .HINUP.opecond = tblHinNum(j).opecond
                            Exit For
                        End If
                    Next j
                End If
            Else
                If i = m Then
                    '' è„ïiî‘ÇÃéÊìæ
                    .HINUP.hinban = tblWafInd(i - 1).HINDN.hinban
                    .HINUP.mnorevno = tblWafInd(i - 1).HINDN.mnorevno
                    .HINUP.factory = tblWafInd(i - 1).HINDN.factory
                    .HINUP.opecond = tblWafInd(i - 1).HINDN.opecond

                    ' â∫ïiî‘ÇÃéÊìæ
                    intPos = orgXl.Hins.LowerArea(.INGOTPOS)
                    If (intPos = 9999) Then
                        .HINDN.hinban = ""
                    Else
                        .HINDN.hinban = orgXl.Hins(CStr(intPos)).hinban
                    End If
                    sHin = Trim$(.HINUP.hinban)
                    If sHin = "" Or sHin = "G" Or sHin = "Z" Then
                        .HINDN.mnorevno = 0
                        .HINDN.factory = ""
                        .HINDN.opecond = ""
                    Else
                        For j = 0 To n
                            If .HINDN.hinban = tblHinNum(j).hinban Then
                                .HINDN.mnorevno = tblHinNum(j).mnorevno
                                .HINDN.factory = tblHinNum(j).factory
                                .HINDN.opecond = tblHinNum(j).opecond
                                Exit For
                            End If
                        Next j
                    End If
                Else
                    .HINUP.hinban = tblWafInd(i - 1).HINDN.hinban
                    .HINUP.mnorevno = tblWafInd(i - 1).HINDN.mnorevno
                    .HINUP.factory = tblWafInd(i - 1).HINDN.factory
                    .HINUP.opecond = tblWafInd(i - 1).HINDN.opecond
                End If
            End If
        End With
    Next i
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_GetWafHinban01
'*
'*    èàóùäTóv      : 1.ÉeÅ[ÉuÉãÇÃè„â∫ïiî‘ÇéÊìæÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^       ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_GetWafHinban01(i As Integer)

    Dim sHin    As String
    Dim intPos  As Integer
    Dim m       As Integer
    Dim n       As Integer
    Dim j       As Integer

    '' î≤éééwé¶ÉfÅ[É^ÇÃçXêV
    m = UBound(tblWafInd)
    n = UBound(tblHinNum)
    With tblWafInd(i)
        If i = 1 Then
            '' è„ïiî‘ÇÃéÊìæ
            intPos = orgXl.Hins.UpperArea(.INGOTPOS)
            If intPos < 0 Then
                .HINUP.hinban = ""
            Else
                .HINUP.hinban = orgXl.Hins(CStr(intPos)).hinban
            End If
            sHin = Trim$(.HINUP.hinban)
            If sHin = "" Or sHin = "G" Or sHin = "Z" Then
                .HINUP.mnorevno = 0
                .HINUP.factory = ""
                .HINUP.opecond = ""
            Else
                For j = 0 To n
                    If .HINUP.hinban = tblHinNum(j).hinban Then
                        .HINUP.mnorevno = tblHinNum(j).mnorevno
                        .HINUP.factory = tblHinNum(j).factory
                        .HINUP.opecond = tblHinNum(j).opecond
                        Exit For
                    End If
                Next j
            End If
        Else
            If i = m Then
                '' è„ïiî‘ÇÃéÊìæ
                .HINUP.hinban = tblWafInd(i - 1).HINDN.hinban
                .HINUP.mnorevno = tblWafInd(i - 1).HINDN.mnorevno
                .HINUP.factory = tblWafInd(i - 1).HINDN.factory
                .HINUP.opecond = tblWafInd(i - 1).HINDN.opecond

                ' â∫ïiî‘ÇÃéÊìæ
                intPos = orgXl.Hins.LowerArea(.INGOTPOS)
                If (intPos = 9999) Then
                    .HINDN.hinban = ""
                Else
                    .HINDN.hinban = orgXl.Hins(CStr(intPos)).hinban
                End If

                sHin = Trim$(.HINUP.hinban)

                If sHin = "" Or sHin = "G" Or sHin = "Z" Then
                    .HINDN.mnorevno = 0
                    .HINDN.factory = ""
                    .HINDN.opecond = ""
                Else
                    For j = 0 To n
                        If .HINDN.hinban = tblHinNum(j).hinban Then
                            .HINDN.mnorevno = tblHinNum(j).mnorevno
                            .HINDN.factory = tblHinNum(j).factory
                            .HINDN.opecond = tblHinNum(j).opecond
                            Exit For
                        End If
                    Next j
                End If
            End If
        End If
    End With
End Sub

'*******************************************************************************
'*    ä÷êîñº        : fnc_BsmpID
'*
'*    èàóùäTóv      : 1.åãèªÉTÉìÉvÉãÇ∆WFÉTÉìÉvÉãïRïtÇØä÷êîåƒÇ—èoÇµÇÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^             ,ê‡ñæ
'*Å@Å@      Å@Å@      udtWfSampleÅ@ ,I  ,typ_WfSampleGr ,WFÉTÉìÉvÉãä«óù
'*Å@Å@      Å@Å@      j          Å@ ,I  ,Integer        ,tblWfSampleç\ë¢ëÃîzóÒóp∂≥›¿
'*
'*    ñﬂÇËíl        : åãèªÉTÉìÉvÉãÇÃÉuÉçÉbÉNID
'*
'*******************************************************************************
Private Function fnc_BsmpID(udtWfSample() As typ_WfSampleGr, j As Integer) As String
    Dim udtWfsmp    As typ_Wf_Smpl   'ïRïtÇØã§í ä÷êîóp(XSDCW) 2003/09/29 í«â¡
    Dim udtCrsmp    As typ_Cry_Smpl  'ïRïtÇØã§í ä÷êîóp(XSDCSñﬂÇËíl)

    With udtWfsmp
        .SXLIDCW = ""
        .TBKBNCW = udtWfSample(j).WFSMP.TBKBNCW
        .XTALCW = udtWfSample(j).WFSMP.XTALCW
        .INPOSCW = udtWfSample(j).WFSMP.INPOSCW
        .HINBCW = udtWfSample(j).WFSMP.HINBCW
        .REVNUMCW = udtWfSample(j).WFSMP.REVNUMCW
        .FACTORYCW = udtWfSample(j).WFSMP.FACTORYCW
        .OPECW = udtWfSample(j).WFSMP.OPECW
    End With

    If funConSxl_Wf_Sampl(udtWfsmp, udtCrsmp) < 0 Then
        'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉW
        fnc_BsmpID = ""
    End If

    fnc_BsmpID = udtCrsmp.CRYNUMCS
End Function

'*******************************************************************************
'*    ä÷êîñº        : sub_Set_SMP_TB
'*
'*    èàóùäTóv      : 1.ã§óLçsÇ™Ãﬁ€Ø∏ÇÃã´äEÇ≈SXLï™äÑÇµÇΩçsÇÃèÍçáÅAUDÇTBÇ…ïœçXÇ∑ÇÈÅB(äeåüç∏çÄñ⁄ÇÃª›ÃﬂŸID)
'*                      (UDÇTBÇ…ïœçX(äeåüç∏çÄñ⁄ÇÃª›ÃﬂŸID))
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^             ,ê‡ñæ
'*Å@Å@      Å@Å@      udtTmpWafSmp  ,I  ,typ_WfSampleGr ,WFÉTÉìÉvÉãä«óù
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_Set_SMP_TB(udtTmpWafSmp() As typ_WfSampleGr)

    Dim intCnt As Integer      'Ÿ∞Ãﬂ∂≥›¿

    'udtTmpWafSmpÇÃêîï™ÉãÅ[ÉvÇ∑ÇÈ (óÒ)
    For intCnt = 1 To UBound(udtTmpWafSmp)
        With udtTmpWafSmp(intCnt)
            'äeåüç∏çÄñ⁄ÇÃWFINDÇ™ÅA0à»äOÇ»ÇÁTBïœä∑èàóùÇçsÇ»Ç§
            If .WFSMP.WFINDRSCW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDRSCW)         'Rs
            If .WFSMP.WFINDOICW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDOICW)         'Oi
            If .WFSMP.WFINDB1CW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDB1CW)         'BMD1
            If .WFSMP.WFINDB2CW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDB2CW)         'BMD2
            If .WFSMP.WFINDB3CW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDB3CW)         'BMD3
            If .WFSMP.WFINDL1CW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDL1CW)         'OSF1
            If .WFSMP.WFINDL2CW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDL2CW)         'OSF2
            If .WFSMP.WFINDL3CW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDL3CW)         'OSF3
            If .WFSMP.WFINDL4CW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDL4CW)         'OSF4
            If .WFSMP.WFINDDSCW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDDSCW)         'DS
            If .WFSMP.WFINDDZCW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDDZCW)         'DZ
            If .WFSMP.WFINDSPCW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDSPCW)         'SPVE
            If .WFSMP.WFINDDO1CW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDDO1CW)       'DOi1
            If .WFSMP.WFINDDO2CW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDDO2CW)       'DOi2
            If .WFSMP.WFINDDO3CW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDDO3CW)       'DOi3
            If .WFSMP.WFINDOT1CW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDOT1CW)       'OT1
            If .WFSMP.WFINDOT2CW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDOT2CW)       'OT2
            If .WFSMP.WFINDAOICW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDAOICW)       'AOI
            If .WFSMP.WFINDGDCW <> "0" Then Call Cnv_GetSample(.WFSMP.WFSMPLIDGDCW)         'GD     '05/02/21 ooba

            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
            If .WFSMP.EPINDB1CW <> "0" Then Call Cnv_GetSample(.WFSMP.EPSMPLIDB1CW)         'BMD1E
            If .WFSMP.EPINDB2CW <> "0" Then Call Cnv_GetSample(.WFSMP.EPSMPLIDB2CW)         'BMD2E
            If .WFSMP.EPINDB3CW <> "0" Then Call Cnv_GetSample(.WFSMP.EPSMPLIDB3CW)         'BMD3E
            If .WFSMP.EPINDL1CW <> "0" Then Call Cnv_GetSample(.WFSMP.EPSMPLIDL1CW)         'OSF1E
            If .WFSMP.EPINDL2CW <> "0" Then Call Cnv_GetSample(.WFSMP.EPSMPLIDL2CW)         'OSF2E
            If .WFSMP.EPINDL3CW <> "0" Then Call Cnv_GetSample(.WFSMP.EPSMPLIDL3CW)         'OSF3E
        End With
    Next intCnt
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_MakeTBCME044
'*
'*    èàóùäTóv      : 1.ÉeÅ[ÉuÉãÇ÷ìoò^Ç≥ÇπÇÈÇΩÇﬂÇ…ç\ë¢ëÃç\íz
'*                      (WFÉTÉìÉvÉãä«óùÉeÅ[ÉuÉãÇÃçÏê¨)
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^             ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_MakeTBCME044()
    Dim m           As Integer
    Dim i           As Integer
    Dim j           As Integer
    Dim ii          As Integer
    Dim intCnt      As Integer      'SXLä«óùóp∂≥›¿
    Dim k           As Integer      'tblWfSampleç\ë¢ëÃîzóÒóp∂≥›¿

    Dim intDx1      As Integer
    Dim intDx2      As Integer
    Dim blBlkFlg    As Boolean      'SXL¡™Ø∏ŒﬁØ∏ΩÃ◊∏ﬁ
    Dim vGetIngotP1 As Variant
    Dim vGetIngotP2 As Variant

    '' WFÉTÉìÉvÉãä«óùÉeÅ[ÉuÉãç\ë¢ëÃÇÃê›íË
    m = UBound(tblNukishi)
    ReDim tblWfSample(0)
    ReDim CngSmpID_UD(0)

    i = 0
    k = 0

    For j = 1 To m
        If j <> 1 And j <> m Then
            If tblNukishi(j).INPOSCW <> -1 Then
                k = k + 1
                ReDim Preserve tblWfSample(k)

                i = i + 1
                With tblWafInd(i)
                    tblWfSample(k).BLOCKID = .BLOCKID                   ' ÉuÉçÉbÉNID
                    tblWfSample(k).blockp = .BlockPos                   ' ÉuÉçÉbÉNà íu
                    tblWfSample(k).WFSMP.SXLIDCW = tblWfSxlMng(i - 1 * ((j + 1) Mod 2)).SXLID  'SXLID

                    tblWfSample(k).WFSMP.SMPKBNCW = Right(tblNukishi(j).REPSMPLIDCW, 1) ' ÉTÉìÉvÉããÊï™
                    tblWfSample(k).WFSMP.TBKBNCW = IIf(tblWfSample(k).WFSMP.SMPKBNCW = "U" Or tblWfSample(k).WFSMP.SMPKBNCW = "B", "B", "T") 'TBãÊï™
                    tblWfSample(k).WFSMP.REPSMPLIDCW = tblNukishi(j).REPSMPLIDCW 'ë„ï\ÉTÉìÉvÉãID
                    tblWfSample(k).WFSMP.XTALCW = tblSXL.CRYNUM            ' åãèªî‘çÜ
                    tblWfSample(k).WFSMP.INPOSCW = .INGOTPOS                ' åãèªì‡à íu

                    'ÉTÉìÉvÉãIDÇ™É}ÉbÉvÇÃIDÇ∆àŸÇ»ÇÈÇ±Ç∆Ç÷ÇÃëŒâû 2003/04/23
                    If tblWfSample(k).WFSMP.TBKBNCW = "B" Then
                        tblWfSample(k).WFSMP.HINBCW = .HINUP.hinban         ' ïiî‘
                        tblWfSample(k).WFSMP.REVNUMCW = .HINUP.mnorevno     ' êªïiî‘çÜâ¸í˘î‘çÜ
                        tblWfSample(k).WFSMP.FACTORYCW = .HINUP.factory     ' çHèÍ
                        tblWfSample(k).WFSMP.OPECW = .HINUP.opecond         ' ëÄã∆èåè
                    Else
                        tblWfSample(k).WFSMP.HINBCW = .HINDN.hinban         ' ïiî‘
                        tblWfSample(k).WFSMP.REVNUMCW = .HINDN.mnorevno     ' êªïiî‘çÜâ¸í˘î‘çÜ
                        tblWfSample(k).WFSMP.FACTORYCW = .HINDN.factory     ' çHèÍ
                        tblWfSample(k).WFSMP.OPECW = .HINDN.opecond         ' ëÄã∆èåè
                    End If

                    tblWfSample(k).WFSMP.KTKBNCW = "0"                      ' ämíËãÊï™
                    tblWfSample(k).WFSMP.SMCRYNUMCW = fnc_BsmpID(tblWfSample, k)              'ÉTÉìÉvÉãÉuÉçÉbÉNIDÅ©ïRïtÇØä÷êî
                    tblWfSample(k).WFSMP.WFSMPLIDRSCW = IIf(tblNukishi(j).WFINDRSCW = "0", "", tblNukishi(j).WFSMPLIDRSCW) 'ÉTÉìÉvÉãID
                    tblWfSample(k).WFSMP.WFSMPLIDOICW = IIf(tblNukishi(j).WFINDOICW = "0", "", tblNukishi(j).WFSMPLIDOICW)
                    tblWfSample(k).WFSMP.WFSMPLIDB1CW = IIf(tblNukishi(j).WFINDB1CW = "0", "", tblNukishi(j).WFSMPLIDB1CW)
                    tblWfSample(k).WFSMP.WFSMPLIDB2CW = IIf(tblNukishi(j).WFINDB2CW = "0", "", tblNukishi(j).WFSMPLIDB2CW)
                    tblWfSample(k).WFSMP.WFSMPLIDB3CW = IIf(tblNukishi(j).WFINDB3CW = "0", "", tblNukishi(j).WFSMPLIDB3CW)
                    tblWfSample(k).WFSMP.WFSMPLIDL1CW = IIf(tblNukishi(j).WFINDL1CW = "0", "", tblNukishi(j).WFSMPLIDL1CW)
                    tblWfSample(k).WFSMP.WFSMPLIDL2CW = IIf(tblNukishi(j).WFINDL2CW = "0", "", tblNukishi(j).WFSMPLIDL2CW)
                    tblWfSample(k).WFSMP.WFSMPLIDL3CW = IIf(tblNukishi(j).WFINDL3CW = "0", "", tblNukishi(j).WFSMPLIDL3CW)
                    tblWfSample(k).WFSMP.WFSMPLIDL4CW = IIf(tblNukishi(j).WFINDL4CW = "0", "", tblNukishi(j).WFSMPLIDL4CW)
                    tblWfSample(k).WFSMP.WFSMPLIDDSCW = IIf(tblNukishi(j).WFINDDSCW = "0", "", tblNukishi(j).WFSMPLIDDSCW)
                    tblWfSample(k).WFSMP.WFSMPLIDDZCW = IIf(tblNukishi(j).WFINDDZCW = "0", "", tblNukishi(j).WFSMPLIDDZCW)
                    tblWfSample(k).WFSMP.WFSMPLIDSPCW = IIf(tblNukishi(j).WFINDSPCW = "0", "", tblNukishi(j).WFSMPLIDSPCW)
                    tblWfSample(k).WFSMP.WFSMPLIDDO1CW = IIf(tblNukishi(j).WFINDDO1CW = "0", "", tblNukishi(j).WFSMPLIDDO1CW)
                    tblWfSample(k).WFSMP.WFSMPLIDDO2CW = IIf(tblNukishi(j).WFINDDO2CW = "0", "", tblNukishi(j).WFSMPLIDDO2CW)
                    tblWfSample(k).WFSMP.WFSMPLIDDO3CW = IIf(tblNukishi(j).WFINDDO3CW = "0", "", tblNukishi(j).WFSMPLIDDO3CW)
                    tblWfSample(k).WFSMP.WFSMPLIDOT1CW = IIf(tblNukishi(j).WFINDOT1CW = "0", "", tblNukishi(j).WFSMPLIDOT1CW)
                    tblWfSample(k).WFSMP.WFSMPLIDOT2CW = IIf(tblNukishi(j).WFINDOT2CW = "0", "", tblNukishi(j).WFSMPLIDOT2CW)
                    tblWfSample(k).WFSMP.WFSMPLIDAOICW = IIf(tblNukishi(j).WFINDAOICW = "0", "", tblNukishi(j).WFSMPLIDAOICW)   'écë∂é_ëfí«â¡Å@03/12/15 ooba
                    tblWfSample(k).WFSMP.WFSMPLIDGDCW = IIf(tblNukishi(j).WFINDGDCW = "0", "", tblNukishi(j).WFSMPLIDGDCW)      'GDí«â¡Å@05/02/21 ooba

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    tblWfSample(k).WFSMP.EPSMPLIDB1CW = IIf(tblNukishi(j).EPINDB1CW = "0", "", tblNukishi(j).EPSMPLIDB1CW)
                    tblWfSample(k).WFSMP.EPSMPLIDB2CW = IIf(tblNukishi(j).EPINDB2CW = "0", "", tblNukishi(j).EPSMPLIDB2CW)
                    tblWfSample(k).WFSMP.EPSMPLIDB3CW = IIf(tblNukishi(j).EPINDB3CW = "0", "", tblNukishi(j).EPSMPLIDB3CW)
                    tblWfSample(k).WFSMP.EPSMPLIDL1CW = IIf(tblNukishi(j).EPINDL1CW = "0", "", tblNukishi(j).EPSMPLIDL1CW)
                    tblWfSample(k).WFSMP.EPSMPLIDL2CW = IIf(tblNukishi(j).EPINDL2CW = "0", "", tblNukishi(j).EPSMPLIDL2CW)
                    tblWfSample(k).WFSMP.EPSMPLIDL3CW = IIf(tblNukishi(j).EPINDL3CW = "0", "", tblNukishi(j).EPSMPLIDL3CW)
                    tblWfSample(k).WFSMP.WFINDRSCW = tblNukishi(j).WFINDRSCW        ' WFåüç∏éwé¶ÅiRs)
                    tblWfSample(k).WFSMP.WFINDOICW = tblNukishi(j).WFINDOICW        ' WFåüç∏éwé¶ÅiOi)
                    tblWfSample(k).WFSMP.WFINDB1CW = tblNukishi(j).WFINDB1CW        ' WFåüç∏éwé¶ÅiB1)
                    tblWfSample(k).WFSMP.WFINDB2CW = tblNukishi(j).WFINDB2CW        ' WFåüç∏éwé¶ÅiB2)
                    tblWfSample(k).WFSMP.WFINDB3CW = tblNukishi(j).WFINDB3CW        ' WFåüç∏éwé¶ÅiB3)
                    tblWfSample(k).WFSMP.WFINDL1CW = tblNukishi(j).WFINDL1CW        ' WFåüç∏éwé¶ÅiL1)
                    tblWfSample(k).WFSMP.WFINDL2CW = tblNukishi(j).WFINDL2CW        ' WFåüç∏éwé¶ÅiL2)
                    tblWfSample(k).WFSMP.WFINDL3CW = tblNukishi(j).WFINDL3CW        ' WFåüç∏éwé¶ÅiL3)
                    tblWfSample(k).WFSMP.WFINDL4CW = tblNukishi(j).WFINDL4CW        ' WFåüç∏éwé¶ÅiL4)
                    tblWfSample(k).WFSMP.WFINDDSCW = tblNukishi(j).WFINDDSCW        ' WFåüç∏éwé¶ÅiDS)
                    tblWfSample(k).WFSMP.WFINDDZCW = tblNukishi(j).WFINDDZCW        ' WFåüç∏éwé¶ÅiDZ)
                    tblWfSample(k).WFSMP.WFINDSPCW = tblNukishi(j).WFINDSPCW        ' WFåüç∏éwé¶ÅiSP)
                    tblWfSample(k).WFSMP.WFINDDO1CW = tblNukishi(j).WFINDDO1CW      ' WFåüç∏éwé¶ÅiD1)
                    tblWfSample(k).WFSMP.WFINDDO2CW = tblNukishi(j).WFINDDO2CW      ' WFåüç∏éwé¶ÅiD2)
                    tblWfSample(k).WFSMP.WFINDDO3CW = tblNukishi(j).WFINDDO3CW      ' WFåüç∏éwé¶ÅiD3)
                    tblWfSample(k).WFSMP.WFINDAOICW = tblNukishi(j).WFINDAOICW      ' WFåüç∏éwé¶ (AOi)    'écë∂é_ëfí«â¡Å@03/12/15 ooba
                    tblWfSample(k).WFSMP.WFINDGDCW = tblNukishi(j).WFINDGDCW        ' WFåüç∏éwé¶ (GD)     'GDí«â¡Å@05/02/21 ooba

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    tblWfSample(k).WFSMP.EPINDB1CW = tblNukishi(j).EPINDB1CW        ' WFåüç∏éwé¶ÅiB1E)
                    tblWfSample(k).WFSMP.EPINDB2CW = tblNukishi(j).EPINDB2CW        ' WFåüç∏éwé¶ÅiB2E)
                    tblWfSample(k).WFSMP.EPINDB3CW = tblNukishi(j).EPINDB3CW        ' WFåüç∏éwé¶ÅiB3E)
                    tblWfSample(k).WFSMP.EPINDL1CW = tblNukishi(j).EPINDL1CW        ' WFåüç∏éwé¶ÅiL1E)
                    tblWfSample(k).WFSMP.EPINDL2CW = tblNukishi(j).EPINDL2CW        ' WFåüç∏éwé¶ÅiL2E)
                    tblWfSample(k).WFSMP.EPINDL3CW = tblNukishi(j).EPINDL3CW        ' WFåüç∏éwé¶ÅiL3E)
                    tblWfSample(k).WFSMP.WFINDOT1CW = tblNukishi(j).WFINDOT1CW
                    tblWfSample(k).WFSMP.WFINDOT2CW = tblNukishi(j).WFINDOT2CW
                    tblWfSample(k).WFSMP.WFRESRS1CW = IIf(tblNukishi(j).WFRESRS1CW = "1", "1", "0")                ' WFåüç∏é¿ê—ÅiRs)
                    tblWfSample(k).WFSMP.WFRESOICW = IIf(tblNukishi(j).WFRESOICW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiOi)
                    tblWfSample(k).WFSMP.WFRESB1CW = IIf(tblNukishi(j).WFRESB1CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiB1)
                    tblWfSample(k).WFSMP.WFRESB2CW = IIf(tblNukishi(j).WFRESB2CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiB2Åj
                    tblWfSample(k).WFSMP.WFRESB3CW = IIf(tblNukishi(j).WFRESB3CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiB3)
                    tblWfSample(k).WFSMP.WFRESL1CW = IIf(tblNukishi(j).WFRESL1CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiL1)
                    tblWfSample(k).WFSMP.WFRESL2CW = IIf(tblNukishi(j).WFRESL2CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiL2)
                    tblWfSample(k).WFSMP.WFRESL3CW = IIf(tblNukishi(j).WFRESL3CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiL3)
                    tblWfSample(k).WFSMP.WFRESL4CW = IIf(tblNukishi(j).WFRESL4CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiDS)
                    tblWfSample(k).WFSMP.WFRESDSCW = IIf(tblNukishi(j).WFRESDSCW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiDZ)
                    tblWfSample(k).WFSMP.WFRESDZCW = IIf(tblNukishi(j).WFRESDZCW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiDZ)
                    tblWfSample(k).WFSMP.WFRESSPCW = IIf(tblNukishi(j).WFRESSPCW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiSP)
                    tblWfSample(k).WFSMP.WFRESDO1CW = IIf(tblNukishi(j).WFRESDO1CW = "1", "1", "0")                ' WFåüç∏é¿ê—ÅiDO1)
                    tblWfSample(k).WFSMP.WFRESDO2CW = IIf(tblNukishi(j).WFRESDO2CW = "1", "1", "0")                ' WFåüç∏é¿ê—ÅiDO2)
                    tblWfSample(k).WFSMP.WFRESDO3CW = IIf(tblNukishi(j).WFRESDO3CW = "1", "1", "0")                ' WFåüç∏é¿ê—ÅiDO3)
                    tblWfSample(k).WFSMP.WFRESOT1CW = IIf(tblNukishi(j).WFRESOT1CW = "1", "1", "0")
                    tblWfSample(k).WFSMP.WFRESOT2CW = IIf(tblNukishi(j).WFRESOT2CW = "1", "1", "0")
                    tblWfSample(k).WFSMP.WFRESAOICW = IIf(tblNukishi(j).WFRESAOICW = "1", "1", "0")                ' WFåüç∏é¿ê—ÅiAOi)  'écë∂é_ëfí«â¡
                    tblWfSample(k).WFSMP.WFRESGDCW = IIf(tblNukishi(j).WFRESGDCW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiGD)   'GDí«â¡

                    tblWfSample(k).WFSMP.WFHSGDCW = IIf(tblNukishi(j).WFHSGDCW = "1", "1", "0")                    ' ï€èÿFLGÅiGD)

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    tblWfSample(k).WFSMP.EPRESB1CW = IIf(tblNukishi(j).EPRESB1CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiB1E)
                    tblWfSample(k).WFSMP.EPRESB2CW = IIf(tblNukishi(j).EPRESB2CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiB2EÅj
                    tblWfSample(k).WFSMP.EPRESB3CW = IIf(tblNukishi(j).EPRESB3CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiB3E)
                    tblWfSample(k).WFSMP.EPRESL1CW = IIf(tblNukishi(j).EPRESL1CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiL1E)
                    tblWfSample(k).WFSMP.EPRESL2CW = IIf(tblNukishi(j).EPRESL2CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiL2E)
                    tblWfSample(k).WFSMP.EPRESL3CW = IIf(tblNukishi(j).EPRESL3CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiL3E)
                    tblWfSample(k).WFSMP.TSTAFFCW = txtStaffID.text
                    tblWfSample(k).WFSMP.KSTAFFCW = txtStaffID.text
                    tblWfSample(k).WFSMP.LIVKCW = "0"

                    j = j + 1
                    k = k + 1
                    ReDim Preserve tblWfSample(k)

                    tblWfSample(k).BLOCKID = .BLOCKID                   ' ÉuÉçÉbÉNID
                    tblWfSample(k).blockp = .BlockPos                   ' ÉuÉçÉbÉNà íu

                    tblWfSample(k).WFSMP.SXLIDCW = tblWfSxlMng(i - 1 * ((j + 1) Mod 2)).SXLID   'SXLID
                    tblWfSample(k).WFSMP.SMPKBNCW = Right(tblNukishi(j).REPSMPLIDCW, 1)         ' ÉTÉìÉvÉããÊï™
                    tblWfSample(k).WFSMP.TBKBNCW = IIf(tblWfSample(k).WFSMP.SMPKBNCW = "U" Or tblWfSample(k).WFSMP.SMPKBNCW = "B", "B", "T") 'TBãÊï™
                    tblWfSample(k).WFSMP.REPSMPLIDCW = tblNukishi(j).REPSMPLIDCW                'ë„ï\ÉTÉìÉvÉãID
                    tblWfSample(k).WFSMP.XTALCW = tblSXL.CRYNUM                                 ' åãèªî‘çÜ
                    tblWfSample(k).WFSMP.INPOSCW = .INGOTPOS                                    ' åãèªì‡à íu

                    If tblNukishi(j).TBKBNCW = "B" Then
                        tblWfSample(k).WFSMP.HINBCW = .HINUP.hinban     ' ïiî‘
                        tblWfSample(k).WFSMP.REVNUMCW = .HINUP.mnorevno ' êªïiî‘çÜâ¸í˘î‘çÜ
                        tblWfSample(k).WFSMP.FACTORYCW = .HINUP.factory ' çHèÍ
                        tblWfSample(k).WFSMP.OPECW = .HINUP.opecond     ' ëÄã∆èåè
                    Else
                        tblWfSample(k).WFSMP.HINBCW = .HINDN.hinban     ' ïiî‘
                        tblWfSample(k).WFSMP.REVNUMCW = .HINDN.mnorevno ' êªïiî‘çÜâ¸í˘î‘çÜ
                        tblWfSample(k).WFSMP.FACTORYCW = .HINDN.factory ' çHèÍ
                        tblWfSample(k).WFSMP.OPECW = .HINDN.opecond     ' ëÄã∆èåè
                    End If
                    tblWfSample(k).WFSMP.KTKBNCW = "0"                  ' ämíËãÊï™
                    tblWfSample(k).WFSMP.SMCRYNUMCW = fnc_BsmpID(tblWfSample, k)    ' ÉTÉìÉvÉãÉuÉçÉbÉNIDÅ©ïRïtÇØä÷êî

                    tblWfSample(k).WFSMP.WFSMPLIDRSCW = IIf(tblNukishi(j).WFINDRSCW = "0", "", tblNukishi(j).WFSMPLIDRSCW) 'ÉTÉìÉvÉãID
                    tblWfSample(k).WFSMP.WFSMPLIDOICW = IIf(tblNukishi(j).WFINDOICW = "0", "", tblNukishi(j).WFSMPLIDOICW)
                    tblWfSample(k).WFSMP.WFSMPLIDB1CW = IIf(tblNukishi(j).WFINDB1CW = "0", "", tblNukishi(j).WFSMPLIDB1CW)
                    tblWfSample(k).WFSMP.WFSMPLIDB2CW = IIf(tblNukishi(j).WFINDB2CW = "0", "", tblNukishi(j).WFSMPLIDB2CW)
                    tblWfSample(k).WFSMP.WFSMPLIDB3CW = IIf(tblNukishi(j).WFINDB3CW = "0", "", tblNukishi(j).WFSMPLIDB3CW)
                    tblWfSample(k).WFSMP.WFSMPLIDL1CW = IIf(tblNukishi(j).WFINDL1CW = "0", "", tblNukishi(j).WFSMPLIDL1CW)
                    tblWfSample(k).WFSMP.WFSMPLIDL2CW = IIf(tblNukishi(j).WFINDL2CW = "0", "", tblNukishi(j).WFSMPLIDL2CW)
                    tblWfSample(k).WFSMP.WFSMPLIDL3CW = IIf(tblNukishi(j).WFINDL3CW = "0", "", tblNukishi(j).WFSMPLIDL3CW)
                    tblWfSample(k).WFSMP.WFSMPLIDL4CW = IIf(tblNukishi(j).WFINDL4CW = "0", "", tblNukishi(j).WFSMPLIDL4CW)
                    tblWfSample(k).WFSMP.WFSMPLIDDSCW = IIf(tblNukishi(j).WFINDDSCW = "0", "", tblNukishi(j).WFSMPLIDDSCW)
                    tblWfSample(k).WFSMP.WFSMPLIDDZCW = IIf(tblNukishi(j).WFINDDZCW = "0", "", tblNukishi(j).WFSMPLIDDZCW)
                    tblWfSample(k).WFSMP.WFSMPLIDSPCW = IIf(tblNukishi(j).WFINDSPCW = "0", "", tblNukishi(j).WFSMPLIDSPCW)
                    tblWfSample(k).WFSMP.WFSMPLIDDO1CW = IIf(tblNukishi(j).WFINDDO1CW = "0", "", tblNukishi(j).WFSMPLIDDO1CW)
                    tblWfSample(k).WFSMP.WFSMPLIDDO2CW = IIf(tblNukishi(j).WFINDDO2CW = "0", "", tblNukishi(j).WFSMPLIDDO2CW)
                    tblWfSample(k).WFSMP.WFSMPLIDDO3CW = IIf(tblNukishi(j).WFINDDO3CW = "0", "", tblNukishi(j).WFSMPLIDDO3CW)
                    tblWfSample(k).WFSMP.WFSMPLIDOT1CW = IIf(tblNukishi(j).WFINDOT1CW = "0", "", tblNukishi(j).WFSMPLIDOT1CW)
                    tblWfSample(k).WFSMP.WFSMPLIDOT2CW = IIf(tblNukishi(j).WFINDOT2CW = "0", "", tblNukishi(j).WFSMPLIDOT2CW)
                    tblWfSample(k).WFSMP.WFSMPLIDAOICW = IIf(tblNukishi(j).WFINDAOICW = "0", "", tblNukishi(j).WFSMPLIDAOICW)   'écë∂é_ëfí«â¡Å@03/12/15 ooba
                    tblWfSample(k).WFSMP.WFSMPLIDGDCW = IIf(tblNukishi(j).WFINDGDCW = "0", "", tblNukishi(j).WFSMPLIDGDCW)      'GDí«â¡Å@05/02/21 ooba

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    tblWfSample(k).WFSMP.EPSMPLIDB1CW = IIf(tblNukishi(j).EPINDB1CW = "0", "", tblNukishi(j).EPSMPLIDB1CW)
                    tblWfSample(k).WFSMP.EPSMPLIDB2CW = IIf(tblNukishi(j).EPINDB2CW = "0", "", tblNukishi(j).EPSMPLIDB2CW)
                    tblWfSample(k).WFSMP.EPSMPLIDB3CW = IIf(tblNukishi(j).EPINDB3CW = "0", "", tblNukishi(j).EPSMPLIDB3CW)
                    tblWfSample(k).WFSMP.EPSMPLIDL1CW = IIf(tblNukishi(j).EPINDL1CW = "0", "", tblNukishi(j).EPSMPLIDL1CW)
                    tblWfSample(k).WFSMP.EPSMPLIDL2CW = IIf(tblNukishi(j).EPINDL2CW = "0", "", tblNukishi(j).EPSMPLIDL2CW)
                    tblWfSample(k).WFSMP.EPSMPLIDL3CW = IIf(tblNukishi(j).EPINDL3CW = "0", "", tblNukishi(j).EPSMPLIDL3CW)

                    tblWfSample(k).WFSMP.WFINDRSCW = tblNukishi(j).WFINDRSCW        ' WFåüç∏éwé¶ÅiRs)
                    tblWfSample(k).WFSMP.WFINDOICW = tblNukishi(j).WFINDOICW        ' WFåüç∏éwé¶ÅiOi)
                    tblWfSample(k).WFSMP.WFINDB1CW = tblNukishi(j).WFINDB1CW        ' WFåüç∏éwé¶ÅiB1)
                    tblWfSample(k).WFSMP.WFINDB2CW = tblNukishi(j).WFINDB2CW        ' WFåüç∏éwé¶ÅiB2)
                    tblWfSample(k).WFSMP.WFINDB3CW = tblNukishi(j).WFINDB3CW        ' WFåüç∏éwé¶ÅiB3)
                    tblWfSample(k).WFSMP.WFINDL1CW = tblNukishi(j).WFINDL1CW        ' WFåüç∏éwé¶ÅiL1)
                    tblWfSample(k).WFSMP.WFINDL2CW = tblNukishi(j).WFINDL2CW        ' WFåüç∏éwé¶ÅiL2)
                    tblWfSample(k).WFSMP.WFINDL3CW = tblNukishi(j).WFINDL3CW        ' WFåüç∏éwé¶ÅiL3)
                    tblWfSample(k).WFSMP.WFINDL4CW = tblNukishi(j).WFINDL4CW        ' WFåüç∏éwé¶ÅiL4)
                    tblWfSample(k).WFSMP.WFINDDSCW = tblNukishi(j).WFINDDSCW        ' WFåüç∏éwé¶ÅiDS)
                    tblWfSample(k).WFSMP.WFINDDZCW = tblNukishi(j).WFINDDZCW        ' WFåüç∏éwé¶ÅiDZ)
                    tblWfSample(k).WFSMP.WFINDSPCW = tblNukishi(j).WFINDSPCW        ' WFåüç∏éwé¶ÅiSP)
                    tblWfSample(k).WFSMP.WFINDDO1CW = tblNukishi(j).WFINDDO1CW      ' WFåüç∏éwé¶ÅiD1)
                    tblWfSample(k).WFSMP.WFINDDO2CW = tblNukishi(j).WFINDDO2CW      ' WFåüç∏éwé¶ÅiD2)
                    tblWfSample(k).WFSMP.WFINDDO3CW = tblNukishi(j).WFINDDO3CW      ' WFåüç∏éwé¶ÅiD3)
                    tblWfSample(k).WFSMP.WFINDOT1CW = tblNukishi(j).WFINDOT1CW
                    tblWfSample(k).WFSMP.WFINDOT2CW = tblNukishi(j).WFINDOT2CW
                    tblWfSample(k).WFSMP.WFINDAOICW = tblNukishi(j).WFINDAOICW      ' WFåüç∏éwé¶ (AOi)     'écë∂é_ëfí«â¡Å@03/12/15 ooba
                    tblWfSample(k).WFSMP.WFINDGDCW = tblNukishi(j).WFINDGDCW        ' WFåüç∏éwé¶ (GD)      'GDí«â¡Å@05/02/21 ooba

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    tblWfSample(k).WFSMP.EPINDB1CW = tblNukishi(j).EPINDB1CW        ' WFåüç∏éwé¶ÅiB1)
                    tblWfSample(k).WFSMP.EPINDB2CW = tblNukishi(j).EPINDB2CW        ' WFåüç∏éwé¶ÅiB2)
                    tblWfSample(k).WFSMP.EPINDB3CW = tblNukishi(j).EPINDB3CW        ' WFåüç∏éwé¶ÅiB3)
                    tblWfSample(k).WFSMP.EPINDL1CW = tblNukishi(j).EPINDL1CW        ' WFåüç∏éwé¶ÅiL1)
                    tblWfSample(k).WFSMP.EPINDL2CW = tblNukishi(j).EPINDL2CW        ' WFåüç∏éwé¶ÅiL2)
                    tblWfSample(k).WFSMP.EPINDL3CW = tblNukishi(j).EPINDL3CW        ' WFåüç∏éwé¶ÅiL3)
                    tblWfSample(k).WFSMP.WFRESRS1CW = IIf(tblNukishi(j).WFRESRS1CW = "1", "1", "0")               ' WFåüç∏é¿ê—ÅiRs)
                    tblWfSample(k).WFSMP.WFRESOICW = IIf(tblNukishi(j).WFRESOICW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiOi)
                    tblWfSample(k).WFSMP.WFRESB1CW = IIf(tblNukishi(j).WFRESB1CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiB1)
                    tblWfSample(k).WFSMP.WFRESB2CW = IIf(tblNukishi(j).WFRESB2CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiB2Åj
                    tblWfSample(k).WFSMP.WFRESB3CW = IIf(tblNukishi(j).WFRESB3CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiB3)
                    tblWfSample(k).WFSMP.WFRESL1CW = IIf(tblNukishi(j).WFRESL1CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiL1)
                    tblWfSample(k).WFSMP.WFRESL2CW = IIf(tblNukishi(j).WFRESL2CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiL2)
                    tblWfSample(k).WFSMP.WFRESL3CW = IIf(tblNukishi(j).WFRESL3CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiL3)
                    tblWfSample(k).WFSMP.WFRESL4CW = IIf(tblNukishi(j).WFRESL4CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiDS)
                    tblWfSample(k).WFSMP.WFRESDSCW = IIf(tblNukishi(j).WFRESDSCW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiDZ)
                    tblWfSample(k).WFSMP.WFRESDZCW = IIf(tblNukishi(j).WFRESDZCW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiDZ)
                    tblWfSample(k).WFSMP.WFRESSPCW = IIf(tblNukishi(j).WFRESSPCW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiSP)
                    tblWfSample(k).WFSMP.WFRESDO1CW = IIf(tblNukishi(j).WFRESDO1CW = "1", "1", "0")                 ' WFåüç∏é¿ê—ÅiDO1)
                    tblWfSample(k).WFSMP.WFRESDO2CW = IIf(tblNukishi(j).WFRESDO2CW = "1", "1", "0")                ' WFåüç∏é¿ê—ÅiDO2)
                    tblWfSample(k).WFSMP.WFRESDO3CW = IIf(tblNukishi(j).WFRESDO3CW = "1", "1", "0")                 ' WFåüç∏é¿ê—ÅiDO3)
                    tblWfSample(k).WFSMP.WFRESOT1CW = IIf(tblNukishi(j).WFRESOT1CW = "1", "1", "0")
                    tblWfSample(k).WFSMP.WFRESOT2CW = IIf(tblNukishi(j).WFRESOT2CW = "1", "1", "0")
                    tblWfSample(k).WFSMP.WFRESAOICW = IIf(tblNukishi(j).WFRESAOICW = "1", "1", "0")                 ' WFåüç∏é¿ê— (AOi)  'écë∂é_ëfí«â¡
                    tblWfSample(k).WFSMP.WFRESGDCW = IIf(tblNukishi(j).WFRESGDCW = "1", "1", "0")                   ' WFåüç∏é¿ê— (GD)   'GDí«â¡
                    tblWfSample(k).WFSMP.WFHSGDCW = IIf(tblNukishi(j).WFHSGDCW = "1", "1", "0")                     ' ï€èÿFLGÅiGD)

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    tblWfSample(k).WFSMP.EPRESB1CW = IIf(tblNukishi(j).EPRESB1CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiB1E)
                    tblWfSample(k).WFSMP.EPRESB2CW = IIf(tblNukishi(j).EPRESB2CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiB2EÅj
                    tblWfSample(k).WFSMP.EPRESB3CW = IIf(tblNukishi(j).EPRESB3CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiB3E)
                    tblWfSample(k).WFSMP.EPRESL1CW = IIf(tblNukishi(j).EPRESL1CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiL1E)
                    tblWfSample(k).WFSMP.EPRESL2CW = IIf(tblNukishi(j).EPRESL2CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiL2E)
                    tblWfSample(k).WFSMP.EPRESL3CW = IIf(tblNukishi(j).EPRESL3CW = "1", "1", "0")                  ' WFåüç∏é¿ê—ÅiL3E)
                    tblWfSample(k).WFSMP.TSTAFFCW = txtStaffID.text
                    tblWfSample(k).WFSMP.KSTAFFCW = txtStaffID.text
                    tblWfSample(k).WFSMP.LIVKCW = "0"

                    'Ãﬁ€Ø∏ÇÃã´äEÇ≈SXLï™äÑÇµÇΩèÍçáUDÇTBÇ…ïœçXÇ∑ÇÈ
                    intDx1 = k - 1:   intDx2 = k

                    blBlkFlg = False
                    With sprExamine
                        .col = 1
                        For ii = intDx1 To .MaxRows Step 2
                            .row = ii
                            If .CellType = CellTypeCheckBox Then
                                If .Value = "1" Then
                                    .GetText 5, ii, vGetIngotP1
                                    .GetText 5, ii + 1, vGetIngotP2
                                    If tblWfSample(intDx1).WFSMP.INPOSCW = CInt(vGetIngotP1) Or _
                                                tblWfSample(intDx1).WFSMP.INPOSCW = CInt(vGetIngotP2) Then
                                        blBlkFlg = True
                                        Exit For
                                    End If
                                End If
                            End If
                        Next
                    End With

                    If tblWfSample(intDx1).WFSMP.SMCRYNUMCW <> tblWfSample(intDx2).WFSMP.SMCRYNUMCW _
                       Or blBlkFlg = True Then
                        ' ïœçXëŒè€Ç…í«â¡
                        ReDim Preserve CngSmpID_UD(UBound(CngSmpID_UD) + 2)
                        CngSmpID_UD(UBound(CngSmpID_UD) - 1) = tblWfSample(intDx1).WFSMP.REPSMPLIDCW
                        CngSmpID_UD(UBound(CngSmpID_UD)) = tblWfSample(intDx2).WFSMP.REPSMPLIDCW

                        tblWfSample(intDx1).WFSMP.SMPKBNCW = Cnv_Smp_KB(tblWfSample(intDx1).WFSMP.SMPKBNCW)
                        tblWfSample(intDx2).WFSMP.SMPKBNCW = Cnv_Smp_KB(tblWfSample(intDx2).WFSMP.SMPKBNCW)
                        tblWfSample(intDx1).WFSMP.REPSMPLIDCW = left(tblWfSample(intDx1).WFSMP.REPSMPLIDCW, Len(tblWfSample(intDx1).WFSMP.REPSMPLIDCW) - 1) + tblWfSample(intDx1).WFSMP.SMPKBNCW
                        tblWfSample(intDx2).WFSMP.REPSMPLIDCW = left(tblWfSample(intDx2).WFSMP.REPSMPLIDCW, Len(tblWfSample(intDx2).WFSMP.REPSMPLIDCW) - 1) + tblWfSample(intDx2).WFSMP.SMPKBNCW
                    End If
                End With
            End If
        Else
            i = i + 1
            With tblWafInd(i)
                k = k + 1
                ReDim Preserve tblWfSample(k)

                tblWfSample(k).BLOCKID = ""                                 ' ÉuÉçÉbÉNID
                tblWfSample(k).WFSMP.XTALCW = tblSXL.CRYNUM                 ' åãèªî‘çÜ
                tblWfSample(k).WFSMP.INPOSCW = .INGOTPOS                    ' åãèªì‡à íu
                If i = 1 Then
                    tblWfSample(k).WFSMP.SXLIDCW = tblWfSxlMng(1).SXLID     'SXLID
                    tblWfSample(k).WFSMP.HINBCW = .HINDN.hinban             ' ïiî‘
                    tblWfSample(k).WFSMP.REVNUMCW = .HINDN.mnorevno         ' êªïiî‘çÜâ¸í˘î‘çÜ
                    tblWfSample(k).WFSMP.FACTORYCW = .HINDN.factory         ' çHèÍ
                    tblWfSample(k).WFSMP.OPECW = .HINDN.opecond             ' ëÄã∆èåè
                Else
                    tblWfSample(k).WFSMP.SXLIDCW = tblWfSxlMng(UBound(tblWfSxlMng)).SXLID  'SXLID ç≈å„ÇÃ
                    tblWfSample(k).WFSMP.HINBCW = .HINUP.hinban             ' ïiî‘
                    tblWfSample(k).WFSMP.REVNUMCW = .HINUP.mnorevno         ' êªïiî‘çÜâ¸í˘î‘çÜ
                    tblWfSample(k).WFSMP.FACTORYCW = .HINUP.factory         ' çHèÍ
                    tblWfSample(k).WFSMP.OPECW = .HINUP.opecond             ' ëÄã∆èåè
                End If
                tblWfSample(k).WFSMP.SMPKBNCW = tblNukishi(j).SMPKBNCW
                tblWfSample(k).WFSMP.TBKBNCW = tblNukishi(j).TBKBNCW        'TBãÊï™
                tblWfSample(k).WFSMP.SMCRYNUMCW = fnc_BsmpID(tblWfSample, k) 'ÉTÉìÉvÉãÉuÉçÉbÉNIDÅ©ïRïtÇØä÷êî
                tblWfSample(k).WFSMP.KSTAFFCW = txtStaffID.text             'çXêVé–àıID

                ''ëSêUë÷éûÇÃåãèªGDà¯åpÇ¨ëŒâû
                If i = 1 And bMotoGDcpyFlg(1) Then
                    tblWfSample(k).WFSMP.WFSMPLIDGDCW = CpyCrySmpl.TsmplidGD
                    tblWfSample(k).WFSMP.WFINDGDCW = CpyCrySmpl.TindGD
                    tblWfSample(k).WFSMP.WFRESGDCW = "1"
                    tblWfSample(k).WFSMP.WFHSGDCW = .SMP.WFHSGD
                ElseIf i <> 1 And bMotoGDcpyFlg(2) Then
                    tblWfSample(k).WFSMP.WFSMPLIDGDCW = CpyCrySmpl.BsmplidGD
                    tblWfSample(k).WFSMP.WFINDGDCW = CpyCrySmpl.BindGD
                    tblWfSample(k).WFSMP.WFRESGDCW = "1"
                    tblWfSample(k).WFSMP.WFHSGDCW = .SMP.WFHSGD
                End If
            End With
        End If
    Next j

    'Ãﬁ€Ø∏ÇÃã´äEÇ≈SXLï™äÑÇµÇΩèÍçáUDÇTBÇ…ïœçXÇ∑ÇÈ
    If UBound(CngSmpID_UD) > 0 Then
        Call sub_Set_SMP_TB(tblWfSample())
    End If
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_MakeTBCME042
'*
'*    èàóùäTóv      : 1.SXLä«óùÉeÅ[ÉuÉãÇ÷ìoò^Ç≥ÇπÇÈÇΩÇﬂÇ…ç\ë¢ëÃç\íz
'*                      (SXLä«óùÉeÅ[ÉuÉãÇÃçÏê¨)
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^             ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_MakeTBCME042()

    Dim udtTmpHin       As tFullHinban  ' ÉtÉãåÖïiî‘éÊìæópç\ë¢ëÃ
    Dim sNowHinban      As String       ' åªç›çsÇÃïiî‘
    Dim intNowIngotPos  As Integer      ' åªç›çsÇÃÉCÉìÉSÉbÉgà íu
    Dim intOldIngotPos  As Integer
    Dim sTmpSXLID       As String       ' SXLID
    Dim intNowSxlLen    As Integer      ' SXLÇÃí∑Ç≥
    Dim intSPoint       As Integer      ' çsà íuï€ë∂
    Dim intFlg          As Integer      ' îªï ÉtÉâÉO
    Dim m               As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim k               As Integer
    Dim vSampl          As Variant
    Dim intCounter      As Integer
    Dim sTemp           As String
    Dim vFlg            As Variant

    ReDim tblWfSxlMng(0)

    m = UBound(tblWafInd)
    k = 0
    For i = 1 To m - 1
        k = k + 1
        ReDim Preserve tblWfSxlMng(k)
        With tblWfSxlMng(k)
            If i = 1 Then
                .SXLID = tblSXL.SXLID     'SXLÇà íuÇ©ÇÁçÏê¨ÇµÇ»Ç®Ç∑Ç∆ÅASXLIDÇ™Ç∏ÇÍÇƒÇµÇ‹Ç§à◊ÅAå≥SXLIDÇÇªÇÃÇ‹Ç‹égÇ§ÇÊÇ§èCê≥
                .CRYNUM = ""                        ' åãèªî‘çÜ
            Else
                .SXLID = Mid(tblWafInd(i).BLOCKID, 1, 10) & GetWafPos(tblWafInd(i).INGOTPOS)
                .CRYNUM = tblSXL.CRYNUM              ' åãèªî‘çÜ
            End If

            'êÊì™SXLÇÃäJénà íuÇÕëOçHíˆÇÃäJénà íuÇ∆Ç»ÇÈ
            If i = 1 Then
                .INGOTPOS = SIngotP
            Else
                .INGOTPOS = tblWafInd(i).INGOTPOS               ' åãèªì‡äJénà íu
            End If
            .LENGTH = tblWafInd(i).LENGTH                       ' í∑Ç≥
            .hinban = tblWafInd(i).HINDN.hinban                 ' ïiî‘
            .REVNUM = tblWafInd(i).HINDN.mnorevno               ' êªïiî‘çÜâ¸í˘î‘çÜ
            .factory = tblWafInd(i).HINDN.factory               ' çHèÍ
            .opecond = tblWafInd(i).HINDN.opecond               ' ëÄã∆èåè
            .KRPROCCD = MGPRCD_WFC_SOUGOUHANTEI                 ' ä«óùçHíˆ
            .NOWPROC = PROCD_WFC_SOUGOUHANTEI                   ' åªç›çHíˆ
            .LPKRPROCCD = MGPRCD_WFC_SOUGOUHANTEI               ' ç≈èIí âﬂä«óùçHíˆ
            .LASTPASS = PROCD_WFC_SOUGOUHANTEI                  ' ç≈èIí âﬂçHíˆ

            '' Çyïiî‘Ç»ÇÁçÌèúãÊï™Ç∆ç≈èIèÛë‘ãÊï™ÇïœÇ¶ÇÈ
            If Trim(.hinban) = "Z" Then
                .DELCLS = "1"                                   ' çÌèúãÊï™
                .LSTATCLS = "H"                                 ' ç≈èIèÛë‘ãÊï™
            Else
                .DELCLS = "0"                                   ' çÌèúãÊï™
                .LSTATCLS = "T"                                 ' ç≈èIèÛë‘ãÊï™
            End If
            .HOLDCLS = "0"                                      ' ÉzÅ[ÉãÉhãÊï™

            'ïiî‘Ç1óÒí«â¡ÇµÇΩÇ±Ç∆Ç…ÇÊÇÈóÒÇÃïœçX
            sprExamine.row = i
            sprExamine.col = 9
            j = sprExamine.TypeComboBoxCurSel + 1
            .BDCAUS = Trim$(tblPrcList(j).CODE)                 ' ïsó«óùóR
            .COUNT = "0"                                        ' ñáêî
        End With
    Next i
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_MakeTBCMY007
'*
'*    èàóùäTóv      : 1.SXLämíËéwé¶ÉeÅ[ÉuÉãÇ÷ìoò^Ç≥ÇπÇÈÇΩÇﬂÇ…ç\ë¢ëÃç\íz
'*                      (SXLämíËéwé¶ÉeÅ[ÉuÉãÇÃçÏê¨)
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^             ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_MakeTBCMY007()
    Dim sNowBlockID     As String
    Dim intNowIngotPos  As Integer
    Dim m               As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim vChgSmpId       As Variant
    Dim vFlg            As Variant
    Dim vHinban         As Variant
    Dim intFuryoCmb     As Integer
    Dim sSmpId(2)       As String       'ã§óLª›ÃﬂŸID
    Dim k               As Integer
    Dim intCntSXL       As Integer      'SXL⁄∫∞ƒﬁêî
    Dim udtRsHIN        As tFullHinban  'î‰íÔçR(Rs)édóléÊìæïiî‘
    Dim sRsData(10)     As String       'î‰íÔçR(Rs)√ﬁ∞¿
    Dim sRsPtn          As String       'î‰íÔçR√ﬁ∞¿éÊìæ ﬂ¿∞›
    Dim intSxlPtn       As Integer      'ìoò^SXL ﬂ¿∞›
    Dim sHosho          As String       'ï€èÿï˚ñ@
'Add Start 2012/03/08 Y.Hitomi
    Dim iBlockHoshoCnt  As String       'ÉuÉçÉbÉNämíËÅiîpä¸ÅjâÒêî
'Add End   2012/03/08 Y.Hitomi

    
'                                       Åú1 : ëSîpä¸SXL
'                                       Åú2 : è„í«çûÇ›SXL
'                                       Åú3 : â∫í«çûÇ›SXL
'                                       Åú4 : SXLÇÃä‘ÇZ
'                                       Åú0 : éÊìæ√ﬁ∞¿Ç»Çµ

    sSmpId(1) = ""       'ª›ÃﬂŸID(From)èâä˙âª
    sSmpId(2) = ""       'ª›ÃﬂŸID(To)èâä˙âª
    intCntSXL = UBound(tblWfSample)
'Add Start 2012/03/08 Y.Hitomi
    iBlockHoshoCnt = 0
'Add End   2012/03/08 Y.Hitomi

    'ïiî‘Ç1óÒí«â¡ÇµÇΩÇ±Ç∆Ç…ÇÊÇÈóÒÇÃïœçX
    With sprExamine
        m = .MaxRows
        ReDim tblSxlKSiji(m)
        j = 0
        For i = 1 To m - 1 Step 2
            '' Zïiî‘Ç»ÇÁÉeÅ[ÉuÉãçÏê¨
            .row = i

            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
            .GetText 37, i, vFlg
            .GetText 2, i, vHinban

            If vHinban = "Z" Then
                j = j + 1

                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                .col = 39
                sNowBlockID = Mid(tblSXL.CRYNUM, 1, 9) & .text

                If i = 1 Then   'ä˘ë∂à íuÇ©ÇÁSXLIDÇÕçÏÇÁÇ»Ç¢
                    intNowIngotPos = SIngotP
                    tblSxlKSiji(j).SXL_ID = tblSXL.SXLID
                Else
                    .col = 5
                    intNowIngotPos = .text
                    '' SXL-ID
                    tblSxlKSiji(j).SXL_ID = GetSXLID(sNowBlockID, intNowIngotPos)
                End If

'                If CutCntFlg = 1 Then
                'Change 2009/10/20 Y.Hitomi
                If ChkHosho(tblSXL.SXLID, sHosho) = FUNCTION_RETURN_SUCCESS Then
                    If sHosho = 1 Then ''Ãﬁ€Ø∏ï€èÿ
                    
                        'Add Start 2012/03/08 Y.HitomiÅ@ÉuÉçÉbÉNämíËÅiîpä¸ÅjÇÕÅA1âÒÇÃÇ›Ç∆Ç∑ÇÈÅB
                        If iBlockHoshoCnt = 0 Then
                            iBlockHoshoCnt = iBlockHoshoCnt + 1
                        Else
                            j = j - 1
                            Exit For
                        End If
                        'Add End   2012/03/08 Y.Hitomi
                        
                        '' ÉuÉçÉbÉNID
                        tblSxlKSiji(j).BLOCKID = sNowBlockID
                        '' ÉTÉìÉvÉãID(From)
                        tblSxlKSiji(j).SAMPLE_FROM = ""
                        '' ÉTÉìÉvÉãID(To)
                        tblSxlKSiji(j).SAMPLE_TO = ""
                    ElseIf sHosho = 2 Then 'WFï€èÿ
                        '' ÉuÉçÉbÉNID
                        tblSxlKSiji(j).BLOCKID = ""
                        '' ÉTÉìÉvÉãID(From)
                        If i = 1 Then
                            tblSxlKSiji(j).SAMPLE_FROM = tblSXL.WFSMP(1).REPSMPLIDCW
                        Else
                            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                            .GetText 38, i, vChgSmpId
                            tblSxlKSiji(j).SAMPLE_FROM = vChgSmpId  'ÉTÉìÉvÉãIDÇçÏÇËíºÇ∑ïKóvÇÕÇ»Ç¢
                        End If
    
                        'ä÷òAÃﬁ€Ø∏ëŒâû 08/08/25 ooba
                        .row = i + 1
                        .col = 1
                        If .CellType = CellTypeCheckBox Then
                            If .Value = "0" And i < m - 1 Then
                                .GetText 2, i + 2, vHinban
                                If vHinban = "Z" Then
                                    i = i + 2
                                End If
                            End If
                        End If
                        
                        '' ÉTÉìÉvÉãID(To)
                        If i = m - 1 Then
                            tblSxlKSiji(j).SAMPLE_TO = tblSXL.WFSMP(2).REPSMPLIDCW
                        Else
                            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                            .GetText 38, i + 1, vChgSmpId
                            tblSxlKSiji(j).SAMPLE_TO = vChgSmpId
                        End If
    
                        ''îpä¸ª›ÃﬂŸIDã§óLëŒâû
                        sSmpId(1) = tblSxlKSiji(j).SAMPLE_FROM
                        sSmpId(2) = tblSxlKSiji(j).SAMPLE_TO
    
                        'ìoò^º›∏ﬁŸÇÃäeåüç∏çÄñ⁄Ç…ëŒÇ∑ÇÈª›ÃﬂŸóLñ≥Ç¡™Ø∏Ç∑ÇÈ
                        If chkComSAMPL(tblSXL.SXLID, sSmpId(1), sSmpId(1)) = FUNCTION_RETURN_SUCCESS Then
                            'é¿ë™Ç™Ç–Ç∆Ç¬Ç‡Ç»Ç¢èÍçáÅAã§óLª›ÃﬂŸIDÇìoò^Ç∑ÇÈ
                            If sSmpId(1) <> tblSxlKSiji(j).SAMPLE_FROM Then
                                tblSxlKSiji(j).SAMPLE_FROM = sSmpId(1)
                            End If
                        End If
    
                        'ìoò^º›∏ﬁŸÇÃäeåüç∏çÄñ⁄Ç…ëŒÇ∑ÇÈª›ÃﬂŸóLñ≥Ç¡™Ø∏Ç∑ÇÈ
                        If chkComSAMPL(tblSXL.SXLID, sSmpId(2), sSmpId(2)) = FUNCTION_RETURN_SUCCESS Then
                            'é¿ë™Ç™Ç–Ç∆Ç¬Ç‡Ç»Ç¢èÍçáÅAã§óLª›ÃﬂŸIDÇìoò^Ç∑ÇÈ
                            If sSmpId(2) <> tblSxlKSiji(j).SAMPLE_TO Then
                                tblSxlKSiji(j).SAMPLE_TO = sSmpId(2)
                            End If
                        End If
                        ''îpä¸ª›ÃﬂŸIDã§óLëŒâû
                    End If
                End If

                '' ämíËïiî‘
                tblSxlKSiji(j).hinban = tblSXL.hinban & Format(tblSXL.REVNUM, "00")

                '' ãÊï™ÉRÅ[Éh
                .row = i
                .col = 9
                intFuryoCmb = .TypeComboBoxCurSel + 1
                tblSxlKSiji(j).KUBUN = Trim$(tblPrcList(intFuryoCmb).CODE)       ' ïsó«óùóR

                '' ÉgÉâÉìÉUÉNÉVÉáÉìID
                tblSxlKSiji(j).TXID = "TX853I"

                ''î‰íÔçR√ﬁ∞¿éÊìæ
                tblSxlKSiji(j).MESDATA1TOP = " "
                tblSxlKSiji(j).MESDATA2TOP = " "
                tblSxlKSiji(j).MESDATA3TOP = " "
                tblSxlKSiji(j).MESDATA4TOP = " "
                tblSxlKSiji(j).MESDATA5TOP = " "
                tblSxlKSiji(j).MESDATA1BOT = " "
                tblSxlKSiji(j).MESDATA2BOT = " "
                tblSxlKSiji(j).MESDATA3BOT = " "
                tblSxlKSiji(j).MESDATA4BOT = " "
                tblSxlKSiji(j).MESDATA5BOT = " "
            End If
        Next i
    ReDim Preserve tblSxlKSiji(j)
    End With
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_MakeTBCMW005
'*
'*    èàóùäTóv      : 1.ÉeÅ[ÉuÉãìoò^ópÇ…WFëççáîªíËé¿ê—ÉeÅ[ÉuÉãç\ë¢ëÃÇÃê›íË
'*                      (WFëççáîªíËé¿ê—ÉeÅ[ÉuÉãç\ë¢ëÃê›íË)
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^             ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_MakeTBCMW005()

    Dim sCode As String

    With sprExamine
        .row = 1
        .col = 2
        sCode = IIf(Trim$(.text) = "Z", "2", "1")
    End With

    With tblWfHantei
        .CRYNUM = tblSXL.CRYNUM             ' åãèªî‘çÜ
        .INGOTPOS = tblSXL.INGOTPOS         ' ÉCÉìÉSÉbÉgà íu
        .CRYLEN = tblSXL.COUNT              ' í∑Ç≥
        .KRPROCCD = MGPRCD_WFC_SOUGOUHANTEI ' ä«óùçHíˆÉRÅ[Éh
        .PROCCODE = PROCD_WFC_SOUGOUHANTEI  ' çHíˆÉRÅ[Éh
        .SXLID = tblSXL.SXLID               ' SXLID
        .CODE = sCode                       ' ãÊï™ÉRÅ[Éh
        .TSTAFFID = txtStaffID.text         ' ìoò^é–àıID
        .KSTAFFID = ""                      ' çXêVé–àıID
    End With
End Sub

'*******************************************************************************
'*    ä÷êîñº        : sub_MakeTBCMW006
'*
'*    èàóùäTóv      : 1.ÉeÅ[ÉuÉãìoò^ópÇ…êUë÷îpä¸é¿ê—ÉeÅ[ÉuÉãç\ë¢ëÃÇÃê›íË
'*                      (êUë÷îpä¸é¿ê—ÉeÅ[ÉuÉãç\ë¢ëÃÇÃê›íË)
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^             ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_MakeTBCMW006()
    Dim udtTmpHin       As tFullHinban
    Dim sHin            As String
    Dim intNowIngotPos  As Integer
    Dim intDwnIngotPos  As Integer
    Dim m               As Integer
    Dim i               As Integer
    Dim vNukisiFlg      As Variant
    Dim intRowCnt       As Integer

    With sprExamine
        m = .MaxRows
        ReDim tblHuriHai(0) 'ç\ë¢ëÃÇÕäYìñçsÇÃéûÇÃÇ›ëùÇ‚Ç∑
        intRowCnt = 0

        For i = 1 To m
            .row = i

            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
            sprExamine.GetText 37, i, vNukisiFlg

            If (vNukisiFlg = 1) Or CheckGetSampleID(i) = True Then    'î≤ééçsÇæÇ¡ÇΩÇÁ
                If i = m Then
                    Exit For
                End If
                intRowCnt = intRowCnt + 1

                ReDim Preserve tblHuriHai(intRowCnt) 'ç\ë¢ëÃÇÕäYìñçsÇÃéûÇÃÇ›ëùÇ‚Ç∑
                .col = 5

                'êÊì™SXLÇÃäJénà íuÇÕëOçHíˆÇÃäJénà íuÇ∆Ç»ÇÈ
                If i = 1 Then
                    tblHuriHai(intRowCnt).INGOTPOS = SIngotP
                    intNowIngotPos = SIngotP
                Else
                    tblHuriHai(intRowCnt).INGOTPOS = .text
                    intNowIngotPos = .text
                End If

                'ç≈èISXLÇÃèIóπà íuÇÕëOçHíˆÇÃèIóπà íuÇ∆Ç»ÇÈ
                If i = m - 2 Then
                    intDwnIngotPos = EIngotP
                Else
                    .row = i + 1
                    intDwnIngotPos = .text
                    .row = i
                End If

                .col = 2
                If .row Mod 2 = 0 Then
                    Call GetLastHinban("", udtTmpHin)           ' ÉtÉãïiî‘
                    sHin = ""
                Else
                    Call GetLastHinban(.text, udtTmpHin)        ' ÉtÉãïiî‘
                    sHin = Trim$(.text)
                End If

                With tblHuriHai(intRowCnt)
                    .CRYNUM = tblSXL.CRYNUM                     ' åãèªî‘çÜ
                    If UBound(tblWafInd()) = 2 Then             '2çsÇÃéûÇæÇØÅAí∑Ç≥éÊìæèàóùïœçX
                        .CRYLEN = EIngotP - SIngotP
                    Else
                        .CRYLEN = intDwnIngotPos - intNowIngotPos     ' í∑Ç≥
                    End If
                    .KRPROCCD = MGPRCD_WFC_SOUGOUHANTEI         ' ä«óùçHíˆÉRÅ[Éh
                    .PROCCODE = PROCD_WFC_SOUGOUHANTEI          ' çHíˆÉRÅ[Éh
                    .TRANCLS = IIf(sHin = "Z", "1", "0")        ' èàóùãÊï™
                    .DUOGNUM = tblSXL.hinban                    ' ì]ópå≥ïiî‘
                    .DUOGREV = tblSXL.REVNUM                    ' ì]ópå≥ïiî‘ êªïiî‘çÜâ¸í˘î‘çÜ
                    .DUOGFACT = tblSXL.factory                  ' ì]ópå≥ïiî‘ çHèÍ
                    .DUOGOPCD = tblSXL.opecond                  ' ì]ópå≥ïiî‘ ëÄã∆èåè
                    .DUNWNUM = sHin                             ' ì]ópêÊïiî‘
                    .DUNWREV = udtTmpHin.mnorevno               ' ì]ópêÊïiî‘ êªïiî‘çÜâ¸í˘î‘çÜ
                    .DUNWFACT = udtTmpHin.factory               ' ì]ópêÊïiî‘ çHèÍ
                    .DUNWOPCD = udtTmpHin.opecond               ' ì]ópêÊïiî‘ ëÄã∆èåè
                    .TSTAFFID = txtStaffID.text                 ' ìoò^é–àıID
                    .KSTAFFID = ""                              ' çXêVé–àıID
                    .MUKESAKI = sCmbMukesaki
                End With
            End If
        Next i
    End With
End Sub

'*******************************************************************************
'*    ä÷êîñº        : fnc_Nukisi_LOAD_DISP
'*
'*    èàóùäTóv      : 1.SXLIDÇ©ÇÁÉuÉçÉbÉNÇhÇcÅiÇÕÇ›èoÇΩïîï™ÅjéÊìæ
'*                    2.ÉuÉçÉbÉNÅASXLIDñàÇÃÉuÉçÉbÉNÇrÇdÇpÅiÉuÉçÉbÉNì‡òAî‘ÅjÇÃ
'*                      ç≈ëÂÅAç≈è¨ílÇ∆ÇªÇÃëºèÓïÒéÊìæ
'*                    3.åüç∏çÄñ⁄éÊìæ
'*                    4.êUë÷¡™Ø∏(èâä˙ï\é¶)
'*                    5.Warp/çáê¨äpìxèÓïÒï\é¶
'*                    6.É`ÉFÉbÉNÉ{ÉbÉNÉXÇèâä˙ï\é¶
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^             ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*******************************************************************************
Private Function fnc_Nukisi_LOAD_DISP() As FUNCTION_RETURN
    Dim intRtn          As Integer
    Dim sBlockId        As String
    Dim intIngotpos()   As Integer
    Dim intWfNum        As Integer
    Dim i, j            As Integer
    Dim intErrCode      As Integer
    Dim intErrMsg       As String

    fnc_Nukisi_LOAD_DISP = FUNCTION_RETURN_FAILURE

    'ëOâÊñ Ç©ÇÁÇÃSXLIDÇéÊìæ
     ReDim tSXLID(0)
     tSXLID(0).SXLID = tblSXL.SXLID

    ''SXLIDÇ©ÇÁÉuÉçÉbÉNÇhÇcÅiÇÕÇ›èoÇΩïîï™ÅjéÊìæ
    If DBDRV_BLOCKIDGET() = FUNCTION_RETURN_FAILURE Then
        lblMsg.Caption = GetMsgStr("ESXL2")
        fnc_Nukisi_LOAD_DISP = FUNCTION_RETURN_FAILURE
        Exit Function
    End If

    ''ÉuÉçÉbÉNÅASXLIDñàÇÃÉuÉçÉbÉNÇrÇdÇpÅiÉuÉçÉbÉNì‡òAî‘ÅjÇÃç≈ëÂÅAç≈è¨ílÇ∆ÇªÇÃëºèÓïÒéÊìæ
    If DBDRV_MIN_MAX_SEQGET(intWfNum) = FUNCTION_RETURN_FAILURE Then
        fnc_Nukisi_LOAD_DISP = FUNCTION_RETURN_FAILURE
        Exit Function
    End If

    'åüç∏çÄñ⁄éÊìæ
    If DVDRV_KENSA_KOUMOKU(tKensa()) = FUNCTION_RETURN_FAILURE Then
        fnc_Nukisi_LOAD_DISP = FUNCTION_RETURN_FAILURE
        Exit Function
    End If

    'ÅfâÊñ ï\é¶
    Call sub_ExamineDisp(tKensa(), intIngotpos(), intWfNum)

    'êUë÷¡™Ø∏(èâä˙ï\é¶)
    lblMsg.Caption = ""
    ReDim tWarpMeasG(0)
    ReDim tKakuMeasG(0)
    'Add Start 2011/07/21 SMPK Nakamura åãèªñ åXÇ´É`ÉFÉbÉNí«â¡ëŒâû
    ReDim tKakuXMeasG(0)
    ReDim tKakuYMeasG(0)
    'Add End 2011/07/21 SMPK Nakamura åãèªñ åXÇ´É`ÉFÉbÉNí«â¡ëŒâû

    For i = 1 To UBound(tMapHin)
        tMapHinG = tMapHin(i)
        For j = 1 To 2
            If Not (tMapHinG.WARPFLG And tMapHinG.KAKUFLG) Then
                intRtn = funChkFurikaeShiyou("CW763", txtKSXLID.text, _
                                            tMapHinG.HIN, tMapHinG.HIN, _
                                            intErrCode, intErrMsg, typ_b, typ_CType, 0)

                tMapHin(i).WARPFLG = tMapHinG.WARPFLG       'WarpêUë÷¡™Ø∏Ã◊∏ﬁæØƒ
                tMapHin(i).KAKUFLG = tMapHinG.KAKUFLG       'çáê¨äpìxêUë÷¡™Ø∏Ã◊∏ﬁæØƒ

                'îªíËNG
                If intRtn = 1 Then
                    If Not tMapHinG.KAKUFLG Then
                        lblMsg.Caption = "WarpîªíËÉGÉâÅ[Å@ïiî‘êUë÷ÇçsÇ¡ÇƒÇ≠ÇæÇ≥Ç¢ÅB"
                    Else
                        lblMsg.Caption = "çáê¨äpìxîªíËÉGÉâÅ[Å@ïiî‘êUë÷ÇçsÇ¡ÇƒÇ≠ÇæÇ≥Ç¢ÅB"
                    End If

                'êUë÷¡™Ø∏¥◊∞
                ElseIf intRtn < 0 Then
                    fnc_Nukisi_LOAD_DISP = FUNCTION_RETURN_FAILURE
                    lblMsg.Caption = intErrMsg
                    Exit Function
                End If
            End If
        Next j
    Next i

    If bMapWarpFlg Then lblMsg.Caption = "WFÉ}ÉbÉvÇ∆Warpé¿ê—ÇÃïsàÍívÉGÉâÅ["

    'Warp/çáê¨äpìxèÓïÒï\é¶
    Call WarpKakuDisp(Me)

    'É`ÉFÉbÉNÉ{ÉbÉNÉXÇèâä˙ï\é¶
    Call sub_LOADDISP_ADD_CHECKBOX

    'êUë÷É`ÉFÉbÉNí«â¡Ç…ÇÊÇÈèCê≥
    Call sub_FurikaeMotoDataSet

    Erase intIngotpos

    fnc_Nukisi_LOAD_DISP = FUNCTION_RETURN_SUCCESS

End Function

'*******************************************************************************
'*    ä÷êîñº        : sub_ExamineDisp
'*
'*    èàóùäTóv      : 1.sprExamineÇ…ï\é¶Ç∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^             ,ê‡ñæ
'*Å@Å@      Å@Å@      udtKensa        ,I  ,typ_XSDCW      ,êVÉTÉìÉvÉãä«óù(SXL)
'*Å@Å@      Å@Å@      intIngotpos()   ,I  ,Integer        ,
'*Å@Å@      Å@Å@      intWfNum        ,I  ,Integer        ,WFñáêî
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************
Private Sub sub_ExamineDisp(ByRef udtKensa() As typ_XSDCW, ByRef intIngotpos() As Integer, ByRef intWfNum As Integer)
    Dim intUCount       As Integer
    Dim i, j, k         As Integer
    Dim intRtn          As Integer
    Dim sSmplID         As String
    Dim vInsertData     As Variant
    Dim intRowNo        As Integer
    Dim intUCount2      As Integer
    Dim dblSmplTopPos   As Double
    Dim intRowMod       As Integer
    Dim intKensaLoop    As Integer
    Dim m               As Integer
    Dim sList           As String
    Dim sBkSMPLID       As String
    Dim dblteikoku      As Double
    Dim intTingot       As Integer
    Dim intBingot       As Integer
    Dim vGetIngot       As Variant
    Dim blSampleChk     As Boolean
    Dim udtChkHin       As tFullHinban  '¡™Ø∏óp12åÖïiî‘
    Dim sBlkSmplID      As String       'åãèªª›ÃﬂŸé¿ê—
    Dim sCryindFlg      As String       'åãèªèÛë‘FLG
    Dim vGetHinban      As Variant      'ïiî‘
    Dim vGetBlockID     As Variant      'Ãﬁ€Ø∏ID
    Dim vGetBlockSEQ_S  As Variant      'Ãﬁ€Ø∏SEQ(Start)
    Dim vGetBlockSEQ_E  As Variant      'Ãﬁ€Ø∏SEQ(End)
    Dim vlvGetWFstatus  As Variant      'WFèÛë‘
    Dim sBuf            As String
    Dim sHinban         As String

    intUCount = UBound(tExamine)

    'ïiî‘Ç1óÒí«â¡Ç∑ÇÈÇ±Ç∆Ç…ÇÊÇÈóÒÇÃïœçX
    With sprExamine
        ''ÉãÅ[ÉväJén
        .MaxRows = 0
        .MaxRows = 1

        'åãèªé¿ê—à¯åpÇ¨√ﬁ∞¿èâä˙âª
        CpyCrySmpl.TsmplidGD = ""           'TOP_ª›ÃﬂŸID(GD)
        CpyCrySmpl.TindGD = ""              'TOP_èÛë‘FLG(GD)
        CpyCrySmpl.BsmplidGD = ""           'BOT_ª›ÃﬂŸID(GD)
        CpyCrySmpl.BindGD = ""              'BOT_èÛë‘FLG(GD)

        For i = 0 To intUCount
            blSampleChk = False
            .BlockMode = True
            .row = i + 1

            '' ÉuÉçÉbÉNID
            If i = 0 Then   'i = 0èàóùÇ∆ÅAelseiféûÅAÇ∆ìØÇ∂èàóùÇÇ∑ÇÈ
                vInsertData = Right(tExamine(i).LOTID, 3)
                .SetText 1, i + 1, vInsertData
                .BlockMode = True
                .backColor = COLOR_DISABLE
                .BlockMode = False
                .CellBorderType = 4     'årê¸è„
                .CellBorderStyle = 1
                .CellBorderColor = vbBlack
                .Action = 16
            ElseIf tExamine(i).LOTID <> tExamine(i - 1).LOTID Then
                .col = 1
                vInsertData = Right(tExamine(i).LOTID, 3)
                .SetText 1, i + 1, vInsertData
                .BlockMode = True
                .backColor = COLOR_DISABLE
                .BlockMode = False
                .CellBorderType = 4     'årê¸è„
                .CellBorderStyle = 1
                .CellBorderColor = vbBlack
                .Action = 16
            End If

            ''Å@ïiî‘
            If (i = 0) Then
                .col = 2
                .SetText 2, i + 1, tExamine(i).hinban
                sHinban = tExamine(i).hinban

                .BlockMode = True
                .backColor = vbWhite
                .BlockMode = False
                .CellBorderType = 4     'årê¸è„
                .CellBorderStyle = 1
                .CellBorderColor = vbBlack
                .Action = 16
                .Lock = False

                '' ÇvÇeñáêî
                .col = 7
                .SetText 7, i + 1, tExamine(i).CURRWPCS

                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                .SetText 43, i + 1, tExamine(i).CURRWPCS
                .CellBorderType = 4     'årê¸è„
                .CellBorderStyle = 1
                .CellBorderColor = vbBlack
                .Action = 16

                'ïiî‘2í«â¡
                .col = 3
                .SetText 3, i + 1, Format(tExamine(i).REVNUM, "00") & tExamine(i).factory & tExamine(i).opecond
                .backColor = COLOR_DISABLE
                .BlockMode = False
            ElseIf (tExamine(i).hinban <> tExamine(i - 1).hinban) Or (tExamine(i).LOTID <> tExamine(i - 1).LOTID) Then
                .col = 2
                .SetText 2, i + 1, tExamine(i).hinban
                sHinban = tExamine(i).hinban

                .BlockMode = True
                .backColor = vbWhite
                .BlockMode = False
                .CellBorderType = 4     'årê¸è„
                .CellBorderStyle = 1
                .CellBorderColor = vbBlack
                .Action = 16
                .Lock = False

                '' ÇvÇeñáêî
                .col = 7
                .SetText 7, i + 1, tExamine(i).CURRWPCS

                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                .SetText 43, i + 1, tExamine(i).CURRWPCS
                .CellBorderType = 4     'årê¸è„
                .CellBorderStyle = 1
                .CellBorderColor = vbBlack
                .Action = 16

                'ïiî‘2í«â¡
                .col = 3
                .SetText 3, i + 1, Format(tExamine(i).REVNUM, "00") & tExamine(i).factory & tExamine(i).opecond
                .backColor = COLOR_DISABLE
                .BlockMode = False
            Else
                'ÅfÉuÉçÉbÉNÇo
                sBuf = GetMukesaki(sHinban)
                .SetText 2, i + 1, sBuf
                sBaseMukesaki = sCmbMukeName

                .BlockMode = True
                .backColor = COLOR_DISABLE
                .BlockMode = False
            End If

            'ÅfÉuÉçÉbÉNÇo
            .SetText 4, i + 1, CStr(tExamine(i).RTOP_POS)
            .BlockMode = True
            .backColor = COLOR_DISABLE
            .BlockMode = False

            ''Å@åãèªÇo
            .SetText 5, i + 1, CStr(tExamine(i).RITOP_POS)
            .BlockMode = True
            .backColor = COLOR_DISABLE
            .BlockMode = False

            'ÅfÉ}ÉbÉvà íu
            .SetText 6, i + 1, Trim(CStr(tExamine(i).BLOCKSEQ))
            .BlockMode = True
            .backColor = COLOR_DISABLE
            .BlockMode = False

            'ÅfÇvÇeèÛë‘
            'WFèÛë‘îªíË
            .col = 8
            .row = i + 1
            .BlockMode = True
            .backColor = COLOR_DISABLE
            .BlockMode = False

            Select Case CStr(tExamine(i).WFSTA)
                Case gsWF_STA_0   'í èÌ
                    .SetText 8, i + 1, gsWF_STA_NORMAL
                    'ÉTÉìÉvÉãÉtÉâÉOîªíË
                    Select Case CStr(tExamine(i).SHAFLAG)
                        Case gsWF_SMPL_0
                            .SetText 8, i + 1, gsWF_STA_NORMAL
                        Case gsWF_SMPL_1
                            .SetText 8, i + 1, gsWF_STA_SIJI
                        Case gsWF_SMPL_2
                            .SetText 8, i + 1, gsWF_STA_SIJI_OK
                        Case gsWF_SMPL_3
                            .SetText 8, i + 1, gsWF_STA_SIJI_NG
                        Case gsWF_SMPL_4
                            .SetText 8, i + 1, gsWF_STA_SIJI_KEKKA
                    End Select
                Case gsWF_STA_1   'ã§óL
                    .SetText 8, i + 1, gsWF_STA_NORMAL
                Case gsWF_STA_4   'åáóé
                    'ÉTÉìÉvÉãÉtÉâÉOîªíË
                    Select Case CStr(tExamine(i).SHAFLAG)
                        Case gsWF_SMPL_0
                            .SetText 8, i + 1, gsWF_STA_NORMAL
                        Case gsWF_SMPL_1
                            .SetText 8, i + 1, gsWF_STA_SIJI
                        Case gsWF_SMPL_2
                            .SetText 8, i + 1, gsWF_STA_SIJI_OK
                        Case gsWF_SMPL_3
                            .SetText 8, i + 1, gsWF_STA_SIJI_NG
                        Case gsWF_SMPL_4
                            .SetText 8, i + 1, gsWF_STA_SIJI_KEKKA
                    End Select
            End Select

            'Åfïsó«ãÊï™
            .col = 9
            intRowMod = (i + 1) Mod 2
            If intRowMod = 0 Then
                .row = i + 1
                .CellType = CellTypeEdit
                .TypeHAlign = TypeHAlignLeft
                .TypeEditCharCase = TypeEditCharCaseSetNone
                .TypeEditMultiLine = False
                .TypeMaxEditLen = 60
                .col = 9
                .CellBorderType = 8     'årê¸â∫
                .CellBorderStyle = 1
                .CellBorderColor = vbBlack
                .Action = 16
            End If

            '' ãÊï™ÉRÉìÉ{ÇÃê›íË
            If i Mod 2 = 0 Then
                m = UBound(tblPrcList)
                sList = GetGPCodeDspStr(tblPrcList(1).CODE, tblPrcList(1).INFO1)

                For j = 2 To m
                    sList = sList & vbTab & GetGPCodeDspStr(tblPrcList(j).CODE, tblPrcList(j).INFO1)
                Next j

                .TypeComboBoxList = sList
                .TypeComboBoxCurSel = 0
                .Lock = False
            End If

            sSmplID = Mid(tExamine(i).SMPLEID, 10, 3) & "-" & Right(tExamine(i).SMPLEID, 4)
            sBkSMPLID = tExamine(i).SMPLEID

            Select Case tExamine(i).WFSTA
                Case "1" 'ã§í 
                    .SetText 10, i + 1, gsWF_SMPL_JOINT

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .SetText 38, i + 1, sBkSMPLID
                Case "0" 'í èÌ
                    If (tExamine(i).SHAFLAG <> "0") Then
                        .SetText 10, i + 1, sSmplID

                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .SetText 38, i + 1, sBkSMPLID
                    End If
                Case "4" 'åáóé
                    If (tExamine(i).SHAFLAG <> "0") Then
                        .SetText 10, i + 1, sSmplID
                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .SetText 38, i + 1, sBkSMPLID
                    End If
                Case Else
            End Select

            .col = 10
            .CellBorderType = 16    'årê¸äOòg
            .CellBorderStyle = 1
            .CellBorderColor = vbBlack
            .Action = 16

            'åüç∏çÄñ⁄ï\é¶
            .col = 11    'ÇRÅ`ÇXóÒñ⁄

            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
            .col2 = 35
            .row = i + 1
            .row2 = i + 1
            .BlockMode = True
            .backColor = vbWhite
            .BlockMode = False

            j = i
            blSampleChk = True

            If blSampleChk = True And tExamine(i).SHAFLAG <> "0" Then
                .row = i + 1
                .row2 = i + 1
                If IsNumeric(udtKensa(j).WFINDRSCW) = True Then
                        .col = 11
                        .col2 = 11
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDRSCW = "0", "", udtKensa(j).WFINDRSCW)
                        .BlockMode = False
                    If .text = "1" Then    '0:åüç∏Ç»Çµ ,1:í èÌ,2:îΩâf,3:êÑíË
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDOICW) = True Then
                        .col = 12
                        .col2 = 12
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDOICW = "0", "", udtKensa(j).WFINDOICW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDB1CW) = True Then
                        .col = 13
                        .col2 = 13
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDB1CW = "0", "", udtKensa(j).WFINDB1CW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDB2CW) = True Then
                        .col = 14
                        .col2 = 14
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDB2CW = "0", "", udtKensa(j).WFINDB2CW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDB3CW) = True Then
                        .col = 15
                        .col2 = 15
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDB3CW = "0", "", udtKensa(j).WFINDB3CW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDL1CW) = True Then
                        .col = 16
                        .col2 = 16
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDL1CW = "0", "", udtKensa(j).WFINDL1CW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDL2CW) = True Then
                        .col = 17
                        .col2 = 17
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDL2CW = "0", "", udtKensa(j).WFINDL2CW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDL3CW) = True Then
                        .col = 18
                        .col2 = 18
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDL3CW = "0", "", udtKensa(j).WFINDL3CW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDL4CW) = True Then
                        .col = 19
                        .col2 = 19
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDL4CW = "0", "", udtKensa(j).WFINDL4CW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP START
'''                        .backColor = vbYellow
'''                        .ForeColor = vbYellow
                        
                        ' ∏ﬁ⁄∞
                        .backColor = COLOR_CryJitsu
                        .ForeColor = COLOR_CryJitsu
                        'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP  END
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDDSCW) = True Then
                        .col = 20
                        .col2 = 20
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDDSCW = "0", "", udtKensa(j).WFINDDSCW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDDZCW) = True Then
                        .col = 21
                        .col2 = 21
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDDZCW = "0", "", udtKensa(j).WFINDDZCW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDSPCW) = True Then
                        .col = 22
                        .col2 = 22
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDSPCW = "0", "", udtKensa(j).WFINDSPCW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDDO1CW) = True Then
                        .col = 23
                        .col2 = 23
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDDO1CW = "0", "", udtKensa(j).WFINDDO1CW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDDO2CW) = True Then
                        .col = 24
                        .col2 = 24
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDDO2CW = "0", "", udtKensa(j).WFINDDO2CW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDDO3CW) = True Then
                        .col = 25
                        .col2 = 25
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDDO3CW = "0", "", udtKensa(j).WFINDDO3CW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If

                ''écë∂é_ëfí«â¡
                If IsNumeric(udtKensa(j).WFINDAOICW) = True Then
                        .col = 26
                        .col2 = 26
                        .BlockMode = True
                        .text = IIf(udtKensa(j).WFINDAOICW = "0", "", udtKensa(j).WFINDAOICW)
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If

                If IsNumeric(udtKensa(j).WFINDOT1CW) = True Then
                        .col = 27
                        .col2 = 27
                        .BlockMode = True
                       .text = IIf(udtKensa(j).WFINDOT1CW = "0", "", udtKensa(j).WFINDOT1CW)
                       .ForeColor = vbWhite
                        .BlockMode = False
                    If .text = "1" Then
                        .backColor = vbBlack
                        .ForeColor = vbBlack
                    ElseIf .text = "0" Then
                    End If
                End If
                If IsNumeric(udtKensa(j).WFINDOT2CW) = True Then
                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 35
                    .col2 = 35
                    .BlockMode = True
                    .text = IIf(udtKensa(j).WFINDOT2CW = "0", "", udtKensa(j).WFINDOT2CW)
                    .ForeColor = vbWhite
                    .BlockMode = False

                    If .text = "1" Then
                        .backColor = vbBlack
                        .ForeColor = vbBlack
                    ElseIf .text = "0" Then
                    End If
                End If

                'GDí«â¡
                If IsNumeric(udtKensa(j).WFINDGDCW) = True Then
                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .col = 28
                    .col2 = 28

                    .BlockMode = True
                    .text = IIf(udtKensa(j).WFINDGDCW = "0", "", udtKensa(j).WFINDGDCW)
                    .BlockMode = False

                    'é¿ë™
                    If .text = "1" And udtKensa(j).WFHSGDCW <> "1" Then
                        .backColor = vbBlack
                    'îΩâf
                    ElseIf .text = "2" And udtKensa(j).WFHSGDCW <> "1" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    'åãèªé¿ê—
                    ElseIf (.text = "1" Or .text = "2") And udtKensa(j).WFHSGDCW = "1" Then
                        .backColor = COLOR_CryJitsu
                        .ForeColor = COLOR_CryJitsu
                    End If
                End If

                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                'BMD1E
                If IsNumeric(udtKensa(j).EPINDB1CW) = True Then
                    .col = 29
                    .col2 = 29
                    .BlockMode = True
                    .text = IIf(udtKensa(j).EPINDB1CW = "0", "", udtKensa(j).EPINDB1CW)
                    .BlockMode = False

                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If

                'BMD2E
                If IsNumeric(udtKensa(j).EPINDB2CW) = True Then
                    .col = 30
                    .col2 = 30
                    .BlockMode = True
                    .text = IIf(udtKensa(j).EPINDB2CW = "0", "", udtKensa(j).EPINDB2CW)
                    .BlockMode = False

                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If

                'BMD3E
                If IsNumeric(udtKensa(j).EPINDB3CW) = True Then
                    .col = 31
                    .col2 = 31
                    .BlockMode = True
                    .text = IIf(udtKensa(j).EPINDB3CW = "0", "", udtKensa(j).EPINDB3CW)
                    .BlockMode = False

                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If

                'OSF1E
                If IsNumeric(udtKensa(j).EPINDL1CW) = True Then
                    .col = 32
                    .col2 = 32
                    .BlockMode = True
                    .text = IIf(udtKensa(j).EPINDL1CW = "0", "", udtKensa(j).EPINDL1CW)
                    .BlockMode = False

                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If

                'OSF2E
                If IsNumeric(udtKensa(j).EPINDL2CW) = True Then
                    .col = 33
                    .col2 = 33
                    .BlockMode = True
                    .text = IIf(udtKensa(j).EPINDL2CW = "0", "", udtKensa(j).EPINDL2CW)
                    .BlockMode = False

                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If

                'OSF3E
                If IsNumeric(udtKensa(j).EPINDL3CW) = True Then
                    .col = 34
                    .col2 = 34
                    .BlockMode = True
                    .text = IIf(udtKensa(j).EPINDL3CW = "0", "", udtKensa(j).EPINDL3CW)
                    .BlockMode = False

                    If .text = "1" Then
                        .backColor = vbBlack
                    ElseIf .text = "2" Then
                        .backColor = vbYellow
                        .ForeColor = vbYellow
                    End If
                End If
            End If

            '' åãèªGDîΩâfëŒâû
            'SXLÇÃTOPà íuÇ∆BOTà íuÇÃåãèªé¿ê—ÇéÊìæÇ∑ÇÈ
            If (i = 0) Or (i = intUCount) Then
                udtChkHin.hinban = ""
                udtChkHin.mnorevno = 0
                udtChkHin.factory = ""
                udtChkHin.opecond = ""

                'à¯åpÇ¨√ﬁ∞¿Ç™ë∂ç›Ç∑ÇÍÇŒÇªÇÃåãèªª›ÃﬂŸIDÅ^åãèªèÛë‘FLGÇæØƒ
                '--GD
                If funBlkSmpDataGet(udtKensa(j).SMCRYNUMCW, udtKensa(j).TBKBNCW, udtKensa(j).INPOSCW, _
                                        udtChkHin, 1, sBlkSmplID, sCryindFlg) = FUNCTION_RETURN_SUCCESS Then
                    'TOP
                    If udtKensa(j).TBKBNCW = "T" Then
                        CpyCrySmpl.TsmplidGD = sBlkSmplID       'ª›ÃﬂŸID(GD)
                        CpyCrySmpl.TindGD = sCryindFlg          'èÛë‘FLG(GD)
                    'BOT
                    ElseIf udtKensa(j).TBKBNCW = "B" Then
                        CpyCrySmpl.BsmplidGD = sBlkSmplID       'ª›ÃﬂŸID(GD)
                        CpyCrySmpl.BindGD = sCryindFlg          'èÛë‘FLG(GD)
                    End If
                End If
            End If

            'çÌèúÉ{É^ÉìÇÃè¡ãéã÷é~ÉtÉâÉO
            If (i = 0) Or (i = intUCount) Then
                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                .SetText 37, i + 1, "1"
            Else
                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                .SetText 37, i + 1, "3"
            End If

            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
            .SetText 39, i + 1, Right(tExamine(i).LOTID, 3)

            'ó\îıÉtÉBÅ[ÉãÉhÇ…ïiî‘ï€ë∂
            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
            .SetText 40, i + 1, tExamine(i).hinban

            .BlockMode = False
            .MaxRows = .MaxRows + 1
        Next i

        .MaxRows = .MaxRows - 1

        'êFÇÇ¬ÇØÇÈ
        .col = 1    'ÇPóÒñ⁄
        .col2 = 1
        .row = 1
        .row2 = .MaxRows
        .BlockMode = True
        .backColor = COLOR_DISABLE
        .BlockMode = False

        .col = 2    'ÇQóÒñ⁄
        .col2 = 2
        .row = 1
        .row2 = .MaxRows
        .BlockMode = True
        .backColor = vbWhite
        .BlockMode = False

        .col = 3    '3óÒñ⁄
        .col2 = 3
        .row = 1
        .row2 = .MaxRows
        .BlockMode = True
        .backColor = COLOR_DISABLE
        .BlockMode = False

        .col = 4    'ÇRÅ`ÇXóÒñ⁄
        .col2 = 10
        .row = 1
        .row2 = .MaxRows
        .BlockMode = True
        .backColor = COLOR_DISABLE
        .BlockMode = False

        .col = 1
        .col2 = 1
        .row = 1
        .row2 = .MaxRows
        .BlockMode = True
        .CellBorderType = 16
        .CellBorderStyle = CellBorderStyleSolid
        .CellBorderColor = vbBlack
        .Action = ActionSetCellBorder
        .BlockMode = False

        'WFœØÃﬂè„ÇÃïiî‘èÓïÒéÊìæ
        ReDim tMapHin(0)
        m = 0
        For i = 1 To .MaxRows Step 2
            'ïiî‘éÊìæ
            .GetText 2, i, vGetHinban
            If vGetHinban <> vbNullString And vGetHinban <> "Z" And vGetHinban <> "G" Then
                For j = 0 To UBound(tExamine)
                    If tExamine(j).hinban = CStr(vGetHinban) Then
                        m = m + 1
                        ReDim Preserve tMapHin(m)

                        tMapHin(m).HIN.hinban = tExamine(j).hinban
                        tMapHin(m).HIN.mnorevno = tExamine(j).REVNUM
                        tMapHin(m).HIN.factory = tExamine(j).factory
                        tMapHin(m).HIN.opecond = tExamine(j).opecond

                        'Ãﬁ€Ø∏IDéÊìæ
                        .GetText 39, i, vGetBlockID
                        tMapHin(m).BLOCKID = left(txtCryNum.text, 9) & CStr(vGetBlockID)

                        'Ãﬁ€Ø∏SEQéÊìæ
                        .GetText 6, i, vGetBlockSEQ_S
                        .GetText 6, i + 1, vGetBlockSEQ_E
                        tMapHin(m).BLKSEQ_S = CInt(vGetBlockSEQ_S)
                        tMapHin(m).BLKSEQ_E = CInt(vGetBlockSEQ_E)

                        'êUë÷¡™Ø∏Ã◊∏ﬁ
                        tMapHin(m).WARPFLG = False
                        tMapHin(m).KAKUFLG = False

                        'Add Start 2011/04/25 SMPK Miyata
                        tMapHin(m).XTALCS = txtCryNum.text      'åãèªî‘çÜ
                        .GetText 5, i, vGetIngot
                        tMapHin(m).INPOSCS_S = CInt(vGetIngot)  'åãèªì‡à íu(Start)
                        .GetText 5, i + 1, vGetIngot
                        tMapHin(m).INPOSCS_E = CInt(vGetIngot)  'åãèªì‡à íu(End)
                        'Add End   2011/04/25 SMPK Miyata

                        Exit For
                    End If
                Next j
            End If
        Next i

        'îMèàóùîªífèàóùí«â¡
        'WFèÛë‘Ç™"åãâ "ÇÃèÍçáÅAÉTÉìÉvÉãIDÇÃîwåiêFÇêÖêFÇ…Ç∑ÇÈ
        For i = 1 To .MaxRows Step 2
            'ïiî‘éÊìæ
            .GetText 2, i, vGetHinban
            If vGetHinban <> vbNullString And vGetHinban <> "Z" And vGetHinban <> "G" Then
                .col = 10
                'WFèÛë‘éÊìæ(TOP)
                .GetText 8, i, vlvGetWFstatus
                'WFèÛë‘Ç™"åãâ "ÇÃèÍçáÅAÉTÉìÉvÉãIDÇÃîwåiêFÇêÖêFÇ…Ç∑ÇÈ
                If Trim(vlvGetWFstatus) = gsWF_STA_SIJI_KEKKA Then
                    .row = i
                    .backColor = f_cmbc039_3.Label12.backColor
                End If
                'WFèÛë‘éÊìæ(BOTTOM)
                .GetText 8, i + 1, vlvGetWFstatus
                'WFèÛë‘Ç™"åãâ "ÇÃèÍçáÅAÉTÉìÉvÉãIDÇÃîwåiêFÇêÖêFÇ…Ç∑ÇÈ
                If Trim(vlvGetWFstatus) = gsWF_STA_SIJI_KEKKA Then
                    .row = i + 1
                    .backColor = f_cmbc039_3.Label12.backColor
                End If

            End If
        Next i
    End With

    'ÇÀÇÁÇ¢íÔçRÇÃè„å¿â∫å¿ÇâÊñ îÕàÕÇ…ïœçXÇµÇƒï\é¶Ç∑ÇÈ
    With sprExamine
        .GetText 5, 1, vGetIngot
        intTingot = CInt(vGetIngot)
        .GetText 5, .MaxRows, vGetIngot
        intBingot = CInt(vGetIngot)
    End With

    'ÉgÉbÉvë§íÔçRíl
    Call sub_Top_Btm_TEIKOU(intTingot, dblteikoku)
    txtTopRsltR.text = CStr(Format(dblteikoku, "0.0000"))

    'É{ÉgÉÄë§íÔçRíl
    Call sub_Top_Btm_TEIKOU(intBingot, dblteikoku)
    txtBotRsltR.text = CStr(Format(dblteikoku, "0.0000"))

    End Sub

'*******************************************************************************************
'*    ä÷êîñº        : sprExamine_ButtonClicked
'*
'*    èàóùäTóv      : 1.ÉTÉìÉvÉãÉtÉâÉOÉIÉtÇ…Ç∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      ,ê‡ñæ
'*Å@Å@      Å@Å@      col         ,I  ,Long    ,É{É^ÉìÇ™ÉNÉäÉbÉNÇ≥ÇÍÇΩÉZÉãÇÃóÒî‘çÜ
'*Å@Å@      Å@Å@      Row()       ,I  ,Long    ,É{É^ÉìÇ™ÉNÉäÉbÉNÇ≥ÇÍÇΩÉZÉãÇÃçsî‘çÜ
'*Å@Å@      Å@Å@      ButtonDown  ,I  ,Integer ,ï€éùå^É{É^ÉìÇÃèÛë‘ÅiÉ`ÉFÉbÉNÉ{ÉbÉNÉXÇÃèÛë‘Åj
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sprExamine_ButtonClicked(ByVal col As Long, ByVal row As Long, ByVal ButtonDown As Integer)
    With sprExamine
        If (col <> 1) Then
            Exit Sub
        End If

        '' ÉTÉìÉvÉãÉtÉâÉOÉIÉt
        bSampFlag = False
    End With
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : sprExamine_Click
'*
'*    èàóùäTóv      : 1.sprExamine_Clickèàóù
'*                      (åüç∏çÄñ⁄ÇÃóLñ≥ÇïœçX)
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      ,ê‡ñæ
'*Å@Å@      Å@Å@      col         ,I  ,Long    ,óÒ
'*Å@Å@      Å@Å@      Row         ,I  ,Long    ,çs
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sprExamine_Click(ByVal col As Long, ByVal row As Long)
    Dim vSMPLID         As Variant
    Dim intRtn          As Integer
    Dim intNukisiFlg    As Integer
    Dim vNukisiFlg      As Variant
    Dim intLoopCnt      As Integer
    Dim vKensa          As Variant
    Dim lngRow          As Long
    Dim vSamp           As Variant
    Dim sGetKensa       As String
    Dim vGetHinUp       As Variant
    Dim vGetHinDn       As Variant
    Dim udtHinUp        As tFullHinban
    Dim udtHinDn        As tFullHinban
    Dim udtHinban       As tFullHinban
    Dim vGetSample      As Variant
    Dim intNo           As Integer
    Dim vGetHin         As Variant
    Dim sOT1            As String
    Dim sOT2            As String
    Dim sKensaFlg       As String
    Dim sKensa          As String
    Dim i               As Integer
    Dim intk            As Integer
    Dim inth            As Integer
    Dim sHin            As String
    Dim intR1           As Integer
    Dim sMAI1           As String
    Dim sMAI2           As String

    'ïiî‘Ç1óÒí«â¡ÇµÇΩÇ±Ç∆Ç…ÇÊÇÈóÒÇÃïœçX
    With sprExamine
        If (col < 10) Then
            Exit Sub
        End If

        'ïiî‘Ç™ZÇÃÇ∆Ç´ÇÕèàóùÇÇµÇ»Ç¢
        If row Mod 2 = 0 Then
            .col = 2
            .row = row - 1
            sHin = Trim(.text)
        Else
            .col = 2
            .row = row
            sHin = Trim(.text)
        End If

        If sHin = "Z" Then
            Exit Sub
        End If

        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
        If col = 27 Or col = 35 Then
            .GetText 7, row, vSamp

            If vSamp = "åáóé" Then
                Exit Sub
            End If

            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
            .GetText 37, row, vNukisiFlg

            If (vNukisiFlg <> "9") And (vNukisiFlg <> "3") And (vNukisiFlg <> "1") Then
                .col = col
                .row = row

                If .backColor = vbWhite Then
                    'add start 2003/05/26 hitec)matsumoto ------------------------
                    If row Mod 2 = 0 Then
                        .GetText 2, row - 1, vGetHin
                    Else
                        .GetText 2, row, vGetHin
                    End If
                    udtHinban.hinban = vbNullString   'èâä˙âª
                    udtHinban.factory = vbNullString
                    udtHinban.mnorevno = 0
                    udtHinban.opecond = vbNullString
                    For intLoopCnt = 1 To UBound(tblsiyou)  'åüç∏édólç\ë¢ëÃÇ∆î‰ärÇµÅAäYìñÇÃÉtÉãåÖïiî‘éÊìæ
                        If tblHinbanRs(intLoopCnt).HIN.hinban = Trim(vGetHin) Then
                            udtHinban.hinban = tblHinbanRs(intLoopCnt).HIN.hinban
                            udtHinban.factory = tblHinbanRs(intLoopCnt).HIN.factory
                            udtHinban.mnorevno = tblHinbanRs(intLoopCnt).HIN.mnorevno
                            udtHinban.opecond = tblHinbanRs(intLoopCnt).HIN.opecond
                            Exit For
                        End If
                    Next
                    If udtHinban.hinban = vbNullString Then   'äYìñÇÃïiî‘Ç™ç\ë¢ëÃÇ…Ç»Ç©Ç¡ÇΩèÍçáâΩÇ‡ÇµÇ»Ç¢
                        Exit Sub
                    End If
                    If scmzc_getE036(udtHinban, sOT1, sOT2, sMAI1, sMAI2) = FUNCTION_RETURN_FAILURE Then
                        Exit Sub    'ÉGÉâÅ[ÇÃèÍçáâΩÇ‡ÇµÇ»Ç¢
                    End If

                    ''écë∂é_ëfåüç∏çÄñ⁄í«â¡Ç…ÇÊÇÈïœçX
                    If col = 27 Then
                        sKensaFlg = sOT1
                    Else
                        sKensaFlg = sOT2
                    End If
                    If sKensaFlg = "1" Then
                        .backColor = vbBlack
                        .ForeColor = vbBlack
                        .SetText col, row, "1"
                    End If
                Else
                    ' ïKÇ∏E036ÉeÅ[ÉuÉãÇÉ`ÉFÉbÉNÇ∑ÇÈÇÊÇ§Ç…ïœçXÇµÇΩÇÃÇ≈èàóùí«â¡
                    ' çïÅié¿ë™ÅjÅ®îíÅiñ≥ÇµÅj
                    .backColor = vbWhite
                    .ForeColor = vbWhite
                    .SetText col, row, ""
                End If
            End If

            Exit Sub
        End If

        .GetText 37, row, vNukisiFlg

        If vNukisiFlg <> "1" Then
            .col = col
            .row = row

            If .Lock = False And .backColor <> vbWhite Then
                If col <> 28 Then
                    .GetText col, row, vKensa
                    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP START
'''                    If vKensa = "2" Then
'''                        vKensa = "1"
'''                        Call sub_Cksmp(row, col, .text)
'''                        .ForeColor = vbBlack
'''                        .backColor = vbBlack
'''                    ElseIf vKensa = "1" Then
'''                        vKensa = "2"
'''                        Call sub_Cksmp(row, col, .text)
'''                        .ForeColor = vbYellow
'''                        .backColor = vbYellow
'''                    End If
                    
                    If col = 19 Then
                        If vKensa = "2" Then
                            vKensa = "1"
                            Call sub_Cksmp(row, col, .text)     ' ∏ﬁ⁄∞Å®çï
                            .ForeColor = vbBlack
                            .backColor = vbBlack
                        ElseIf vKensa = "1" Then
                            vKensa = "2"
                            Call sub_Cksmp(row, col, .text)     ' çïÅ®∏ﬁ⁄∞
                            .ForeColor = COLOR_CryJitsu
                            .backColor = COLOR_CryJitsu
                        End If
                    Else
                        If vKensa = "2" Then
                            vKensa = "1"
                            Call sub_Cksmp(row, col, .text)
                            .ForeColor = vbBlack
                            .backColor = vbBlack
                        ElseIf vKensa = "1" Then
                            vKensa = "2"
                            Call sub_Cksmp(row, col, .text)
                            .ForeColor = vbYellow
                            .backColor = vbYellow
                        End If
                    End If
                    
                    'Åü--- 2010/01/20 SIRDëŒâû SPK habuki REP  END
                    .SetText col, row, vKensa
                Else
                    'ª›ÃﬂŸñ¢èàóùÇÃèÍçáÇÕèàóùÇî≤ÇØÇÈ
                    If bSampFlag = False Then Exit Sub
                    .GetText col, row, vKensa
                    'îΩâfÅ^åãèªé¿ê—Å@Å®Å@é¿ë™
                    If vKensa = "2" Then
                        vKensa = "1"
                        Call sub_Cksmp(row, col, .text)
                        .ForeColor = vbBlack
                        .backColor = vbBlack
                    ElseIf vKensa = "1" Then
                        vKensa = "2"
                        Call sub_Cksmp(row, col, .text)
                        'é¿ë™Å@Å®Å@îΩâf
                        If tblNukishi(row).WFHSGDCW <> "1" Then
                            .ForeColor = vbYellow
                            .backColor = vbYellow
                        'é¿ë™Å@Å®Å@åãèªé¿ê—
                        Else
                            .ForeColor = COLOR_CryJitsu
                            .backColor = COLOR_CryJitsu
                        End If
                    End If
                    .SetText col, row, vKensa
                End If

                If row Mod 2 = 0 Then
                    intR1 = row + 1
                Else
                    intR1 = row - 1
                End If

                If tWafk(row).SAMPLEID = tWafk(intR1).SAMPLEID Then
                    .GetText 10, row, vSMPLID

                    If vSMPLID = gsWF_SMPL_JOINT Then
                        .GetText 44, row, vSMPLID   'UDï ï€ë∂ÇÃÉTÉìÉvÉãID
                        .SetText 38, row, vSMPLID

                        .SetText 10, row, Trim$(Mid(tblNukishi(row).REPSMPLIDCW, 10, 3) & "-" & Right(tblNukishi(row).REPSMPLIDCW, 4))
                        .SetText 8, row, gsWF_STA_SIJI
                    Else
                        For i = 0 To 24
                            If i <> 16 And i <> 24 Then
                                .col = i + 11
                                .row = row
                                sKensa = .text
                                If sKensa <> "" And sKensa <> "0" Then
                                    intk = intk + 1

                                    If sKensa = "2" Or .backColor = COLOR_CryJitsu Then   '05/02/24 ooba
                                        inth = inth + 1
                                    End If
                                End If
                            End If
                        Next i
                        If intk = inth Then 'åüç∏çÄñ⁄Ç™ëSÇƒâ©êF(îΩâf)
                            .SetText 10, row, gsWF_SMPL_JOINT
                            .SetText 8, row, gsWF_STA_NORMAL

                            'ï ÇÃç\ë¢ëÃÇ©ÇÁÉRÉsÅ[
                            vSMPLID = tWafk(row).SAMPLEID
                            .SetText 38, row, vSMPLID
                        Else 'é¿ÉfÅ[É^ÇÇ∆ÇÈèÍçá
                            .GetText 44, row, vSMPLID
                            .SetText 38, row, vSMPLID
                        End If
                    End If
                End If
            End If
        'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD START(TOP,BOTÇÕåüç∏çœÇ›ÇÃÇΩÇﬂïœçXïsâ¬)
'''        Else
'''            '<vNukisiFlg="1">ÅEÅEÅEcol=37
'''            .col = col: .row = row
'''            If .Lock = False Then
'''                If col = 19 Then
'''                    If .text = "1" Then
'''                        .SetText col, row, "2"  ' çïÅ®∏ﬁ⁄∞
'''                        .backColor = COLOR_CryJitsu
'''                        .ForeColor = COLOR_CryJitsu
'''                    Else
'''                        .SetText col, row, "1"  ' ∏ﬁ⁄∞Å®çï
'''                        .backColor = vbBlack
'''                        .ForeColor = vbBlack
'''                    End If
'''                End If
'''            End If
        'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD  END
        End If
    End With
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : sub_Cksmp
'*
'*    èàóùäTóv      : 1.åüç∏çÄñ⁄Ç™ÉNÉäÉbÉNÇ≥ÇÍÇΩÇ∆Ç´Ç…ÉTÉìÉvÉãIDÇïœçXÇ∑ÇÈ
'*
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      ,ê‡ñæ
'*Å@Å@      Å@Å@      R           ,I  ,Long    ,É{É^ÉìÇ™ÉNÉäÉbÉNÇ≥ÇÍÇΩÉZÉãÇÃóÒî‘çÜ
'*Å@Å@      Å@Å@      C           ,I  ,Long    ,É{É^ÉìÇ™ÉNÉäÉbÉNÇ≥ÇÍÇΩÉZÉãÇÃçsî‘çÜ
'*Å@Å@      Å@Å@      sHkbn        ,I  ,String  ,RCÇ≈ëIëÇ≥ÇÍÇΩTextÇÃíl
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sub_Cksmp(R As Long, C As Long, sHkbn As String)
    If sHkbn = "2" Then 'â©êFÅ®çï
        Select Case C
            Case 11
                tblNukishi(R).WFSMPLIDRSCW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESRS1CW = "0"
            Case 12
                tblNukishi(R).WFSMPLIDOICW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESOICW = "0"
            Case 13
                tblNukishi(R).WFSMPLIDB1CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESB1CW = "0"
            Case 14
                tblNukishi(R).WFSMPLIDB2CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESB2CW = "0"
            Case 15
                tblNukishi(R).WFSMPLIDB3CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESB3CW = "0"
            Case 16
                tblNukishi(R).WFSMPLIDL1CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESL1CW = "0"
            Case 17
                tblNukishi(R).WFSMPLIDL2CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESL2CW = "0"
            Case 18
                tblNukishi(R).WFSMPLIDL3CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESL3CW = "0"
            Case 19
                tblNukishi(R).WFSMPLIDL4CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESL4CW = "0"
            Case 20
                tblNukishi(R).WFSMPLIDDSCW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESDSCW = "0"
            Case 21
                tblNukishi(R).WFSMPLIDDZCW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESDZCW = "0"
            Case 22
                tblNukishi(R).WFSMPLIDSPCW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESSPCW = "0"
            Case 23
                tblNukishi(R).WFSMPLIDDO1CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESDO1CW = "0"
            Case 24
                tblNukishi(R).WFSMPLIDDO2CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESDO2CW = "0"
            Case 25
                tblNukishi(R).WFSMPLIDDO3CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESDO3CW = "0"
            ''écë∂é_ëfí«â¡
            Case 26
                tblNukishi(R).WFSMPLIDAOICW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESAOICW = "0"
            Case 27
                tblNukishi(R).WFSMPLIDOT1CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESOT1CW = "0"
            ' ÉGÉsêÊçsï]âøí«â¡
            Case 35
                tblNukishi(R).WFSMPLIDOT2CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESOT2CW = "0"
            'GDí«â¡
            Case 28
                tblNukishi(R).WFSMPLIDGDCW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).WFRESGDCW = "0"
                tblNukishi(R).WFHSGDCW = "0"
            Case 29
                tblNukishi(R).EPSMPLIDB1CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).EPRESB1CW = "0"
            Case 30
                tblNukishi(R).EPSMPLIDB2CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).EPRESB2CW = "0"
            Case 31
                tblNukishi(R).EPSMPLIDB3CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).EPRESB3CW = "0"
            Case 32
                tblNukishi(R).EPSMPLIDL1CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).EPRESL1CW = "0"
            Case 33
                tblNukishi(R).EPSMPLIDL2CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).EPRESL2CW = "0"
            Case 34
                tblNukishi(R).EPSMPLIDL3CW = tblNukishi(R).REPSMPLIDCW
                tblNukishi(R).EPRESL3CW = "0"
        End Select

        'ZÇ©Ç«Ç§Ç©ÇÃîªífÇÇµÇƒZÇÃÇ∆Ç´ÇÕÉTÉìÉvÉãIDÇÉRÉsÅ[Çµé¿ê—ÉtÉâÉOÇ0Ç…Ç∑ÇÈ
        Call sub_Zsample(R, C, sHkbn)
    ElseIf sHkbn = "1" Then 'Å®çïÅ®â©êF
        Select Case C
            Case 11
                tblNukishi(R).WFSMPLIDRSCW = tblKns(R).WFSMPLIDRSCW
                tblNukishi(R).WFRESRS1CW = tblKns(R).WFRESRS1CW
            Case 12
                tblNukishi(R).WFSMPLIDOICW = tblKns(R).WFSMPLIDOICW
                tblNukishi(R).WFRESOICW = tblKns(R).WFRESOICW
            Case 13
                tblNukishi(R).WFSMPLIDB1CW = tblKns(R).WFSMPLIDB1CW
                tblNukishi(R).WFRESB1CW = tblKns(R).WFRESB1CW
            Case 14
                tblNukishi(R).WFSMPLIDB2CW = tblKns(R).WFSMPLIDB2CW
                tblNukishi(R).WFRESB2CW = tblKns(R).WFRESB2CW
            Case 15
                tblNukishi(R).WFSMPLIDB3CW = tblKns(R).WFSMPLIDB3CW
                tblNukishi(R).WFRESB3CW = tblKns(R).WFRESB3CW
            Case 16
                tblNukishi(R).WFSMPLIDL1CW = tblKns(R).WFSMPLIDL1CW
                tblNukishi(R).WFRESL1CW = tblKns(R).WFRESL1CW
            Case 17
                tblNukishi(R).WFSMPLIDL2CW = tblKns(R).WFSMPLIDL2CW
                tblNukishi(R).WFRESL2CW = tblKns(R).WFRESL2CW
            Case 18
                tblNukishi(R).WFSMPLIDL3CW = tblKns(R).WFSMPLIDL3CW
                tblNukishi(R).WFRESL3CW = tblKns(R).WFRESL3CW
            Case 19
                tblNukishi(R).WFSMPLIDL4CW = tblKns(R).WFSMPLIDL4CW
                tblNukishi(R).WFRESL4CW = tblKns(R).WFRESL4CW
            Case 20
                tblNukishi(R).WFSMPLIDDSCW = tblKns(R).WFSMPLIDDSCW
                tblNukishi(R).WFRESDSCW = tblKns(R).WFRESDSCW
            Case 21
                tblNukishi(R).WFSMPLIDDZCW = tblKns(R).WFSMPLIDDZCW
                tblNukishi(R).WFRESDZCW = tblKns(R).WFRESDZCW
            Case 22
                tblNukishi(R).WFSMPLIDSPCW = tblKns(R).WFSMPLIDSPCW
                tblNukishi(R).WFRESSPCW = tblKns(R).WFRESSPCW
            Case 23
                tblNukishi(R).WFSMPLIDDO1CW = tblKns(R).WFSMPLIDDO1CW
                tblNukishi(R).WFRESDO1CW = tblKns(R).WFRESDO1CW
            Case 24
                tblNukishi(R).WFSMPLIDDO2CW = tblKns(R).WFSMPLIDDO2CW
                tblNukishi(R).WFRESDO2CW = tblKns(R).WFRESDO2CW
            Case 25
                tblNukishi(R).WFSMPLIDDO3CW = tblKns(R).WFSMPLIDDO3CW
                tblNukishi(R).WFRESDO3CW = tblKns(R).WFRESDO3CW
            ''écë∂é_ëfí«â¡
            Case 26
                tblNukishi(R).WFSMPLIDAOICW = tblKns(R).WFSMPLIDAOICW
                tblNukishi(R).WFRESAOICW = tblKns(R).WFRESAOICW
            Case 27
                tblNukishi(R).WFSMPLIDOT1CW = tblKns(R).WFSMPLIDOT1CW
                tblNukishi(R).WFRESOT1CW = tblKns(R).WFRESOT1CW
            ' ÉGÉsêÊçsï]âøí«â¡
            Case 35
                tblNukishi(R).WFSMPLIDOT2CW = tblKns(R).WFSMPLIDOT2CW
                tblNukishi(R).WFRESOT2CW = tblKns(R).WFRESOT2CW
            'GDí«â¡
            Case 28
                tblNukishi(R).WFSMPLIDGDCW = tblKns(R).WFSMPLIDGDCW
                tblNukishi(R).WFRESGDCW = tblKns(R).WFRESGDCW
                tblNukishi(R).WFHSGDCW = tblKns(R).WFHSGDCW
            Case 29
                tblNukishi(R).EPSMPLIDB1CW = tblKns(R).REPSMPLIDCW
                tblNukishi(R).EPRESB1CW = tblKns(R).EPRESB1CW
            Case 30
                tblNukishi(R).EPSMPLIDB2CW = tblKns(R).REPSMPLIDCW
                tblNukishi(R).EPRESB2CW = tblKns(R).EPRESB2CW
            Case 31
                tblNukishi(R).EPSMPLIDB3CW = tblKns(R).REPSMPLIDCW
                tblNukishi(R).EPRESB3CW = tblKns(R).EPRESB3CW
            Case 32
                tblNukishi(R).EPSMPLIDL1CW = tblKns(R).REPSMPLIDCW
                tblNukishi(R).EPRESL1CW = tblKns(R).EPRESL1CW
            Case 33
                tblNukishi(R).EPSMPLIDL2CW = tblKns(R).REPSMPLIDCW
                tblNukishi(R).EPRESL2CW = tblKns(R).EPRESL2CW
            Case 34
                tblNukishi(R).EPSMPLIDL3CW = tblKns(R).REPSMPLIDCW
                tblNukishi(R).EPRESL3CW = tblKns(R).EPRESL3CW
        End Select

        Call sub_Zsample(R, C, sHkbn)
    End If
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : sub_Zsample
'*
'*    èàóùäTóv      : 1.è„Ç‹ÇΩÇÕâ∫Ç™Zïiî‘ÇæÇ¡ÇΩÇÁ
'*Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@ZÇ…ëIëÇ≥ÇÍÇΩÉfÅ[É^ÇÃÉTÉìÉvÉãIDÇÉRÉsÅ[Çµé¿ê—ÉtÉâÉOÇ0Ç…Ç∑ÇÈ
'*Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@ç\ë¢ëÃÇ…ÉfÅ[É^ÇÉZÉbÉgÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      ,ê‡ñæ
'*Å@Å@      Å@Å@      R           ,I  ,Long    ,É{É^ÉìÇ™ÉNÉäÉbÉNÇ≥ÇÍÇΩÉZÉãÇÃóÒî‘çÜ
'*Å@Å@      Å@Å@      C           ,I  ,Long    ,É{É^ÉìÇ™ÉNÉäÉbÉNÇ≥ÇÍÇΩÉZÉãÇÃçsî‘çÜ
'*Å@Å@      Å@Å@      sHkbn        ,I  ,String  ,RCÇ≈ëIëÇ≥ÇÍÇΩTextÇÃíl
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sub_Zsample(R As Long, C As Long, sHkbn As String)
    'ÉNÉäÉbÉNÇµÇΩïiî‘ÇÃè„ïiî‘Ç‹ÇΩÇÕâ∫ïiî‘Ç™ZÇæÇ¡ÇΩèÍçá
    'ZÇ…ëIëÇ≥ÇÍÇΩÉfÅ[É^ÇÃÉTÉìÉvÉãIDÇÉRÉsÅ[Çµé¿ê—ÉtÉâÉOÇ0Ç…Ç∑ÇÈ
    'ç\ë¢ëÃÇ…ÉfÅ[É^ÇÉZÉbÉgÇ∑ÇÈ
    '3ÇÃÇ∆Ç´(è„ïiî‘Ç™Z)
    If R <= 2 Then
        Exit Sub
    End If

    If sHkbn = "2" Then 'â©êFÇçïÇ…
        If R Mod 2 = 0 Then
        '4ÇÃÇ∆Ç´(â∫ïiî‘Z)
            If Trim(tblNukishi(R + 1).HINBCW) = "Z" Then
                Select Case C
                    Case 11
                        tblNukishi(R + 1).WFSMPLIDRSCW = tblNukishi(R).WFSMPLIDRSCW
                        tblNukishi(R + 1).WFRESRS1CW = "0"
                    Case 12
                        tblNukishi(R + 1).WFSMPLIDOICW = tblNukishi(R).WFSMPLIDOICW
                        tblNukishi(R + 1).WFRESOICW = "0"
                    Case 13
                        tblNukishi(R + 1).WFSMPLIDB1CW = tblNukishi(R).WFSMPLIDB1CW
                        tblNukishi(R + 1).WFRESB1CW = "0"
                    Case 14
                        tblNukishi(R + 1).WFSMPLIDB2CW = tblNukishi(R).WFSMPLIDB2CW
                        tblNukishi(R + 1).WFRESB2CW = "0"
                    Case 15
                        tblNukishi(R + 1).WFSMPLIDB3CW = tblNukishi(R).WFSMPLIDB3CW
                        tblNukishi(R + 1).WFRESB3CW = "0"
                    Case 16
                        tblNukishi(R + 1).WFSMPLIDL1CW = tblNukishi(R).WFSMPLIDL1CW
                        tblNukishi(R + 1).WFRESL1CW = "0"
                    Case 17
                        tblNukishi(R + 1).WFSMPLIDL2CW = tblNukishi(R).WFSMPLIDL2CW
                        tblNukishi(R + 1).WFRESL2CW = "0"
                    Case 18
                        tblNukishi(R + 1).WFSMPLIDL3CW = tblNukishi(R).WFSMPLIDL3CW
                        tblNukishi(R + 1).WFRESL3CW = "0"
                    Case 19
                        tblNukishi(R + 1).WFSMPLIDL4CW = tblNukishi(R).WFSMPLIDL4CW
                        tblNukishi(R + 1).WFRESL4CW = "0"
                    Case 20
                        tblNukishi(R + 1).WFSMPLIDDSCW = tblNukishi(R).WFSMPLIDDSCW
                        tblNukishi(R + 1).WFRESDSCW = "0"
                    Case 21
                        tblNukishi(R + 1).WFSMPLIDDZCW = tblNukishi(R).WFSMPLIDDZCW
                        tblNukishi(R + 1).WFRESDZCW = "0"
                    Case 22
                        tblNukishi(R + 1).WFSMPLIDSPCW = tblNukishi(R).WFSMPLIDSPCW
                        tblNukishi(R + 1).WFRESSPCW = "0"
                    Case 23
                        tblNukishi(R + 1).WFSMPLIDDO1CW = tblNukishi(R).WFSMPLIDDO1CW
                        tblNukishi(R + 1).WFRESDO1CW = "0"
                    Case 24
                        tblNukishi(R + 1).WFSMPLIDDO2CW = tblNukishi(R).WFSMPLIDDO2CW
                        tblNukishi(R + 1).WFRESDO2CW = "0"
                    Case 25
                        tblNukishi(R + 1).WFSMPLIDDO3CW = tblNukishi(R).WFSMPLIDDO3CW
                        tblNukishi(R + 1).WFRESDO3CW = "0"
                    ''écë∂é_ëf
                    Case 26
                        tblNukishi(R + 1).WFSMPLIDAOICW = tblNukishi(R).WFSMPLIDAOICW
                        tblNukishi(R + 1).WFRESAOICW = "0"
                    Case 27
                        tblNukishi(R + 1).WFSMPLIDOT1CW = ""
                        tblNukishi(R + 1).WFRESOT1CW = "0"
                    ' ÉGÉsêÊçsï]âøí«â¡
                    Case 35
                        tblNukishi(R + 1).WFSMPLIDOT2CW = ""
                        tblNukishi(R + 1).WFRESOT2CW = "0"
                    'GDí«â¡
                    Case 28
                        tblNukishi(R + 1).WFSMPLIDGDCW = tblNukishi(R).WFSMPLIDGDCW
                        tblNukishi(R + 1).WFRESGDCW = "0"
                        tblNukishi(R + 1).WFHSGDCW = tblNukishi(R).WFHSGDCW
                    Case 29
                        tblNukishi(R + 1).EPSMPLIDB1CW = tblNukishi(R).EPSMPLIDB1CW
                        tblNukishi(R + 1).EPRESB1CW = "0"
                    Case 30
                        tblNukishi(R + 1).EPSMPLIDB2CW = tblNukishi(R).EPSMPLIDB2CW
                        tblNukishi(R + 1).EPRESB2CW = "0"
                    Case 31
                        tblNukishi(R + 1).EPSMPLIDB3CW = tblNukishi(R).EPSMPLIDB3CW
                        tblNukishi(R + 1).EPRESB3CW = "0"
                    Case 32
                        tblNukishi(R + 1).EPSMPLIDL1CW = tblNukishi(R).EPSMPLIDL1CW
                        tblNukishi(R + 1).EPRESL1CW = "0"
                    Case 33
                        tblNukishi(R + 1).EPSMPLIDL2CW = tblNukishi(R).EPSMPLIDL2CW
                        tblNukishi(R + 1).EPRESL2CW = "0"
                    Case 34
                        tblNukishi(R + 1).EPSMPLIDL3CW = tblNukishi(R).EPSMPLIDL3CW
                        tblNukishi(R + 1).EPRESL3CW = "0"
                End Select
            End If
        Else
            '3ÇÃÇ∆Ç´(è„ïiî‘Z)
            If Trim(tblNukishi(R - 1).HINBCW) = "Z" Then
                Select Case C
                    Case 11
                        tblNukishi(R - 1).WFSMPLIDRSCW = tblNukishi(R).WFSMPLIDRSCW
                        tblNukishi(R - 1).WFRESRS1CW = "0"
                    Case 12
                        tblNukishi(R - 1).WFSMPLIDOICW = tblNukishi(R).WFSMPLIDOICW
                        tblNukishi(R - 1).WFRESOICW = "0"
                    Case 13
                        tblNukishi(R - 1).WFSMPLIDB1CW = tblNukishi(R).WFSMPLIDB1CW
                        tblNukishi(R - 1).WFRESB1CW = "0"
                    Case 14
                        tblNukishi(R - 1).WFSMPLIDB2CW = tblNukishi(R).WFSMPLIDB2CW
                        tblNukishi(R - 1).WFRESB2CW = "0"
                    Case 15
                        tblNukishi(R - 1).WFSMPLIDB3CW = tblNukishi(R).WFSMPLIDB3CW
                        tblNukishi(R - 1).WFRESB3CW = "0"
                    Case 16
                        tblNukishi(R - 1).WFSMPLIDL1CW = tblNukishi(R).WFSMPLIDL1CW
                        tblNukishi(R - 1).WFRESL1CW = "0"
                    Case 17
                        tblNukishi(R - 1).WFSMPLIDL2CW = tblNukishi(R).WFSMPLIDL2CW
                        tblNukishi(R - 1).WFRESL2CW = "0"
                    Case 18
                        tblNukishi(R - 1).WFSMPLIDL3CW = tblNukishi(R).WFSMPLIDL3CW
                        tblNukishi(R - 1).WFRESL3CW = "0"
                    Case 19
                        tblNukishi(R - 1).WFSMPLIDL4CW = tblNukishi(R).WFSMPLIDL4CW
                        tblNukishi(R - 1).WFRESL4CW = "0"
                    Case 20
                        tblNukishi(R - 1).WFSMPLIDDSCW = tblNukishi(R).WFSMPLIDDSCW
                        tblNukishi(R - 1).WFRESDSCW = "0"
                    Case 21
                        tblNukishi(R - 1).WFSMPLIDDZCW = tblNukishi(R).WFSMPLIDDZCW
                        tblNukishi(R - 1).WFRESDZCW = "0"
                    Case 22
                        tblNukishi(R - 1).WFSMPLIDSPCW = tblNukishi(R).WFSMPLIDSPCW
                        tblNukishi(R - 1).WFRESSPCW = "0"
                    Case 23
                        tblNukishi(R - 1).WFSMPLIDDO1CW = tblNukishi(R).WFSMPLIDDO1CW
                        tblNukishi(R - 1).WFRESDO1CW = "0"
                    Case 24
                        tblNukishi(R - 1).WFSMPLIDDO2CW = tblNukishi(R).WFSMPLIDDO2CW
                        tblNukishi(R - 1).WFRESDO2CW = "0"
                    Case 25
                        tblNukishi(R - 1).WFSMPLIDDO3CW = tblNukishi(R).WFSMPLIDDO3CW
                        tblNukishi(R - 1).WFRESDO3CW = "0"
                    ''écë∂é_ëfí«â¡
                    Case 26
                        tblNukishi(R - 1).WFSMPLIDAOICW = tblNukishi(R).WFSMPLIDAOICW
                        tblNukishi(R - 1).WFRESAOICW = "0"
                    Case 27
                        tblNukishi(R - 1).WFSMPLIDOT1CW = ""
                        tblNukishi(R - 1).WFRESOT1CW = "0"
                    ' ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    Case 35
                        tblNukishi(R - 1).WFSMPLIDOT2CW = ""
                        tblNukishi(R - 1).WFRESOT2CW = "0"
                    'GDí«â¡
                    Case 28
                        tblNukishi(R - 1).WFSMPLIDGDCW = tblNukishi(R).WFSMPLIDGDCW
                        tblNukishi(R - 1).WFRESGDCW = "0"
                        tblNukishi(R - 1).WFHSGDCW = tblNukishi(R).WFHSGDCW
                    Case 29
                        tblNukishi(R - 1).EPSMPLIDB1CW = tblNukishi(R).EPSMPLIDB1CW
                        tblNukishi(R - 1).EPRESB1CW = "0"
                    Case 30
                        tblNukishi(R - 1).EPSMPLIDB2CW = tblNukishi(R).EPSMPLIDB2CW
                        tblNukishi(R - 1).EPRESB2CW = "0"
                    Case 31
                        tblNukishi(R - 1).EPSMPLIDB3CW = tblNukishi(R).EPSMPLIDB3CW
                        tblNukishi(R - 1).EPRESB3CW = "0"
                    Case 32
                        tblNukishi(R - 1).EPSMPLIDL1CW = tblNukishi(R).EPSMPLIDL1CW
                        tblNukishi(R - 1).EPRESL1CW = "0"
                    Case 33
                        tblNukishi(R - 1).EPSMPLIDL2CW = tblNukishi(R).EPSMPLIDL2CW
                        tblNukishi(R - 1).EPRESL2CW = "0"
                    Case 34
                        tblNukishi(R - 1).EPSMPLIDL3CW = tblNukishi(R).EPSMPLIDL3CW
                        tblNukishi(R - 1).EPRESL3CW = "0"
                End Select
            End If
        End If 'Mod
    ElseIf sHkbn = "1" Then  'Å®çïÅ®â©êF
        If R Mod 2 = 0 Then
        '4ÇÃÇ∆Ç´(â∫ïiî‘Z)
            If Trim(tblNukishi(R + 1).HINBCW) = "Z" Then
                Select Case C
                    Case 11
                        tblNukishi(R + 1).WFSMPLIDRSCW = tblKns(R + 1).WFSMPLIDRSCW
                        tblNukishi(R + 1).WFRESRS1CW = tblKns(R + 1).WFRESRS1CW
                    Case 12
                        tblNukishi(R + 1).WFSMPLIDOICW = tblKns(R + 1).WFSMPLIDOICW
                        tblNukishi(R + 1).WFRESOICW = tblKns(R + 1).WFRESOICW
                    Case 13
                        tblNukishi(R + 1).WFSMPLIDB1CW = tblKns(R + 1).WFSMPLIDB1CW
                        tblNukishi(R + 1).WFRESB1CW = tblKns(R + 1).WFRESB1CW
                    Case 14
                        tblNukishi(R + 1).WFSMPLIDB2CW = tblKns(R + 1).WFSMPLIDB2CW
                        tblNukishi(R + 1).WFRESB2CW = tblKns(R + 1).WFRESB2CW
                    Case 15
                        tblNukishi(R + 1).WFSMPLIDB3CW = tblKns(R + 1).WFSMPLIDB3CW
                        tblNukishi(R + 1).WFRESB3CW = tblKns(R + 1).WFRESB3CW
                    Case 16
                        tblNukishi(R + 1).WFSMPLIDL1CW = tblKns(R + 1).WFSMPLIDL1CW
                        tblNukishi(R + 1).WFRESL1CW = tblKns(R + 1).WFRESL1CW
                    Case 17
                        tblNukishi(R + 1).WFSMPLIDL2CW = tblKns(R + 1).WFSMPLIDL2CW
                        tblNukishi(R + 1).WFRESL2CW = tblKns(R + 1).WFRESL2CW
                    Case 18
                        tblNukishi(R + 1).WFSMPLIDL3CW = tblKns(R + 1).WFSMPLIDL3CW
                        tblNukishi(R + 1).WFRESL3CW = tblKns(R + 1).WFRESL3CW
                    Case 19
                        tblNukishi(R + 1).WFSMPLIDL4CW = tblKns(R + 1).WFSMPLIDL4CW
                        tblNukishi(R + 1).WFRESL4CW = tblKns(R + 1).WFRESL4CW
                    Case 20
                        tblNukishi(R + 1).WFSMPLIDDSCW = tblKns(R + 1).WFSMPLIDDSCW
                        tblNukishi(R + 1).WFRESDSCW = tblKns(R + 1).WFRESDSCW
                    Case 21
                        tblNukishi(R + 1).WFSMPLIDDZCW = tblKns(R + 1).WFSMPLIDDZCW
                        tblNukishi(R + 1).WFRESDZCW = tblKns(R + 1).WFRESDZCW
                    Case 22
                        tblNukishi(R + 1).WFSMPLIDSPCW = tblKns(R + 1).WFSMPLIDSPCW
                        tblNukishi(R + 1).WFRESSPCW = tblKns(R + 1).WFRESSPCW
                    Case 23
                        tblNukishi(R + 1).WFSMPLIDDO1CW = tblKns(R + 1).WFSMPLIDDO1CW
                        tblNukishi(R + 1).WFRESDO1CW = tblKns(R + 1).WFRESDO1CW
                    Case 24
                        tblNukishi(R + 1).WFSMPLIDDO2CW = tblKns(R + 1).WFSMPLIDDO2CW
                        tblNukishi(R + 1).WFRESDO2CW = tblKns(R + 1).WFRESDO2CW
                    Case 25
                        tblNukishi(R + 1).WFSMPLIDDO3CW = tblKns(R + 1).WFSMPLIDDO3CW
                        tblNukishi(R + 1).WFRESDO3CW = tblKns(R + 1).WFRESDO3CW
                    ''écë∂é_ëfí«â¡
                    Case 26
                        tblNukishi(R + 1).WFSMPLIDAOICW = tblKns(R + 1).WFSMPLIDAOICW
                        tblNukishi(R + 1).WFRESAOICW = tblKns(R + 1).WFRESAOICW
                    Case 27
                        tblNukishi(R + 1).WFSMPLIDOT1CW = tblKns(R + 1).WFSMPLIDOT1CW
                        tblNukishi(R + 1).WFRESOT1CW = tblKns(R + 1).WFRESOT1CW
                    ' ÉGÉsêÊçsï]âøí«â¡
                    Case 35
                        tblNukishi(R + 1).WFSMPLIDOT2CW = tblKns(R + 1).WFSMPLIDOT2CW
                        tblNukishi(R + 1).WFRESOT2CW = tblKns(R + 1).WFRESOT2CW
                    'GDí«â¡
                    Case 28
                        tblNukishi(R + 1).WFSMPLIDGDCW = tblKns(R + 1).WFSMPLIDGDCW
                        tblNukishi(R + 1).WFRESGDCW = tblKns(R + 1).WFRESGDCW
                        tblNukishi(R + 1).WFHSGDCW = tblKns(R + 1).WFHSGDCW
                    Case 29
                        tblNukishi(R + 1).EPSMPLIDB1CW = tblKns(R + 1).EPSMPLIDB1CW
                        tblNukishi(R + 1).EPRESB1CW = tblKns(R + 1).EPRESB1CW
                    Case 30
                        tblNukishi(R + 1).EPSMPLIDB2CW = tblKns(R + 1).EPSMPLIDB2CW
                        tblNukishi(R + 1).EPRESB2CW = tblKns(R + 1).EPRESB2CW
                    Case 31
                        tblNukishi(R + 1).EPSMPLIDB3CW = tblKns(R + 1).EPSMPLIDB3CW
                        tblNukishi(R + 1).EPRESB3CW = tblKns(R + 1).EPRESB3CW
                    Case 32
                        tblNukishi(R + 1).EPSMPLIDL1CW = tblKns(R + 1).EPSMPLIDL1CW
                        tblNukishi(R + 1).EPRESL1CW = tblKns(R + 1).EPRESL1CW
                    Case 33
                        tblNukishi(R + 1).EPSMPLIDL2CW = tblKns(R + 1).EPSMPLIDL2CW
                        tblNukishi(R + 1).EPRESL2CW = tblKns(R + 1).EPRESL2CW
                    Case 34
                        tblNukishi(R + 1).EPSMPLIDL3CW = tblKns(R + 1).EPSMPLIDL3CW
                        tblNukishi(R + 1).EPRESL3CW = tblKns(R + 1).EPRESL3CW
                End Select
            End If
        Else
            If Trim(tblNukishi(R - 1).HINBCW) = "Z" Then
                Select Case C
                    Case 11
                        tblNukishi(R - 1).WFSMPLIDRSCW = tblKns(R - 1).WFSMPLIDRSCW
                        tblNukishi(R - 1).WFRESRS1CW = tblKns(R - 1).WFRESRS1CW
                    Case 12
                        tblNukishi(R - 1).WFSMPLIDOICW = tblKns(R - 1).WFSMPLIDOICW
                        tblNukishi(R - 1).WFRESOICW = tblKns(R - 1).WFRESOICW
                    Case 13
                        tblNukishi(R - 1).WFSMPLIDB1CW = tblKns(R - 1).WFSMPLIDB1CW
                        tblNukishi(R - 1).WFRESB1CW = tblKns(R - 1).WFRESB1CW
                    Case 14
                        tblNukishi(R - 1).WFSMPLIDB2CW = tblKns(R - 1).WFSMPLIDB2CW
                        tblNukishi(R - 1).WFRESB2CW = tblKns(R - 1).WFRESB2CW
                    Case 15
                        tblNukishi(R - 1).WFSMPLIDB3CW = tblKns(R - 1).WFSMPLIDB3CW
                        tblNukishi(R - 1).WFRESB3CW = tblKns(R - 1).WFRESB3CW
                    Case 16
                        tblNukishi(R - 1).WFSMPLIDL1CW = tblKns(R - 1).WFSMPLIDL1CW
                        tblNukishi(R - 1).WFRESL1CW = tblKns(R - 1).WFRESL1CW
                    Case 17
                        tblNukishi(R - 1).WFSMPLIDL2CW = tblKns(R - 1).WFSMPLIDL2CW
                        tblNukishi(R - 1).WFRESL2CW = tblKns(R - 1).WFRESL2CW
                    Case 18
                        tblNukishi(R - 1).WFSMPLIDL3CW = tblKns(R - 1).WFSMPLIDL3CW
                        tblNukishi(R - 1).WFRESL3CW = tblKns(R - 1).WFRESL3CW
                    Case 19
                        tblNukishi(R - 1).WFSMPLIDL4CW = tblKns(R - 1).WFSMPLIDL4CW
                        tblNukishi(R - 1).WFRESL4CW = tblKns(R - 1).WFRESL4CW
                    Case 20
                        tblNukishi(R - 1).WFSMPLIDDSCW = tblKns(R - 1).WFSMPLIDDSCW
                        tblNukishi(R - 1).WFRESDSCW = tblKns(R - 1).WFRESDSCW
                    Case 21
                        tblNukishi(R - 1).WFSMPLIDDZCW = tblKns(R - 1).WFSMPLIDDZCW
                        tblNukishi(R - 1).WFRESDZCW = tblKns(R - 1).WFRESDZCW
                    Case 22
                        tblNukishi(R - 1).WFSMPLIDSPCW = tblKns(R - 1).WFSMPLIDSPCW
                        tblNukishi(R - 1).WFRESSPCW = tblKns(R - 1).WFRESSPCW
                    Case 23
                        tblNukishi(R - 1).WFSMPLIDDO1CW = tblKns(R - 1).WFSMPLIDDO1CW
                        tblNukishi(R - 1).WFRESDO1CW = tblKns(R - 1).WFRESDO1CW
                    Case 24
                        tblNukishi(R - 1).WFSMPLIDDO2CW = tblKns(R - 1).WFSMPLIDDO2CW
                        tblNukishi(R - 1).WFRESDO2CW = tblKns(R - 1).WFRESDO2CW
                    Case 25
                        tblNukishi(R - 1).WFSMPLIDDO3CW = tblKns(R - 1).WFSMPLIDDO3CW
                        tblNukishi(R - 1).WFRESDO3CW = tblKns(R - 1).WFRESDO3CW
                    ''écë∂é_ëf
                    Case 26
                        tblNukishi(R - 1).WFSMPLIDAOICW = tblKns(R - 1).WFSMPLIDAOICW
                        tblNukishi(R - 1).WFRESAOICW = tblKns(R - 1).WFRESAOICW
                    Case 27
                        tblNukishi(R - 1).WFSMPLIDOT1CW = tblKns(R - 1).WFSMPLIDOT1CW
                        tblNukishi(R - 1).WFRESOT1CW = tblKns(R - 1).WFRESOT1CW
                    ' ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    Case 35
                        tblNukishi(R - 1).WFSMPLIDOT2CW = tblKns(R - 1).WFSMPLIDOT2CW
                        tblNukishi(R - 1).WFRESOT2CW = tblKns(R - 1).WFRESOT2CW
                    'GDí«â¡
                    Case 28
                        tblNukishi(R - 1).WFSMPLIDGDCW = tblKns(R - 1).WFSMPLIDGDCW
                        tblNukishi(R - 1).WFRESGDCW = tblKns(R - 1).WFRESGDCW
                        tblNukishi(R - 1).WFHSGDCW = tblKns(R - 1).WFHSGDCW
                    Case 29
                        tblNukishi(R - 1).EPSMPLIDB1CW = tblKns(R - 1).EPSMPLIDB1CW
                        tblNukishi(R - 1).EPRESB1CW = tblKns(R - 1).EPRESB1CW
                    Case 30
                        tblNukishi(R - 1).EPSMPLIDB2CW = tblKns(R - 1).EPSMPLIDB2CW
                        tblNukishi(R - 1).EPRESB2CW = tblKns(R - 1).EPRESB2CW
                    Case 31
                        tblNukishi(R - 1).EPSMPLIDB3CW = tblKns(R - 1).EPSMPLIDB3CW
                        tblNukishi(R - 1).EPRESB3CW = tblKns(R - 1).EPRESB3CW
                    Case 32
                        tblNukishi(R - 1).EPSMPLIDL1CW = tblKns(R - 1).EPSMPLIDL1CW
                        tblNukishi(R - 1).EPRESL1CW = tblKns(R - 1).EPRESL1CW
                    Case 33
                        tblNukishi(R - 1).EPSMPLIDL2CW = tblKns(R - 1).EPSMPLIDL2CW
                        tblNukishi(R - 1).EPRESL2CW = tblKns(R - 1).EPRESL2CW
                    Case 34
                        tblNukishi(R - 1).EPSMPLIDL3CW = tblKns(R - 1).EPSMPLIDL3CW
                        tblNukishi(R - 1).EPRESL3CW = tblKns(R - 1).EPRESL3CW
                End Select
            End If
        End If
    End If
End Sub

'Del Start 2011/03/11 SMPK Miyata
''*******************************************************************************************
''*    ä÷êîñº        : Combo1_Change
''*
''*    èàóùäTóv      : 1.égópÇµÇƒÇ¢Ç»Ç¢ãCÇ™Ç∑ÇÈÅH
''*
''*
''*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      ,ê‡ñæ
''*Å@Å@      Å@Å@      Ç»Çµ
''*
''*    ñﬂÇËíl        : Ç»Çµ
''*
''*******************************************************************************************
'Private Sub Combo1_Change()
'    Dim blRtn       As Boolean
'    Dim sErrMsg     As String
'    Dim sBlkId      As String
'    Dim sSXLID      As String
'
'    Dim intLoopCnt  As Integer
'    Dim intSprSta   As Integer
'    Dim sSprSta     As String
'    Dim vSprSta     As Variant
'
'    With sprExamine
'        .ReDraw = False
'        For intLoopCnt = 1 To .MaxRows
'            Select Case cmbSprChg.ListIndex
'                Case intConSprChg_0  'ëSåèéwíË
'                    .row = intLoopCnt
'                    .RowHidden = False
'                Case intConSprChg_1  'ó«ïiéwíË
'                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
'                    .GetText 38, intLoopCnt, vSprSta
'
'                    If vSprSta <> intConSprChg_1 Then  'ó«ïià»äOÇæÇ¡ÇΩÇÁÅAîÒï\é¶
'                        .row = intLoopCnt
'                        .RowHidden = True
'                    Else
'                        .row = intLoopCnt
'                        .RowHidden = False
'                    End If
'                Case intConSprChg_2  'ÉTÉìÉvÉãéwíË
'                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
'                    .GetText 38, intLoopCnt, vSprSta
'
'                    If vSprSta <> intConSprChg_2 Then  'ÉTÉìÉvÉãà»äOÇæÇ¡ÇΩÇÁÅAîÒï\é¶
'                        .row = intLoopCnt
'                        .RowHidden = True
'                    Else
'                        .row = intLoopCnt
'                        .RowHidden = False
'                    End If
'                Case intConSprChg_3  'ïsó«éwíË
'                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
'                    .GetText 38, intLoopCnt, vSprSta
'
'                    If vSprSta <> intConSprChg_3 Then  'ïsó«à»äOÇæÇ¡ÇΩÇÁÅAîÒï\é¶
'                        .row = intLoopCnt
'                        .RowHidden = True
'                    Else
'                        .row = intLoopCnt
'                        .RowHidden = False
'                    End If
'            End Select
'        Next
'        .ReDraw = True
'    End With
'End Sub
'Del End   2011/03/11 SMPK Miyata

'*******************************************************************************************
'*    ä÷êîñº        : sub_F_InsertRow
'*
'*    èàóùäTóv      : 1.ÇPçsë}ì¸ÇçsÇ§
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sub_F_InsertRow()
    Dim intResult       As Integer
    Dim lngNewRow       As Long
    Dim lngNewRow2      As Long
    Dim vGetHinban      As Variant
    Dim vFirstFlg       As Variant
    Dim vActiveBLOCK    As Variant
    Dim vOldHinban      As Variant
    Dim i               As Integer

    'ç≈ëÂçsêîí«â¡
    sprExamine.MaxRows = sprExamine.MaxRows + 2

    intResult = sprExamine.ActiveRow Mod 2
    If intResult = 0 Then     'ãÙêîçsÇ»ÇÁè„2çsë}ì¸
        lngNewRow = sprExamine.ActiveRow
        lngNewRow2 = sprExamine.ActiveRow + 1
    Else                      'äÔêîÇ»ÇÁâ∫ÇQçsë}ì¸
        lngNewRow = sprExamine.ActiveRow + 1
        lngNewRow2 = sprExamine.ActiveRow + 2
    End If

    With sprExamine
        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
        .GetText 39, .ActiveRow, vActiveBLOCK   'ÉuÉçÉbÉNIDÇÕcol=30ÇÊÇËéÊìæ
        .GetText 40, .ActiveRow, vOldHinban

        .row = lngNewRow
        .row2 = lngNewRow2
        .col = (-1)
        .BlockMode = True
        .Action = ActionInsertRow
        .Protect = True

        'êFÅAårê¸ÅAÉçÉbÉNê›íË
        .backColor = vbWhite

        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
        .SetText 40, lngNewRow, vOldHinban
        .SetText 40, lngNewRow2, vOldHinban
        .SetText 39, lngNewRow, vActiveBLOCK
        .SetText 39, lngNewRow2, vActiveBLOCK

        .col = 1                'àÍî‘ç∂ÇÃóÒ
        .col2 = 1
        .CellBorderType = 2
        .CellBorderStyle = 1
        .CellBorderColor = vbBlack
        .Action = 16
        .backColor = &H80FF80

        .col = 4                'ç∂Ç©ÇÁ3î‘ñ⁄à»ç~
        .col2 = 10
        .backColor = &H80FF80
        .CellBorderType = 15
        .CellBorderStyle = 1
        .CellBorderColor = vbBlack
        .Action = 16

        .col = 7                'ç∂Ç©ÇÁ6î‘ñ⁄
        .col2 = 7
        .CellBorderType = 4 Or 8
        .CellBorderStyle = 1
        .CellBorderColor = &H8000000F
        .Action = 16

        .col = 4                'ç∂Ç©ÇÁÇRî‘ñ⁄Ç©ÇÁÇÃårê¸
        .col2 = 10
        .CellBorderType = 4
        .CellBorderStyle = 1
        .CellBorderColor = vbBlack
        .Action = 16

        .col = 4                'ç∂Ç©ÇÁ3î‘ñ⁄è„ÉuÉçÉbÉNPÇï“èWâ¬î\Ç…
        .col2 = 4
        .row = lngNewRow
        .row2 = lngNewRow
        .Lock = False
        .backColor = vbWhite

        .col = 2                'ç∂Ç©ÇÁ2î‘ñ⁄êVïiî‘Çï“èWâ¬î\Ç…(â∫ROWÇÃÇ›)
        .row = lngNewRow2
        .row2 = lngNewRow2
        .Lock = False
        .CellBorderType = 4
        .CellBorderStyle = 1
        .CellBorderColor = vbBlack
        .Action = 16

        .col = 3                'ç∂Ç©ÇÁ3î‘ñ⁄
        .row = lngNewRow2
        .row2 = lngNewRow2
        .Lock = True
        .CellBorderType = 4
        .CellBorderStyle = 1
        .CellBorderColor = vbBlack
        .Action = 16

        .col = 7                'WFñáêî
        .col2 = 7
        .row = lngNewRow
        .row2 = lngNewRow
        .Lock = False
        .CellBorderType = 4
        .CellBorderStyle = 1
        .CellBorderColor = &H8000000F
        .Action = 16

        .col = 7                'WFñáêî
        .col2 = 7
        .row = lngNewRow2
        .row2 = lngNewRow2
        .Lock = False
        .CellBorderType = 8
        .CellBorderStyle = 1
        .CellBorderColor = &H8000000F
        .Action = 16
        vFirstFlg = 0

        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
        .SetText 37, lngNewRow, vFirstFlg
        .SetText 37, lngNewRow2, vFirstFlg
        .col = 9                'ïsó«ãÊï™
        .col2 = 9
        .row = lngNewRow
        .row2 = lngNewRow
        .Lock = False
        .CellBorderType = 4
        .CellBorderStyle = 1
        .CellBorderColor = &H8000000F
        .Action = 16

        .col = 9                'ïsó«ãÊï™
        .col2 = 9
        .row = lngNewRow2
        .row2 = lngNewRow2
        .Lock = False
        .CellBorderType = 8
        .CellBorderStyle = 1
        .CellBorderColor = &H8000000F
        .Action = 16

        .col = 4                'ç∂Ç©ÇÁ3î‘ñ⁄ÉuÉçÉbÉNPÇï“èWïsâ¬Ç…(â∫ROWÇÃÇ›)
        .row = lngNewRow2
        .Lock = True

        .col = 11                'åüç∏çÄñ⁄ÇÃì¸óÕïsâ¬
        .row = lngNewRow

        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
        .col2 = 35
        .row2 = lngNewRow2
        .Lock = True

        .col = 9                'í«â¡çsÇ…ãÊï™ÇçÏÇÈÅiãÊï™Ç™Ç†ÇÈèâä˙ï\é¶çsÇ©ÇÁÇÃÉRÉsÅ[Åj
        .row = 1
        .col2 = 9
        .row2 = 1
        .DestCol = 9
        .DestRow = lngNewRow2
        .Action = ActionCopyRange

        .Lock = False
        .col = 9
        .col2 = 9
        .row = lngNewRow2
        .row2 = lngNewRow2
        .BlockMode = True
        .backColor = &H80FF80
        .BlockMode = False

        .col = 9                'ç∂Ç©ÇÁÇWî‘ñ⁄Åiè„çsÅjÇÉeÉLÉXÉgÇ…
        .col2 = 9
        .row = lngNewRow
        .row2 = lngNewRow
        .CellType = CellTypeEdit

        .BlockMode = False
    End With

    If intResult = 0 Then     'ãÙêîçsÇ»ÇÁè„2çsë}ì¸
    Else                      'äÔêîÇ»ÇÁâ∫ÇQçsë}ì¸
        sprExamine.GetText 2, sprExamine.ActiveRow, vGetHinban
        sprExamine.SetText 2, sprExamine.ActiveRow, vbNullString
        sprExamine.SetText 2, sprExamine.ActiveRow + 2, vGetHinban
        sprExamine.GetText 3, sprExamine.ActiveRow, vGetHinban      'ïiî‘2ÇÃèàóùÇí«â¡
        sprExamine.SetText 3, sprExamine.ActiveRow, vbNullString
        sprExamine.SetText 3, sprExamine.ActiveRow + 2, vGetHinban
    End If
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : sub_SelWFmap
'*
'*    èàóùäTóv      : 1.WFœØÃﬂä«óù√∞ÃﬁŸÅiTBCMY011ÅjÇ©ÇÁ√ﬁ∞¿ÇéÊìæ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@Å@ ,ê‡ñæ
'*Å@Å@      Å@Å@      records()   ,O  ,typ_TBCME037 ,íäèoÉåÉRÅ[Éh
'*Å@Å@      Å@Å@      sqlWhere    ,I  ,String       ,íäèoèåè(SQLÇÃWhereêﬂ:è»ó™â¬î\)
'*Å@Å@      Å@Å@      sqlOrder    ,I  ,String       ,íäèoèáèò(SQLÇÃOrder byêﬂ:è»ó™â¬î\)
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*******************************************************************************************
Public Function sub_SelWFmap(ByVal sBlkId As String, ByVal sSXLID As String, ByRef sErrMsg As String) As FUNCTION_RETURN
    Dim sSql        As String
    Dim bBlkOn      As Boolean 'Ãﬁ€Ø∏Ç™ë∂ç›ÇµÇƒÇ¢ÇΩÇÁÅASXLIDÇÃèåèÇ…ANDÇì¸ÇÍÇÈ
    Dim rs          As OraDynaset    'RecordSet
    Dim intDataCnt  As Integer
    Dim sSXLID9     As String

    On Error GoTo proc_err

    sub_SelWFmap = FUNCTION_RETURN_FAILURE
    bBlkOn = False
    intDataCnt = 0

    sSql = vbNullString
    sSql = sSql & "SELECT * FROM TBCMY011"
    sSql = sSql & " WHERE"

    If giFKeyFlg <> 2 Then
        If sSXLID <> vbNullString Then
            sSql = sSql & " MSXLID = '" & sSXLID & "'"
        End If
    Else    'é¿çsÉ{É^Éìâüâ∫å„ÇÕï°êîÉVÉìÉOÉãÇï\é¶Ç∑ÇÈÅièâä˙éÊìæÇÃîÕàÕéwíËÇ≈SELECTÅj
        sSXLID9 = Mid(sSXLID, 1, 9)
        sSql = sSql & " SUBSTR(MSXLID,1,9) = '" & sSXLID9 & "'"
        sSql = sSql & " AND RITOP_POS > " & SIngotP
        sSql = sSql & " AND RITOP_POS <= " & EIngotP
    End If
    sSql = sSql & " ORDER BY RITOP_POS"

    ''ÉfÅ[É^ÇíäèoÇ∑ÇÈ
    Set rs = OraDB.DBCreateDynaset(sSql, ORADYN_DEFAULT)
    If rs Is Nothing Then
        ReDim records(0)
        sub_SelWFmap = FUNCTION_RETURN_FAILURE
        sErrMsg = GetMsgStr("SET46")
        rs.Close
        Exit Function
    End If

    Do While Not rs.EOF
        ReDim Preserve gtWFmap(intDataCnt) As typeWFmap
        With gtWFmap(intDataCnt)
            .LOTID = CStr(rs.Fields("LOTID"))
            If IsNull(rs.Fields("BLOCKSEQ")) = True Then
                .BLOCKSEQ = 0
            Else
                .BLOCKSEQ = CInt(rs.Fields("BLOCKSEQ"))
            End If
            If IsNull(rs.Fields("INDTM")) = True Then
                .INDTM = vbNullString
            Else
                .INDTM = CStr(rs.Fields("INDTM"))
            End If
            If IsNull(rs.Fields("BASKETID")) = True Then
                .BASKETID = vbNullString
            Else
                .BASKETID = CStr(rs.Fields("BASKETID"))
            End If
            If IsNull(rs.Fields("SLOTNO")) = True Then
                .SLOTNO = 0
            Else
                .SLOTNO = CInt(rs.Fields("SLOTNO"))
            End If
            If IsNull(rs.Fields("CURRWPCS")) = True Then
                .CURRWPCS = 0
            Else
                .CURRWPCS = CInt(rs.Fields("CURRWPCS"))
            End If
            If IsNull(rs.Fields("EXISTFLG")) = True Then
                .EXISTFLG = vbNullString
            Else
                .EXISTFLG = CStr(rs.Fields("EXISTFLG"))
            End If
            If IsNull(rs.Fields("TOP_POS")) = True Then
                .TOP_POS = 0
            Else
                .TOP_POS = rs.Fields("TOP_POS")
            End If
            If IsNull(rs.Fields("REJCAT")) = True Then
                .REJCAT = vbNullString
            Else
                .REJCAT = CStr(rs.Fields("REJCAT"))
            End If
            If IsNull(rs.Fields("TXID")) = True Then
                .TXID = vbNullString
            Else
                .TXID = CStr(rs.Fields("TXID"))
            End If
            If IsNull(rs.Fields("REGDATE")) = True Then
                .REGDATE = vbNullString
            Else
                .REGDATE = CStr(rs.Fields("REGDATE"))
            End If
            If IsNull(rs.Fields("SUMMITSENDFLAG")) = True Then
                .SUMMITSENDFLG = vbNullString
            Else
                .SUMMITSENDFLG = CStr(rs.Fields("SUMMITSENDFLAG"))
            End If
            If IsNull(rs.Fields("SENDFLAG")) = True Then
                .SENDFLG = vbNullString
            Else
                .SENDFLG = CStr(rs.Fields("SENDFLAG"))
            End If
            If IsNull(rs.Fields("SENDDATE")) = True Then
                .SENDDATE = vbNullString
            Else
                .SENDDATE = CStr(rs.Fields("SENDDATE"))
            End If
            If IsNull(rs.Fields("WFSTA")) = True Then
                .WFSTA = vbNullString
            Else
                .WFSTA = CStr(rs.Fields("WFSTA"))
            End If
            If IsNull(rs.Fields("HREJCODE")) = True Then
                .HREJCODE = vbNullString
            Else
                .HREJCODE = CStr(rs.Fields("HREJCODE"))
            End If
            If IsNull(rs.Fields("UPDPROC")) = True Then
                .UPDPROC = vbNullString
            Else
                .UPDPROC = CStr(rs.Fields("UPDPROC"))
            End If
            If IsNull(rs.Fields("UPDDATE")) = True Then
                .UPDDATE = vbNullString
            Else
                .UPDDATE = CStr(rs.Fields("UPDDATE"))
            End If
            If IsNull(rs.Fields("MSXLID")) = True Then
                .SXLID = vbNullString
            Else
                .SXLID = CStr(rs.Fields("MSXLID"))
            End If
            If IsNull(rs.Fields("MHINBAN")) = True Then
                .hinban = vbNullString
            Else
                .hinban = CStr(rs.Fields("MHINBAN"))
            End If
            If IsNull(rs.Fields("MREVNUM")) = True Then
                .REVNUM = 0
            Else
                .REVNUM = CInt(rs.Fields("MREVNUM"))
            End If
            If IsNull(rs.Fields("MFACTORY")) = True Then
                .factory = vbNullString
            Else
                .factory = CStr(rs.Fields("MFACTORY"))
            End If
            If IsNull(rs.Fields("MOPECOND")) = True Then
                .opecond = vbNullString
            Else
                .opecond = CStr(rs.Fields("MOPECOND"))
            End If
            If IsNull(rs.Fields("KANKBN")) = True Then
                .KANKBN = vbNullString
            Else
                .KANKBN = CStr(rs.Fields("KANKBN"))
            End If
            If IsNull(rs.Fields("MSMPLEID")) = True Then
                .SMPLEID = vbNullString
            Else
                .SMPLEID = CStr(rs.Fields("MSMPLEID"))
            End If
            If IsNull(rs.Fields("NREJCODE")) = True Then
                .NREJCODE = vbNullString
            Else
                .NREJCODE = CStr(rs.Fields("NREJCODE"))
            End If
            If IsNull(rs.Fields("SHAFLAG")) = True Then
                .SMPLEFLG = vbNullString
            Else
                .SMPLEFLG = CStr(rs.Fields("SHAFLAG"))
            End If
            If IsNull(rs.Fields("RTOP_POS")) = True Then
                .RTOP_POS = 0
            Else
                .RTOP_POS = rs.Fields("RTOP_POS")
            End If
            If IsNull(rs.Fields("RITOP_POS")) = True Then
                .RITOP_POS = 0
            Else
                .RITOP_POS = rs.Fields("RITOP_POS")
            End If
        End With
        intDataCnt = intDataCnt + 1
        rs.MoveNext
    Loop
    If intDataCnt = 0 Then
        ReDim records(0)
        sub_SelWFmap = FUNCTION_RETURN_FAILURE
        sErrMsg = GetMsgStr("SET46")
        rs.Close
        Exit Function
    End If

    rs.Close
    sub_SelWFmap = FUNCTION_RETURN_SUCCESS
    Exit Function

proc_err:
    '' ÉGÉâÅ[ÉnÉìÉhÉâ
    Debug.Print "====== Error SQL ======"
    Debug.Print sSql
    sub_SelWFmap = FUNCTION_RETURN_FAILURE
    sErrMsg = GetMsgStr("SET47")
    rs.Close
End Function

'Del Start 2011/03/11 SMPK Miyata
''*******************************************************************************************
''*    ä÷êîñº        : fnc_SetWFmapData
''*
''*    èàóùäTóv      : 1.ÉfÅ[É^ï\é¶èàóù
''*
''*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@Å@ ,ê‡ñæ
''*Å@Å@      Å@Å@      Ç»Çµ
''*
''*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
''*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
''*
''*******************************************************************************************
'Private Function fnc_SetWFmapData() As FUNCTION_RETURN
'    Dim intLoopCnt    As Integer
'    Dim dblTopPos     As Double
'    Dim dblRTopPos    As Double
'    Dim dblRITopPos   As Double
'    Dim intWarpPoint  As Integer
'
'    With sprWfmapView
'        .MaxRows = 0
'        intWarpPoint = 1
'        For intLoopCnt = 0 To UBound(gtWFmap)
'            .MaxRows = .MaxRows + 1
'            .SetText 3, intLoopCnt + 1, gtWFmap(intLoopCnt).LOTID
'            .SetText 5, intLoopCnt + 1, gtWFmap(intLoopCnt).BLOCKSEQ
'            .SetText 17, intLoopCnt + 1, gtWFmap(intLoopCnt).INDTM
'            .SetText 18, intLoopCnt + 1, gtWFmap(intLoopCnt).BASKETID
'            .SetText 19, intLoopCnt + 1, gtWFmap(intLoopCnt).SLOTNO
'            .SetText 9, intLoopCnt + 1, gtWFmap(intLoopCnt).CURRWPCS
'            .SetText 10, intLoopCnt + 1, gtWFmap(intLoopCnt).EXISTFLG
'            If gtWFmap(intLoopCnt).TOP_POS / 10 = 0 Then
'                .SetText 6, intLoopCnt + 1, 0
'            Else
'                dblTopPos = gtWFmap(intLoopCnt).TOP_POS / 10
'                dblTopPos = dblTopPos
'                .SetText 6, intLoopCnt + 1, dblTopPos
'            End If
'            .SetText 11, intLoopCnt + 1, gtWFmap(intLoopCnt).REJCAT
'            .SetText 26, intLoopCnt + 1, gtWFmap(intLoopCnt).TXID
'            .SetText 25, intLoopCnt + 1, Format(CVar(gtWFmap(intLoopCnt).REGDATE), "yyyy/mm/dd")
'            .SetText 27, intLoopCnt + 1, gtWFmap(intLoopCnt).SUMMITSENDFLG
'            .SetText 28, intLoopCnt + 1, gtWFmap(intLoopCnt).SENDFLG
'            .SetText 29, intLoopCnt + 1, Format(CVar(gtWFmap(intLoopCnt).SENDDATE), "yyyy/mm/dd")
'
'            'WFèÛë‘îªíË
'            Select Case gtWFmap(intLoopCnt).WFSTA
'                Case gsWF_STA_0   'í èÌ
'                    Select Case gtWFmap(intLoopCnt).SMPLEFLG
'                        Case gsWF_SMPL_1
'                            .SetText 1, intLoopCnt + 1, gsWF_STA_SIJI & "(" & gtWFmap(intLoopCnt).WFSTA & ")"   '2003/06/05 hitec)matsumoto  WFèÛë‘ÉtÉâÉOÇÃï\é¶Çí«â¡
'                            .SetText 30, intLoopCnt + 1, intConSprChg_2
'                            .col = 1
'                            .col2 = 32          'WarpîªíËëŒâû
'                            .row = intLoopCnt + 1
'                            .row2 = intLoopCnt + 1
'                            .BlockMode = True
'                            .backColor = vbYellow
'                            .BlockMode = False
'                        Case gsWF_SMPL_2
'                            .SetText 1, intLoopCnt + 1, gsWF_STA_SIJI_OK & "(" & gtWFmap(intLoopCnt).WFSTA & ")"   '2003/06/05 hitec)matsumoto  WFèÛë‘ÉtÉâÉOÇÃï\é¶Çí«â¡
'                            .SetText 30, intLoopCnt + 1, intConSprChg_2
'                            .col = 1
'                            .col2 = 32          'WarpîªíËëŒâû
'                            .row = intLoopCnt + 1
'                            .row2 = intLoopCnt + 1
'                            .BlockMode = True
'                            .backColor = vbYellow
'                            .BlockMode = False
'                        Case gsWF_SMPL_3
'                            .SetText 1, intLoopCnt + 1, gsWF_STA_SIJI_NG & "(" & gtWFmap(intLoopCnt).WFSTA & ")"   '2003/06/05 hitec)matsumoto  WFèÛë‘ÉtÉâÉOÇÃï\é¶Çí«â¡
'                            .SetText 30, intLoopCnt + 1, intConSprChg_2
'                            .col = 1
'                            .col2 = 32          'WarpîªíËëŒâû
'                            .row = intLoopCnt + 1
'                            .row2 = intLoopCnt + 1
'                            .BlockMode = True
'                            .backColor = vbYellow
'                            .BlockMode = False
'                        Case Else
'                            .SetText 1, intLoopCnt + 1, gsWF_STA_NORMAL & "(" & gtWFmap(intLoopCnt).WFSTA & ")"   '2003/06/05 hitec)matsumoto  WFèÛë‘ÉtÉâÉOÇÃï\é¶Çí«â¡
'                            .SetText 30, intLoopCnt + 1, intConSprChg_1
'                            .col = 1
'                            .col2 = 32          'WarpîªíËëŒâû
'                            .row = intLoopCnt + 1
'                            .row2 = intLoopCnt + 1
'                            .BlockMode = True
'                            .backColor = &H80FF80
'                            .BlockMode = False
'                    End Select
'                Case gsWF_STA_1   'ã§óL
'                    .SetText 1, intLoopCnt + 1, gsWF_STA_NORMAL & "(" & gtWFmap(intLoopCnt).WFSTA & ")"   '2003/06/05 hitec)matsumoto  WFèÛë‘ÉtÉâÉOÇÃï\é¶Çí«â¡
'                    .SetText 30, intLoopCnt + 1, intConSprChg_1
'                    .col = 1
'                    .col2 = 32          'WarpîªíËëŒâû
'                    .row = intLoopCnt + 1
'                    .row2 = intLoopCnt + 1
'                    .BlockMode = True
'                    .backColor = &H80FF80
'                    .BlockMode = False
'                Case gsWF_STA_4   'åáóé
'                    'ÉTÉìÉvÉãÉtÉâÉOîªíË
'                    Select Case gtWFmap(intLoopCnt).SMPLEFLG
'                        Case gsWF_SMPL_4    'upd 2003/05/19 hitec)matsumoto ÉTÉìÉvÉãÇÃåãâ à»äOÇÕÇ∑Ç◊ÇƒåáóéÇ∆îªífÇ∑ÇÈ
'                            .SetText 1, intLoopCnt + 1, gsWF_STA_SIJI_KEKKA & "(" & gtWFmap(intLoopCnt).WFSTA & ")"   '2003/06/05 hitec)matsumoto  WFèÛë‘ÉtÉâÉOÇÃï\é¶Çí«â¡
'                            .SetText 30, intLoopCnt + 1, intConSprChg_2
'                            .col = 1
'                            .col2 = 32          'WarpîªíËëŒâû
'                            .row = intLoopCnt + 1
'                            .row2 = intLoopCnt + 1
'                            .BlockMode = True
'                            .backColor = vbYellow
'                            .BlockMode = False
'                        Case Else
'                            .SetText 1, intLoopCnt + 1, gsWF_STA_STA_K & "(" & gtWFmap(intLoopCnt).WFSTA & ")"   '2003/06/05 hitec)matsumoto  WFèÛë‘ÉtÉâÉOÇÃï\é¶Çí«â¡
'                            .SetText 30, intLoopCnt + 1, intConSprChg_3
'                            .col = 1
'                            .col2 = 32          'WarpîªíËëŒâû
'                            .row = intLoopCnt + 1
'                            .row2 = intLoopCnt + 1
'                            .BlockMode = True
'                            .backColor = vbRed
'                            .BlockMode = False
'                    End Select
'            End Select
'
'            .SetText 14, intLoopCnt + 1, gtWFmap(intLoopCnt).SMPLEID
'            .SetText 12, intLoopCnt + 1, gtWFmap(intLoopCnt).HREJCODE
'            .SetText 23, intLoopCnt + 1, gtWFmap(intLoopCnt).UPDPROC
'            .SetText 24, intLoopCnt + 1, gtWFmap(intLoopCnt).UPDDATE
'            .SetText 2, intLoopCnt + 1, gtWFmap(intLoopCnt).SXLID
'            .SetText 4, intLoopCnt + 1, gtWFmap(intLoopCnt).hinban
'            .SetText 20, intLoopCnt + 1, gtWFmap(intLoopCnt).REVNUM
'            .SetText 21, intLoopCnt + 1, gtWFmap(intLoopCnt).factory
'            .SetText 22, intLoopCnt + 1, gtWFmap(intLoopCnt).opecond
'            .SetText 13, intLoopCnt + 1, gtWFmap(intLoopCnt).KANKBN
'            .SetText 15, intLoopCnt + 1, gtWFmap(intLoopCnt).NREJCODE
'            .SetText 16, intLoopCnt + 1, gtWFmap(intLoopCnt).SMPLEFLG
'
'            If gtWFmap(intLoopCnt).RTOP_POS = 0 Then
'                .SetText 7, intLoopCnt + 1, 0
'            Else
'                dblRTopPos = gtWFmap(intLoopCnt).RTOP_POS
'                dblRTopPos = Format(dblRTopPos, "0000.0")
'                .SetText 7, intLoopCnt + 1, dblRTopPos
'            End If
'
'            If gtWFmap(intLoopCnt).RITOP_POS = 0 Then
'                .SetText 8, intLoopCnt + 1, 0
'            Else
'                dblRITopPos = gtWFmap(intLoopCnt).RITOP_POS
'                dblRITopPos = Format(dblRITopPos, "0000.0")
'                .SetText 8, intLoopCnt + 1, dblRITopPos
'            End If
'
'            'WarpèÓïÒï\é¶í«â¡
'            If UBound(tWarpMeasG) >= intWarpPoint Then
'                'Ãﬁ€Ø∏IDÇ∆Ãﬁ€Ø∏ì‡òAî‘Ç≈ïRïtÇØ
'                If tWarpMeasG(intWarpPoint).BLOCKID = gtWFmap(intLoopCnt).LOTID And _
'                   tWarpMeasG(intWarpPoint).WAFID = gtWFmap(intLoopCnt).BLOCKSEQ Then
'                    'é¿√ﬁ∞¿Ç™ñ≥Ç¢èÍçáÇÕï\é¶ÇµÇ»Ç¢
'                    If tWarpMeasG(intWarpPoint).EXISTFLG > 0 Then
'                        'Warpíl
'                        .SetText 31, intLoopCnt + 1, CStr(DBData2DispData_nl(tWarpMeasG(intWarpPoint).MEASDATA))
'                        'îªíË
'                        .SetText 32, intLoopCnt + 1, IIf(tWarpMeasG(intWarpPoint).Judg, "OK", "NG")
'                    End If
'                    intWarpPoint = intWarpPoint + 1
'                End If
'            End If
'        Next
'    End With
'End Function
'Del End   2011/03/11 SMPK Miyata

'Del Start 2011/03/11 SMPK Miyata
''*******************************************************************************************
''*    ä÷êîñº        : cmbSprChg_Click
''*
''*    èàóùäTóv      : 1.íäèoèåèÇ…ÇÊÇËÅAWFœØÃﬂàÍóóÇéÌï ñàÇÃï\é¶ÇÃêÿÇËë÷Ç¶ÇçsÇ§
''*
''*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@Å@ ,ê‡ñæ
''*Å@Å@      Å@Å@      Ç»Çµ
''*
''*    ñﬂÇËíl        : Ç»Çµ
''*
''*******************************************************************************************
'Private Sub cmbSprChg_Click()
'    Dim intLoopCnt  As Integer
'    Dim intSprSta   As Integer
'    Dim sSprSta     As String
'    Dim vSprSta     As Variant
'    Dim intRowNo    As Integer
'
'    intRowNo = 0  'ï\é¶Ç≥ÇÍÇƒÇ¢ÇÈçsÇæÇØî‘çÜÇÇ”ÇËÇ»Ç®Ç∑
'     With sprWfmapView
'        .ReDraw = False
'        For intLoopCnt = 1 To .MaxRows
'            Select Case cmbSprChg.ListIndex
'                Case intConSprChg_0  'ëSåèéwíË
'                    .row = intLoopCnt
'                    .RowHidden = False
'                    intRowNo = intRowNo + 1
'                    .row = intLoopCnt
'                    .RowHidden = False
'                    .col = 0
'                    .row = intLoopCnt
'                    .text = intRowNo
'                Case intConSprChg_1  'ó«ïiéwíË
'                    .GetText 30, intLoopCnt, vSprSta
'                    If vSprSta <> intConSprChg_1 Then  'ó«ïià»äOÇæÇ¡ÇΩÇÁÅAîÒï\é¶
'                        .row = intLoopCnt
'                        .RowHidden = True
'                    Else
'                        intRowNo = intRowNo + 1
'                        .row = intLoopCnt
'                        .RowHidden = False
'                        .col = 0
'                        .row = intLoopCnt
'                        .text = intRowNo
'                    End If
'                Case intConSprChg_2  'ÉTÉìÉvÉãéwíË
'                    .GetText 30, intLoopCnt, vSprSta
'                    If vSprSta <> intConSprChg_2 Then  'ÉTÉìÉvÉãà»äOÇæÇ¡ÇΩÇÁÅAîÒï\é¶
'                        .row = intLoopCnt
'                        .RowHidden = True
'                    Else
'                        intRowNo = intRowNo + 1
'                        .row = intLoopCnt
'                        .RowHidden = False
'                        .col = 0
'                        .row = intLoopCnt
'                        .text = intRowNo
'                    End If
'                Case intConSprChg_3  'ïsó«éwíË
'                    .GetText 30, intLoopCnt, vSprSta
'                    If vSprSta <> intConSprChg_3 Then  'ïsó«à»äOÇæÇ¡ÇΩÇÁÅAîÒï\é¶
'                        .row = intLoopCnt
'                        .RowHidden = True
'                    Else
'                        intRowNo = intRowNo + 1
'                        .row = intLoopCnt
'                        .RowHidden = False
'                        .col = 0
'                        .row = intLoopCnt
'                        .text = intRowNo
'                    End If
'            End Select
'        Next
'
'        If .MaxRows > 0 Then
'            .col = 1
'            .row = 1
'            .Action = ActionActiveCell
'        End If
'        .ReDraw = True
'    End With
'End Sub
'Del End   2011/03/11 SMPK Miyata

'*******************************************************************************************
'*    ä÷êîñº        : fnc_CheckDataWfmap
'*
'*    èàóùäTóv      : 1.î≤éééwé¶àÍóóÇÃì¸óÕì‡óeÇÉ`ÉFÉbÉNÇ∑ÇÈ
'*                      (î≤éééwé¶àÍóóÇÃÉfÅ[É^É`ÉFÉbÉN(WFœØÃﬂëŒâûÅj)
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@Å@ ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*******************************************************************************************
Private Function fnc_CheckDataWfmap() As FUNCTION_RETURN
    Dim intLoopCnt      As Integer
    Dim vFlg            As Variant
    Dim vBlockP         As Variant
    Dim intNukisiFlg    As Integer
    Dim intBlkChkLoop   As Integer
    Dim vChkBlk         As Variant
    Dim intLoopCntAdd   As Integer
    Dim intHinChkLoop   As Integer
    Dim vHinChk         As Variant
    Dim vDummyBlk       As Variant
    Dim vDummyHin       As Variant
    Dim intDummyBlkSet  As Integer
    Dim sNowBlk         As String
    Dim vBlckID         As Variant
    Dim sBlckID         As Variant
    Dim vUBlckP         As Variant
    Dim vMaxBlckP       As Variant
    Dim vUpPos          As Variant
    Dim vSmpId1         As Variant
    Dim vSmpId2         As Variant
    Dim intBlkPChk      As Integer
    Dim vStrB           As Variant
    Dim vStrSam         As Variant

    'ïiî‘ÇÃñ¢ì¸óÕÉGÉâÅ[
    With sprExamine
        For intHinChkLoop = 1 To .MaxRows Step 2
            .GetText 2, intHinChkLoop, vHinChk
            If vHinChk = vbNullString Then
                fnc_CheckDataWfmap = FUNCTION_RETURN_FAILURE
                lblMsg.Caption = GetMsgStr("EHINA")
                Exit Function
            End If
        Next
    End With

    'ÉuÉçÉbÉNÇÃì¸óÕÉ`ÉFÉbÉN
    intLoopCntAdd = 2
    With sprExamine
        For intLoopCnt = 1 To .MaxRows
            For intBlkPChk = 1 To .MaxRows
                If intBlkPChk Mod 2 = 0 Then
                    .GetText 4, intBlkPChk, vBlockP
                    If vBlockP = vbNullString Then
                        fnc_CheckDataWfmap = FUNCTION_RETURN_FAILURE
                        lblMsg.Caption = GetMsgStr("EBLK8")
                        .col = 4
                        .col2 = 4
                        .row = intBlkPChk
                        .row2 = intBlkPChk
                        .BlockMode = True
                        .backColor = &H8080FF
                        .BlockMode = False
                        Exit Function
                    End If
                    If intLoopCnt Mod 2 = 0 Then
                        If intLoopCnt >= 2 Then
                            .GetText 4, intLoopCnt, vBlockP
                            .GetText 4, intLoopCnt - 1, vUBlckP
                            If vBlockP <> vbNullString And vUBlckP <> vbNullString Then
                                If CInt(vUBlckP) >= CInt(vBlockP) Then
                                    fnc_CheckDataWfmap = FUNCTION_RETURN_FAILURE
                                    lblMsg.Caption = GetMsgStr("EBLKA")
                                    .col = 4
                                    .col2 = 4
                                    .row = intLoopCnt
                                    .row2 = intLoopCnt
                                    .BlockMode = True
                                    .backColor = COLOR_NG
                                    .BlockMode = False
                                    Exit Function
                                End If
                            End If
                        End If
                    End If
                End If
            Next

            If intLoopCnt <> .MaxRows Then
                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                .GetText 37, intLoopCnt, vFlg
                If (vFlg = "1") Or (vFlg = "3") Then    'èâä˙ï\é¶ÇÃî≤ééçs

                ElseIf intLoopCnt Mod 2 = 0 Then        'ë}ì¸Ç≥ÇÍÇΩçsÇ≈ÅAãÙêîçsÇ™ì¸óÕÇÃçsÇ…Ç»ÇÈ
                    .GetText 4, intLoopCnt, vBlockP

                    'ìØàÍÉuÉçÉbÉNÇ≈ÇÃêîílîÕàÕÉ`ÉFÉbÉN
                    'åªç›ÉuÉçÉbÉNID
                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .GetText 39, intLoopCnt, vBlckID
                    sBlckID = CStr(vBlckID)

                    'è„ÇÃílÇÊÇËëÂÇ´Ç¢Ç±Ç∆
                    If intLoopCnt > 2 Then
                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .GetText 37, intLoopCnt - 1, vUpPos
                        If (vUpPos = "1") Or (vUpPos = "3") Or (vUpPos = "9") Then
                            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                            .GetText 39, intLoopCnt - 1, vBlckID
                        Else
                            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                            .GetText 39, intLoopCnt - 2, vBlckID
                        End If
                        If sBlckID = CStr(vBlckID) Then
                            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                            .GetText 37, intLoopCnt - 1, vUpPos
                            If (vUpPos = "1") Or (vUpPos = "3") Or (vUpPos = "9") Then
                                .GetText 4, intLoopCnt - 1, vUBlckP
                            Else
                                .GetText 4, intLoopCnt - 2, vUBlckP
                            End If

                            If CInt(vBlockP) <= CInt(vUBlckP) Then
                                fnc_CheckDataWfmap = FUNCTION_RETURN_FAILURE
                                .col = 4
                                .col2 = 4
                                .row = intLoopCnt
                                .row2 = intLoopCnt
                                .BlockMode = True
                                .backColor = COLOR_NG
                                .BlockMode = False
                                lblMsg.Caption = GetMsgStr("EBLKB")
                                Exit Function
                            End If
                        End If
                    End If

                    'â∫ÇÃílÇÊÇËÇ‡è¨Ç≥Ç¢Ç±Ç∆
                    If intLoopCnt < .MaxRows Then
                        'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                        .GetText 39, intLoopCnt + 2, vBlckID
                        If sBlckID = CStr(vBlckID) Then
                            .GetText 4, intLoopCnt + 2, vUBlckP
                            If CInt(vUBlckP) <= CInt(vBlockP) Then
                                fnc_CheckDataWfmap = FUNCTION_RETURN_FAILURE
                                lblMsg.Caption = GetMsgStr("EBLKC")
                                .col = 4
                                .col2 = 4
                                .row = intLoopCnt
                                .row2 = intLoopCnt
                                .BlockMode = True
                                .backColor = COLOR_NG
                                .BlockMode = False
                                Exit Function
                            End If
                        End If
                    End If

                    'É_É~Å[ÇÃÉuÉçÉbÉNIDÅEïiî‘Ç…äYìñ√ﬁ∞¿Çì¸ÇÍÇƒÇ®Ç≠
                    'åªç›à íuÇÃÉuÉçÉbÉNIDÇ™NULLÇæÇ¡ÇΩÇÁè„ÇÃçsÇ…íTÇµÇ…Ç¢Ç≠
                    .GetText 1, intLoopCnt, vDummyBlk
                    If vDummyBlk = vbNullString Then
                        For intDummyBlkSet = intLoopCnt - 1 To 1 Step -1
                            .GetText 1, intDummyBlkSet, vDummyBlk
                            If vDummyBlk <> vbNullString Then
                                Exit For
                            End If
                        Next
                    End If

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .SetText 39, intLoopCnt, vDummyBlk
                    'ïiî‘
                    .GetText 2, intLoopCnt + 1, vDummyHin

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .SetText 40, intLoopCnt, vDummyHin

                    'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                    .SetText 37, intLoopCnt, "2"
                    intLoopCnt = intLoopCnt + 1  '2çsâ∫ÇÃçsÇå©Ç…çsÇ≠ÇΩÇﬂÇ…Å{ÇPÇµÇƒÇ®Ç≠
                End If
            End If
        Next

        'ÉTÉìÉvÉãÇ™è„â∫ã§óLÇÃèÍçáÇÃÉGÉâÅ[ÉÅÉbÉZÅ[ÉW---------------
        For intLoopCnt = 2 To .MaxRows Step 2
            .GetText 10, intLoopCnt, vSmpId1
            .GetText 10, intLoopCnt + 1, vSmpId2
            If (vSmpId1 = vSmpId2) And (vSmpId1 <> vbNullString) And (vSmpId2 <> vbNullString) Then    'ÉTÉìÉvÉãIDÇ™ÅAè„â∫ã§óL
                fnc_CheckDataWfmap = FUNCTION_RETURN_FAILURE
                lblMsg.Caption = GetMsgStr("ENSP3")

                'ÉGÉsêÊçsï]âøí«â¡ëŒâû
                 .GetText 39, intLoopCnt, vBlckID
                 .GetText 38, intLoopCnt, vStrSam
                 vStrB = Right(vBlckID, 3) & "-" & Right(vStrSam, 4)
                 .SetText 10, intLoopCnt, vStrB ''ÉTÉìÉvÉãIDï\é¶
                 .SetText 10, intLoopCnt + 1, "ã§óL"
                Exit Function
            End If
        Next
    End With
    fnc_CheckDataWfmap = FUNCTION_RETURN_SUCCESS
End Function

'*******************************************************************************************
'*    ä÷êîñº        : fnc_DispChangeDataWfmap
'*
'*    èàóùäTóv      : 1.WFÉ}ÉbÉvÇÃï\é¶ÉfÅ[É^Ç…âÊñ Ç≈ÇÃïœçXÇîΩâfÇ∑ÇÈÅiDBìoò^ëOÇ≈Ç‡Åj
'*                      (WFÉ}ÉbÉvï\é¶ÉfÅ[É^ïœçX(WFœØÃﬂëŒâûÅj)
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@Å@ ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*
'*  Chg 2011/03/11 SMPK Miyata  Ç±ÇÃä÷êîì‡ÇÃWFœØÃﬂÇï\é¶êÊÇïœçXÇ∑ÇÈÅB
'*                              f_cmbc039_4.sprWfmapViewÇf_cmbc039_4.sprWfmapViewÇ…ïœçX
'*                              ÉvÉçÉOÉâÉÄÇ™îœéGÇ…Ç»ÇÈÇÃÇ≈èCê≥óöóÇÕécÇµÇƒÇ¢Ç‹ÇπÇÒÅB
'*******************************************************************************************
Private Function fnc_DispChangeDataWfmap() As FUNCTION_RETURN
    Dim lngRoopCnt      As Long
    Dim lngMapRoopCnt   As Long
    Dim lngMapMaxRows   As Long
    Dim lngSmplMaxRows  As Long
    Dim vFromMap        As Variant
    Dim vToMap          As Variant
    Dim vNowMap         As Variant
    Dim sBlockId        As String
    Dim vBlockId        As Variant
    Dim vHinban         As Variant
    Dim vMapBlockID     As Variant
    Dim vWFStatus1      As Variant
    Dim vWFStatus2      As Variant
    Dim vStatusWfmap    As Variant
    Dim sWFStatusWfmap  As String
    Dim vGetSampId      As Variant

    fnc_DispChangeDataWfmap = FUNCTION_RETURN_SUCCESS

    lngSmplMaxRows = f_cmbc039_3.sprExamine.MaxRows
    lngMapMaxRows = f_cmbc039_4.sprWfmapView.MaxRows

    'ÉTÉìÉvÉãâÊñ ÇÃïœçXì_Å®É}ÉbÉvâÊñ Ç…
    With f_cmbc039_3.sprExamine

        For lngRoopCnt = 1 To lngSmplMaxRows Step 2
            .GetText 1, lngRoopCnt, vBlockId
            If (vBlockId <> "") Then
                'ÉTÉìÉvÉã_ÉuÉçÉbÉNIDï€ë∂
                sBlockId = CStr(vBlockId)
            End If
            'ÉTÉìÉvÉãâÊñ ÉfÅ[É^éÊìæ
            .GetText 6, lngRoopCnt, vFromMap        'ÉTÉìÉvÉã_É}ÉbÉvà íuÅiäJénÅj
            .GetText 6, lngRoopCnt + 1, vToMap      'ÉTÉìÉvÉã_É}ÉbÉvà íuÅièIóπÅj
            .GetText 2, lngRoopCnt, vHinban         'ÉTÉìÉvÉã_ïiî‘

            'É}ÉbÉvâÊñ åüçıÅïïœçX
            For lngMapRoopCnt = 1 To lngMapMaxRows
                'É}ÉbÉv_ÉuÉçÉbÉNIDéÊìæ
                f_cmbc039_4.sprWfmapView.GetText 3, lngMapRoopCnt, vMapBlockID
                If sBlockId = Mid(CStr(vMapBlockID), 10, 3) Then
                    f_cmbc039_4.sprWfmapView.GetText 5, lngMapRoopCnt, vNowMap
                    'î≤ééçs
                    If CInt(vNowMap) = CInt(vFromMap) Or CInt(vNowMap) = CInt(vToMap) Then
                        If vHinban = "Z" Then
                            vStatusWfmap = "åáóé" & "(4)"
                            f_cmbc039_4.sprWfmapView.SetText 1, lngMapRoopCnt, vStatusWfmap
                            f_cmbc039_4.sprWfmapView.col = 1
                            f_cmbc039_4.sprWfmapView.col2 = 40
                            f_cmbc039_4.sprWfmapView.row = lngMapRoopCnt
                            f_cmbc039_4.sprWfmapView.row2 = lngMapRoopCnt
                            f_cmbc039_4.sprWfmapView.BlockMode = True
                            f_cmbc039_4.sprWfmapView.backColor = &H8080FF
                            f_cmbc039_4.sprWfmapView.BlockMode = False
                        Else
                            If CInt(vNowMap) = CInt(vFromMap) Then
                                .GetText 8, lngRoopCnt, vWFStatus1         'ÉTÉìÉvÉã_WFèÛë‘
                                sWFStatusWfmap = CStr(vWFStatus1)
                                .GetText 10, lngRoopCnt, vGetSampId
                            Else
                                .GetText 8, lngRoopCnt + 1, vWFStatus1       'ÉTÉìÉvÉã_WFèÛë‘
                                sWFStatusWfmap = CStr(vWFStatus1)
                                .GetText 10, lngRoopCnt + 1, vGetSampId
                            End If
                            'ïœçXîÕàÕ(ÉTÉìÉvÉãÇ†ÇËÅj
                            If sWFStatusWfmap = "ã§óL" Or sWFStatusWfmap = "í èÌ" Then
                                If vGetSampId = "ã§óL" Then
                                    vStatusWfmap = sWFStatusWfmap & "(1)"
                                Else
                                    vStatusWfmap = sWFStatusWfmap & "(0)"
                                End If
                                f_cmbc039_4.sprWfmapView.SetText 1, lngMapRoopCnt, vStatusWfmap
                                f_cmbc039_4.sprWfmapView.col = 1
                                f_cmbc039_4.sprWfmapView.col2 = 40
                                f_cmbc039_4.sprWfmapView.row = lngMapRoopCnt
                                f_cmbc039_4.sprWfmapView.row2 = lngMapRoopCnt
                                f_cmbc039_4.sprWfmapView.BlockMode = True
                                f_cmbc039_4.sprWfmapView.backColor = &H80FF80
                                f_cmbc039_4.sprWfmapView.BlockMode = False
                            Else            'ÉTÉìÉvÉãÇ†ÇËÇ≈í èÌÇ≈Åiî≤éééwé¶WFÅj
                                vStatusWfmap = sWFStatusWfmap & "(0)"
                                f_cmbc039_4.sprWfmapView.SetText 1, lngMapRoopCnt, vStatusWfmap
                                f_cmbc039_4.sprWfmapView.col = 1
                                f_cmbc039_4.sprWfmapView.col2 = 40
                                f_cmbc039_4.sprWfmapView.row = lngMapRoopCnt
                                f_cmbc039_4.sprWfmapView.row2 = lngMapRoopCnt
                                f_cmbc039_4.sprWfmapView.BlockMode = True
                                f_cmbc039_4.sprWfmapView.backColor = vbYellow
                                f_cmbc039_4.sprWfmapView.BlockMode = False
                            End If
                        End If
                    'î≤ééçsà»äO
                    ElseIf CInt(vNowMap) > CInt(vFromMap) And CInt(vNowMap) < CInt(vToMap) Then
                        If vHinban = "Z" Then
                            vStatusWfmap = "åáóé" & "(4)"
                            f_cmbc039_4.sprWfmapView.SetText 1, lngMapRoopCnt, vStatusWfmap
                            f_cmbc039_4.sprWfmapView.col = 1
                            f_cmbc039_4.sprWfmapView.col2 = 40
                            f_cmbc039_4.sprWfmapView.row = lngMapRoopCnt
                            f_cmbc039_4.sprWfmapView.row2 = lngMapRoopCnt
                            f_cmbc039_4.sprWfmapView.BlockMode = True
                            f_cmbc039_4.sprWfmapView.backColor = &H8080FF
                            f_cmbc039_4.sprWfmapView.BlockMode = False
'Del Start 2011/03/11 SMPK Miyata
'                        Else
'                            'ïœçXîÕàÕ(ÉTÉìÉvÉãÇ»ÇµÅj
'                            vStatusWfmap = "í èÌ" & "(0)"
'                            f_cmbc039_4.sprWfmapView.SetText 1, lngMapRoopCnt, vStatusWfmap
'                            f_cmbc039_4.sprWfmapView.col = 1
'                            f_cmbc039_4.sprWfmapView.col2 = 40
'                            f_cmbc039_4.sprWfmapView.row = lngMapRoopCnt
'                            f_cmbc039_4.sprWfmapView.row2 = lngMapRoopCnt
'                            f_cmbc039_4.sprWfmapView.BlockMode = True
'                            f_cmbc039_4.sprWfmapView.backColor = &H80FF80
'                            f_cmbc039_4.sprWfmapView.BlockMode = False
'Del End   2011/03/11 SMPK Miyata
                        End If
                    End If
                End If
            Next lngMapRoopCnt
        Next lngRoopCnt
    End With
End Function

'*******************************************************************************************
'*    ä÷êîñº        : sub_LOADDISP_ADD_CHECKBOX
'*
'*    èàóùäTóv      : 1.ìØàÍSXLìØàÍïiî‘ÇÃÉuÉçÉbÉNã´äEÇ…î≤ééóLñ≥ÇÃÉ`ÉFÉbÉNÉ{ÉbÉNÉXï\é¶
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@Å@ ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*******************************************************************************************
Public Sub sub_LOADDISP_ADD_CHECKBOX()
    Dim i As Integer

    On Error Resume Next
    With sprExamine
        For i = 1 To .MaxRows
            CheckGetSampleID (i)
        Next i
    End With
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : fnc_ErrDispCheck
'*
'*    èàóùäTóv      : 1.î≤ééÉXÉvÉåÉbÉhÇ…ï\é¶Ç≥ÇÍÇΩÉfÅ[É^Ç™ÅAê≥èÌÇ≈Ç†ÇÈÇ©É`ÉFÉbÉN
'*                      á@ä˘ë∂î≤ééçsÇ…ÉTÉìÉvÉãIDÇ™ì¸Ç¡ÇƒÇ¢ÇÈÇ©
'*                      áAî≤ééÇÃTOPà íuÇ∆BOTTOMà íuÇ™ÅASXLà íuÇ∆àÍívÇµÇƒÇ¢ÇÈÇ©
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº    ,IO ,å^      Å@Å@ ,ê‡ñæ
'*Å@Å@      Å@Å@      sMsg      ,O  ,String       ,ï\é¶ÉÅÉbÉZÅ[ÉWï∂éöóÒ
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*******************************************************************************************
Public Function fnc_ErrDispCheck(sMsg As String) As FUNCTION_RETURN
    Dim intLoopCnt      As Integer
    Dim vNukisiFlg      As Variant
    Dim vGetSample      As Variant
    Dim vDispSIngotP    As Variant
    Dim vDispEIngotP    As Variant
    Dim vWfSta          As Variant

    With sprExamine
        'ÉTÉìÉvÉãIDì¸óÕÉ`ÉFÉbÉN
        For intLoopCnt = 1 To .MaxRows

            'ÉGÉsêÊçsï]âøí«â¡
            .GetText 37, intLoopCnt, vNukisiFlg
            .GetText 8, intLoopCnt, vWfSta
            If vNukisiFlg = 1 Then
                .GetText 10, intLoopCnt, vGetSample
                If Trim(vGetSample) = vbNullString Then
                    cmdF(6).Enabled = False
                    cmdF(7).Enabled = False
                    cmdF(8).Enabled = False
                    cmdF(9).Enabled = False
                    cmdF(10).Enabled = False
                    cmdF(12).Enabled = False
                    fnc_ErrDispCheck = FUNCTION_RETURN_FAILURE
                    sMsg = "ENSP4"
                    Exit Function
                End If
            ElseIf vNukisiFlg = 3 And vWfSta <> gsWF_STA_NORMAL And vWfSta <> gsWF_STA_STA_K Then
                .GetText 10, intLoopCnt, vGetSample
                If Trim(vGetSample) = vbNullString Then
                    cmdF(6).Enabled = False
                    cmdF(7).Enabled = False
                    cmdF(8).Enabled = False
                    cmdF(9).Enabled = False
                    cmdF(10).Enabled = False
                    cmdF(12).Enabled = False
                    fnc_ErrDispCheck = FUNCTION_RETURN_FAILURE
                    sMsg = "ENSP4"
                    Exit Function
                End If
            End If
        Next

        'î≤ééÇÃTOPà íuÇ∆BOTTOMà íuÇÃÉ`ÉFÉbÉN
        .GetText 5, 1, vDispSIngotP
        .GetText 5, .MaxRows, vDispEIngotP

        'tuku +-1ÇÃÉYÉåÇÕOKÇ∆Ç∑ÇÈÅBÅÀWFïùä‘Ç…ì¸óÕâ¬î\ílÇ™ÇQÇ¬Ç†ÇÈèÍçáÇÃëŒâû
        fnc_ErrDispCheck = FUNCTION_RETURN_SUCCESS
    End With
End Function

'*******************************************************************************************
'*    ä÷êîñº        : sub_FurikaeMotoDataSet
'*
'*    èàóùäTóv      : 1.êUë÷å≥ïiî‘ÇÉZÅ[ÉuÇµÅAêUë÷ì‡óeê›íËÇÉNÉäÉAÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@Å@ ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sub_FurikaeMotoDataSet()
    Dim lngCnt  As Long
    Dim i       As Long
    Dim m       As Long

    ReDim MotoHinban((UBound(tExamine) + 1) / 2)

    For i = 1 To ((UBound(tExamine) + 1) / 2)
        With MotoHinban(i)
            For lngCnt = (i * 2 - 1) To (i * 2)
                If lngCnt Mod 2 = 0 Then
                .MOTOICHIE = tExamine(lngCnt - 1).RITOP_POS
                Else
                .MOTOICHIS = tExamine(lngCnt - 1).RITOP_POS
                .MOTOHIN.hinban = tExamine(lngCnt - 1).hinban
                .MOTOHIN.factory = tExamine(lngCnt - 1).factory
                .MOTOHIN.opecond = tExamine(lngCnt - 1).opecond
                .MOTOHIN.mnorevno = tExamine(lngCnt - 1).REVNUM
                End If
            Next lngCnt
        End With
    Next i

    ReDim FurikaeNaiyou(0)
    ReDim FurikaeNaiyouWK(0)

    TokuCntWK = 0

    ReDim TokusaiBangou(TokuCnt)
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : sub_FurikaeKouho
'*
'*    èàóùäTóv      : 1.êUë÷â¬î\åÛï‚ïiî‘âÊñ ÇÊÇËêUë÷êÊïiî‘ÇéÊìæÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@Å@ ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sub_FurikaeKouho()
    With sprExamine
        .row = .ActiveRow
        .col = .ActiveCol
        If .text <> "" Then
            .col = 5
            If .text = "" Then
                lblMsg.Caption = "åãèªà íuÇ™Ç†ÇËÇ‹ÇπÇÒ"
                Exit Sub
            End If
            If sub_FurikaeKouho_Check() = False Then
                Exit Sub
            End If
        Else
            lblMsg.Caption = "êUë÷å≥ÇÃïiî‘Ç™éwíËÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒ"
            Exit Sub
        End If
    End With

    '' êUë÷â¬î\åÛï‚ïiî‘âÊñ åƒÇ—èoÇµ
    f_cmzcFKKH.Show 1

    '' êUë÷êÊïiî‘Çï\é¶Ç∑ÇÈ
    If FKKH_SakiHinban <> "" Then
        With sprExamine
            .row = .ActiveRow
            .col = 2
            .text = left$(FKKH_SakiHinban, 8)
            .col = 3
            .text = Right$(FKKH_SakiHinban, 4)

            '' èàóùÇ™ïœçXÇ≥ÇÍÇΩéû
            Call sprExamine_Change(2, .row)
        End With
    End If
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : sub_FurikaeKouho_Check
'*
'*    èàóùäTóv      : 1.ïiî‘ñ¢ëIëÇÃÉ`ÉFÉbÉNÇçsÇ§
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@Å@ ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : BooleanÅiÉ`ÉFÉbÉNOK:TrueÅAÉ`ÉFÉbÉNNG:FalseÅj
'*
'*******************************************************************************************
Public Function sub_FurikaeKouho_Check() As Boolean
    Dim intIchi         As Integer
    Dim lngCnt          As Long
    Dim sCkHinban       As String
    Dim sCkHinbanRev    As String

    sub_FurikaeKouho_Check = False

    With sprExamine
        '' ëIëïiî‘ÇÃê›íË
        .row = .ActiveRow
        .col = 5            ' à íu
        If .text = "" Then
            .row = .ActiveRow - 1
        End If
        intIchi = .text

        '' êUë÷å≥ïiî‘É`ÉFÉbÉN
        For lngCnt = 1 To UBound(MotoHinban)
            If MotoHinban(lngCnt).MOTOICHIS <= intIchi And intIchi < MotoHinban(lngCnt).MOTOICHIE Then
                sCkHinban = MotoHinban(lngCnt).MOTOHIN.hinban
                sCkHinbanRev = Format$(MotoHinban(lngCnt).MOTOHIN.mnorevno, "00") & MotoHinban(lngCnt).MOTOHIN.factory & MotoHinban(lngCnt).MOTOHIN.opecond
                Exit For
            End If
        Next

        If (Trim$(sCkHinban) = "G" Or Trim$(sCkHinban) = "Z" Or _
            Trim$(sCkHinban) = "") Then
            .col = 2           ' ïiî‘
            .backColor = COLOR_NG
            lblMsg.Caption = "ëIëÇÃïiî‘ÇÕêUë÷â¬î\ïiî‘Ç≈ÇÕÇ†ÇËÇ‹ÇπÇÒ"
            Exit Function
        End If

        '' ïKóvÉfÅ[É^ê›íË
        FKKH_Proccd = "CW760"
        FKKH_MotoHinban = sCkHinban & sCkHinbanRev
        FKKH_Crynum = txtCryNum.text
    End With

    sub_FurikaeKouho_Check = True
End Function

'*******************************************************************************************
'*    ä÷êîñº        : fnc_Furikae_Check
'*
'*    èàóùäTóv      : 1.êUë÷â¬î€É`ÉFÉbÉN
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@Å@ ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : BooleanÅiÉ`ÉFÉbÉNOK:TrueÅAÉ`ÉFÉbÉNNG:FalseÅj
'*
'*******************************************************************************************
Private Function fnc_Furikae_Check() As Boolean
    Dim intLp           As Integer
    Dim lngCnt          As Long
    Dim lngCnt2         As Long
    Dim lngCnt3         As Long
    Dim lngCnt4         As Long
    Dim udtSakiHin      As tFullHinban
    Dim intIchi         As Integer
    Dim intIchiE        As Integer      'ïiî‘èIóπà íu
    Dim intUmuFlg       As Integer
    Dim intTokuFlg      As Integer
    Dim intOikomiFlg    As Integer
    Dim intRet          As Integer
    Dim intErrCode      As Integer
    Dim intErrMsg       As String
    Dim sRepidT         As String
    Dim sRepidB         As String
    Dim sVgetlotid      As String
    Dim sSmpllID1       As String
    Dim intSmpGetFlg    As Integer
    Dim m, intLp2       As Integer
    Dim blWKchkFlg      As Boolean      'Warp/çáê¨äpìxÇÃ¡™Ø∏óLñ≥
    Dim udtCAhin()      As typ_XSDCA    'Ãﬁ€Ø∏ì‡ïiî‘éÊìæóp
    Dim sSqlWhere       As String       'WHEREãÂ
    Dim udtHin          As tFullHinban  'ïiî‘
    Dim udtChkHin()     As tFullHinban  'ëgçáÇπ¡™Ø∏ópïiî‘
    Dim intHinRow()     As Integer      'ïiî‘çsà íu
    Dim intHinCnt       As Integer      'ïiî‘êî
    Dim intHinGrp       As Integer      'ïiî‘∏ﬁŸ∞Ãﬂ(Ãﬁ€Ø∏íPà )
    Dim sBlkChk         As String       'Ãﬁ€Ø∏ID
    Dim intOiChk        As Integer      'í«çûÇ›¡™Ø∏
    Dim intNGrow        As Integer      'ëgçáÇπ¡™Ø∏NGïiî‘çsà íu

    intHinCnt = 0
    intHinGrp = 0
    intOiChk = 0
    ReDim udtChkHin(0)
    ReDim intHinRow(0)

    Dim nInpos      As Integer          ' åãèªì‡à íuÅië„ï\ÉTÉìÉvÉãÇhÇcéÊìæÇÃà◊Åj

    fnc_Furikae_Check = False

    With sprExamine
        ReDim FurikaeNaiyouWK(.MaxRows)
        m = 0       '06/01/12 ooba
        '' êUë÷É`ÉFÉbÉN
        For intLp = 1 To .MaxRows - 1
            blWKchkFlg = False

            .row = intLp
            .col = 5                    ' à íu
            If .text = "" Then          'â∫Ç…çsÇë}ì¸ÇµÇΩèÍçáÇ…ÇÕèâä˙ï\é¶éûÇ…à íuÇ™ê›íËÇ≥ÇÍÇƒÇ¢Ç»Ç¢ÇÃÇ≈è„ÇÃà íuÇå©ÇÈ
                .row = intLp - 1
            End If
            intIchi = .text

            'ïiî‘èIóπà íuéÊìæ
            .row = intLp + 1
            intIchiE = .text
            .row = intLp
            intOiChk = 0      'í«çûÇ›¡™Ø∏Ã◊∏ﬁèâä˙âª

            .col = 2           ' ïiî‘
            udtSakiHin.hinban = .text

            Call GetLastHinban(udtSakiHin.hinban, udtSakiHin) 'ÉtÉãåÖïiî‘ÇéÊìæ

            .col = 3        ' ïiî‘ÉäÉrÉWÉáÉì
            .text = Format$(udtSakiHin.mnorevno, "00") & udtSakiHin.factory & udtSakiHin.opecond

            If Trim(udtSakiHin.hinban) <> "" And _
               Trim(udtSakiHin.hinban) <> "G" And _
               Trim(udtSakiHin.hinban) <> "Z" Then

                m = m + 1
                tMapHinG = tMapHin(m)
                blWKchkFlg = True
            End If

            ''ïiî‘ëgçáÇπ¡™Ø∏ëŒâû
            'è„í«çûÇ›¡™Ø∏
            If intIchi <> tExamine(0).RITOP_POS Then intOiChk = intOiChk + 1

            'â∫í«çûÇ›¡™Ø∏
            If intIchiE <> tExamine(UBound(tExamine)).RITOP_POS Then intOiChk = intOiChk + 1

            'G/Zïià»äO
            If Trim(udtSakiHin.hinban) <> "" And Trim(udtSakiHin.hinban) <> "G" And _
               Trim(udtSakiHin.hinban) <> "Z" Then
                intHinCnt = intHinCnt + 1
                ReDim Preserve udtChkHin(intHinCnt)
                ReDim Preserve intHinRow(intHinCnt)

                'ïiî‘æØƒ
                udtChkHin(intHinCnt) = udtSakiHin
                intHinRow(intHinCnt) = intLp

                'Ãﬁ€Ø∏IDï\é¶óLÇ»ÇÁï Ãﬁ€Ø∏
                    .col = 1:   sBlkChk = .text
                    If Trim(sBlkChk) <> "" Then intHinGrp = intHinGrp + 1

                'Ãﬁ€Ø∏íPà NoæØƒ
                If intHinGrp < 10 Then
                    udtChkHin(intHinCnt).Hinkubun = Chr$(intHinGrp + vbKey0)
                Else
                    udtChkHin(intHinCnt).Hinkubun = Chr$(intHinGrp - 10 + vbKeyA)
                End If
            End If

            'ÉGÉsêÊçsï]âøí«â¡ëŒâû
            .col = 39
            .row = intLp
            sVgetlotid = .text

            ' ÉTÉìÉvÉãIDÇÃéÊìæ
            .col = 5
            nInpos = CInt(.text)
            Call fnc_Furikae_Set_RepID(sRepidT, sRepidB, nInpos)

            '' nÉuÉçÉbÉN1SXLópÇ…ÉNÉäÉAÇ∑ÇÈ
            .row = intLp
            .col = 10
            If Trim(.text) = "" Then sRepidT = ""
            .row = intLp + 1
            .col = 10
            If Trim(.text) = "" Then sRepidB = ""

            .row = intLp


            '' êUë÷óLñ≥É`ÉFÉbÉN
            intUmuFlg = 0
            intOikomiFlg = 0
            For lngCnt = 1 To UBound(MotoHinban)
                If MotoHinban(lngCnt).MOTOICHIS <= intIchi And intIchi < MotoHinban(lngCnt).MOTOICHIE Then
                    If MotoHinban(lngCnt).MOTOHIN.hinban <> udtSakiHin.hinban Or _
                       MotoHinban(lngCnt).MOTOHIN.mnorevno <> udtSakiHin.mnorevno Or _
                       MotoHinban(lngCnt).MOTOHIN.factory <> udtSakiHin.factory Or _
                       MotoHinban(lngCnt).MOTOHIN.opecond <> udtSakiHin.opecond Then
                        intUmuFlg = 1
                        If MotoHinban(lngCnt).MOTOICHIS <> intIchi Then
                            intOikomiFlg = 1
                        End If
                    End If
                    .col = 2
                    .backColor = vbWhite
                    Exit For
                End If
            Next

            '' êUë÷â¬î€É`ÉFÉbÉN
            If intUmuFlg = 1 Then
                '' êUë÷ì‡óeê›íËÉfÅ[É^
                FurikaeNaiyouWK(intLp).FURIUMU = intUmuFlg
                FurikaeNaiyouWK(intLp).ICHI = tblNukishi(intLp).INPOSCW         '2003/10/27 SystemBrain
                FurikaeNaiyouWK(intLp).MOTOHIN = MotoHinban(lngCnt).MOTOHIN
                FurikaeNaiyouWK(intLp).SAKIHIN = udtSakiHin
                FurikaeNaiyouWK(intLp).TREPID = sRepidT
                FurikaeNaiyouWK(intLp).BREPID = sRepidB

                '' à íuÇÃçƒê›íË
                If tblNukishi(intLp).INPOSCW = -1 Then
                    FurikaeNaiyouWK(intLp).ICHI = intIchi
                End If

                '' ä˘ë∂ÇÃì¡çÃîzóÒÇÃà íuÇ∆ª›ÃﬂŸIDÇå©íºÇ∑
                For lngCnt3 = 1 To TokuCntWK - 1
                    For lngCnt4 = 1 To UBound(FurikaeNaiyouWK)
                        If TokusaiBangou(lngCnt3).SAKIHIN.hinban = FurikaeNaiyouWK(lngCnt4).SAKIHIN.hinban And _
                           TokusaiBangou(lngCnt3).SAKIHIN.mnorevno = FurikaeNaiyouWK(lngCnt4).SAKIHIN.mnorevno And _
                           TokusaiBangou(lngCnt3).SAKIHIN.factory = FurikaeNaiyouWK(lngCnt4).SAKIHIN.factory And _
                           TokusaiBangou(lngCnt3).SAKIHIN.opecond = FurikaeNaiyouWK(lngCnt4).SAKIHIN.opecond Then
                            TokusaiBangou(lngCnt3).ICHI = FurikaeNaiyouWK(lngCnt4).ICHI
                            TokusaiBangou(lngCnt3).TREPID = FurikaeNaiyouWK(lngCnt4).TREPID   'ë„ï\ÉTÉìÉvÉãID
                            TokusaiBangou(lngCnt3).BREPID = FurikaeNaiyouWK(lngCnt4).BREPID   'ë„ï\ÉTÉìÉvÉãID
                        End If
                    Next lngCnt4
                Next lngCnt3

                '' ì¡çÃî‘çÜì¸óÕÉ`ÉFÉbÉN
                intTokuFlg = 0
                For lngCnt2 = 1 To TokuCntWK
                    If FurikaeNaiyouWK(intLp).ICHI = TokusaiBangou(lngCnt2).ICHI And _
                       FurikaeNaiyouWK(intLp).MOTOHIN.hinban = TokusaiBangou(lngCnt2).MOTOHIN.hinban And _
                       FurikaeNaiyouWK(intLp).MOTOHIN.mnorevno = TokusaiBangou(lngCnt2).MOTOHIN.mnorevno And _
                       FurikaeNaiyouWK(intLp).MOTOHIN.factory = TokusaiBangou(lngCnt2).MOTOHIN.factory And _
                       FurikaeNaiyouWK(intLp).MOTOHIN.opecond = TokusaiBangou(lngCnt2).MOTOHIN.opecond And _
                       FurikaeNaiyouWK(intLp).SAKIHIN.hinban = TokusaiBangou(lngCnt2).SAKIHIN.hinban And _
                       FurikaeNaiyouWK(intLp).SAKIHIN.mnorevno = TokusaiBangou(lngCnt2).SAKIHIN.mnorevno And _
                       FurikaeNaiyouWK(intLp).SAKIHIN.factory = TokusaiBangou(lngCnt2).SAKIHIN.factory And _
                       FurikaeNaiyouWK(intLp).SAKIHIN.opecond = TokusaiBangou(lngCnt2).SAKIHIN.opecond Then
                        intTokuFlg = 1
                        ' ì¡çÃî‘çÜÉfÅ[É^Ç†ÇËÇ≈ì¡çÃî‘çÜÇ»ÇµÇÃèÍçá
                        If TokusaiBangou(lngCnt2).BANGOU = "" Then
                            intTokuFlg = 2
                        End If
                        Exit For
                    End If
                Next

                '' ì¡çÃî‘çÜì¸óÕÇÃèÍçáÇÕÉ`ÉFÉbÉNÇ»Çµ
                If intTokuFlg = 0 Then
                    For lngCnt2 = 1 To TokuCntWK
                        If FurikaeNaiyouWK(intLp).MOTOHIN.hinban = TokusaiBangou(lngCnt2).MOTOHIN.hinban And _
                           FurikaeNaiyouWK(intLp).MOTOHIN.mnorevno = TokusaiBangou(lngCnt2).MOTOHIN.mnorevno And _
                           FurikaeNaiyouWK(intLp).MOTOHIN.factory = TokusaiBangou(lngCnt2).MOTOHIN.factory And _
                           FurikaeNaiyouWK(intLp).MOTOHIN.opecond = TokusaiBangou(lngCnt2).MOTOHIN.opecond And _
                           FurikaeNaiyouWK(intLp).SAKIHIN.hinban = TokusaiBangou(lngCnt2).SAKIHIN.hinban And _
                           FurikaeNaiyouWK(intLp).SAKIHIN.mnorevno = TokusaiBangou(lngCnt2).SAKIHIN.mnorevno And _
                           FurikaeNaiyouWK(intLp).SAKIHIN.factory = TokusaiBangou(lngCnt2).SAKIHIN.factory And _
                           FurikaeNaiyouWK(intLp).SAKIHIN.opecond = TokusaiBangou(lngCnt2).SAKIHIN.opecond Then
                            '' êÊÇÃì¡çÃî‘çÜÉfÅ[É^ÇÊÇËê›íË
                            TokuCntWK = TokuCntWK + 1
                            ReDim Preserve TokusaiBangou(TokuCntWK)
                            TokusaiBangou(TokuCntWK).ICHI = FurikaeNaiyouWK(intLp).ICHI
                            TokusaiBangou(TokuCntWK).MOTOHIN = FurikaeNaiyouWK(intLp).MOTOHIN
                            TokusaiBangou(TokuCntWK).SAKIHIN = FurikaeNaiyouWK(intLp).SAKIHIN
                            TokusaiBangou(TokuCntWK).BANGOU = TokusaiBangou(lngCnt2).BANGOU
                            TokusaiBangou(TokuCntWK).RIYUU = TokusaiBangou(lngCnt2).RIYUU
                            TokusaiBangou(TokuCntWK).ERRRIYUU = TokusaiBangou(lngCnt2).ERRRIYUU
                            intTokuFlg = 3
                            Exit For
                        End If
                    Next

                    If intTokuFlg = 0 Then
                        If intOiChk <> 2 Then
'2012/01/12 Update START DCS)Shoryuji åãèªÉ{ÉgÉÄë§ï•èoãKêßí«â¡ëŒâû
'                            intRet = funChkFurikaeShiyou("CW761", tblSXL.SXLID, MotoHinban(lngCnt).MOTOHIN, _
'                                udtSakiHin, intErrCode, intErrMsg, typ_b, typ_CType, intSmpGetFlg, sSmpllID1, "", 0, 0, 2)
                            intRet = funChkFurikaeShiyou("CW761", tblSXL.SXLID, MotoHinban(lngCnt).MOTOHIN, _
                                udtSakiHin, intErrCode, intErrMsg, typ_b, typ_CType, intSmpGetFlg, sSmpllID1, "", 0, 0, 2, , , , intIchi, intIchiE)
'2012/01/12 Update E_N_D DCS)Shoryuji
                        Else
'2012/01/12 Update START DCS)Shoryuji åãèªÉ{ÉgÉÄë§ï•èoãKêßí«â¡ëŒâû
'                            intRet = funChkFurikaeShiyou("CW762", tblSXL.SXLID, MotoHinban(lngCnt).MOTOHIN, _
'                                udtSakiHin, intErrCode, intErrMsg, typ_b, typ_CType, intSmpGetFlg, sSmpllID1, "", 0, 0, 2)
                            intRet = funChkFurikaeShiyou("CW762", tblSXL.SXLID, MotoHinban(lngCnt).MOTOHIN, _
                                udtSakiHin, intErrCode, intErrMsg, typ_b, typ_CType, intSmpGetFlg, sSmpllID1, "", 0, 0, 2, , , , intIchi, intIchiE)
'2012/01/12 Update E_N_D DCS)Shoryuji
                        End If

                        If Trim(udtSakiHin.hinban) <> "" And _
                           Trim(udtSakiHin.hinban) <> "G" And _
                           Trim(udtSakiHin.hinban) <> "Z" Then

                            tMapHin(m).WARPFLG = tMapHinG.WARPFLG   'WarpêUë÷¡™Ø∏Ã◊∏ﬁæØƒ
                            tMapHin(m).KAKUFLG = tMapHinG.KAKUFLG   'çáê¨äpìxêUë÷¡™Ø∏Ã◊∏ﬁæØƒ
                        End If

                        ''ï°êîïiî‘ëŒâû
                        If intRet = 0 Then
                            sSqlWhere = "where crynumca = '" & Mid(tblSXL.CRYNUM, 1, 9) & Trim(sVgetlotid) & "' "
                            sSqlWhere = sSqlWhere & "and livkca = '0' "

                            'Ãﬁ€Ø∏ì‡ïiî‘éÊìæ
                            If DBDRV_GetXSDCA(udtCAhin(), sSqlWhere) = FUNCTION_RETURN_FAILURE Then
                                lblMsg.Caption = GetMsgStr("EGET2", "XSDCA")
                                Exit Function
                            End If

                            '' 1-4(Cs)É`ÉFÉbÉN
                            For lngCnt4 = 1 To UBound(udtCAhin)
                                udtHin.hinban = udtCAhin(lngCnt4).HINBCA
                                udtHin.mnorevno = udtCAhin(lngCnt4).REVNUMCA
                                udtHin.factory = udtCAhin(lngCnt4).FACTORYCA
                                udtHin.opecond = udtCAhin(lngCnt4).OPECA
                                'CsÇÃédól¡™Ø∏(1-4)Ç…Ç¬Ç¢ÇƒÇÕÃﬁ€Ø∏ì‡ëSïiî‘Ç≈çsÇ§
                                If intOiChk <> 2 Then
'2012/01/12 Update START DCS)Shoryuji åãèªÉ{ÉgÉÄë§ï•èoãKêßí«â¡ëŒâû
'                                    intRet = funChkFurikaeShiyou("CW761", tblSXL.SXLID, _
'                                                              udtHin, udtSakiHin, intErrCode, intErrMsg, _
'                                                              typ_b, typ_CType, intSmpGetFlg, _
'                                                              sSmpllID1, "", 0, 0, 3)
                                    intRet = funChkFurikaeShiyou("CW761", tblSXL.SXLID, _
                                                              udtHin, udtSakiHin, intErrCode, intErrMsg, _
                                                              typ_b, typ_CType, intSmpGetFlg, _
                                                              sSmpllID1, "", 0, 0, 3, , , , intIchi, intIchiE)
'2012/01/12 Update E_N_D DCS)Shoryuji
                                Else
'2012/01/12 Update START DCS)Shoryuji åãèªÉ{ÉgÉÄë§ï•èoãKêßí«â¡ëŒâû
'                                    intRet = funChkFurikaeShiyou("CW762", tblSXL.SXLID, _
'                                                              udtHin, udtSakiHin, intErrCode, intErrMsg, _
'                                                              typ_b, typ_CType, intSmpGetFlg, _
'                                                              sSmpllID1, "", 0, 0, 3)
                                    intRet = funChkFurikaeShiyou("CW762", tblSXL.SXLID, _
                                                              udtHin, udtSakiHin, intErrCode, intErrMsg, _
                                                              typ_b, typ_CType, intSmpGetFlg, _
                                                              sSmpllID1, "", 0, 0, 3, , , , intIchi, intIchiE)
'2012/01/12 Update E_N_D DCS)Shoryuji
                                End If
                                If intRet <= 0 Then Exit For
                            Next lngCnt4

                            '' 1-4(EPD)É`ÉFÉbÉN
                            If intRet = 0 Then
                                For lngCnt4 = 1 To UBound(udtCAhin)
                                    udtHin.hinban = udtCAhin(lngCnt4).HINBCA
                                    udtHin.mnorevno = udtCAhin(lngCnt4).REVNUMCA
                                    udtHin.factory = udtCAhin(lngCnt4).FACTORYCA
                                    udtHin.opecond = udtCAhin(lngCnt4).OPECA
                                    'EPDÇÃédól¡™Ø∏(1-4)Ç…Ç¬Ç¢ÇƒÇÕÃﬁ€Ø∏ì‡ëSïiî‘Ç≈çsÇ§
                                    If intOiChk <> 2 Then
'2012/01/12 Update START DCS)Shoryuji åãèªÉ{ÉgÉÄë§ï•èoãKêßí«â¡ëŒâû
'                                        intRet = funChkFurikaeShiyou("CW761", tblSXL.SXLID, _
'                                                                  udtHin, udtSakiHin, intErrCode, intErrMsg, _
'                                                                  typ_b, typ_CType, intSmpGetFlg, _
'                                                                  sSmpllID1, "", 0, 0, 4)
                                        intRet = funChkFurikaeShiyou("CW761", tblSXL.SXLID, _
                                                                  udtHin, udtSakiHin, intErrCode, intErrMsg, _
                                                                  typ_b, typ_CType, intSmpGetFlg, _
                                                                  sSmpllID1, "", 0, 0, 4, , , , intIchi, intIchiE)
'2012/01/12 Update E_N_D DCS)Shoryuji
                                    Else
'2012/01/12 Update START DCS)Shoryuji åãèªÉ{ÉgÉÄë§ï•èoãKêßí«â¡ëŒâû
'                                        intRet = funChkFurikaeShiyou("CW762", tblSXL.SXLID, _
'                                                                  udtHin, udtSakiHin, intErrCode, intErrMsg, _
'                                                                  typ_b, typ_CType, intSmpGetFlg, _
'                                                                  sSmpllID1, "", 0, 0, 4)
                                        intRet = funChkFurikaeShiyou("CW762", tblSXL.SXLID, _
                                                                  udtHin, udtSakiHin, intErrCode, intErrMsg, _
                                                                  typ_b, typ_CType, intSmpGetFlg, _
                                                                  sSmpllID1, "", 0, 0, 4, , , , intIchi, intIchiE)
'2012/01/12 Update E_N_D DCS)Shoryuji
                                    End If
                                    If intRet <= 0 Then Exit For
                                Next lngCnt4
                            End If

                            '' 1-4(LT)É`ÉFÉbÉN
                            If intRet = 0 Then
                                For lngCnt4 = 1 To UBound(udtCAhin)
                                    udtHin.hinban = udtCAhin(lngCnt4).HINBCA
                                    udtHin.mnorevno = udtCAhin(lngCnt4).REVNUMCA
                                    udtHin.factory = udtCAhin(lngCnt4).FACTORYCA
                                    udtHin.opecond = udtCAhin(lngCnt4).OPECA

                                    'LTÇÃédól¡™Ø∏(1-4)Ç…Ç¬Ç¢ÇƒÇÕÃﬁ€Ø∏ì‡ëSïiî‘Ç≈çsÇ§
                                    If intOiChk <> 2 Then
'2012/01/12 Update START DCS)Shoryuji åãèªÉ{ÉgÉÄë§ï•èoãKêßí«â¡ëŒâû
'                                        intRet = funChkFurikaeShiyou("CW761", tblSXL.SXLID, _
'                                                                  udtHin, udtSakiHin, intErrCode, intErrMsg, _
'                                                                  typ_b, typ_CType, intSmpGetFlg, _
'                                                                  sSmpllID1, "", 0, 0, 5)
                                        intRet = funChkFurikaeShiyou("CW761", tblSXL.SXLID, _
                                                                  udtHin, udtSakiHin, intErrCode, intErrMsg, _
                                                                  typ_b, typ_CType, intSmpGetFlg, _
                                                                  sSmpllID1, "", 0, 0, 5, , , , intIchi, intIchiE)
'2012/01/12 Update E_N_D DCS)Shoryuji
                                    Else
'2012/01/12 Update START DCS)Shoryuji åãèªÉ{ÉgÉÄë§ï•èoãKêßí«â¡ëŒâû
'                                        intRet = funChkFurikaeShiyou("CW762", tblSXL.SXLID, _
'                                                                  udtHin, udtSakiHin, intErrCode, intErrMsg, _
'                                                                  typ_b, typ_CType, intSmpGetFlg, _
'                                                                  sSmpllID1, "", 0, 0, 5)
                                        intRet = funChkFurikaeShiyou("CW762", tblSXL.SXLID, _
                                                                  udtHin, udtSakiHin, intErrCode, intErrMsg, _
                                                                  typ_b, typ_CType, intSmpGetFlg, _
                                                                  sSmpllID1, "", 0, 0, 5, , , , intIchi, intIchiE)
'2012/01/12 Update E_N_D DCS)Shoryuji
                                    End If
                                    If intRet <= 0 Then Exit For
                                Next lngCnt4
                            End If
                        End If

                        If intRet = 1 Then  'êUë÷NGÇ∆êUë÷OK
                            '' ì¡çÃî‘çÜÉfÅ[É^
                            TokuCntWK = TokuCntWK + 1
                            ReDim Preserve TokusaiBangou(TokuCntWK)
                            TokusaiBangou(TokuCntWK).ICHI = FurikaeNaiyouWK(intLp).ICHI
                            TokusaiBangou(TokuCntWK).MOTOHIN = FurikaeNaiyouWK(intLp).MOTOHIN
                            TokusaiBangou(TokuCntWK).SAKIHIN = FurikaeNaiyouWK(intLp).SAKIHIN
                            TokusaiBangou(TokuCntWK).BANGOU = ""
                            TokusaiBangou(TokuCntWK).RIYUU = ""
                            TokusaiBangou(TokuCntWK).ERRRIYUU = left$(intErrMsg, 25)
                            TokusaiBangou(TokuCntWK).TREPID = FurikaeNaiyouWK(intLp).TREPID   'ë„ï\ÉTÉìÉvÉãID
                            TokusaiBangou(TokuCntWK).BREPID = FurikaeNaiyouWK(intLp).BREPID   'ë„ï\ÉTÉìÉvÉãID

                            .col = 2           ' ïiî‘
                            .backColor = COLOR_NG
                            lblMsg.Caption = intErrMsg
                            If bTokuKengenFlag = True Then      ' ì¡çÃå†å¿Ç†ÇËÇÃèÍçá
                                cmdF(5).Enabled = True
                                cmdF(5).backColor = vbRed
                            End If
                            Exit Function
                        ElseIf intRet < 0 Then 'êUë÷ÉGÉâÅ[
                            lblMsg.Caption = intErrMsg
                            Exit Function
                        ElseIf intRet = 0 Then
                            .col = 2
                            .backColor = vbWhite
                        End If
                    Else
                        'êUë÷¡™Ø∏ëŒè€äOÇÃWarp/çáê¨äpìxîªíË
                        For intLp2 = 1 To 2
                            If Not (tMapHinG.WARPFLG And tMapHinG.KAKUFLG) Then
                                intRet = funChkFurikaeShiyou("CW763", tblSXL.SXLID, _
                                                          tMapHinG.HIN, tMapHinG.HIN, _
                                                          intErrCode, intErrMsg, _
                                                          typ_b, typ_CType, 0)

                                tMapHin(m).WARPFLG = tMapHinG.WARPFLG   'WarpêUë÷¡™Ø∏Ã◊∏ﬁæØƒ
                                tMapHin(m).KAKUFLG = tMapHinG.KAKUFLG   'çáê¨äpìxêUë÷¡™Ø∏Ã◊∏ﬁæØƒ
                            End If
                        Next intLp2
                    End If

                '' ì¡çÃî‘çÜì¸óÕÇÃèÍçáÇÕê›íË
                ElseIf intTokuFlg = 2 Then
                    For lngCnt3 = 1 To TokuCntWK
                        If TokusaiBangou(lngCnt2).MOTOHIN.hinban = TokusaiBangou(lngCnt3).MOTOHIN.hinban And _
                           TokusaiBangou(lngCnt2).MOTOHIN.mnorevno = TokusaiBangou(lngCnt3).MOTOHIN.mnorevno And _
                           TokusaiBangou(lngCnt2).MOTOHIN.factory = TokusaiBangou(lngCnt3).MOTOHIN.factory And _
                           TokusaiBangou(lngCnt2).MOTOHIN.opecond = TokusaiBangou(lngCnt3).MOTOHIN.opecond And _
                           TokusaiBangou(lngCnt2).SAKIHIN.hinban = TokusaiBangou(lngCnt3).SAKIHIN.hinban And _
                           TokusaiBangou(lngCnt2).SAKIHIN.mnorevno = TokusaiBangou(lngCnt3).SAKIHIN.mnorevno And _
                           TokusaiBangou(lngCnt2).SAKIHIN.factory = TokusaiBangou(lngCnt3).SAKIHIN.factory And _
                           TokusaiBangou(lngCnt2).SAKIHIN.opecond = TokusaiBangou(lngCnt3).SAKIHIN.opecond Then
                            '' êÊÇÃì¡çÃî‘çÜÉfÅ[É^Ç†ÇËÇ≈ì¡çÃî‘çÜÇ†ÇËÇÃèÍçá
                            If TokusaiBangou(lngCnt3).BANGOU <> "" Then
                                TokusaiBangou(lngCnt2).BANGOU = TokusaiBangou(lngCnt3).BANGOU
                                intTokuFlg = 4
                                Exit For
                            End If
                        End If
                    Next

                    '' ì¡çÃî‘çÜÉfÅ[É^ÇçÏê¨ÇπÇ∏Ç…ÉGÉâÅ[
                    If intTokuFlg = 2 Then
                        .col = 2           ' ïiî‘
                        .backColor = COLOR_NG
                        lblMsg.Caption = "êUë÷î‘çÜÇÃì¸óÕÇ™Ç†ÇËÇ‹ÇπÇÒ"
                        If bTokuKengenFlag = True Then      ' ì¡çÃå†å¿Ç†ÇËÇÃèÍçá
                            cmdF(5).Enabled = True
                            cmdF(5).backColor = vbRed
                        End If
                        Exit Function
                    End If

                    'êUë÷¡™Ø∏ëŒè€äOÇÃWarp/çáê¨äpìxîªíË
                    For intLp2 = 1 To 2
                        If Not (tMapHinG.WARPFLG And tMapHinG.KAKUFLG) Then
                            intRet = funChkFurikaeShiyou("CW763", tblSXL.SXLID, _
                                                      tMapHinG.HIN, tMapHinG.HIN, _
                                                      intErrCode, intErrMsg, _
                                                      typ_b, typ_CType, 0)

                            tMapHin(m).WARPFLG = tMapHinG.WARPFLG   'WarpêUë÷¡™Ø∏Ã◊∏ﬁæØƒ
                            tMapHin(m).KAKUFLG = tMapHinG.KAKUFLG   'çáê¨äpìxêUë÷¡™Ø∏Ã◊∏ﬁæØƒ
                        End If
                    Next intLp2
                Else
                    'êUë÷¡™Ø∏ëŒè€äOÇÃWarp/çáê¨äpìxîªíË
                    For intLp2 = 1 To 2
                        If Not (tMapHinG.WARPFLG And tMapHinG.KAKUFLG) Then
                            intRet = funChkFurikaeShiyou("CW763", tblSXL.SXLID, _
                                                      tMapHinG.HIN, tMapHinG.HIN, _
                                                      intErrCode, intErrMsg, _
                                                      typ_b, typ_CType, 0)

                            tMapHin(m).WARPFLG = tMapHinG.WARPFLG   'WarpêUë÷¡™Ø∏Ã◊∏ﬁæØƒ
                            tMapHin(m).KAKUFLG = tMapHinG.KAKUFLG   'çáê¨äpìxêUë÷¡™Ø∏Ã◊∏ﬁæØƒ
                        End If
                    Next intLp2
                End If
            Else
                'êUë÷¡™Ø∏ëŒè€äOÇÃWarp/çáê¨äpìxîªíË
                If blWKchkFlg Then
                    For intLp2 = 1 To 2
                        If Not (tMapHinG.WARPFLG And tMapHinG.KAKUFLG) Then
                            intRet = funChkFurikaeShiyou("CW763", tblSXL.SXLID, _
                                                      tMapHinG.HIN, tMapHinG.HIN, _
                                                      intErrCode, intErrMsg, _
                                                      typ_b, typ_CType, 0)

                            tMapHin(m).WARPFLG = tMapHinG.WARPFLG   'WarpêUë÷¡™Ø∏Ã◊∏ﬁæØƒ
                            tMapHin(m).KAKUFLG = tMapHinG.KAKUFLG   'çáê¨äpìxêUë÷¡™Ø∏Ã◊∏ﬁæØƒ
                            'îªíËNG
                            If intRet = 1 Then
                                If Not tMapHinG.KAKUFLG Then
                                    lblMsg.Caption = "WarpîªíËÉGÉâÅ[Å@ïiî‘êUë÷ÇçsÇ¡ÇƒÇ≠ÇæÇ≥Ç¢ÅB"
                                Else
                                    lblMsg.Caption = "çáê¨äpìxîªíËÉGÉâÅ[Å@ïiî‘êUë÷ÇçsÇ¡ÇƒÇ≠ÇæÇ≥Ç¢ÅB"
                                End If
                                Exit Function
                            'êUë÷¡™Ø∏¥◊∞
                            ElseIf intRet < 0 Then
                                lblMsg.Caption = intErrMsg
                                Exit Function
                            End If
                        End If
                    Next intLp2
                End If
            End If
            intLp = intLp + 1 '1çsÇ†Ç∆ÇÃçs
        Next intLp

        '' Zïiî‘ÇÃÇ›ÇÃèÍçáÇÕïiî‘ëgçáÇπÉ`ÉFÉbÉNÇÕïsóv
        If UBound(udtChkHin) > 0 Then
            ''ïiî‘ëgçáÇπ¡™Ø∏ëŒâû
            'í«çûÇ›
            If intOiChk = 2 Then
                intRet = funChkKumiHinban("CW762", tblSXL.CRYNUM, _
                                        udtChkHin(), intHinRow(), intNGrow, intErrCode, intErrMsg)
            'êUë÷
            Else
                intRet = funChkKumiHinban("CW761", tblSXL.CRYNUM, _
                                        udtChkHin(), intHinRow(), intNGrow, intErrCode, intErrMsg)
            End If
            If intRet = 1 Then
                .row = intNGrow
                .col = 2
                .backColor = COLOR_NG
                'ïiî‘ÇÃëgçáÇπÇ™ïsê≥Ç≈Ç∑(%s)
                lblMsg.Caption = GetMsgStr("EHIN7", intErrMsg)
                Exit Function
            ElseIf intRet < 0 Then
                lblMsg.Caption = intErrMsg
                Exit Function
            End If
        End If
    End With

    fnc_Furikae_Check = True
End Function

'*******************************************************************************************
'*    ä÷êîñº        : fnc_Furikae_Set_RepID
'*
'*    èàóùäTóv      : 1.êUë÷â¬î€É`ÉFÉbÉN
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@Å@ ,ê‡ñæ
'*Å@Å@      Å@Å@      sRepidT   ,O  ,String       ,ë„ï\ÉTÉìÉvÉãID(Top)
'*Å@Å@      Å@Å@      sRepidB   ,O  ,String       ,ë„ï\ÉTÉìÉvÉãID(Bot)
'*Å@Å@      Å@Å@      intInpos      ,O  ,Integer      ,åãèªì‡à íuÅië„ï\ÉTÉìÉvÉãÇhÇcéÊìæÇÃà◊Åj
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub fnc_Furikae_Set_RepID(sRepidT As String, sRepidB As String, intInpos As Integer)
    Dim i As Integer

    ' èâä˙âªÇµÇƒÇ®Ç≠
    sRepidT = ""
    sRepidB = ""
    For i = 0 To UBound(tKensa()) - 1 Step 2
        ' åãèªì‡à íuÇ™è„â∫ÉTÉìÉvÉãÇÃîÕàÕì‡Ç…Ç†ÇÈÇ©ÅH
        If tKensa(i).INPOSCW <= intInpos And tKensa(i + 1).INPOSCW >= intInpos Then
            sRepidT = tKensa(i).REPSMPLIDCW
            sRepidB = tKensa(i + 1).REPSMPLIDCW
            Exit For
        End If
    Next
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : sub_TokusaiInput
'*
'*    èàóùäTóv      : 1.ì¡çÃî‘çÜì¸óÕâÊñ Ç…Çƒì¡çÃî‘çÜÇì¸óÕÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@Å@ ,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sub_TokusaiInput()
    '' êUë÷å≥ïiî‘Ç∆êUë÷êÊïiî‘ÇÃê›íË
    With TokusaiBangou(TokuCntWK)
        TBN_MotoHinban = .MOTOHIN.hinban & Format$(.MOTOHIN.mnorevno, "00") & .MOTOHIN.factory & .MOTOHIN.opecond
        TBN_SakiHinban = .SAKIHIN.hinban & Format$(.SAKIHIN.mnorevno, "00") & .SAKIHIN.factory & .SAKIHIN.opecond
        TBN_Bangou = .BANGOU
        TBN_Riyuu = .RIYUU
    End With

    '' ì¡çÃî‘çÜì¸óÕâÊñ åƒÇ—èoÇµ
    f_cmzcTBN.Show 1

    '' ì¡çÃî‘çÜÇê›íËÇ∑ÇÈ
    If TBN_Bangou <> "" Then
        TokusaiBangou(TokuCntWK).BANGOU = TBN_Bangou
        TokusaiBangou(TokuCntWK).RIYUU = TBN_Riyuu
    End If
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : fnc_RirekiKanriDB_Touroku
'*
'*    èàóùäTóv      : 1.óöóä«óùÇcÇaÇÃìoò^ÇçsÇ§
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@,ê‡ñæ
'*Å@Å@      Å@Å@      p_ErrMsg    ,O  ,string    ,ERRÉÅÉbÉZÅ[ÉW
'*
'*    ñﬂÇËíl        : Boolean (True:OK False:NG)
'*
'*******************************************************************************************
Public Function fnc_RirekiKanriDB_Touroku(sP_ErrMsg As String) As Boolean
    Dim cnt             As Long
    Dim cnt2            As Long
    Dim intLp           As Integer
    Dim intKCNTC3       As Integer
    Dim udtDataXSDC3()  As typ_XSDC3    'çHíˆé¿ê—îzóÒ
    Dim sWhere          As String       'SQLï∂éöóÒ
    Dim sDBName         As String
    Dim intTokuFlg      As Integer
    Dim sErrMsg         As String
    Dim sCGetlotid      As String
    Dim sVgetlotid      As String
    Dim intINPOSC3      As Integer

    fnc_RirekiKanriDB_Touroku = False

    cnt = 0
    ReDim FurikaeRireki(cnt)

    For intLp = 1 To UBound(FurikaeNaiyou)
        '' êUë÷óöóÇÃìoò^ÉfÅ[É^ê›íË
        If FurikaeNaiyou(intLp).FURIUMU = 1 Then
            cnt = cnt + 1
            ReDim Preserve FurikaeRireki(cnt)

            'ÉuÉçÉbÉNID
            sprExamine.col = 39

            sprExamine.row = intLp
            sVgetlotid = sprExamine.text

            '' çHíˆòAî‘éÊìæ
            intKCNTC3 = GetKCNTC3(Mid(tblSXL.SXLID, 1, 9) & Trim(sVgetlotid), "CW760")
            If intKCNTC3 = 0 Then
                sP_ErrMsg = "çHíˆòAî‘ÇéÊìæÇ≈Ç´Ç‹ÇπÇÒÇ≈ÇµÇΩ"
                Exit Function
            End If

            'WHEREèåè
            sWhere = "WHERE CRYNUMC3 = '" & Mid(tblSXL.SXLID, 1, 9) & Trim(sVgetlotid) & "' "
            sWhere = sWhere & "AND INPOSC3 = " & FurikaeNaiyou(intLp).ICHI & " "    'åãèªì‡äJénà íu
            sWhere = sWhere & "AND KCNTC3  = " & intKCNTC3 & " "

            '' çHíˆé¿ê—(XSDC3)ÉfÅ[É^éÊìæ
            sDBName = "XSDC3"
            If DBDRV_GetXSDC3(udtDataXSDC3, sWhere) = FUNCTION_RETURN_FAILURE Then
                sP_ErrMsg = GetMsgStr("EGET ", vbNullString, sDBName)
                Exit Function
            End If

            intINPOSC3 = -1
            If UBound(udtDataXSDC3) = 0 Then
                '' åãèªì‡äJénà íu
                intINPOSC3 = GetINPOSC3(Mid(tblSXL.SXLID, 1, 9) & Trim(sVgetlotid), FurikaeNaiyou(intLp).ICHI, intKCNTC3)
                If intINPOSC3 = -1 Then
                    sP_ErrMsg = "åãèªì‡äJénà íuÇéÊìæÇ≈Ç´Ç‹ÇπÇÒÇ≈ÇµÇΩ"
                    Exit Function
                End If

                'WHEREèåè
                sWhere = "WHERE CRYNUMC3 = '" & Mid(tblSXL.SXLID, 1, 9) & Trim(sVgetlotid) & "' "
                sWhere = sWhere & "AND INPOSC3 = " & intINPOSC3 & " "
                sWhere = sWhere & "AND KCNTC3  = " & intKCNTC3 & " "

                '' çHíˆé¿ê—(XSDC3)ÉfÅ[É^éÊìæ
                sDBName = "XSDC3"
                If DBDRV_GetXSDC3(udtDataXSDC3, sWhere) = FUNCTION_RETURN_FAILURE Then
                    sP_ErrMsg = GetMsgStr("EGET ", vbNullString, sDBName)
                    Exit Function
                End If

                If UBound(udtDataXSDC3) = 0 Then
                    sP_ErrMsg = "çHíˆé¿ê—(XSDC3)ÇéÊìæÇ≈Ç´Ç‹ÇπÇÒÇ≈ÇµÇΩ"
                    Exit Function
                End If
            End If

            '' ì¡çÃî‘çÜéÊìæ
            intTokuFlg = 0
            For cnt2 = 1 To TokuCntWK
                If FurikaeNaiyou(intLp).ICHI = TokusaiBangou(cnt2).ICHI And _
                   FurikaeNaiyou(intLp).MOTOHIN.hinban = TokusaiBangou(cnt2).MOTOHIN.hinban And _
                   FurikaeNaiyou(intLp).MOTOHIN.mnorevno = TokusaiBangou(cnt2).MOTOHIN.mnorevno And _
                   FurikaeNaiyou(intLp).MOTOHIN.factory = TokusaiBangou(cnt2).MOTOHIN.factory And _
                   FurikaeNaiyou(intLp).MOTOHIN.opecond = TokusaiBangou(cnt2).MOTOHIN.opecond And _
                   FurikaeNaiyou(intLp).SAKIHIN.hinban = TokusaiBangou(cnt2).SAKIHIN.hinban And _
                   FurikaeNaiyou(intLp).SAKIHIN.mnorevno = TokusaiBangou(cnt2).SAKIHIN.mnorevno And _
                   FurikaeNaiyou(intLp).SAKIHIN.factory = TokusaiBangou(cnt2).SAKIHIN.factory And _
                   FurikaeNaiyou(intLp).SAKIHIN.opecond = TokusaiBangou(cnt2).SAKIHIN.opecond Then
                    intTokuFlg = 1
                    Exit For
                End If
            Next

            With FurikaeRireki(cnt)
                .CRYNUMCE = udtDataXSDC3(1).CRYNUMC3                    ' ÉuÉçÉbÉNIDÅEåãèªî‘çÜÅ©XSDC3ÇÊÇË
                .INPOSCE = FurikaeNaiyou(intLp).ICHI                    ' åãèªì‡äJénà íu
                If intINPOSC3 <> -1 Then
                    .INPOSCE = intINPOSC3                               ' åãèªì‡äJénà íu
                End If
                .KCNTCE = udtDataXSDC3(1).KCNTC3                        ' çHíˆòAî‘
                .HINBCE = FurikaeNaiyou(intLp).SAKIHIN.hinban           ' êUë÷êÊïiî‘
                .REVNUMCE = FurikaeNaiyou(intLp).SAKIHIN.mnorevno       ' êªïiî‘çÜâ¸í˘î‘çÜ(êUë÷êÊ)
                .FACTORYCE = FurikaeNaiyou(intLp).SAKIHIN.factory       ' çHèÍ(êUë÷êÊ)
                .OPECE = FurikaeNaiyou(intLp).SAKIHIN.opecond           ' ëÄã∆èåè(êUë÷êÊ)
                .MOTHINCE = FurikaeNaiyou(intLp).MOTOHIN.hinban         ' êUë÷å≥ïiî‘
                .MREVNUMCE = FurikaeNaiyou(intLp).MOTOHIN.mnorevno      ' êªïiî‘çÜâ¸í˘î‘çÜ(êUë÷å≥)
                .MFACTORYCE = FurikaeNaiyou(intLp).MOTOHIN.factory      ' çHèÍ(êUë÷å≥)
                .MOPECE = FurikaeNaiyou(intLp).MOTOHIN.opecond          ' ëÄã∆èåè(êUë÷å≥)
                .SXLIDCE = udtDataXSDC3(1).SXLIDC3                      ' SXLID
                .WKKTCE = udtDataXSDC3(1).WKKTC3                        ' çHíˆ
                .KNKTCE = udtDataXSDC3(1).KNKTC3                        ' ä«óùçHíˆ
                .REPSMPLIDTCE = FurikaeNaiyou(intLp).TREPID             ' ë„ï\ÉTÉìÉvÉãID(TOP)
                .REPSMPLIDBCE = FurikaeNaiyou(intLp).BREPID             ' ë„ï\ÉTÉìÉvÉãID(BOT)
                If intTokuFlg = 0 Then
                    .TOKNUMCE = ""                                      ' ì¡çÃî‘çÜ
                    .TOKCAUSECE = ""                                    ' ì¡çÃóùóR
                    .ERRCAUSECE = ""                                    ' ÉGÉâÅ[óùóR
                Else
                    .TOKNUMCE = TokusaiBangou(cnt2).BANGOU              ' ì¡çÃî‘çÜ
                    .TOKCAUSECE = TokusaiBangou(cnt2).RIYUU             ' ì¡çÃóùóR
                    .ERRCAUSECE = TokusaiBangou(cnt2).ERRRIYUU          ' ÉGÉâÅ[óùóR
                End If
                .TOKCODECE = ""                                         ' ì¡çÃóùóRÉRÅ[Éh
                .HULCE = udtDataXSDC3(1).TOLC3                          ' êUë÷í∑Ç≥
                .HUWCE = udtDataXSDC3(1).TOWC3                          ' êUë÷èdó 
                .HUMCE = udtDataXSDC3(1).TOMC3                          ' êUë÷ñáêî Å©XSDC3ÇÊÇË
                .TSTAFFCE = txtStaffID.text                             ' ìoò^é–àıID
                .KSTAFFCE = txtStaffID.text                             ' çXêVé–àıID
                .SNDKCE = "0"                                           ' ëóêMÉtÉâÉO (0:ñ¢ëóêM)
                .SNDDAYCE = ""                                          ' ëóêMì˙ït (ÉuÉâÉìÉN)
            End With
        End If
    Next

    ' nÉuÉçÉbÉN1SXLÇÃÉfÅ[É^ÇÃêUë÷óöóÇÕÇPåè
    intLp = 1
    Do While True
        If UBound(FurikaeRireki) >= intLp + 1 Then
            If FurikaeRireki(intLp).HINBCE = FurikaeRireki(intLp + 1).HINBCE And _
               FurikaeRireki(intLp).REVNUMCE = FurikaeRireki(intLp + 1).REVNUMCE And _
               FurikaeRireki(intLp).FACTORYCE = FurikaeRireki(intLp + 1).FACTORYCE And _
               FurikaeRireki(intLp).OPECE = FurikaeRireki(intLp + 1).OPECE And _
               Trim(FurikaeRireki(intLp).REPSMPLIDBCE) = "" And _
               Trim(FurikaeRireki(intLp + 1).REPSMPLIDTCE) = "" Then
                Call fnc_FurikaeRireki_Join(intLp)
                Call fnc_FurikaeRireki_Move(intLp + 1)
                ReDim Preserve FurikaeRireki(UBound(FurikaeRireki) - 1)
            Else
                intLp = intLp + 1
            End If
        Else
            Exit Do
        End If
    Loop

    For intLp = 1 To UBound(FurikaeRireki)
        '' êUë÷óöóÇÃìoò^
        If CreateXSDCE(FurikaeRireki(intLp), sErrMsg) = False Then
            sP_ErrMsg = sErrMsg
            Exit Function
        End If
        'ì¡çÃì¸óÕí ímÉÅÅ[ÉãëóêM  2011/07/04 Kameda
        If intTokuFlg = 1 Then
            Call SendMailMain(FurikaeRireki(intLp))
        End If
    Next

    fnc_RirekiKanriDB_Touroku = True
End Function

'*******************************************************************************************
'*    ä÷êîñº        : fnc_FurikaeRireki_Join
'*
'*    èàóùäTóv      : 1.â∫ïiî‘ÇéüÇÃóöóÇ©ÇÁÉRÉsÅ[
'*Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@2.éüÇÃóöóÇ∆ÇÃçáéZ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@,ê‡ñæ
'*Å@Å@      Å@Å@      intIdxÅ@Å@     ,I  ,Integer   ,êUë÷óöóÉfÅ[É^ìYÇ¶éö
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Public Sub fnc_FurikaeRireki_Join(intIdx As Integer)
    ' â∫ïiî‘ÇéüÇÃóöóÇ©ÇÁÉRÉsÅ[
    FurikaeRireki(intIdx).REPSMPLIDBCE = FurikaeRireki(intIdx + 1).REPSMPLIDBCE
    ' çáéZ
    FurikaeRireki(intIdx).HULCE = CStr(CInt(FurikaeRireki(intIdx).HULCE) + CInt(FurikaeRireki(intIdx + 1).HULCE))    ' êUë÷í∑Ç≥
    FurikaeRireki(intIdx).HUWCE = CStr(CLng(FurikaeRireki(intIdx).HUWCE) + CLng(FurikaeRireki(intIdx + 1).HUWCE))    ' êUë÷èdó 
    FurikaeRireki(intIdx).HUMCE = CStr(CInt(FurikaeRireki(intIdx).HUMCE) + CInt(FurikaeRireki(intIdx + 1).HUMCE))    ' êUë÷ñáêî
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : fnc_FurikaeRireki_Move
'*
'*    èàóùäTóv      : 1.óöóÉfÅ[É^ÇÇPåèãlÇﬂÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@,ê‡ñæ
'*Å@Å@      Å@Å@      intIdxÅ@Å@     ,I  ,Integer   ,êUë÷óöóÉfÅ[É^ìYÇ¶éö
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Public Sub fnc_FurikaeRireki_Move(intIdx As Integer)
    ' óöóÉfÅ[É^ÇÇPåèãlÇﬂÇÈ
    Dim intLp As Integer

    For intLp = intIdx To UBound(FurikaeRireki) - 1
        FurikaeRireki(intLp) = FurikaeRireki(intLp + 1)
    Next
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : sub_ClearTokusai
'*
'*    èàóùäTóv      : 1.ì¡çÃèÓïÒÉNÉäÉA
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sub_ClearTokusai()

    '' ì¡çÃÉoÉbÉtÉ@ÉNÉäÉA
    TokuCntWK = TokuCnt
    ReDim Preserve TokusaiBangou(TokuCntWK)
    '' ì¡çÃÉ{É^ÉìÉNÉäÉA
    cmdF(5).Enabled = False
    cmdF(5).backColor = &H8000000F
    'ÉÅÉbÉZÅ[ÉWÉGÉäÉAÉNÉäÉA
    lblMsg.Caption = ""
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : sub_DispSumple_Hanei_Ep_1
'*
'*    èàóùäTóv      : 1.ÉTÉìÉvÉãîΩâf(ÉGÉs)
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@,ê‡ñæ
'*Å@Å@      Å@Å@      i  Å@Å@     ,I  ,Integer   ,SpreadÇÃçsÇ…égópÇµÇƒÇ¢ÇÈìYéö
'*Å@Å@      Å@Å@      intNukisiRowÅ@,I  ,Integer   ,î≤éééwé¶ÉeÅ[ÉuÉãà íu
'*Å@Å@      Å@Å@      intSmpkbn   ,I  ,Integer   ,ÉTÉìÉvÉããÊï™Ç™ë„ï\ÉTÉìÉvÉãÇ©îªífÇ∑ÇÈ
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sub_DispSumple_Hanei_Ep_1(i As Integer, intNukisiRow As Integer, intSmpkbn As Integer)
    With sprExamine
        'BMD1E
        .col = 29
        .row = i
        .backColor = vbWhite
        If .text <> "2" Then
            If tblWafInd(intNukisiRow).SMP.EPIINDB1 = "3" Then
                If tblNukishi(i).EPINDB1CW = "1" And tblNukishi(i + 1).EPINDB1CW = "1" Then
                    tblNukishi(i + 1).EPINDB1CW = "2"
                    tblNukishi(i + 1).EPSMPLIDB1CW = tblNukishi(i).EPSMPLIDB1CW
                    tblNukishi(i + 1).EPRESB1CW = "0"
                    .row = i + 1
                    .text = "2"
                Else
                    intSmpkbn = 1
                End If
            End If
        ElseIf (.text = "2" And tblNukishi(i + 1).EPINDB1CW = "2") Or (.text = "2" And tblNukishi(i + 1).EPINDB1CW = "1") Then
            intSmpkbn = 1
        End If

        'BMD2E
        .col = 30
        .row = i
        .backColor = vbWhite
        If .text <> "2" Then
            If tblWafInd(intNukisiRow).SMP.EPIINDB2 = "3" Then
                If tblNukishi(i).EPINDB2CW = "1" And tblNukishi(i + 1).EPINDB2CW = "1" Then
                    tblNukishi(i + 1).EPINDB2CW = "2"
                    tblNukishi(i + 1).EPSMPLIDB2CW = tblNukishi(i).EPSMPLIDB2CW
                    tblNukishi(i + 1).EPRESB2CW = "0"
                    .row = i + 1
                    .text = "2"
                Else
                    intSmpkbn = 1
                End If
            End If
        ElseIf (.text = "2" And tblNukishi(i + 1).EPINDB2CW = "2") Or (.text = "2" And tblNukishi(i + 1).EPINDB2CW = "1") Then
            intSmpkbn = 1
        End If

        'BMD3E
        .col = 31
        .row = i
        .backColor = vbWhite
        If .text <> "2" Then
            If tblWafInd(intNukisiRow).SMP.EPIINDB3 = "3" Then
                If tblNukishi(i).EPINDB3CW = "1" And tblNukishi(i + 1).EPINDB3CW = "1" Then
                    tblNukishi(i + 1).EPINDB3CW = "2"
                    tblNukishi(i + 1).EPSMPLIDB3CW = tblNukishi(i).EPSMPLIDB3CW
                    tblNukishi(i + 1).EPRESB3CW = "0"
                    .row = i + 1
                    .text = "2"
                Else
                    intSmpkbn = 1
                End If
            End If
        ElseIf (.text = "2" And tblNukishi(i + 1).EPINDB3CW = "2") Or (.text = "2" And tblNukishi(i + 1).EPINDB3CW = "1") Then
            intSmpkbn = 1
        End If

        'OSF1E
        .col = 32
        .row = i
        .backColor = vbWhite
        If .text <> "2" Then
            If tblWafInd(intNukisiRow).SMP.EPIINDL1 = "3" Then
                If tblNukishi(i).EPINDL1CW = "1" And tblNukishi(i + 1).EPINDL1CW = "1" Then
                    tblNukishi(i + 1).EPINDL1CW = "2"
                    tblNukishi(i + 1).EPSMPLIDL1CW = tblNukishi(i).EPSMPLIDL1CW
                    tblNukishi(i + 1).EPRESL1CW = "0"
                    .row = i + 1
                    .text = "2"
                Else
                    intSmpkbn = 1
                End If
            End If
        ElseIf (.text = "2" And tblNukishi(i + 1).EPINDL1CW = "2") Or (.text = "2" And tblNukishi(i + 1).EPINDL1CW = "1") Then
            intSmpkbn = 1
        End If

        'OSF2E
        .col = 33
        .row = i
        .backColor = vbWhite
        If .text <> "2" Then
            If tblWafInd(intNukisiRow).SMP.EPIINDL2 = "3" Then
                If tblNukishi(i).EPINDL2CW = "1" And tblNukishi(i + 1).EPINDL2CW = "1" Then
                    tblNukishi(i + 1).EPINDL2CW = "2"
                    tblNukishi(i + 1).EPSMPLIDL2CW = tblNukishi(i).EPSMPLIDL2CW
                    tblNukishi(i + 1).EPRESL2CW = "0"
                    .row = i + 1
                    .text = "2"
                Else
                    intSmpkbn = 1
                End If
            End If
        ElseIf (.text = "2" And tblNukishi(i + 1).EPINDL2CW = "2") Or (.text = "2" And tblNukishi(i + 1).EPINDL2CW = "1") Then
            intSmpkbn = 1
        End If

        'OSF3E
        .col = 34
        .row = i
        .backColor = vbWhite
        If .text <> "2" Then
            If tblWafInd(intNukisiRow).SMP.EPIINDL3 = "3" Then
                If tblNukishi(i).EPINDL3CW = "1" And tblNukishi(i + 1).EPINDL3CW = "1" Then
                    tblNukishi(i + 1).EPINDL3CW = "2"
                    tblNukishi(i + 1).EPSMPLIDL3CW = tblNukishi(i).EPSMPLIDL3CW
                    tblNukishi(i + 1).EPRESL3CW = "0"
                    .row = i + 1
                    .text = "2"
                Else
                    intSmpkbn = 1
                End If
            End If
        ElseIf (.text = "2" And tblNukishi(i + 1).EPINDL3CW = "2") Or (.text = "2" And tblNukishi(i + 1).EPINDL3CW = "1") Then
            intSmpkbn = 1
        End If
    End With
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : sub_DispSumple_Hanei_Ep_2
'*
'*    èàóùäTóv      : 1.ÉTÉìÉvÉãîΩâf(ÉGÉs)
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@,ê‡ñæ
'*Å@Å@      Å@Å@      i  Å@Å@     ,I  ,Integer   ,SpreadÇÃçsÇ…égópÇµÇƒÇ¢ÇÈìYéö
'*Å@Å@      Å@Å@      intNukisiRowÅ@,I  ,Integer   ,î≤éééwé¶ÉeÅ[ÉuÉãà íu
'*Å@Å@      Å@Å@      skensa1   ,I  ,Integer   ,åüç∏óp
'*Å@Å@      Å@Å@      skensa2   ,I  ,Integer   ,åüç∏óp
'*Å@Å@      Å@Å@      intZkbnÅ@   ,I  ,Integer   ,ZãÊï™
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sub_DispSumple_Hanei_Ep_2(i As Integer, intNukisiRow As Integer, skensa1() As String, skensa2() As String, intZkbn As Integer)
    With sprExamine
         '' BMD1E
         .col = 29
         .backColor = vbWhite
         If .text <> "2" And .text <> "" Then
             If intZkbn = 4 Or intZkbn = 2 Then
                 If tblNukishi(i + 1).EPINDB1CW = "1" Then
                     tblNukishi(i).EPINDB1CW = "2"
                     tblNukishi(i).EPSMPLIDB1CW = ""
                     tblNukishi(i).EPRESB1CW = "1"
                 Else
                     'ÉRÉsÅ[
                     tblNukishi(i + 1).EPSMPLIDB1CW = tblNukishi(i).EPSMPLIDB1CW
                     tblNukishi(i + 1).EPRESB1CW = tblNukishi(i).EPRESB1CW
                 End If
             ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                 If tblWafInd(intNukisiRow).SMP.EPIINDB1 = "3" Then
                     If tblNukishi(i).EPINDB1CW = "1" And tblNukishi(i + 1).EPINDB1CW = "1" Then
                         If skensa1(19) = "2" Then
                             tblNukishi(i).EPINDB1CW = "2"
                             tblNukishi(i).EPSMPLIDB1CW = tblNukishi(i + 1).EPSMPLIDB1CW
                             tblNukishi(i).EPRESB1CW = "0"
                             .text = skensa1(19)
                         End If
                     End If
                 End If
             End If
         ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
             tblNukishi(i + 1).EPSMPLIDB1CW = tblNukishi(i).EPSMPLIDB1CW
         End If
         If (intZkbn = 4 Or intZkbn = 2) And skensa2(19) = "0" Then
             tblNukishi(i + 1).EPINDB1CW = "0"
             tblNukishi(i + 1).EPSMPLIDB1CW = ""
             tblNukishi(i + 1).EPRESB1CW = "0"
             .row = i + 1
             .text = ""
             .row = i
         End If

         '' BMD2E
         .col = 30
         .backColor = vbWhite
         If .text <> "2" And .text <> "" Then
             If intZkbn = 4 Or intZkbn = 2 Then
                 If tblNukishi(i + 1).EPINDB2CW = "1" Then
                     tblNukishi(i).EPINDB2CW = "2"
                     tblNukishi(i).EPSMPLIDB2CW = ""
                     tblNukishi(i).EPRESB2CW = "1"
                 Else
                     'ÉRÉsÅ[
                     tblNukishi(i + 1).EPSMPLIDB2CW = tblNukishi(i).EPSMPLIDB2CW
                     tblNukishi(i + 1).EPRESB2CW = tblNukishi(i).EPRESB2CW
                 End If
             ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                 If tblWafInd(intNukisiRow).SMP.EPIINDB2 = "3" Then
                     If tblNukishi(i).EPINDB2CW = "1" And tblNukishi(i + 1).EPINDB2CW = "1" Then
                         If skensa1(20) = "2" Then
                             tblNukishi(i).EPINDB2CW = "2"
                             tblNukishi(i).EPSMPLIDB2CW = tblNukishi(i + 1).EPSMPLIDB2CW
                             tblNukishi(i).EPRESB2CW = "0"
                             .text = skensa1(20)
                         End If
                     End If
                 End If
             End If
         ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
             tblNukishi(i + 1).EPSMPLIDB2CW = tblNukishi(i).EPSMPLIDB2CW
         End If
         If (intZkbn = 4 Or intZkbn = 2) And skensa2(20) = "0" Then
             tblNukishi(i + 1).EPINDB2CW = "0"
             tblNukishi(i + 1).EPSMPLIDB2CW = ""
             tblNukishi(i + 1).EPRESB2CW = "0"
             .row = i + 1
             .text = ""
             .row = i
         End If

         '' BMD3E
         .col = 31
         .backColor = vbWhite
         If .text <> "2" And .text <> "" Then
             If intZkbn = 4 Or intZkbn = 2 Then
                 If tblNukishi(i + 1).EPINDB3CW = "1" Then
                     tblNukishi(i).EPINDB3CW = "2"
                     tblNukishi(i).EPSMPLIDB3CW = ""
                     tblNukishi(i).EPRESB3CW = "1"
                 Else
                     'ÉRÉsÅ[
                     tblNukishi(i + 1).EPSMPLIDB3CW = tblNukishi(i).EPSMPLIDB3CW
                     tblNukishi(i + 1).EPRESB3CW = tblNukishi(i).EPRESB3CW
                 End If
             ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                 If tblWafInd(intNukisiRow).SMP.EPIINDB3 = "3" Then
                     If tblNukishi(i).EPINDB3CW = "1" And tblNukishi(i + 1).EPINDB3CW = "1" Then
                         If skensa1(21) = "2" Then
                             tblNukishi(i).EPINDB3CW = "2"
                             tblNukishi(i).EPSMPLIDB3CW = tblNukishi(i + 1).EPSMPLIDB3CW
                             tblNukishi(i).EPRESB3CW = "0"
                             .text = skensa1(21)
                         End If
                     End If
                 End If
             End If
         ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
             tblNukishi(i + 1).EPSMPLIDB3CW = tblNukishi(i).EPSMPLIDB3CW
         End If
         If (intZkbn = 4 Or intZkbn = 2) And skensa2(21) = "0" Then
             tblNukishi(i + 1).EPINDB3CW = "0"
             tblNukishi(i + 1).EPSMPLIDB3CW = ""
             tblNukishi(i + 1).EPRESB3CW = "0"
             .row = i + 1
             .text = ""
             .row = i
         End If

         'OSF1E
         .col = 32
         .backColor = vbWhite
         If .text <> "2" And .text <> "" Then
             If intZkbn = 4 Or intZkbn = 2 Then
                 If tblNukishi(i + 1).EPINDL1CW = "1" Then
                     tblNukishi(i).EPINDL1CW = "2"
                     tblNukishi(i).EPSMPLIDL1CW = ""
                     tblNukishi(i).EPRESL1CW = "1"
                 Else
                     tblNukishi(i + 1).EPSMPLIDL1CW = tblNukishi(i).EPSMPLIDL1CW
                     tblNukishi(i + 1).EPRESL1CW = tblNukishi(i).EPRESL1CW
                 End If
             ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                 If tblWafInd(intNukisiRow).SMP.EPIINDL1 = "3" Then
                     If tblNukishi(i).EPINDL1CW = "1" And tblNukishi(i + 1).EPINDL1CW = "1" Then
                         If skensa1(22) = "2" Then
                             tblNukishi(i).EPINDL1CW = "2"
                             tblNukishi(i).EPSMPLIDL1CW = tblNukishi(i + 1).EPSMPLIDL1CW
                             tblNukishi(i).EPRESL1CW = "0"
                             .text = skensa1(22)
                         End If
                     End If
                 End If
             End If
         ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
             tblNukishi(i + 1).EPSMPLIDL1CW = tblNukishi(i).EPSMPLIDL1CW
         End If
         If (intZkbn = 4 Or intZkbn = 2) And skensa2(22) = "0" Then
             tblNukishi(i + 1).EPINDL1CW = "0"
             tblNukishi(i + 1).EPSMPLIDL1CW = ""
             tblNukishi(i + 1).EPRESL1CW = "0"
             .row = i + 1
             .text = ""
             .row = i
         End If

        'OSF2E
         .col = 33
         .backColor = vbWhite
         If .text <> "2" And .text <> "" Then
             If intZkbn = 4 Or intZkbn = 2 Then
                 If tblNukishi(i + 1).EPINDL2CW = "1" Then
                     tblNukishi(i).EPINDL2CW = "2"
                     tblNukishi(i).EPSMPLIDL2CW = ""
                     tblNukishi(i).EPRESL2CW = "1"
                 Else
                     tblNukishi(i + 1).EPSMPLIDL2CW = tblNukishi(i).EPSMPLIDL2CW
                     tblNukishi(i + 1).EPRESL2CW = tblNukishi(i).EPRESL2CW
                 End If
             ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                 If tblWafInd(intNukisiRow).SMP.EPIINDL2 = "3" Then
                     If tblNukishi(i).EPINDL2CW = "1" And tblNukishi(i + 1).EPINDL2CW = "1" Then
                         If skensa1(23) = "2" Then
                             tblNukishi(i).EPINDL2CW = "2"
                             tblNukishi(i).EPSMPLIDL2CW = tblNukishi(i + 1).EPSMPLIDL2CW
                             tblNukishi(i).EPRESL2CW = "0"
                             .text = skensa1(23)
                         End If
                     End If
                 End If
             End If
         ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
             tblNukishi(i + 1).EPSMPLIDL2CW = tblNukishi(i).EPSMPLIDL2CW
         End If
         If (intZkbn = 4 Or intZkbn = 2) And skensa2(23) = "0" Then
             tblNukishi(i + 1).EPINDL2CW = "0"
             tblNukishi(i + 1).EPSMPLIDL2CW = ""
             tblNukishi(i + 1).EPRESL2CW = "0"
             .row = i + 1
             .text = ""
             .row = i
         End If

        'OSF3E
         .col = 34
         .backColor = vbWhite
         If .text <> "2" And .text <> "" Then
             If intZkbn = 4 Or intZkbn = 2 Then
                 If tblNukishi(i + 1).EPINDL3CW = "1" Then
                     tblNukishi(i).EPINDL3CW = "2"
                     tblNukishi(i).EPSMPLIDL3CW = ""
                     tblNukishi(i).EPRESL3CW = "1"
                 Else
                     tblNukishi(i + 1).EPSMPLIDL3CW = tblNukishi(i).EPSMPLIDL3CW
                     tblNukishi(i + 1).EPRESL3CW = tblNukishi(i).EPRESL3CW
                 End If
             ElseIf intZkbn = 0 Then 'ZÇ∂Ç·Ç»Ç¢Ç∆Ç´
                 If tblWafInd(intNukisiRow).SMP.EPIINDL3 = "3" Then
                     If tblNukishi(i).EPINDL3CW = "1" And tblNukishi(i + 1).EPINDL3CW = "1" Then
                         If skensa1(24) = "2" Then
                             tblNukishi(i).EPINDL3CW = "2"
                             tblNukishi(i).EPSMPLIDL3CW = tblNukishi(i + 1).EPSMPLIDL3CW
                             tblNukishi(i).EPRESL3CW = "0"
                             .text = skensa1(24)
                         End If
                     End If
                 End If
             End If
         ElseIf (intZkbn = 4 And .text = "2") Or (intZkbn = 2 And .text = "2") Then
             tblNukishi(i + 1).EPSMPLIDL3CW = tblNukishi(i).EPSMPLIDL3CW
         End If
         If (intZkbn = 4 Or intZkbn = 2) And skensa2(24) = "0" Then
             tblNukishi(i + 1).EPINDL3CW = "0"
             tblNukishi(i + 1).EPSMPLIDL3CW = ""
             tblNukishi(i + 1).EPRESL3CW = "0"
             .row = i + 1
             .text = ""
             .row = i
         End If
     End With
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : sub_DispSumple_Hanei_Ep_3
'*
'*    èàóùäTóv      : 1.ÉTÉìÉvÉãîΩâf(ÉGÉs)
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@,ê‡ñæ
'*Å@Å@      Å@Å@      i  Å@Å@     ,I  ,Integer   ,SpreadÇÃçsÇ…égópÇµÇƒÇ¢ÇÈìYéö
'*Å@Å@      Å@Å@      intNukisiRowÅ@,I  ,Integer   ,î≤éééwé¶ÉeÅ[ÉuÉãà íu
'*Å@Å@      Å@Å@      skensa1   ,I  ,Integer   ,åüç∏óp
'*Å@Å@      Å@Å@      skensa2   ,I  ,Integer   ,åüç∏óp
'*Å@Å@      Å@Å@      intZkbnÅ@   ,I  ,Integer   ,ZãÊï™
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sub_DispSumple_Hanei_Ep_3(i As Integer, intNukisiRow As Integer, skensa1() As String, skensa2() As String, intZkbn As Integer)
    With sprExamine
        '' BMD1E
        .col = 29
        .backColor = vbWhite
        If .text <> "2" And .text <> "" Then
            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                If tblNukishi(i).EPINDB1CW = "1" Then
                    tblNukishi(i + 1).EPINDB1CW = "2"
                    tblNukishi(i + 1).EPSMPLIDB1CW = tblNukishi(i).EPSMPLIDB1CW
                    tblNukishi(i + 1).EPRESB1CW = "1"
                Else
                    tblNukishi(i).EPSMPLIDB1CW = tblNukishi(i + 1).EPSMPLIDB1CW
                    tblNukishi(i).EPRESB1CW = tblNukishi(i + 1).EPRESB1CW
                End If
            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                If tblWafInd(intNukisiRow).SMP.EPIINDB1 = "3" Then
                    If tblNukishi(i).EPINDB1CW = "1" And tblNukishi(i + 1).EPINDB1CW = "1" Then
                        If skensa2(19) = "2" Then
                            tblNukishi(i + 1).EPINDB1CW = "2"
                            tblNukishi(i + 1).EPSMPLIDB1CW = tblNukishi(i).EPSMPLIDB1CW
                            tblNukishi(i + 1).EPRESB1CW = "0"
                            .text = skensa2(19)
                        End If
                    End If
                End If
            End If
        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
            tblNukishi(i).EPSMPLIDB1CW = tblNukishi(i + 1).EPSMPLIDB1CW
        End If
        If (intZkbn = 3 Or intZkbn = 1) And skensa1(19) = "0" Then
            tblNukishi(i).EPINDB1CW = "0"
            tblNukishi(i).EPSMPLIDB1CW = ""
            tblNukishi(i).EPRESB1CW = "0"
            .row = i
            .text = ""
            .row = i + 1
        End If

        '' BMD2E
        .col = 30
        .backColor = vbWhite
        If .text <> "2" And .text <> "" Then
            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                If tblNukishi(i).EPINDB2CW = "1" Then
                    tblNukishi(i + 1).EPINDB2CW = "2"
                    tblNukishi(i + 1).EPSMPLIDB2CW = tblNukishi(i).EPSMPLIDB2CW
                    tblNukishi(i + 1).EPRESB2CW = "1"
                Else
                    tblNukishi(i).EPSMPLIDB2CW = tblNukishi(i + 1).EPSMPLIDB2CW
                    tblNukishi(i).EPRESB2CW = tblNukishi(i + 1).EPRESB2CW
                End If
            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                If tblWafInd(intNukisiRow).SMP.EPIINDB2 = "3" Then
                    If tblNukishi(i).EPINDB2CW = "1" And tblNukishi(i + 1).EPINDB2CW = "1" Then
                        If skensa2(20) = "2" Then
                            tblNukishi(i + 1).EPINDB2CW = "2"
                            tblNukishi(i + 1).EPSMPLIDB2CW = tblNukishi(i).EPSMPLIDB2CW
                            tblNukishi(i + 1).EPRESB2CW = "0"
                            .text = skensa2(20)
                        End If
                    End If
                End If
            End If
        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
            tblNukishi(i).EPSMPLIDB2CW = tblNukishi(i + 1).EPSMPLIDB2CW
        End If
        If (intZkbn = 3 Or intZkbn = 1) And skensa1(20) = "0" Then
            tblNukishi(i).EPINDB2CW = "0"
            tblNukishi(i).EPSMPLIDB2CW = ""
            tblNukishi(i).EPRESB2CW = "0"
            .row = i
            .text = ""
            .row = i + 1
        End If

        '' BMD3E
        .col = 31
        .backColor = vbWhite
        If .text <> "2" And .text <> "" Then
            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                If tblNukishi(i).EPINDB3CW = "1" Then
                    tblNukishi(i + 1).EPINDB3CW = "2"
                    tblNukishi(i + 1).EPSMPLIDB3CW = tblNukishi(i).EPSMPLIDB3CW
                    tblNukishi(i + 1).EPRESB3CW = "1"
                Else
                    tblNukishi(i).EPSMPLIDB3CW = tblNukishi(i + 1).EPSMPLIDB3CW
                    tblNukishi(i).EPRESB3CW = tblNukishi(i + 1).EPRESB3CW
                End If
            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                If tblWafInd(intNukisiRow).SMP.EPIINDB3 = "3" Then
                    If tblNukishi(i).EPINDB3CW = "1" And tblNukishi(i + 1).EPINDB3CW = "1" Then
                        If skensa2(21) = "2" Then
                            tblNukishi(i + 1).EPINDB3CW = "2"
                            tblNukishi(i + 1).EPSMPLIDB3CW = tblNukishi(i).EPSMPLIDB3CW
                            tblNukishi(i + 1).EPRESB3CW = "0"
                            .text = skensa2(21)
                        End If
                    End If
                End If
            End If
        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
            tblNukishi(i).EPSMPLIDB3CW = tblNukishi(i + 1).EPSMPLIDB3CW
        End If
        If (intZkbn = 3 Or intZkbn = 1) And skensa1(21) = "0" Then
            tblNukishi(i).EPINDB3CW = "0"
            tblNukishi(i).EPSMPLIDB3CW = ""
            tblNukishi(i).EPRESB3CW = "0"
            .row = i
            .text = ""
            .row = i + 1
        End If

        ''OSF1E
        .col = 32
        .backColor = vbWhite
        If .text <> "2" And .text <> "" Then
            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                If tblNukishi(i).EPINDL1CW = "1" Then
                    tblNukishi(i + 1).EPINDL1CW = "2"
                    tblNukishi(i + 1).EPSMPLIDL1CW = tblNukishi(i).EPSMPLIDL1CW
                    tblNukishi(i + 1).EPRESL1CW = "1"
                Else
                    tblNukishi(i).EPSMPLIDL1CW = tblNukishi(i + 1).EPSMPLIDL1CW
                    tblNukishi(i).EPRESL1CW = tblNukishi(i + 1).EPRESL1CW
                End If
            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                If tblWafInd(intNukisiRow).SMP.EPIINDL1 = "3" Then
                    If tblNukishi(i).EPINDL1CW = "1" And tblNukishi(i + 1).EPINDL1CW = "1" Then
                        If skensa2(22) = "2" Then
                            tblNukishi(i + 1).EPINDL1CW = "2"
                            tblNukishi(i + 1).EPSMPLIDL1CW = tblNukishi(i).EPSMPLIDL1CW
                            tblNukishi(i + 1).EPRESL1CW = "0"
                            .text = skensa2(22)
                        End If
                    End If
                End If
            End If
        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                tblNukishi(i).EPSMPLIDL1CW = tblNukishi(i + 1).EPSMPLIDL1CW
        End If
        If (intZkbn = 3 Or intZkbn = 1) And skensa1(22) = "0" Then
            tblNukishi(i).EPINDL1CW = "0"
            tblNukishi(i).EPSMPLIDL1CW = ""
            tblNukishi(i).EPRESL1CW = "0"
            .row = i
            .text = ""
            .row = i + 1
        End If

        ''OSF2E
        .col = 33
        .backColor = vbWhite
        If .text <> "2" And .text <> "" Then
            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                If tblNukishi(i).EPINDL2CW = "1" Then
                    tblNukishi(i + 1).EPINDL2CW = "2"
                    tblNukishi(i + 1).EPSMPLIDL2CW = tblNukishi(i).EPSMPLIDL2CW
                    tblNukishi(i + 1).EPRESL2CW = "1"
                Else
                    tblNukishi(i).EPSMPLIDL2CW = tblNukishi(i + 1).EPSMPLIDL2CW
                    tblNukishi(i).EPRESL2CW = tblNukishi(i + 1).EPRESL2CW
                End If
            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                If tblWafInd(intNukisiRow).SMP.EPIINDL2 = "3" Then
                    If tblNukishi(i).EPINDL2CW = "1" And tblNukishi(i + 1).EPINDL2CW = "1" Then
                        If skensa2(23) = "2" Then
                            tblNukishi(i + 1).EPINDL2CW = "2"
                            tblNukishi(i + 1).EPSMPLIDL2CW = tblNukishi(i).EPSMPLIDL2CW
                            tblNukishi(i + 1).EPRESL2CW = "0"
                            .text = skensa2(23)
                        End If
                    End If
                End If
            End If
        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                tblNukishi(i).EPSMPLIDL2CW = tblNukishi(i + 1).EPSMPLIDL2CW
        End If
        If (intZkbn = 3 Or intZkbn = 1) And skensa1(23) = "0" Then
            tblNukishi(i).EPINDL2CW = "0"
            tblNukishi(i).EPSMPLIDL3CW = ""
            tblNukishi(i).EPRESL2CW = "0"
            .row = i
            .text = ""
            .row = i + 1
        End If

        ''OSF3E
        .col = 34
        .backColor = vbWhite
        If .text <> "2" And .text <> "" Then
            If intZkbn = 3 Or intZkbn = 1 Then 'è„ë§Z
                If tblNukishi(i).EPINDL3CW = "1" Then
                    tblNukishi(i + 1).EPINDL3CW = "2"
                    tblNukishi(i + 1).EPSMPLIDL3CW = tblNukishi(i).EPSMPLIDL3CW
                    tblNukishi(i + 1).EPRESL3CW = "1"
                Else
                    tblNukishi(i).EPSMPLIDL3CW = tblNukishi(i + 1).EPSMPLIDL3CW
                    tblNukishi(i).EPRESL3CW = tblNukishi(i + 1).EPRESL3CW
                End If
            ElseIf intZkbn = 0 Then 'ZÇ≈ÇÕÇ»Ç¢
                If tblWafInd(intNukisiRow).SMP.EPIINDL3 = "3" Then
                    If tblNukishi(i).EPINDL3CW = "1" And tblNukishi(i + 1).EPINDL3CW = "1" Then
                        If skensa2(24) = "2" Then
                            tblNukishi(i + 1).EPINDL3CW = "2"
                            tblNukishi(i + 1).EPSMPLIDL3CW = tblNukishi(i).EPSMPLIDL3CW
                            tblNukishi(i + 1).EPRESL3CW = "0"
                            .text = skensa2(24)
                        End If
                    End If
                End If
            End If
        ElseIf (intZkbn = 3 And .text = "2") Or (intZkbn = 1 And .text = "2") Then
                tblNukishi(i).EPSMPLIDL3CW = tblNukishi(i + 1).EPSMPLIDL3CW
        End If
        If (intZkbn = 3 Or intZkbn = 1) And skensa1(24) = "0" Then
            tblNukishi(i).EPINDL3CW = "0"
            tblNukishi(i).EPSMPLIDL3CW = ""
            tblNukishi(i).EPRESL3CW = "0"
            .row = i
            .text = ""
            .row = i + 1
        End If
    End With
End Sub

'*******************************************************************************************
'*    ä÷êîñº        : fnc_ChkMukesaki
'*
'*    èàóùäTóv      : 1.ëIëÇ≥ÇÍÇΩïiî‘Ç…ëŒÇ∑ÇÈå¸êÊÇÉ`ÉFÉbÉNÇ∑ÇÈ
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº      ,IO ,å^      Å@,ê‡ñæ
'*Å@Å@      Å@Å@      Ç»Çµ
'*
'*    ñﬂÇËíl        : ê≥èÌèIóπéûÇÕFUNCTION_RETURN_SUCCESS(0),
'*                    ÉGÉâÅ[èIóπéûÇÕ FUNCTION_RETURN_FAILURE(-1)
'*
'*******************************************************************************************
Public Function fnc_ChkMukesaki() As FUNCTION_RETURN
    Dim i As Integer
    Dim sMukesaki As String
    Dim sHinban As String

    fnc_ChkMukesaki = FUNCTION_RETURN_FAILURE

    With sprExamine
        For i = 1 To .MaxRows Step 2
            .row = i
            .col = 2
            sHinban = .text

            If Trim(sHinban) <> "Z" And Trim(sHinban) <> "G" And Trim(sHinban) <> "" Then
                If ChkMukesaki_E001(Trim(sHinban)) = FUNCTION_RETURN_FAILURE Then
                    .row = i + 1
                    .backColor = vbRed
                    Exit Function
                Else
                    .row = i + 1
                    .backColor = vbWhite
                End If
            End If
        Next i
    End With

    fnc_ChkMukesaki = FUNCTION_RETURN_SUCCESS
End Function

'*******************************************************************************************
'*    ä÷êîñº        : sub_cmbc039_3_ChangeHinSpec
'*
'*    èàóùäTóv      : 1.WFédólÅÃÉGÉsédólÇÃï\é¶êÿë÷
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^              ,ê‡ñæ
'*Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@intCategoryÅ@ ,I  ,Integer         ,ï\é¶ÉJÉeÉSÉä(0:WFédól,1:ÉGÉsédól)
'*
'*    ñﬂÇËíl        : Ç»Çµ
'*
'*******************************************************************************************
Private Sub sub_cmbc039_3_ChangeHinSpec(Optional intCategory As Integer = 0)
    Dim i       As Long

    On Error Resume Next

    With f_cmbc039_3.sprSpec

        .ReDraw = False

        Select Case intCategory
        Case 0          ' WFédólÉfÅ[É^ÇÃï\é¶
            ' Rs(6óÒñ⁄)Å`AO(21óÒñ⁄)
            For i = 6 To 21 Step 1
                .ColWidth(i) = 2.75
            Next i

            ' OT1(22óÒñ⁄)
            i = 22:   .ColWidth(i) = 3

            ' GD(23óÒñ⁄)
            i = 23:   .ColWidth(i) = 2.75

            ' B1E(24óÒñ⁄)Å`OT2(30óÒñ⁄)
            For i = 24 To 30 Step 1
                .ColWidth(i) = 0      ' îÒï\é¶
            Next i
        Case 1          ' ÉGÉsédólÉfÅ[É^ÇÃï\é¶
            ' Rs(6óÒñ⁄)Å`GD(23óÒñ⁄)
            For i = 6 To 23 Step 1
                .ColWidth(i) = 0      ' îÒï\é¶
            Next i

            ' B1E(24óÒñ⁄)Å`OT2(30óÒñ⁄)
            For i = 24 To 30 Step 1
                .ColWidth(i) = 3
            Next i
        Case Else

        End Select

        .ReDraw = True
    End With
End Sub

'***********************************************************************************
'*    ä÷êîñº        : fnc_GetMukesaki_XSDCB
'*
'*    èàóùäTóv      : 1.ï™äÑåãèªÅiSXLÅjÇÃSXLIDÇ…ëŒÇ∑ÇÈå¸êÊÇï\é¶
'*
'*    ÉpÉâÉÅÅ[É^    : ïœêîñº        ,IO ,å^              ,ê‡ñæ
'*Å@Å@Å@Å@Å@Å@Å@Å@Å@Å@sSXLid Å@Å@Å@ ,I  ,String          ,SXL ID
'*
'*    ñﬂÇËíl        : String(å¸êÊ)
'*
'***********************************************************************************
Private Function fnc_GetMukesaki_XSDCB(sSXLID As String) As FUNCTION_RETURN
    Dim sSql        As String
    Dim rs          As OraDynaset
    Dim lngRecCnt   As Long      'ÉåÉRÅ[Éhêî
    Dim i           As Long

    'ÉGÉâÅ[ÉnÉìÉhÉâÇÃê›íË
    On Error GoTo proc_err
    gErr.Push "s_cmbc039.bas -- Function Getstaffauthority"

    fnc_GetMukesaki_XSDCB = FUNCTION_RETURN_FAILURE

    sSql = "Select PLANTCATCB "
    sSql = sSql & "from XSDCB "
    sSql = sSql & "where SXLIDCB = '" & Trim(sSXLID) & "' "

    ''ÉfÅ[É^ÇíäèoÇ∑ÇÈ
    Set rs = OraDB.DBCreateDynaset(sSql, ORADYN_DEFAULT)
    If rs.RecordCount = 0 Then
        GoTo proc_exit
    End If

    ''íäèoåãâ Çäiî[Ç∑ÇÈ
    lngRecCnt = rs.RecordCount

    If lngRecCnt = 0 Then
        Exit Function
    End If

    If IsNull(rs("PLANTCATCB")) = False Then
        For i = 0 To UBound(s_MukesakiBase)
            If s_MukesakiBase(i).sMukeCode = rs("PLANTCATCB") Then
               f_cmbc039_3.lblMukesaki.Caption = s_MukesakiBase(i).sMukeName
            End If
        Next i
    End If

    rs.Close

    fnc_GetMukesaki_XSDCB = FUNCTION_RETURN_SUCCESS
proc_exit:
    'èIóπ
    gErr.Pop
    Exit Function

proc_err:
    'ÉGÉâÅ[ÉnÉìÉhÉâ
    Debug.Print "====== Error SQL ======"
    Debug.Print sSql
    gErr.HandleError
    Resume proc_exit
End Function

'äTóv      :åüç∏çÄñ⁄ÇÃÉXÉvÉåÉbÉhÇÃèÛë‘Ç©ÇÁÉTÉìÉvÉãóLÇÉJÉEÉìÉgÇ∑ÇÈ
'Å@2008/03/21 aoyagi
Private Function sub_DispSample_SCnt01(IRow As Integer) As Integer
Dim strKval     As String
Dim i           As Integer 'óÒ
Dim iCnt        As Integer 'åèêî

    iCnt = 0
    
    'ÉXÉvÉåÉbÉhÇÃåüç∏çÄñ⁄(""ÅFîí=vbWhiteÅA1ÅFçï=vbBlackÅA2ÅFâ©êF=vbYellow)
    '                   1or2ÅF∏ﬁ⁄∞=COLOR_CryJitsu
    With sprExamine
    
        .row = IRow
        
        ''écë∂é_ëfåüç∏çÄñ⁄í«â¡Ç…ÇÊÇÈïœçXÅ@03/12/09 ooba
        For i = 11 To 26
            .col = i
            If .backColor = vbBlack Then
                iCnt = iCnt + 1
            End If
            If .backColor = vbYellow Then
                iCnt = iCnt + 1
            End If
            'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD START
            If i = 19 Then
                If .backColor = COLOR_CryJitsu Then
                    iCnt = iCnt + 1
                End If
            End If
            'Åü--- 2010/01/20 SIRDëŒâû SPK habuki ADD END
        Next i

        ''écë∂é_ëfåüç∏çÄñ⁄í«â¡Ç…ÇÊÇÈïœçXÅ@03/12/09 ooba
        '--- 2006/08/15 Cng ÉGÉsêÊçsï]âøí«â¡ëŒâû SMP)kondoh
        For i = 27 To 27
            .col = i
            If .backColor = vbBlack Then
                iCnt = iCnt + 1
            End If
            If .backColor = vbYellow Then
                iCnt = iCnt + 1
            End If
        Next i

        'GDî≤éééwé¶ï\é¶í«â¡Å@05/02/10 ooba
        .col = 28
        If .backColor = vbBlack Then
            iCnt = iCnt + 1
        End If
        If .backColor = vbYellow Then
            iCnt = iCnt + 1
        End If
        
        ''BM1EÅ`OF3E
        For i = 29 To 34
            .col = i
            If .backColor = vbBlack Then
                iCnt = iCnt + 1
            End If
            If .backColor = vbYellow Then
                iCnt = iCnt + 1
            End If
        Next i
        
        ''OT2
        .col = 35
        If .backColor = vbBlack Then
            iCnt = iCnt + 1
        End If
        If .backColor = vbYellow Then
            iCnt = iCnt + 1
        End If
        
        .col = 37
        If .text = 1 Then       'èâä˙ï\é¶çsÇÕÉ`ÉFÉbÉNäOOKÇ∆Ç∑ÇÈ
            iCnt = 9999
        End If
        
        .col = 8
        If .text = "åáóé" Then  'åáóéÇÕÉ`ÉFÉbÉNäOOKÇ∆Ç∑ÇÈ
            iCnt = 9999
        End If
        
        .col = 10
        If Trim(.text) = "" Then    'ÉTÉìÉvÉãIDñ≥ÇÕÉ`ÉFÉbÉNäOOKÇ∆Ç∑ÇÈÅ@08/08/01 ooba
            iCnt = 9999
        End If
        
    End With

    'åèêîÇñﬂÇ∑
    sub_DispSample_SCnt01 = iCnt
    
End Function

'äTóv      :åüç∏çÄñ⁄ÇÃÉXÉvÉåÉbÉhÇÃèÛë‘Ç©ÇÁóLå¯SXLêîÇÉJÉEÉìÉgÇ∑ÇÈ
'Å@2008/03/21 aoyagi
Private Function sub_DispSample_SCnt02(IRow As Integer) As Integer
Dim i           As Integer 'óÒ
Dim iCnt        As Integer 'åèêî
Dim old_bid     As String
Dim now_bid     As String
Dim flg    As String
    
    iCnt = 0
    
    With sprExamine
    
    .row = IRow
    .col = 39
    old_bid = .text
    now_bid = .text
    
    For i = IRow To .MaxRows Step 2
        .row = i
        .col = 39
        now_bid = .text
        
        If now_bid <> old_bid Then
            Exit For
        End If
        
''        .col = 37
''        flg = .text
''        If flg <> 9 Then
            iCnt = iCnt + 1
''        End If
    Next i
    
    'åèêîÇñﬂÇ∑
    sub_DispSample_SCnt02 = iCnt
    
    End With

End Function

'äTóv      :åüç∏çÄñ⁄ÇÃÉXÉvÉåÉbÉhÇÃèÛë‘Ç©ÇÁìØàÍÉuÉçÉbÉNçsêîÇÉJÉEÉìÉgÇ∑ÇÈ
'Å@2008/03/21 aoyagi
Private Function sub_DispSample_SCnt03(IRow As Integer) As Integer
Dim i           As Integer 'óÒ
Dim iCnt        As Integer 'åèêî
Dim old_bid     As String
Dim now_bid     As String
Dim flg    As String
    
    iCnt = 0
    
    With sprExamine
    
    .row = IRow
    .col = 39
    
    old_bid = .text
    now_bid = .text
    
    For i = IRow To .MaxRows
        .row = i
        .col = 39
        now_bid = .text
        
        If now_bid <> old_bid Then
            Exit For
        End If
        
        iCnt = iCnt + 1
    Next i
    
    'åèêîÇñﬂÇ∑
    sub_DispSample_SCnt03 = iCnt
    
    End With

End Function




